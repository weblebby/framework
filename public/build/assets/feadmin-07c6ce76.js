var DT=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports);import{_ as LT}from"./preload-helper-edc1b5d6.js";import{g as VT}from"./_tagify-37881a53.js";import{C as bd}from"./_tab-2f4e71a8.js";import"./_api-32e76925.js";var LF=DT((Ce,xe)=>{const Ci={open:(s,e={})=>{setTimeout(()=>s.classList.toggle("drawer--open"),100),Ci.overlay(s);const i=s.querySelector("[data-drawer-focus]");i==null||i.focus(),s.dispatchEvent(new CustomEvent("drawer.open",{detail:e}))},close:(s,e={})=>{s.classList.toggle("drawer--open");const i=document.querySelector(".drawer__overlay");i.classList.remove("drawer__overlay--fade-in"),s.dispatchEvent(new CustomEvent("drawer.hide",{detail:e})),setTimeout(()=>{i.remove(),s.dispatchEvent(new CustomEvent("drawer.hidden",{detail:e}))},300)},closeCurrent:()=>{Ci.close(document.querySelector(".drawer--open"))},overlay:s=>{const e=document.createElement("div");e.classList.add("drawer__overlay"),document.body.append(e),setTimeout(()=>{e.classList.add("drawer__overlay--fade-in")},10),e.addEventListener("click",()=>{Ci.close(s,{related:e})})}};document.addEventListener("click",s=>{const e=s.target.closest("[data-drawer]");if(e){s.preventDefault();const i=document.querySelector(e.dataset.drawer);i.classList.contains("drawer--open")?Ci.close(i,{related:e}):Ci.open(i,{related:e})}});document.querySelectorAll("[data-drawer-close]").forEach(s=>{s.addEventListener("click",e=>{e.preventDefault(),Ci.close(s.closest(".drawer"),{related:s})})});window.Feadmin.Drawer=Ci;const N_={toastr:null,init(){this.toastr=document.createElement("div"),this.toastr.classList.add("toastr"),document.body.append(this.toastr),this.toastr.addEventListener("click",s=>{const e=s.target;e.classList.contains("toastr__item")&&this.remove(e)})},add(s){const e=document.createElement("div");e.classList.add("toastr__item"),e.innerText=s,this.toastr.appendChild(e),setTimeout(()=>{e.classList.add("toastr__item--born")},10),setTimeout(()=>{this.remove(e)},3e3)},remove(s){s.classList.remove("toastr__item--born"),setTimeout(()=>s.remove(),300)}};N_.init();window.Feadmin.Toastr=N_;var Bd={exports:{}};/*!
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */(function(s,e){(function(i){const a=i.en=i.en||{};a.dictionary=Object.assign(a.dictionary||{},{"%0 of %1":"%0 of %1",Aquamarine:"Aquamarine",Black:"Black","Block quote":"Block quote",Blue:"Blue",Bold:"Bold","Break text":"Break text","Bulleted List":"Bulleted List",Cancel:"Cancel","Cannot upload file:":"Cannot upload file:","Centered image":"Centered image","Change image text alternative":"Change image text alternative","Choose heading":"Choose heading",Column:"Column","Could not insert image at the current position.":"Could not insert image at the current position.","Could not obtain resized image URL.":"Could not obtain resized image URL.","Decrease indent":"Decrease indent","Delete column":"Delete column","Delete row":"Delete row","Dim grey":"Dim grey",Downloadable:"Downloadable","Dropdown toolbar":"Dropdown toolbar","Edit block":"Edit block","Edit link":"Edit link","Editor toolbar":"Editor toolbar","Enter image caption":"Enter image caption","Full size image":"Full size image",Green:"Green",Grey:"Grey","Header column":"Header column","Header row":"Header row",Heading:"Heading","Heading 1":"Heading 1","Heading 2":"Heading 2","Heading 3":"Heading 3","Heading 4":"Heading 4","Heading 5":"Heading 5","Heading 6":"Heading 6","Image toolbar":"Image toolbar","image widget":"image widget","In line":"In line","Increase indent":"Increase indent","Insert column left":"Insert column left","Insert column right":"Insert column right","Insert image":"Insert image","Insert image or file":"Insert image or file","Insert media":"Insert media","Insert paragraph after block":"Insert paragraph after block","Insert paragraph before block":"Insert paragraph before block","Insert row above":"Insert row above","Insert row below":"Insert row below","Insert table":"Insert table","Inserting image failed":"Inserting image failed",Italic:"Italic","Left aligned image":"Left aligned image","Light blue":"Light blue","Light green":"Light green","Light grey":"Light grey",Link:"Link","Link URL":"Link URL","Media URL":"Media URL","media widget":"media widget","Merge cell down":"Merge cell down","Merge cell left":"Merge cell left","Merge cell right":"Merge cell right","Merge cell up":"Merge cell up","Merge cells":"Merge cells",Next:"Next","Numbered List":"Numbered List","Open in a new tab":"Open in a new tab","Open link in new tab":"Open link in new tab",Orange:"Orange",Paragraph:"Paragraph","Paste the media URL in the input.":"Paste the media URL in the input.",Previous:"Previous",Purple:"Purple",Red:"Red",Redo:"Redo","Rich Text Editor":"Rich Text Editor","Rich Text Editor, %0":"Rich Text Editor, %0","Right aligned image":"Right aligned image",Row:"Row",Save:"Save","Select all":"Select all","Select column":"Select column","Select row":"Select row","Selecting resized image failed":"Selecting resized image failed","Show more items":"Show more items","Side image":"Side image","Split cell horizontally":"Split cell horizontally","Split cell vertically":"Split cell vertically","Table toolbar":"Table toolbar","Text alternative":"Text alternative","The URL must not be empty.":"The URL must not be empty.","This link has no URL":"This link has no URL","This media URL is not supported.":"This media URL is not supported.","Tip: Paste the URL into the content to embed faster.":"Tip: Paste the URL into the content to embed faster.","Toggle caption off":"Toggle caption off","Toggle caption on":"Toggle caption on",Turquoise:"Turquoise",Undo:"Undo",Unlink:"Unlink","Upload failed":"Upload failed","Upload in progress":"Upload in progress",White:"White","Widget toolbar":"Widget toolbar","Wrap text":"Wrap text",Yellow:"Yellow"})})(window.CKEDITOR_TRANSLATIONS||(window.CKEDITOR_TRANSLATIONS={})),function(i,a){s.exports=a()}(window,function(){return function(i){var a={};function d(h){if(a[h])return a[h].exports;var f=a[h]={i:h,l:!1,exports:{}};return i[h].call(f.exports,f,f.exports,d),f.l=!0,f.exports}return d.m=i,d.c=a,d.d=function(h,f,b){d.o(h,f)||Object.defineProperty(h,f,{enumerable:!0,get:b})},d.r=function(h){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(h,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(h,"__esModule",{value:!0})},d.t=function(h,f){if(1&f&&(h=d(h)),8&f||4&f&&typeof h=="object"&&h&&h.__esModule)return h;var b=Object.create(null);if(d.r(b),Object.defineProperty(b,"default",{enumerable:!0,value:h}),2&f&&typeof h!="string")for(var k in h)d.d(b,k,(function(C){return h[C]}).bind(null,k));return b},d.n=function(h){var f=h&&h.__esModule?function(){return h.default}:function(){return h};return d.d(f,"a",f),f},d.o=function(h,f){return Object.prototype.hasOwnProperty.call(h,f)},d.p="",d(d.s=110)}([function(i,a,d){d.d(a,"a",function(){return h}),d.d(a,"b",function(){return f});class h extends Error{constructor(y,P,R){super(function(D,$){const Z=new WeakSet,nt=$?" "+JSON.stringify($,(Lt,J)=>{if(typeof J=="object"&&J!==null){if(Z.has(J))return`[object ${J.constructor.name}]`;Z.add(J)}return J}):"",ot=b(D);return D+nt+ot}(y,R)),this.name="CKEditorError",this.context=P,this.data=R}is(y){return y==="CKEditorError"}static rethrowUnexpectedError(y,P){if(y.is&&y.is("CKEditorError"))throw y;const R=new h(y.message,P);throw R.stack=y.stack,R}}function f(C,y){console.warn(...k(C,y))}function b(C){return`
Read more: https://ckeditor.com/docs/ckeditor5/latest/framework/guides/support/error-codes.html#error-`+C}function k(C,y){const P=b(C);return y?[C,y,P]:[C,P]}},function(i,a,d){var h,f=function(){return h===void 0&&(h=!!(window&&document&&document.all&&!window.atob)),h},b=function(){var J={};return function(G){if(J[G]===void 0){var Q=document.querySelector(G);if(window.HTMLIFrameElement&&Q instanceof window.HTMLIFrameElement)try{Q=Q.contentDocument.head}catch{Q=null}J[G]=Q}return J[G]}}(),k=[];function C(J){for(var G=-1,Q=0;Q<k.length;Q++)if(k[Q].identifier===J){G=Q;break}return G}function y(J,G){for(var Q={},B=[],K=0;K<J.length;K++){var W=J[K],it=G.base?W[0]+G.base:W[0],Ht=Q[it]||0,Te="".concat(it," ").concat(Ht);Q[it]=Ht+1;var qo=C(Te),kr={css:W[1],media:W[2],sourceMap:W[3]};qo!==-1?(k[qo].references++,k[qo].updater(kr)):k.push({identifier:Te,updater:Lt(kr,G),references:1}),B.push(Te)}return B}function P(J){var G=document.createElement("style"),Q=J.attributes||{};if(Q.nonce===void 0){var B=d.nc;B&&(Q.nonce=B)}if(Object.keys(Q).forEach(function(W){G.setAttribute(W,Q[W])}),typeof J.insert=="function")J.insert(G);else{var K=b(J.insert||"head");if(!K)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");K.appendChild(G)}return G}var R,D=(R=[],function(J,G){return R[J]=G,R.filter(Boolean).join(`
`)});function $(J,G,Q,B){var K=Q?"":B.media?"@media ".concat(B.media," {").concat(B.css,"}"):B.css;if(J.styleSheet)J.styleSheet.cssText=D(G,K);else{var W=document.createTextNode(K),it=J.childNodes;it[G]&&J.removeChild(it[G]),it.length?J.insertBefore(W,it[G]):J.appendChild(W)}}function Z(J,G,Q){var B=Q.css,K=Q.media,W=Q.sourceMap;if(K?J.setAttribute("media",K):J.removeAttribute("media"),W&&typeof btoa<"u"&&(B+=`
/*# sourceMappingURL=data:application/json;base64,`.concat(btoa(unescape(encodeURIComponent(JSON.stringify(W))))," */")),J.styleSheet)J.styleSheet.cssText=B;else{for(;J.firstChild;)J.removeChild(J.firstChild);J.appendChild(document.createTextNode(B))}}var nt=null,ot=0;function Lt(J,G){var Q,B,K;if(G.singleton){var W=ot++;Q=nt||(nt=P(G)),B=$.bind(null,Q,W,!1),K=$.bind(null,Q,W,!0)}else Q=P(G),B=Z.bind(null,Q,G),K=function(){(function(it){if(it.parentNode===null)return!1;it.parentNode.removeChild(it)})(Q)};return B(J),function(it){if(it){if(it.css===J.css&&it.media===J.media&&it.sourceMap===J.sourceMap)return;B(J=it)}else K()}}i.exports=function(J,G){(G=G||{}).singleton||typeof G.singleton=="boolean"||(G.singleton=f());var Q=y(J=J||[],G);return function(B){if(B=B||[],Object.prototype.toString.call(B)==="[object Array]"){for(var K=0;K<Q.length;K++){var W=C(Q[K]);k[W].references--}for(var it=y(B,G),Ht=0;Ht<Q.length;Ht++){var Te=C(Q[Ht]);k[Te].references===0&&(k[Te].updater(),k.splice(Te,1))}Q=it}}}},,function(i,a,d){var h=d(8),f=typeof self=="object"&&self&&self.Object===Object&&self,b=h.a||f||Function("return this")();a.a=b},function(i,a,d){(function(h){var f=d(3),b=d(14),k=e&&!e.nodeType&&e,C=k&&typeof h=="object"&&h&&!h.nodeType&&h,y=C&&C.exports===k?f.a.Buffer:void 0,P=(y?y.isBuffer:void 0)||b.a;a.a=P}).call(this,d(10)(i))},function(i,a,d){(function(h){var f=d(8),b=e&&!e.nodeType&&e,k=b&&typeof h=="object"&&h&&!h.nodeType&&h,C=k&&k.exports===b&&f.a.process,y=function(){try{var P=k&&k.require&&k.require("util").types;return P||C&&C.binding&&C.binding("util")}catch{}}();a.a=y}).call(this,d(10)(i))},function(i,a,d){(function(h){var f=d(0);const b=typeof window=="object"?window:h;if(b.CKEDITOR_VERSION)throw new f.a("ckeditor-duplicated-modules",null);b.CKEDITOR_VERSION="31.1.0"}).call(this,d(12))},function(i,a,d){var h=d(1),f=d(78);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a,d){(function(h){var f=typeof h=="object"&&h&&h.Object===Object&&h;a.a=f}).call(this,d(12))},function(i,a,d){(function(h){var f=d(3),b=e&&!e.nodeType&&e,k=b&&typeof h=="object"&&h&&!h.nodeType&&h,C=k&&k.exports===b?f.a.Buffer:void 0,y=C?C.allocUnsafe:void 0;a.a=function(P,R){if(R)return P.slice();var D=P.length,$=y?y(D):new P.constructor(D);return P.copy($),$}}).call(this,d(10)(i))},function(i,a){i.exports=function(d){if(!d.webpackPolyfill){var h=Object.create(d);h.children||(h.children=[]),Object.defineProperty(h,"loaded",{enumerable:!0,get:function(){return h.l}}),Object.defineProperty(h,"id",{enumerable:!0,get:function(){return h.i}}),Object.defineProperty(h,"exports",{enumerable:!0}),h.webpackPolyfill=1}return h}},function(i,a,d){var h=d(1),f=d(79);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){var d;d=function(){return this}();try{d=d||new Function("return this")()}catch{typeof window=="object"&&(d=window)}i.exports=d},function(i,a,d){var h=d(1),f=d(73);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a,d){a.a=function(){return!1}},function(i,a,d){var h=d(1),f=d(16);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=".ck.ck-editor__editable span[data-ck-unsafe-element]{display:none}"},function(i,a,d){var h=d(1),f=d(18);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=".ck-hidden{display:none!important}.ck.ck-reset,.ck.ck-reset_all,.ck.ck-reset_all *{box-sizing:border-box;width:auto;height:auto;position:static}:root{--ck-z-default:1;--ck-z-modal:calc(var(--ck-z-default) + 999)}.ck-transitions-disabled,.ck-transitions-disabled *{transition:none!important}:root{--ck-color-base-foreground:#fafafa;--ck-color-base-background:#fff;--ck-color-base-border:#c4c4c4;--ck-color-base-action:#61b045;--ck-color-base-focus:#6cb5f9;--ck-color-base-text:#333;--ck-color-base-active:#198cf0;--ck-color-base-active-focus:#0e7fe1;--ck-color-base-error:#db3700;--ck-color-focus-border-coordinates:208,79%,51%;--ck-color-focus-border:hsl(var(--ck-color-focus-border-coordinates));--ck-color-focus-outer-shadow:#bcdefb;--ck-color-focus-disabled-shadow:rgba(119,186,248,0.3);--ck-color-focus-error-shadow:rgba(255,64,31,0.3);--ck-color-text:var(--ck-color-base-text);--ck-color-shadow-drop:rgba(0,0,0,0.15);--ck-color-shadow-drop-active:rgba(0,0,0,0.2);--ck-color-shadow-inner:rgba(0,0,0,0.1);--ck-color-button-default-background:transparent;--ck-color-button-default-hover-background:#e6e6e6;--ck-color-button-default-active-background:#d9d9d9;--ck-color-button-default-active-shadow:#bfbfbf;--ck-color-button-default-disabled-background:transparent;--ck-color-button-on-background:#dedede;--ck-color-button-on-hover-background:#c4c4c4;--ck-color-button-on-active-background:#bababa;--ck-color-button-on-active-shadow:#a1a1a1;--ck-color-button-on-disabled-background:#dedede;--ck-color-button-action-background:var(--ck-color-base-action);--ck-color-button-action-hover-background:#579e3d;--ck-color-button-action-active-background:#53973b;--ck-color-button-action-active-shadow:#498433;--ck-color-button-action-disabled-background:#7ec365;--ck-color-button-action-text:var(--ck-color-base-background);--ck-color-button-save:#008a00;--ck-color-button-cancel:#db3700;--ck-color-switch-button-off-background:#b0b0b0;--ck-color-switch-button-off-hover-background:#a3a3a3;--ck-color-switch-button-on-background:var(--ck-color-button-action-background);--ck-color-switch-button-on-hover-background:#579e3d;--ck-color-switch-button-inner-background:var(--ck-color-base-background);--ck-color-switch-button-inner-shadow:rgba(0,0,0,0.1);--ck-color-dropdown-panel-background:var(--ck-color-base-background);--ck-color-dropdown-panel-border:var(--ck-color-base-border);--ck-color-input-background:var(--ck-color-base-background);--ck-color-input-border:#c7c7c7;--ck-color-input-error-border:var(--ck-color-base-error);--ck-color-input-text:var(--ck-color-base-text);--ck-color-input-disabled-background:#f2f2f2;--ck-color-input-disabled-border:#c7c7c7;--ck-color-input-disabled-text:#757575;--ck-color-list-background:var(--ck-color-base-background);--ck-color-list-button-hover-background:var(--ck-color-button-default-hover-background);--ck-color-list-button-on-background:var(--ck-color-base-active);--ck-color-list-button-on-background-focus:var(--ck-color-base-active-focus);--ck-color-list-button-on-text:var(--ck-color-base-background);--ck-color-panel-background:var(--ck-color-base-background);--ck-color-panel-border:var(--ck-color-base-border);--ck-color-toolbar-background:var(--ck-color-base-foreground);--ck-color-toolbar-border:var(--ck-color-base-border);--ck-color-tooltip-background:var(--ck-color-base-text);--ck-color-tooltip-text:var(--ck-color-base-background);--ck-color-engine-placeholder-text:#707070;--ck-color-upload-bar-background:#6cb5f9;--ck-color-link-default:#0000f0;--ck-color-link-selected-background:rgba(31,177,255,0.1);--ck-color-link-fake-selection:rgba(31,177,255,0.3);--ck-disabled-opacity:.5;--ck-focus-outer-shadow-geometry:0 0 0 3px;--ck-focus-outer-shadow:var(--ck-focus-outer-shadow-geometry) var(--ck-color-focus-outer-shadow);--ck-focus-disabled-outer-shadow:var(--ck-focus-outer-shadow-geometry) var(--ck-color-focus-disabled-shadow);--ck-focus-error-outer-shadow:var(--ck-focus-outer-shadow-geometry) var(--ck-color-focus-error-shadow);--ck-focus-ring:1px solid var(--ck-color-focus-border);--ck-font-size-base:13px;--ck-line-height-base:1.84615;--ck-font-face:Helvetica,Arial,Tahoma,Verdana,Sans-Serif;--ck-font-size-tiny:0.7em;--ck-font-size-small:0.75em;--ck-font-size-normal:1em;--ck-font-size-big:1.4em;--ck-font-size-large:1.8em;--ck-ui-component-min-height:2.3em}.ck.ck-reset,.ck.ck-reset_all,.ck.ck-reset_all *{margin:0;padding:0;border:0;background:transparent;text-decoration:none;vertical-align:middle;transition:none;word-wrap:break-word}.ck.ck-reset_all,.ck.ck-reset_all *{border-collapse:collapse;font:normal normal normal var(--ck-font-size-base)/var(--ck-line-height-base) var(--ck-font-face);color:var(--ck-color-text);text-align:left;white-space:nowrap;cursor:auto;float:none}.ck.ck-reset_all .ck-rtl *{text-align:right}.ck.ck-reset_all iframe{vertical-align:inherit}.ck.ck-reset_all textarea{white-space:pre-wrap}.ck.ck-reset_all input[type=password],.ck.ck-reset_all input[type=text],.ck.ck-reset_all textarea{cursor:text}.ck.ck-reset_all input[type=password][disabled],.ck.ck-reset_all input[type=text][disabled],.ck.ck-reset_all textarea[disabled]{cursor:default}.ck.ck-reset_all fieldset{padding:10px;border:2px groove #dfdee3}.ck.ck-reset_all button::-moz-focus-inner{padding:0;border:0}.ck[dir=rtl],.ck[dir=rtl] .ck{text-align:right}:root{--ck-border-radius:2px;--ck-inner-shadow:2px 2px 3px var(--ck-color-shadow-inner) inset;--ck-drop-shadow:0 1px 2px 1px var(--ck-color-shadow-drop);--ck-drop-shadow-active:0 3px 6px 1px var(--ck-color-shadow-drop-active);--ck-spacing-unit:0.6em;--ck-spacing-large:calc(var(--ck-spacing-unit)*1.5);--ck-spacing-standard:var(--ck-spacing-unit);--ck-spacing-medium:calc(var(--ck-spacing-unit)*0.8);--ck-spacing-small:calc(var(--ck-spacing-unit)*0.5);--ck-spacing-tiny:calc(var(--ck-spacing-unit)*0.3);--ck-spacing-extra-tiny:calc(var(--ck-spacing-unit)*0.16)}"},function(i,a,d){var h=d(1),f=d(20);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=".ck.ck-icon{vertical-align:middle}:root{--ck-icon-size:calc(var(--ck-line-height-base)*var(--ck-font-size-normal))}.ck.ck-icon{width:var(--ck-icon-size);height:var(--ck-icon-size);font-size:.8333350694em;will-change:transform}.ck.ck-icon,.ck.ck-icon *{color:inherit;cursor:inherit}.ck.ck-icon :not([fill]){fill:currentColor}"},function(i,a,d){var h=d(1),f=d(22);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports='.ck.ck-tooltip,.ck.ck-tooltip .ck-tooltip__text:after{position:absolute;pointer-events:none;-webkit-backface-visibility:hidden}.ck.ck-tooltip{visibility:hidden;opacity:0;display:none;z-index:var(--ck-z-modal)}.ck.ck-tooltip .ck-tooltip__text{display:inline-block}.ck.ck-tooltip .ck-tooltip__text:after{content:"";width:0;height:0}:root{--ck-tooltip-arrow-size:5px}.ck.ck-tooltip{left:50%;top:0;transition:opacity .2s ease-in-out .2s}.ck.ck-tooltip .ck-tooltip__text{border-radius:0}.ck-rounded-corners .ck.ck-tooltip .ck-tooltip__text,.ck.ck-tooltip .ck-tooltip__text.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-tooltip .ck-tooltip__text{font-size:.9em;line-height:1.5;color:var(--ck-color-tooltip-text);padding:var(--ck-spacing-small) var(--ck-spacing-medium);background:var(--ck-color-tooltip-background);position:relative;left:-50%}.ck.ck-tooltip .ck-tooltip__text:after{transition:opacity .2s ease-in-out .2s;border-style:solid;left:50%}.ck.ck-tooltip.ck-tooltip_s,.ck.ck-tooltip.ck-tooltip_se,.ck.ck-tooltip.ck-tooltip_sw{bottom:calc(var(--ck-tooltip-arrow-size)*-1);transform:translateY(100%)}.ck.ck-tooltip.ck-tooltip_s .ck-tooltip__text:after,.ck.ck-tooltip.ck-tooltip_se .ck-tooltip__text:after,.ck.ck-tooltip.ck-tooltip_sw .ck-tooltip__text:after{top:calc(var(--ck-tooltip-arrow-size)*-1 + 1px);transform:translateX(-50%);border-left-color:transparent;border-bottom-color:var(--ck-color-tooltip-background);border-right-color:transparent;border-top-color:transparent;border-left-width:var(--ck-tooltip-arrow-size);border-bottom-width:var(--ck-tooltip-arrow-size);border-right-width:var(--ck-tooltip-arrow-size);border-top-width:0}.ck.ck-tooltip.ck-tooltip_sw{right:50%;left:auto}.ck.ck-tooltip.ck-tooltip_sw .ck-tooltip__text{left:auto;right:calc(var(--ck-tooltip-arrow-size)*-2)}.ck.ck-tooltip.ck-tooltip_sw .ck-tooltip__text:after{left:auto;right:0}.ck.ck-tooltip.ck-tooltip_se{left:50%;right:auto}.ck.ck-tooltip.ck-tooltip_se .ck-tooltip__text{right:auto;left:calc(var(--ck-tooltip-arrow-size)*-2)}.ck.ck-tooltip.ck-tooltip_se .ck-tooltip__text:after{right:auto;left:0;transform:translateX(50%)}.ck.ck-tooltip.ck-tooltip_n{top:calc(var(--ck-tooltip-arrow-size)*-1);transform:translateY(-100%)}.ck.ck-tooltip.ck-tooltip_n .ck-tooltip__text:after{bottom:calc(var(--ck-tooltip-arrow-size)*-1);transform:translateX(-50%);border-left-color:transparent;border-bottom-color:transparent;border-right-color:transparent;border-top-color:var(--ck-color-tooltip-background);border-left-width:var(--ck-tooltip-arrow-size);border-bottom-width:0;border-right-width:var(--ck-tooltip-arrow-size);border-top-width:var(--ck-tooltip-arrow-size)}.ck.ck-tooltip.ck-tooltip_e{left:calc(100% + var(--ck-tooltip-arrow-size));top:50%}.ck.ck-tooltip.ck-tooltip_e .ck-tooltip__text{left:0;transform:translateY(-50%)}.ck.ck-tooltip.ck-tooltip_e .ck-tooltip__text:after{left:calc(var(--ck-tooltip-arrow-size)*-1);top:calc(50% - var(--ck-tooltip-arrow-size)*1);border-left-color:transparent;border-bottom-color:transparent;border-right-color:var(--ck-color-tooltip-background);border-top-color:transparent;border-left-width:0;border-bottom-width:var(--ck-tooltip-arrow-size);border-right-width:var(--ck-tooltip-arrow-size);border-top-width:var(--ck-tooltip-arrow-size)}.ck.ck-tooltip.ck-tooltip_w{right:calc(100% + var(--ck-tooltip-arrow-size));left:auto;top:50%}.ck.ck-tooltip.ck-tooltip_w .ck-tooltip__text{left:0;transform:translateY(-50%)}.ck.ck-tooltip.ck-tooltip_w .ck-tooltip__text:after{left:100%;top:calc(50% - var(--ck-tooltip-arrow-size)*1);border-left-color:var(--ck-color-tooltip-background);border-bottom-color:transparent;border-right-color:transparent;border-top-color:transparent;border-left-width:var(--ck-tooltip-arrow-size);border-bottom-width:var(--ck-tooltip-arrow-size);border-right-width:0;border-top-width:var(--ck-tooltip-arrow-size)}'},function(i,a,d){var h=d(1),f=d(24);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=".ck.ck-button,a.ck.ck-button{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.ck.ck-button .ck-tooltip,a.ck.ck-button .ck-tooltip{display:block}@media (hover:none){.ck.ck-button .ck-tooltip,a.ck.ck-button .ck-tooltip{display:none}}.ck.ck-button,a.ck.ck-button{position:relative;display:inline-flex;align-items:center;justify-content:left}.ck.ck-button .ck-button__label,a.ck.ck-button .ck-button__label{display:none}.ck.ck-button.ck-button_with-text .ck-button__label,a.ck.ck-button.ck-button_with-text .ck-button__label{display:inline-block}.ck.ck-button:not(.ck-button_with-text),a.ck.ck-button:not(.ck-button_with-text){justify-content:center}.ck.ck-button:hover .ck-tooltip,a.ck.ck-button:hover .ck-tooltip{visibility:visible;opacity:1}.ck.ck-button:focus:not(:hover) .ck-tooltip,a.ck.ck-button:focus:not(:hover) .ck-tooltip{display:none}.ck.ck-button,a.ck.ck-button{background:var(--ck-color-button-default-background)}.ck.ck-button:not(.ck-disabled):hover,a.ck.ck-button:not(.ck-disabled):hover{background:var(--ck-color-button-default-hover-background)}.ck.ck-button:not(.ck-disabled):active,a.ck.ck-button:not(.ck-disabled):active{background:var(--ck-color-button-default-active-background);box-shadow:inset 0 2px 2px var(--ck-color-button-default-active-shadow)}.ck.ck-button.ck-disabled,a.ck.ck-button.ck-disabled{background:var(--ck-color-button-default-disabled-background)}.ck.ck-button,a.ck.ck-button{border-radius:0}.ck-rounded-corners .ck.ck-button,.ck-rounded-corners a.ck.ck-button,.ck.ck-button.ck-rounded-corners,a.ck.ck-button.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-button,a.ck.ck-button{white-space:nowrap;cursor:default;vertical-align:middle;padding:var(--ck-spacing-tiny);text-align:center;min-width:var(--ck-ui-component-min-height);min-height:var(--ck-ui-component-min-height);line-height:1;font-size:inherit;border:1px solid transparent;transition:box-shadow .2s ease-in-out,border .2s ease-in-out;-webkit-appearance:none}.ck.ck-button:active,.ck.ck-button:focus,a.ck.ck-button:active,a.ck.ck-button:focus{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-focus-outer-shadow),0 0}.ck.ck-button .ck-button__icon use,.ck.ck-button .ck-button__icon use *,a.ck.ck-button .ck-button__icon use,a.ck.ck-button .ck-button__icon use *{color:inherit}.ck.ck-button .ck-button__label,a.ck.ck-button .ck-button__label{font-size:inherit;font-weight:inherit;color:inherit;cursor:inherit;vertical-align:middle}[dir=ltr] .ck.ck-button .ck-button__label,[dir=ltr] a.ck.ck-button .ck-button__label{text-align:left}[dir=rtl] .ck.ck-button .ck-button__label,[dir=rtl] a.ck.ck-button .ck-button__label{text-align:right}.ck.ck-button .ck-button__keystroke,a.ck.ck-button .ck-button__keystroke{color:inherit}[dir=ltr] .ck.ck-button .ck-button__keystroke,[dir=ltr] a.ck.ck-button .ck-button__keystroke{margin-left:var(--ck-spacing-large)}[dir=rtl] .ck.ck-button .ck-button__keystroke,[dir=rtl] a.ck.ck-button .ck-button__keystroke{margin-right:var(--ck-spacing-large)}.ck.ck-button .ck-button__keystroke,a.ck.ck-button .ck-button__keystroke{font-weight:700;opacity:.7}.ck.ck-button.ck-disabled:active,.ck.ck-button.ck-disabled:focus,a.ck.ck-button.ck-disabled:active,a.ck.ck-button.ck-disabled:focus{box-shadow:var(--ck-focus-disabled-outer-shadow),0 0}.ck.ck-button.ck-disabled .ck-button__icon,a.ck.ck-button.ck-disabled .ck-button__icon{opacity:var(--ck-disabled-opacity)}.ck.ck-button.ck-disabled .ck-button__label,a.ck.ck-button.ck-disabled .ck-button__label{opacity:var(--ck-disabled-opacity)}.ck.ck-button.ck-disabled .ck-button__keystroke,a.ck.ck-button.ck-disabled .ck-button__keystroke{opacity:.3}.ck.ck-button.ck-button_with-text,a.ck.ck-button.ck-button_with-text{padding:var(--ck-spacing-tiny) var(--ck-spacing-standard)}[dir=ltr] .ck.ck-button.ck-button_with-text .ck-button__icon,[dir=ltr] a.ck.ck-button.ck-button_with-text .ck-button__icon{margin-left:calc(var(--ck-spacing-small)*-1);margin-right:var(--ck-spacing-small)}[dir=rtl] .ck.ck-button.ck-button_with-text .ck-button__icon,[dir=rtl] a.ck.ck-button.ck-button_with-text .ck-button__icon{margin-right:calc(var(--ck-spacing-small)*-1);margin-left:var(--ck-spacing-small)}.ck.ck-button.ck-button_with-keystroke .ck-button__label,a.ck.ck-button.ck-button_with-keystroke .ck-button__label{flex-grow:1}.ck.ck-button.ck-on,a.ck.ck-button.ck-on{background:var(--ck-color-button-on-background)}.ck.ck-button.ck-on:not(.ck-disabled):hover,a.ck.ck-button.ck-on:not(.ck-disabled):hover{background:var(--ck-color-button-on-hover-background)}.ck.ck-button.ck-on:not(.ck-disabled):active,a.ck.ck-button.ck-on:not(.ck-disabled):active{background:var(--ck-color-button-on-active-background);box-shadow:inset 0 2px 2px var(--ck-color-button-on-active-shadow)}.ck.ck-button.ck-on.ck-disabled,a.ck.ck-button.ck-on.ck-disabled{background:var(--ck-color-button-on-disabled-background)}.ck.ck-button.ck-button-save,a.ck.ck-button.ck-button-save{color:var(--ck-color-button-save)}.ck.ck-button.ck-button-cancel,a.ck.ck-button.ck-button-cancel{color:var(--ck-color-button-cancel)}.ck.ck-button-action,a.ck.ck-button-action{background:var(--ck-color-button-action-background)}.ck.ck-button-action:not(.ck-disabled):hover,a.ck.ck-button-action:not(.ck-disabled):hover{background:var(--ck-color-button-action-hover-background)}.ck.ck-button-action:not(.ck-disabled):active,a.ck.ck-button-action:not(.ck-disabled):active{background:var(--ck-color-button-action-active-background);box-shadow:inset 0 2px 2px var(--ck-color-button-action-active-shadow)}.ck.ck-button-action.ck-disabled,a.ck.ck-button-action.ck-disabled{background:var(--ck-color-button-action-disabled-background)}.ck.ck-button-action,a.ck.ck-button-action{color:var(--ck-color-button-action-text)}.ck.ck-button-bold,a.ck.ck-button-bold{font-weight:700}"},function(i,a,d){var h=d(1),f=d(26);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=".ck.ck-button.ck-switchbutton .ck-button__toggle,.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner{display:block}:root{--ck-switch-button-toggle-width:2.6153846154em;--ck-switch-button-toggle-inner-size:1.0769230769em;--ck-switch-button-toggle-spacing:1px;--ck-switch-button-translation:calc(var(--ck-switch-button-toggle-width) - var(--ck-switch-button-toggle-inner-size) - var(--ck-switch-button-toggle-spacing)*2)}[dir=ltr] .ck.ck-button.ck-switchbutton .ck-button__label{margin-right:calc(var(--ck-spacing-large)*2)}[dir=rtl] .ck.ck-button.ck-switchbutton .ck-button__label{margin-left:calc(var(--ck-spacing-large)*2)}.ck.ck-button.ck-switchbutton .ck-button__toggle{border-radius:0}.ck-rounded-corners .ck.ck-button.ck-switchbutton .ck-button__toggle,.ck.ck-button.ck-switchbutton .ck-button__toggle.ck-rounded-corners{border-radius:var(--ck-border-radius)}[dir=ltr] .ck.ck-button.ck-switchbutton .ck-button__toggle{margin-left:auto}[dir=rtl] .ck.ck-button.ck-switchbutton .ck-button__toggle{margin-right:auto}.ck.ck-button.ck-switchbutton .ck-button__toggle{transition:background .4s ease;width:var(--ck-switch-button-toggle-width);background:var(--ck-color-switch-button-off-background)}.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner{border-radius:0}.ck-rounded-corners .ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner,.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner.ck-rounded-corners{border-radius:var(--ck-border-radius);border-radius:calc(var(--ck-border-radius)*0.5)}.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner{margin:var(--ck-switch-button-toggle-spacing);width:var(--ck-switch-button-toggle-inner-size);height:var(--ck-switch-button-toggle-inner-size);background:var(--ck-color-switch-button-inner-background);transition:all .3s ease}.ck.ck-button.ck-switchbutton .ck-button__toggle:hover{background:var(--ck-color-switch-button-off-hover-background)}.ck.ck-button.ck-switchbutton .ck-button__toggle:hover .ck-button__toggle__inner{box-shadow:0 0 0 5px var(--ck-color-switch-button-inner-shadow)}.ck.ck-button.ck-switchbutton.ck-disabled .ck-button__toggle{opacity:var(--ck-disabled-opacity)}.ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle{background:var(--ck-color-switch-button-on-background)}.ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle:hover{background:var(--ck-color-switch-button-on-hover-background)}[dir=ltr] .ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle .ck-button__toggle__inner{transform:translateX(var(--ck-switch-button-translation))}[dir=rtl] .ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle .ck-button__toggle__inner{transform:translateX(calc(var(--ck-switch-button-translation)*-1))}"},function(i,a,d){var h=d(1),f=d(28);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=".ck.ck-color-grid{display:grid}:root{--ck-color-grid-tile-size:24px;--ck-color-color-grid-check-icon:#000}.ck.ck-color-grid{grid-gap:5px;padding:8px}.ck.ck-color-grid__tile{width:var(--ck-color-grid-tile-size);height:var(--ck-color-grid-tile-size);min-width:var(--ck-color-grid-tile-size);min-height:var(--ck-color-grid-tile-size);padding:0;transition:box-shadow .2s ease;border:0}.ck.ck-color-grid__tile.ck-disabled{cursor:unset;transition:unset}.ck.ck-color-grid__tile.ck-color-table__color-tile_bordered{box-shadow:0 0 0 1px var(--ck-color-base-border)}.ck.ck-color-grid__tile .ck.ck-icon{display:none;color:var(--ck-color-color-grid-check-icon)}.ck.ck-color-grid__tile.ck-on{box-shadow:inset 0 0 0 1px var(--ck-color-base-background),0 0 0 2px var(--ck-color-base-text)}.ck.ck-color-grid__tile.ck-on .ck.ck-icon{display:block}.ck.ck-color-grid__tile.ck-on,.ck.ck-color-grid__tile:focus:not(.ck-disabled),.ck.ck-color-grid__tile:hover:not(.ck-disabled){border:0}.ck.ck-color-grid__tile:focus:not(.ck-disabled),.ck.ck-color-grid__tile:hover:not(.ck-disabled){box-shadow:inset 0 0 0 1px var(--ck-color-base-background),0 0 0 2px var(--ck-color-focus-border)}.ck.ck-color-grid__label{padding:0 var(--ck-spacing-standard)}"},function(i,a,d){var h=d(1),f=d(30);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports='.ck.ck-splitbutton{font-size:inherit}.ck.ck-splitbutton .ck-splitbutton__action:focus{z-index:calc(var(--ck-z-default) + 1)}.ck.ck-splitbutton.ck-splitbutton_open>.ck-button .ck-tooltip{display:none}:root{--ck-color-split-button-hover-background:#ebebeb;--ck-color-split-button-hover-border:#b3b3b3}[dir=ltr] .ck.ck-splitbutton.ck-splitbutton_open>.ck-splitbutton__action,[dir=ltr] .ck.ck-splitbutton:hover>.ck-splitbutton__action{border-top-right-radius:unset;border-bottom-right-radius:unset}[dir=rtl] .ck.ck-splitbutton.ck-splitbutton_open>.ck-splitbutton__action,[dir=rtl] .ck.ck-splitbutton:hover>.ck-splitbutton__action{border-top-left-radius:unset;border-bottom-left-radius:unset}.ck.ck-splitbutton>.ck-splitbutton__arrow{min-width:unset}[dir=ltr] .ck.ck-splitbutton>.ck-splitbutton__arrow{border-top-left-radius:unset;border-bottom-left-radius:unset}[dir=rtl] .ck.ck-splitbutton>.ck-splitbutton__arrow{border-top-right-radius:unset;border-bottom-right-radius:unset}.ck.ck-splitbutton>.ck-splitbutton__arrow svg{width:var(--ck-dropdown-arrow-size)}.ck.ck-splitbutton.ck-splitbutton_open>.ck-button:not(.ck-on):not(.ck-disabled):not(:hover),.ck.ck-splitbutton:hover>.ck-button:not(.ck-on):not(.ck-disabled):not(:hover){background:var(--ck-color-split-button-hover-background)}.ck.ck-splitbutton.ck-splitbutton_open>.ck-splitbutton__arrow:not(.ck-disabled):after,.ck.ck-splitbutton:hover>.ck-splitbutton__arrow:not(.ck-disabled):after{content:"";position:absolute;width:1px;height:100%;background-color:var(--ck-color-split-button-hover-border)}[dir=ltr] .ck.ck-splitbutton.ck-splitbutton_open>.ck-splitbutton__arrow:not(.ck-disabled):after,[dir=ltr] .ck.ck-splitbutton:hover>.ck-splitbutton__arrow:not(.ck-disabled):after{left:-1px}[dir=rtl] .ck.ck-splitbutton.ck-splitbutton_open>.ck-splitbutton__arrow:not(.ck-disabled):after,[dir=rtl] .ck.ck-splitbutton:hover>.ck-splitbutton__arrow:not(.ck-disabled):after{right:-1px}.ck.ck-splitbutton.ck-splitbutton_open{border-radius:0}.ck-rounded-corners .ck.ck-splitbutton.ck-splitbutton_open,.ck.ck-splitbutton.ck-splitbutton_open.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck-rounded-corners .ck.ck-splitbutton.ck-splitbutton_open>.ck-splitbutton__action,.ck.ck-splitbutton.ck-splitbutton_open.ck-rounded-corners>.ck-splitbutton__action{border-bottom-left-radius:0}.ck-rounded-corners .ck.ck-splitbutton.ck-splitbutton_open>.ck-splitbutton__arrow,.ck.ck-splitbutton.ck-splitbutton_open.ck-rounded-corners>.ck-splitbutton__arrow{border-bottom-right-radius:0}'},function(i,a,d){var h=d(1),f=d(32);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=":root{--ck-dropdown-max-width:75vw}.ck.ck-dropdown{display:inline-block;position:relative}.ck.ck-dropdown .ck-dropdown__arrow{pointer-events:none;z-index:var(--ck-z-default)}.ck.ck-dropdown .ck-button.ck-dropdown__button{width:100%}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-on .ck-tooltip{display:none}.ck.ck-dropdown .ck-dropdown__panel{-webkit-backface-visibility:hidden;display:none;z-index:var(--ck-z-modal);max-width:var(--ck-dropdown-max-width);position:absolute}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel-visible{display:inline-block}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_n,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_ne,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_nme,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_nmw,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_nw{bottom:100%}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_s,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_se,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_sme,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_smw,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_sw{top:100%;bottom:auto}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_ne,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_se{left:0}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_nw,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_sw{right:0}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_n,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_s{left:50%;transform:translateX(-50%)}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_nmw,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_smw{left:75%;transform:translateX(-75%)}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_nme,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_sme{left:25%;transform:translateX(-25%)}.ck.ck-toolbar .ck-dropdown__panel{z-index:calc(var(--ck-z-modal) + 1)}:root{--ck-dropdown-arrow-size:calc(var(--ck-icon-size)*0.5)}.ck.ck-dropdown{font-size:inherit}.ck.ck-dropdown .ck-dropdown__arrow{width:var(--ck-dropdown-arrow-size)}[dir=ltr] .ck.ck-dropdown .ck-dropdown__arrow{right:var(--ck-spacing-standard);margin-left:var(--ck-spacing-standard)}[dir=rtl] .ck.ck-dropdown .ck-dropdown__arrow{left:var(--ck-spacing-standard);margin-right:var(--ck-spacing-small)}.ck.ck-dropdown.ck-disabled .ck-dropdown__arrow{opacity:var(--ck-disabled-opacity)}[dir=ltr] .ck.ck-dropdown .ck-button.ck-dropdown__button:not(.ck-button_with-text){padding-left:var(--ck-spacing-small)}[dir=rtl] .ck.ck-dropdown .ck-button.ck-dropdown__button:not(.ck-button_with-text){padding-right:var(--ck-spacing-small)}.ck.ck-dropdown .ck-button.ck-dropdown__button .ck-button__label{width:7em;overflow:hidden;text-overflow:ellipsis}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-disabled .ck-button__label{opacity:var(--ck-disabled-opacity)}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-on{border-bottom-left-radius:0;border-bottom-right-radius:0}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-dropdown__button_label-width_auto .ck-button__label{width:auto}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-off:active,.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-on:active{box-shadow:none}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-off:active:focus,.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-on:active:focus{box-shadow:var(--ck-focus-outer-shadow),0 0}.ck.ck-dropdown__panel{border-radius:0}.ck-rounded-corners .ck.ck-dropdown__panel,.ck.ck-dropdown__panel.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-dropdown__panel{box-shadow:var(--ck-drop-shadow),0 0;background:var(--ck-color-dropdown-panel-background);border:1px solid var(--ck-color-dropdown-panel-border);bottom:0;min-width:100%}.ck.ck-dropdown__panel.ck-dropdown__panel_se{border-top-left-radius:0}.ck.ck-dropdown__panel.ck-dropdown__panel_sw{border-top-right-radius:0}.ck.ck-dropdown__panel.ck-dropdown__panel_ne{border-bottom-left-radius:0}.ck.ck-dropdown__panel.ck-dropdown__panel_nw{border-bottom-right-radius:0}"},function(i,a,d){var h=d(1),f=d(34);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=".ck.ck-toolbar{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;display:flex;flex-flow:row nowrap;align-items:center}.ck.ck-toolbar>.ck-toolbar__items{display:flex;flex-flow:row wrap;align-items:center;flex-grow:1}.ck.ck-toolbar .ck.ck-toolbar__separator{display:inline-block}.ck.ck-toolbar .ck.ck-toolbar__separator:first-child,.ck.ck-toolbar .ck.ck-toolbar__separator:last-child{display:none}.ck.ck-toolbar .ck-toolbar__line-break{flex-basis:100%}.ck.ck-toolbar.ck-toolbar_grouping>.ck-toolbar__items{flex-wrap:nowrap}.ck.ck-toolbar.ck-toolbar_vertical>.ck-toolbar__items{flex-direction:column}.ck.ck-toolbar.ck-toolbar_floating>.ck-toolbar__items{flex-wrap:nowrap}.ck.ck-toolbar>.ck.ck-toolbar__grouped-dropdown>.ck-dropdown__button .ck-dropdown__arrow{display:none}.ck.ck-toolbar{border-radius:0}.ck-rounded-corners .ck.ck-toolbar,.ck.ck-toolbar.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-toolbar{background:var(--ck-color-toolbar-background);padding:0 var(--ck-spacing-small);border:1px solid var(--ck-color-toolbar-border)}.ck.ck-toolbar .ck.ck-toolbar__separator{align-self:stretch;width:1px;min-width:1px;background:var(--ck-color-toolbar-border);margin-top:var(--ck-spacing-small);margin-bottom:var(--ck-spacing-small)}.ck.ck-toolbar .ck-toolbar__line-break{height:0}.ck.ck-toolbar>.ck-toolbar__items>:not(.ck-toolbar__line-break){margin-right:var(--ck-spacing-small)}.ck.ck-toolbar>.ck-toolbar__items:empty+.ck.ck-toolbar__separator{display:none}.ck.ck-toolbar>.ck-toolbar__items>:not(.ck-toolbar__line-break),.ck.ck-toolbar>.ck.ck-toolbar__grouped-dropdown{margin-top:var(--ck-spacing-small);margin-bottom:var(--ck-spacing-small)}.ck.ck-toolbar.ck-toolbar_vertical{padding:0}.ck.ck-toolbar.ck-toolbar_vertical>.ck-toolbar__items>.ck{width:100%;margin:0;border-radius:0;border:0}.ck.ck-toolbar.ck-toolbar_compact{padding:0}.ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>*{margin:0}.ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>:not(:first-child):not(:last-child){border-radius:0}.ck.ck-toolbar>.ck.ck-toolbar__grouped-dropdown>.ck.ck-button.ck-dropdown__button{padding-left:var(--ck-spacing-tiny)}.ck-toolbar-container .ck.ck-toolbar{border:0}.ck.ck-toolbar[dir=rtl]>.ck-toolbar__items>.ck,[dir=rtl] .ck.ck-toolbar>.ck-toolbar__items>.ck{margin-right:0}.ck.ck-toolbar[dir=rtl]:not(.ck-toolbar_compact)>.ck-toolbar__items>.ck,[dir=rtl] .ck.ck-toolbar:not(.ck-toolbar_compact)>.ck-toolbar__items>.ck{margin-left:var(--ck-spacing-small)}.ck.ck-toolbar[dir=rtl]>.ck-toolbar__items>.ck:last-child,[dir=rtl] .ck.ck-toolbar>.ck-toolbar__items>.ck:last-child{margin-left:0}.ck.ck-toolbar[dir=rtl].ck-toolbar_compact>.ck-toolbar__items>.ck:first-child,[dir=rtl] .ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>.ck:first-child{border-top-left-radius:0;border-bottom-left-radius:0}.ck.ck-toolbar[dir=rtl].ck-toolbar_compact>.ck-toolbar__items>.ck:last-child,[dir=rtl] .ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>.ck:last-child{border-top-right-radius:0;border-bottom-right-radius:0}.ck.ck-toolbar[dir=rtl]>.ck.ck-toolbar__separator,[dir=rtl] .ck.ck-toolbar>.ck.ck-toolbar__separator{margin-left:var(--ck-spacing-small)}.ck.ck-toolbar[dir=rtl].ck-toolbar_grouping>.ck-toolbar__items:not(:empty):not(:only-child),[dir=rtl] .ck.ck-toolbar.ck-toolbar_grouping>.ck-toolbar__items:not(:empty):not(:only-child){margin-left:var(--ck-spacing-small)}.ck.ck-toolbar[dir=ltr]>.ck-toolbar__items>.ck:last-child,[dir=ltr] .ck.ck-toolbar>.ck-toolbar__items>.ck:last-child{margin-right:0}.ck.ck-toolbar[dir=ltr].ck-toolbar_compact>.ck-toolbar__items>.ck:first-child,[dir=ltr] .ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>.ck:first-child{border-top-right-radius:0;border-bottom-right-radius:0}.ck.ck-toolbar[dir=ltr].ck-toolbar_compact>.ck-toolbar__items>.ck:last-child,[dir=ltr] .ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>.ck:last-child{border-top-left-radius:0;border-bottom-left-radius:0}.ck.ck-toolbar[dir=ltr]>.ck.ck-toolbar__separator,[dir=ltr] .ck.ck-toolbar>.ck.ck-toolbar__separator{margin-right:var(--ck-spacing-small)}.ck.ck-toolbar[dir=ltr].ck-toolbar_grouping>.ck-toolbar__items:not(:empty):not(:only-child),[dir=ltr] .ck.ck-toolbar.ck-toolbar_grouping>.ck-toolbar__items:not(:empty):not(:only-child){margin-right:var(--ck-spacing-small)}"},function(i,a,d){var h=d(1),f=d(36);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=".ck.ck-list{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;display:flex;flex-direction:column}.ck.ck-list .ck-list__item,.ck.ck-list .ck-list__separator{display:block}.ck.ck-list .ck-list__item>:focus{position:relative;z-index:var(--ck-z-default)}.ck.ck-list{border-radius:0}.ck-rounded-corners .ck.ck-list,.ck.ck-list.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-list{list-style-type:none;background:var(--ck-color-list-background)}.ck.ck-list__item{cursor:default;min-width:12em}.ck.ck-list__item .ck-button{min-height:unset;width:100%;text-align:left;border-radius:0;padding:calc(var(--ck-line-height-base)*0.2*var(--ck-font-size-base)) calc(var(--ck-line-height-base)*0.4*var(--ck-font-size-base))}.ck.ck-list__item .ck-button .ck-button__label{line-height:calc(var(--ck-line-height-base)*1.2*var(--ck-font-size-base))}.ck.ck-list__item .ck-button:active{box-shadow:none}.ck.ck-list__item .ck-button.ck-on{background:var(--ck-color-list-button-on-background);color:var(--ck-color-list-button-on-text)}.ck.ck-list__item .ck-button.ck-on:active{box-shadow:none}.ck.ck-list__item .ck-button.ck-on:hover:not(.ck-disabled){background:var(--ck-color-list-button-on-background-focus)}.ck.ck-list__item .ck-button.ck-on:focus:not(.ck-disabled){border-color:var(--ck-color-base-background)}.ck.ck-list__item .ck-button:hover:not(.ck-disabled){background:var(--ck-color-list-button-hover-background)}.ck.ck-list__item .ck-switchbutton.ck-on{background:var(--ck-color-list-background);color:inherit}.ck.ck-list__item .ck-switchbutton.ck-on:hover:not(.ck-disabled){background:var(--ck-color-list-button-hover-background);color:inherit}.ck.ck-list__separator{height:1px;width:100%;background:var(--ck-color-base-border)}"},function(i,a,d){var h=d(1),f=d(38);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=":root{--ck-toolbar-dropdown-max-width:60vw}.ck.ck-toolbar-dropdown>.ck-dropdown__panel{width:max-content;max-width:var(--ck-toolbar-dropdown-max-width)}.ck.ck-toolbar-dropdown>.ck-dropdown__panel .ck-button:focus{z-index:calc(var(--ck-z-default) + 1)}.ck.ck-toolbar-dropdown .ck-toolbar{border:0}"},function(i,a,d){var h=d(1),f=d(40);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=".ck.ck-dropdown .ck-dropdown__panel .ck-list{border-radius:0}.ck-rounded-corners .ck.ck-dropdown .ck-dropdown__panel .ck-list,.ck.ck-dropdown .ck-dropdown__panel .ck-list.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:0}.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:first-child .ck-button{border-radius:0}.ck-rounded-corners .ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:first-child .ck-button,.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:first-child .ck-button.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:0;border-bottom-left-radius:0;border-bottom-right-radius:0}.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:last-child .ck-button{border-radius:0}.ck-rounded-corners .ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:last-child .ck-button,.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:last-child .ck-button.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:0;border-top-right-radius:0}"},function(i,a,d){var h=d(1),f=d(42);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=":root{--ck-color-editable-blur-selection:#d9d9d9}.ck.ck-editor__editable:not(.ck-editor__nested-editable){border-radius:0}.ck-rounded-corners .ck.ck-editor__editable:not(.ck-editor__nested-editable),.ck.ck-editor__editable:not(.ck-editor__nested-editable).ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-editor__editable:not(.ck-editor__nested-editable).ck-focused{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-inner-shadow),0 0}.ck.ck-editor__editable_inline{overflow:auto;padding:0 var(--ck-spacing-standard);border:1px solid transparent}.ck.ck-editor__editable_inline[dir=ltr]{text-align:left}.ck.ck-editor__editable_inline[dir=rtl]{text-align:right}.ck.ck-editor__editable_inline>:first-child{margin-top:var(--ck-spacing-large)}.ck.ck-editor__editable_inline>:last-child{margin-bottom:var(--ck-spacing-large)}.ck.ck-editor__editable_inline.ck-blurred ::selection{background:var(--ck-color-editable-blur-selection)}.ck.ck-balloon-panel.ck-toolbar-container[class*=arrow_n]:after{border-bottom-color:var(--ck-color-base-foreground)}.ck.ck-balloon-panel.ck-toolbar-container[class*=arrow_s]:after{border-top-color:var(--ck-color-base-foreground)}"},function(i,a,d){var h=d(1),f=d(44);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=".ck.ck-label{display:block}.ck.ck-voice-label{display:none}.ck.ck-label{font-weight:700}"},function(i,a,d){var h=d(1),f=d(46);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=".ck.ck-form__header{display:flex;flex-direction:row;flex-wrap:nowrap;align-items:center;justify-content:space-between}:root{--ck-form-header-height:38px}.ck.ck-form__header{padding:var(--ck-spacing-small) var(--ck-spacing-large);height:var(--ck-form-header-height);line-height:var(--ck-form-header-height);border-bottom:1px solid var(--ck-color-base-border)}.ck.ck-form__header .ck-form__header__label{font-weight:700}"},function(i,a,d){var h=d(1),f=d(48);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=":root{--ck-input-text-width:18em}.ck.ck-input-text{border-radius:0}.ck-rounded-corners .ck.ck-input-text,.ck.ck-input-text.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-input-text{background:var(--ck-color-input-background);border:1px solid var(--ck-color-input-border);padding:var(--ck-spacing-extra-tiny) var(--ck-spacing-medium);min-width:var(--ck-input-text-width);min-height:var(--ck-ui-component-min-height);transition:box-shadow .1s ease-in-out,border .1s ease-in-out}.ck.ck-input-text:focus{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-focus-outer-shadow),0 0}.ck.ck-input-text[readonly]{border:1px solid var(--ck-color-input-disabled-border);background:var(--ck-color-input-disabled-background);color:var(--ck-color-input-disabled-text)}.ck.ck-input-text[readonly]:focus{box-shadow:var(--ck-focus-disabled-outer-shadow),0 0}.ck.ck-input-text.ck-error{border-color:var(--ck-color-input-error-border);animation:ck-text-input-shake .3s ease both}.ck.ck-input-text.ck-error:focus{box-shadow:var(--ck-focus-error-outer-shadow),0 0}@keyframes ck-text-input-shake{20%{transform:translateX(-2px)}40%{transform:translateX(2px)}60%{transform:translateX(-1px)}80%{transform:translateX(1px)}}"},function(i,a,d){var h=d(1),f=d(50);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=".ck.ck-labeled-field-view>.ck.ck-labeled-field-view__input-wrapper{display:flex;position:relative}.ck.ck-labeled-field-view .ck.ck-label{display:block;position:absolute}:root{--ck-labeled-field-view-transition:.1s cubic-bezier(0,0,0.24,0.95);--ck-labeled-field-empty-unfocused-max-width:100% - 2 * var(--ck-spacing-medium);--ck-color-labeled-field-label-background:var(--ck-color-base-background)}.ck.ck-labeled-field-view{border-radius:0}.ck-rounded-corners .ck.ck-labeled-field-view,.ck.ck-labeled-field-view.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-labeled-field-view>.ck.ck-labeled-field-view__input-wrapper{width:100%}.ck.ck-labeled-field-view>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label{top:0}[dir=ltr] .ck.ck-labeled-field-view>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label{left:0}[dir=rtl] .ck.ck-labeled-field-view>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label{right:0}.ck.ck-labeled-field-view>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label{pointer-events:none;transform-origin:0 0;transform:translate(var(--ck-spacing-medium),-6px) scale(.75);background:var(--ck-color-labeled-field-label-background);padding:0 calc(var(--ck-font-size-tiny)*0.5);line-height:normal;font-weight:400;text-overflow:ellipsis;overflow:hidden;max-width:100%;transition:transform var(--ck-labeled-field-view-transition),padding var(--ck-labeled-field-view-transition),background var(--ck-labeled-field-view-transition)}.ck.ck-labeled-field-view.ck-error .ck-input:not([readonly])+.ck.ck-label,.ck.ck-labeled-field-view.ck-error>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label{color:var(--ck-color-base-error)}.ck.ck-labeled-field-view .ck-labeled-field-view__status{font-size:var(--ck-font-size-small);margin-top:var(--ck-spacing-small);white-space:normal}.ck.ck-labeled-field-view .ck-labeled-field-view__status.ck-labeled-field-view__status_error{color:var(--ck-color-base-error)}.ck.ck-labeled-field-view.ck-disabled>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label,.ck.ck-labeled-field-view.ck-labeled-field-view_empty:not(.ck-labeled-field-view_focused)>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label{color:var(--ck-color-input-disabled-text)}[dir=ltr] .ck.ck-labeled-field-view.ck-disabled.ck-labeled-field-view_empty>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label,[dir=ltr] .ck.ck-labeled-field-view.ck-labeled-field-view_empty:not(.ck-labeled-field-view_focused):not(.ck-labeled-field-view_placeholder)>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label{transform:translate(var(--ck-spacing-medium),calc(var(--ck-font-size-base)*0.6)) scale(1)}[dir=rtl] .ck.ck-labeled-field-view.ck-disabled.ck-labeled-field-view_empty>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label,[dir=rtl] .ck.ck-labeled-field-view.ck-labeled-field-view_empty:not(.ck-labeled-field-view_focused):not(.ck-labeled-field-view_placeholder)>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label{transform:translate(calc(var(--ck-spacing-medium)*-1),calc(var(--ck-font-size-base)*0.6)) scale(1)}.ck.ck-labeled-field-view.ck-disabled.ck-labeled-field-view_empty>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label,.ck.ck-labeled-field-view.ck-labeled-field-view_empty:not(.ck-labeled-field-view_focused):not(.ck-labeled-field-view_placeholder)>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label{max-width:calc(var(--ck-labeled-field-empty-unfocused-max-width));background:transparent;padding:0}.ck.ck-labeled-field-view>.ck.ck-labeled-field-view__input-wrapper>.ck-dropdown>.ck.ck-button{background:transparent}.ck.ck-labeled-field-view.ck-labeled-field-view_empty>.ck.ck-labeled-field-view__input-wrapper>.ck-dropdown>.ck-button>.ck-button__label{opacity:0}.ck.ck-labeled-field-view.ck-labeled-field-view_empty:not(.ck-labeled-field-view_focused):not(.ck-labeled-field-view_placeholder)>.ck.ck-labeled-field-view__input-wrapper>.ck-dropdown+.ck-label{max-width:calc(var(--ck-labeled-field-empty-unfocused-max-width) - var(--ck-dropdown-arrow-size) - var(--ck-spacing-standard))}"},function(i,a,d){var h=d(1),f=d(52);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=':root{--ck-balloon-panel-arrow-z-index:calc(var(--ck-z-default) - 3)}.ck.ck-balloon-panel{display:none;position:absolute;z-index:var(--ck-z-modal)}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:after,.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:before{content:"";position:absolute}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:before{z-index:var(--ck-balloon-panel-arrow-z-index)}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:after{z-index:calc(var(--ck-balloon-panel-arrow-z-index) + 1)}.ck.ck-balloon-panel[class*=arrow_n]:before{z-index:var(--ck-balloon-panel-arrow-z-index)}.ck.ck-balloon-panel[class*=arrow_n]:after{z-index:calc(var(--ck-balloon-panel-arrow-z-index) + 1)}.ck.ck-balloon-panel[class*=arrow_s]:before{z-index:var(--ck-balloon-panel-arrow-z-index)}.ck.ck-balloon-panel[class*=arrow_s]:after{z-index:calc(var(--ck-balloon-panel-arrow-z-index) + 1)}.ck.ck-balloon-panel.ck-balloon-panel_visible{display:block}:root{--ck-balloon-arrow-offset:2px;--ck-balloon-arrow-height:10px;--ck-balloon-arrow-half-width:8px;--ck-balloon-arrow-drop-shadow:0 2px 2px var(--ck-color-shadow-drop)}.ck.ck-balloon-panel{border-radius:0}.ck-rounded-corners .ck.ck-balloon-panel,.ck.ck-balloon-panel.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-balloon-panel{box-shadow:var(--ck-drop-shadow),0 0;min-height:15px;background:var(--ck-color-panel-background);border:1px solid var(--ck-color-panel-border)}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:after,.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:before{width:0;height:0;border-style:solid}.ck.ck-balloon-panel[class*=arrow_n]:after,.ck.ck-balloon-panel[class*=arrow_n]:before{border-left-width:var(--ck-balloon-arrow-half-width);border-bottom-width:var(--ck-balloon-arrow-height);border-right-width:var(--ck-balloon-arrow-half-width);border-top-width:0}.ck.ck-balloon-panel[class*=arrow_n]:before{border-bottom-color:var(--ck-color-panel-border)}.ck.ck-balloon-panel[class*=arrow_n]:after,.ck.ck-balloon-panel[class*=arrow_n]:before{border-left-color:transparent;border-right-color:transparent;border-top-color:transparent}.ck.ck-balloon-panel[class*=arrow_n]:after{border-bottom-color:var(--ck-color-panel-background);margin-top:var(--ck-balloon-arrow-offset)}.ck.ck-balloon-panel[class*=arrow_s]:after,.ck.ck-balloon-panel[class*=arrow_s]:before{border-left-width:var(--ck-balloon-arrow-half-width);border-bottom-width:0;border-right-width:var(--ck-balloon-arrow-half-width);border-top-width:var(--ck-balloon-arrow-height)}.ck.ck-balloon-panel[class*=arrow_s]:before{border-top-color:var(--ck-color-panel-border);filter:drop-shadow(var(--ck-balloon-arrow-drop-shadow))}.ck.ck-balloon-panel[class*=arrow_s]:after,.ck.ck-balloon-panel[class*=arrow_s]:before{border-left-color:transparent;border-bottom-color:transparent;border-right-color:transparent}.ck.ck-balloon-panel[class*=arrow_s]:after{border-top-color:var(--ck-color-panel-background);margin-bottom:var(--ck-balloon-arrow-offset)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_n:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_n:before{left:50%;margin-left:calc(var(--ck-balloon-arrow-half-width)*-1);top:calc(var(--ck-balloon-arrow-height)*-1)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_nw:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_nw:before{left:calc(var(--ck-balloon-arrow-half-width)*2);top:calc(var(--ck-balloon-arrow-height)*-1)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_ne:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_ne:before{right:calc(var(--ck-balloon-arrow-half-width)*2);top:calc(var(--ck-balloon-arrow-height)*-1)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_s:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_s:before{left:50%;margin-left:calc(var(--ck-balloon-arrow-half-width)*-1);bottom:calc(var(--ck-balloon-arrow-height)*-1)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_sw:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_sw:before{left:calc(var(--ck-balloon-arrow-half-width)*2);bottom:calc(var(--ck-balloon-arrow-height)*-1)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_se:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_se:before{right:calc(var(--ck-balloon-arrow-half-width)*2);bottom:calc(var(--ck-balloon-arrow-height)*-1)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_sme:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_sme:before{right:25%;margin-right:calc(var(--ck-balloon-arrow-half-width)*2);bottom:calc(var(--ck-balloon-arrow-height)*-1)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_smw:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_smw:before{left:25%;margin-left:calc(var(--ck-balloon-arrow-half-width)*2);bottom:calc(var(--ck-balloon-arrow-height)*-1)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_nme:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_nme:before{right:25%;margin-right:calc(var(--ck-balloon-arrow-half-width)*2);top:calc(var(--ck-balloon-arrow-height)*-1)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_nmw:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_nmw:before{left:25%;margin-left:calc(var(--ck-balloon-arrow-half-width)*2);top:calc(var(--ck-balloon-arrow-height)*-1)}'},function(i,a,d){var h=d(1),f=d(54);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=".ck .ck-balloon-rotator__navigation{display:flex;align-items:center;justify-content:center}.ck .ck-balloon-rotator__content .ck-toolbar{justify-content:center}.ck .ck-balloon-rotator__navigation{background:var(--ck-color-toolbar-background);border-bottom:1px solid var(--ck-color-toolbar-border);padding:0 var(--ck-spacing-small)}.ck .ck-balloon-rotator__navigation>*{margin-right:var(--ck-spacing-small);margin-top:var(--ck-spacing-small);margin-bottom:var(--ck-spacing-small)}.ck .ck-balloon-rotator__navigation .ck-balloon-rotator__counter{margin-right:var(--ck-spacing-standard);margin-left:var(--ck-spacing-small)}.ck .ck-balloon-rotator__content .ck.ck-annotation-wrapper{box-shadow:none}"},function(i,a,d){var h=d(1),f=d(56);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=".ck .ck-fake-panel{position:absolute;z-index:calc(var(--ck-z-modal) - 1)}.ck .ck-fake-panel div{position:absolute}.ck .ck-fake-panel div:first-child{z-index:2}.ck .ck-fake-panel div:nth-child(2){z-index:1}:root{--ck-balloon-fake-panel-offset-horizontal:6px;--ck-balloon-fake-panel-offset-vertical:6px}.ck .ck-fake-panel div{box-shadow:var(--ck-drop-shadow),0 0;min-height:15px;background:var(--ck-color-panel-background);border:1px solid var(--ck-color-panel-border);border-radius:var(--ck-border-radius);width:100%;height:100%}.ck .ck-fake-panel div:first-child{margin-left:var(--ck-balloon-fake-panel-offset-horizontal);margin-top:var(--ck-balloon-fake-panel-offset-vertical)}.ck .ck-fake-panel div:nth-child(2){margin-left:calc(var(--ck-balloon-fake-panel-offset-horizontal)*2);margin-top:calc(var(--ck-balloon-fake-panel-offset-vertical)*2)}.ck .ck-fake-panel div:nth-child(3){margin-left:calc(var(--ck-balloon-fake-panel-offset-horizontal)*3);margin-top:calc(var(--ck-balloon-fake-panel-offset-vertical)*3)}.ck .ck-balloon-panel_arrow_s+.ck-fake-panel,.ck .ck-balloon-panel_arrow_se+.ck-fake-panel,.ck .ck-balloon-panel_arrow_sw+.ck-fake-panel{--ck-balloon-fake-panel-offset-vertical:-6px}"},function(i,a,d){var h=d(1),f=d(58);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=".ck.ck-sticky-panel .ck-sticky-panel__content_sticky{z-index:var(--ck-z-modal);position:fixed;top:0}.ck.ck-sticky-panel .ck-sticky-panel__content_sticky_bottom-limit{top:auto;position:absolute}.ck.ck-sticky-panel .ck-sticky-panel__content_sticky{box-shadow:var(--ck-drop-shadow),0 0;border-width:0 1px 1px;border-top-left-radius:0;border-top-right-radius:0}"},function(i,a,d){var h=d(1),f=d(60);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=".ck.ck-block-toolbar-button{position:absolute;z-index:var(--ck-z-default)}:root{--ck-color-block-toolbar-button:var(--ck-color-text);--ck-block-toolbar-button-size:var(--ck-font-size-normal)}.ck.ck-block-toolbar-button{color:var(--ck-color-block-toolbar-button);font-size:var(--ck-block-toolbar-size)}"},function(i,a,d){var h=d(1),f=d(62);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=".ck.ck-placeholder,.ck .ck-placeholder{position:relative}.ck.ck-placeholder:before,.ck .ck-placeholder:before{position:absolute;left:0;right:0;content:attr(data-placeholder);pointer-events:none}.ck.ck-read-only .ck-placeholder:before{display:none}.ck.ck-placeholder:before,.ck .ck-placeholder:before{cursor:text;color:var(--ck-color-engine-placeholder-text)}"},function(i,a,d){var h=d(1),f=d(64);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=".ck.ck-editor{position:relative}.ck.ck-editor .ck-editor__top .ck-sticky-panel .ck-toolbar{z-index:var(--ck-z-modal)}.ck.ck-editor__top .ck-sticky-panel .ck-toolbar{border-radius:0}.ck-rounded-corners .ck.ck-editor__top .ck-sticky-panel .ck-toolbar,.ck.ck-editor__top .ck-sticky-panel .ck-toolbar.ck-rounded-corners{border-radius:var(--ck-border-radius);border-bottom-left-radius:0;border-bottom-right-radius:0}.ck.ck-editor__top .ck-sticky-panel .ck-toolbar{border-bottom-width:0}.ck.ck-editor__top .ck-sticky-panel .ck-sticky-panel__content_sticky .ck-toolbar{border-bottom-width:1px;border-radius:0}.ck-rounded-corners .ck.ck-editor__top .ck-sticky-panel .ck-sticky-panel__content_sticky .ck-toolbar,.ck.ck-editor__top .ck-sticky-panel .ck-sticky-panel__content_sticky .ck-toolbar.ck-rounded-corners{border-radius:var(--ck-border-radius);border-radius:0}.ck.ck-editor__main>.ck-editor__editable{background:var(--ck-color-base-background);border-radius:0}.ck-rounded-corners .ck.ck-editor__main>.ck-editor__editable,.ck.ck-editor__main>.ck-editor__editable.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:0;border-top-right-radius:0}.ck.ck-editor__main>.ck-editor__editable:not(.ck-focused){border-color:var(--ck-color-base-border)}"},function(i,a,d){var h=d(1),f=d(66);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports='.ck .ck-widget .ck-widget__type-around__button{display:block;position:absolute;overflow:hidden;z-index:var(--ck-z-default)}.ck .ck-widget .ck-widget__type-around__button svg{position:absolute;top:50%;left:50%;z-index:calc(var(--ck-z-default) + 2)}.ck .ck-widget .ck-widget__type-around__button.ck-widget__type-around__button_before{top:calc(var(--ck-widget-outline-thickness)*-0.5);left:min(10%,30px);transform:translateY(-50%)}.ck .ck-widget .ck-widget__type-around__button.ck-widget__type-around__button_after{bottom:calc(var(--ck-widget-outline-thickness)*-0.5);right:min(10%,30px);transform:translateY(50%)}.ck .ck-widget.ck-widget_selected>.ck-widget__type-around>.ck-widget__type-around__button:after,.ck .ck-widget>.ck-widget__type-around>.ck-widget__type-around__button:hover:after{content:"";display:block;position:absolute;top:1px;left:1px;z-index:calc(var(--ck-z-default) + 1)}.ck .ck-widget>.ck-widget__type-around>.ck-widget__type-around__fake-caret{display:none;position:absolute;left:0;right:0}.ck .ck-widget:hover>.ck-widget__type-around>.ck-widget__type-around__fake-caret{left:calc(var(--ck-widget-outline-thickness)*-1);right:calc(var(--ck-widget-outline-thickness)*-1)}.ck .ck-widget.ck-widget_type-around_show-fake-caret_before>.ck-widget__type-around>.ck-widget__type-around__fake-caret{top:calc(var(--ck-widget-outline-thickness)*-1 - 1px);display:block}.ck .ck-widget.ck-widget_type-around_show-fake-caret_after>.ck-widget__type-around>.ck-widget__type-around__fake-caret{bottom:calc(var(--ck-widget-outline-thickness)*-1 - 1px);display:block}.ck.ck-editor__editable.ck-read-only .ck-widget__type-around,.ck.ck-editor__editable.ck-restricted-editing_mode_restricted .ck-widget__type-around,.ck.ck-editor__editable.ck-widget__type-around_disabled .ck-widget__type-around{display:none}:root{--ck-widget-type-around-button-size:20px;--ck-color-widget-type-around-button-active:var(--ck-color-focus-border);--ck-color-widget-type-around-button-hover:var(--ck-color-widget-hover-border);--ck-color-widget-type-around-button-blurred-editable:var(--ck-color-widget-blurred-border);--ck-color-widget-type-around-button-radar-start-alpha:0;--ck-color-widget-type-around-button-radar-end-alpha:.3;--ck-color-widget-type-around-button-icon:var(--ck-color-base-background)}.ck .ck-widget .ck-widget__type-around__button{width:var(--ck-widget-type-around-button-size);height:var(--ck-widget-type-around-button-size);background:var(--ck-color-widget-type-around-button);border-radius:100px;transition:opacity var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve),background var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve);opacity:0;pointer-events:none}.ck .ck-widget .ck-widget__type-around__button svg{width:10px;height:8px;transform:translate(-50%,-50%);transition:transform .5s ease;margin-top:1px}.ck .ck-widget .ck-widget__type-around__button svg *{stroke-dasharray:10;stroke-dashoffset:0;fill:none;stroke:var(--ck-color-widget-type-around-button-icon);stroke-width:1.5px;stroke-linecap:round;stroke-linejoin:round}.ck .ck-widget .ck-widget__type-around__button svg line{stroke-dasharray:7}.ck .ck-widget .ck-widget__type-around__button:hover{animation:ck-widget-type-around-button-sonar 1s ease infinite}.ck .ck-widget .ck-widget__type-around__button:hover svg polyline{animation:ck-widget-type-around-arrow-dash 2s linear}.ck .ck-widget .ck-widget__type-around__button:hover svg line{animation:ck-widget-type-around-arrow-tip-dash 2s linear}.ck .ck-widget.ck-widget_selected>.ck-widget__type-around>.ck-widget__type-around__button,.ck .ck-widget:hover>.ck-widget__type-around>.ck-widget__type-around__button{opacity:1;pointer-events:auto}.ck .ck-widget:not(.ck-widget_selected)>.ck-widget__type-around>.ck-widget__type-around__button{background:var(--ck-color-widget-type-around-button-hover)}.ck .ck-widget.ck-widget_selected>.ck-widget__type-around>.ck-widget__type-around__button,.ck .ck-widget>.ck-widget__type-around>.ck-widget__type-around__button:hover{background:var(--ck-color-widget-type-around-button-active)}.ck .ck-widget.ck-widget_selected>.ck-widget__type-around>.ck-widget__type-around__button:after,.ck .ck-widget>.ck-widget__type-around>.ck-widget__type-around__button:hover:after{width:calc(var(--ck-widget-type-around-button-size) - 2px);height:calc(var(--ck-widget-type-around-button-size) - 2px);border-radius:100px;background:linear-gradient(135deg,hsla(0,0%,100%,0),hsla(0,0%,100%,.3))}.ck .ck-widget.ck-widget_with-selection-handle>.ck-widget__type-around>.ck-widget__type-around__button_before{margin-left:20px}.ck .ck-widget .ck-widget__type-around__fake-caret{pointer-events:none;height:1px;animation:ck-widget-type-around-fake-caret-pulse 1s linear infinite normal forwards;outline:1px solid hsla(0,0%,100%,.5);background:var(--ck-color-base-text)}.ck .ck-widget.ck-widget_selected.ck-widget_type-around_show-fake-caret_after,.ck .ck-widget.ck-widget_selected.ck-widget_type-around_show-fake-caret_before{outline-color:transparent}.ck .ck-widget.ck-widget_type-around_show-fake-caret_after.ck-widget_selected:hover,.ck .ck-widget.ck-widget_type-around_show-fake-caret_before.ck-widget_selected:hover{outline-color:var(--ck-color-widget-hover-border)}.ck .ck-widget.ck-widget_type-around_show-fake-caret_after>.ck-widget__type-around>.ck-widget__type-around__button,.ck .ck-widget.ck-widget_type-around_show-fake-caret_before>.ck-widget__type-around>.ck-widget__type-around__button{opacity:0;pointer-events:none}.ck .ck-widget.ck-widget_type-around_show-fake-caret_after.ck-widget_with-selection-handle.ck-widget_selected:hover>.ck-widget__selection-handle,.ck .ck-widget.ck-widget_type-around_show-fake-caret_after.ck-widget_with-selection-handle.ck-widget_selected>.ck-widget__selection-handle,.ck .ck-widget.ck-widget_type-around_show-fake-caret_before.ck-widget_with-selection-handle.ck-widget_selected:hover>.ck-widget__selection-handle,.ck .ck-widget.ck-widget_type-around_show-fake-caret_before.ck-widget_with-selection-handle.ck-widget_selected>.ck-widget__selection-handle{opacity:0}.ck .ck-widget.ck-widget_type-around_show-fake-caret_after.ck-widget_selected.ck-widget_with-resizer>.ck-widget__resizer,.ck .ck-widget.ck-widget_type-around_show-fake-caret_before.ck-widget_selected.ck-widget_with-resizer>.ck-widget__resizer{opacity:0}.ck[dir=rtl] .ck-widget.ck-widget_with-selection-handle .ck-widget__type-around>.ck-widget__type-around__button_before{margin-left:0;margin-right:20px}.ck-editor__nested-editable.ck-editor__editable_selected .ck-widget.ck-widget_selected>.ck-widget__type-around>.ck-widget__type-around__button,.ck-editor__nested-editable.ck-editor__editable_selected .ck-widget:hover>.ck-widget__type-around>.ck-widget__type-around__button{opacity:0;pointer-events:none}.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected>.ck-widget__type-around>.ck-widget__type-around__button:not(:hover){background:var(--ck-color-widget-type-around-button-blurred-editable)}.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected>.ck-widget__type-around>.ck-widget__type-around__button:not(:hover) svg *{stroke:#999}@keyframes ck-widget-type-around-arrow-dash{0%{stroke-dashoffset:10}20%,to{stroke-dashoffset:0}}@keyframes ck-widget-type-around-arrow-tip-dash{0%,20%{stroke-dashoffset:7}40%,to{stroke-dashoffset:0}}@keyframes ck-widget-type-around-button-sonar{0%{box-shadow:0 0 0 0 hsla(var(--ck-color-focus-border-coordinates),var(--ck-color-widget-type-around-button-radar-start-alpha))}50%{box-shadow:0 0 0 5px hsla(var(--ck-color-focus-border-coordinates),var(--ck-color-widget-type-around-button-radar-end-alpha))}to{box-shadow:0 0 0 5px hsla(var(--ck-color-focus-border-coordinates),var(--ck-color-widget-type-around-button-radar-start-alpha))}}@keyframes ck-widget-type-around-fake-caret-pulse{0%{opacity:1}49%{opacity:1}50%{opacity:0}99%{opacity:0}to{opacity:1}}'},function(i,a,d){var h=d(1),f=d(68);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=":root{--ck-color-resizer:var(--ck-color-focus-border);--ck-color-resizer-tooltip-background:#262626;--ck-color-resizer-tooltip-text:#f2f2f2;--ck-resizer-border-radius:var(--ck-border-radius);--ck-resizer-tooltip-offset:10px;--ck-resizer-tooltip-height:calc(var(--ck-spacing-small)*2 + 10px)}.ck .ck-widget,.ck .ck-widget.ck-widget_with-selection-handle{position:relative}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle{position:absolute}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle .ck-icon{display:block}.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected>.ck-widget__selection-handle,.ck .ck-widget.ck-widget_with-selection-handle:hover>.ck-widget__selection-handle{visibility:visible}.ck .ck-size-view{background:var(--ck-color-resizer-tooltip-background);color:var(--ck-color-resizer-tooltip-text);border:1px solid var(--ck-color-resizer-tooltip-text);border-radius:var(--ck-resizer-border-radius);font-size:var(--ck-font-size-tiny);display:block;padding:0 var(--ck-spacing-small);height:var(--ck-resizer-tooltip-height);line-height:var(--ck-resizer-tooltip-height)}.ck .ck-size-view.ck-orientation-above-center,.ck .ck-size-view.ck-orientation-bottom-left,.ck .ck-size-view.ck-orientation-bottom-right,.ck .ck-size-view.ck-orientation-top-left,.ck .ck-size-view.ck-orientation-top-right{position:absolute}.ck .ck-size-view.ck-orientation-top-left{top:var(--ck-resizer-tooltip-offset);left:var(--ck-resizer-tooltip-offset)}.ck .ck-size-view.ck-orientation-top-right{top:var(--ck-resizer-tooltip-offset);right:var(--ck-resizer-tooltip-offset)}.ck .ck-size-view.ck-orientation-bottom-right{bottom:var(--ck-resizer-tooltip-offset);right:var(--ck-resizer-tooltip-offset)}.ck .ck-size-view.ck-orientation-bottom-left{bottom:var(--ck-resizer-tooltip-offset);left:var(--ck-resizer-tooltip-offset)}.ck .ck-size-view.ck-orientation-above-center{top:calc(var(--ck-resizer-tooltip-height)*-1);left:50%;transform:translate(-50%)}:root{--ck-widget-outline-thickness:3px;--ck-widget-handler-icon-size:16px;--ck-widget-handler-animation-duration:200ms;--ck-widget-handler-animation-curve:ease;--ck-color-widget-blurred-border:#dedede;--ck-color-widget-hover-border:#ffc83d;--ck-color-widget-editable-focus-background:var(--ck-color-base-background);--ck-color-widget-drag-handler-icon-color:var(--ck-color-base-background)}.ck .ck-widget{outline-width:var(--ck-widget-outline-thickness);outline-style:solid;outline-color:transparent;transition:outline-color var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve)}.ck .ck-widget.ck-widget_selected,.ck .ck-widget.ck-widget_selected:hover{outline:var(--ck-widget-outline-thickness) solid var(--ck-color-focus-border)}.ck .ck-widget:hover{outline-color:var(--ck-color-widget-hover-border)}.ck .ck-editor__nested-editable{border:1px solid transparent}.ck .ck-editor__nested-editable.ck-editor__nested-editable_focused,.ck .ck-editor__nested-editable:focus{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-inner-shadow),0 0;background-color:var(--ck-color-widget-editable-focus-background)}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle{padding:4px;box-sizing:border-box;background-color:transparent;opacity:0;transition:background-color var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve),visibility var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve),opacity var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve);border-radius:var(--ck-border-radius) var(--ck-border-radius) 0 0;transform:translateY(-100%);left:calc(0px - var(--ck-widget-outline-thickness));top:0}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle .ck-icon{width:var(--ck-widget-handler-icon-size);height:var(--ck-widget-handler-icon-size);color:var(--ck-color-widget-drag-handler-icon-color)}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle .ck-icon .ck-icon__selected-indicator{opacity:0;transition:opacity .3s var(--ck-widget-handler-animation-curve)}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle:hover .ck-icon .ck-icon__selected-indicator{opacity:1}.ck .ck-widget.ck-widget_with-selection-handle:hover>.ck-widget__selection-handle{opacity:1;background-color:var(--ck-color-widget-hover-border)}.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected:hover>.ck-widget__selection-handle,.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected>.ck-widget__selection-handle{opacity:1;background-color:var(--ck-color-focus-border)}.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected:hover>.ck-widget__selection-handle .ck-icon .ck-icon__selected-indicator,.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected>.ck-widget__selection-handle .ck-icon .ck-icon__selected-indicator{opacity:1}.ck[dir=rtl] .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle{left:auto;right:calc(0px - var(--ck-widget-outline-thickness))}.ck.ck-editor__editable.ck-read-only .ck-widget{transition:none}.ck.ck-editor__editable.ck-read-only .ck-widget:not(.ck-widget_selected){--ck-widget-outline-thickness:0px}.ck.ck-editor__editable.ck-read-only .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle,.ck.ck-editor__editable.ck-read-only .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle:hover{background:var(--ck-color-widget-blurred-border)}.ck.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected,.ck.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected:hover{outline-color:var(--ck-color-widget-blurred-border)}.ck.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected.ck-widget_with-selection-handle>.ck-widget__selection-handle,.ck.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected.ck-widget_with-selection-handle>.ck-widget__selection-handle:hover,.ck.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected:hover.ck-widget_with-selection-handle>.ck-widget__selection-handle,.ck.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected:hover.ck-widget_with-selection-handle>.ck-widget__selection-handle:hover{background:var(--ck-color-widget-blurred-border)}.ck.ck-editor__editable>.ck-widget.ck-widget_with-selection-handle:first-child,.ck.ck-editor__editable blockquote>.ck-widget.ck-widget_with-selection-handle:first-child{margin-top:calc(1em + var(--ck-widget-handler-icon-size))}"},function(i,a,d){var h=d(1),f=d(70);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports='.ck.ck-editor__editable .ck.ck-clipboard-drop-target-position{display:inline;position:relative;pointer-events:none}.ck.ck-editor__editable .ck.ck-clipboard-drop-target-position span{position:absolute;width:0}.ck.ck-editor__editable .ck-widget:-webkit-drag>.ck-widget__selection-handle,.ck.ck-editor__editable .ck-widget:-webkit-drag>.ck-widget__type-around{display:none}:root{--ck-clipboard-drop-target-dot-width:12px;--ck-clipboard-drop-target-dot-height:8px;--ck-clipboard-drop-target-color:var(--ck-color-focus-border)}.ck.ck-editor__editable .ck.ck-clipboard-drop-target-position span{bottom:calc(var(--ck-clipboard-drop-target-dot-height)*-0.5);top:calc(var(--ck-clipboard-drop-target-dot-height)*-0.5);border:1px solid var(--ck-clipboard-drop-target-color);background:var(--ck-clipboard-drop-target-color);margin-left:-1px}.ck.ck-editor__editable .ck.ck-clipboard-drop-target-position span:after{content:"";width:0;height:0;display:block;position:absolute;left:50%;top:calc(var(--ck-clipboard-drop-target-dot-height)*-0.5);transform:translateX(-50%);border-left:calc(var(--ck-clipboard-drop-target-dot-width)*0.5) solid transparent;border-bottom:0 solid transparent;border-right:calc(var(--ck-clipboard-drop-target-dot-width)*0.5) solid transparent;border-top:calc(var(--ck-clipboard-drop-target-dot-height)) solid var(--ck-clipboard-drop-target-color)}.ck.ck-editor__editable .ck-widget.ck-clipboard-drop-target-range{outline:var(--ck-widget-outline-thickness) solid var(--ck-clipboard-drop-target-color)!important}.ck.ck-editor__editable .ck-widget:-webkit-drag{zoom:.6;outline:none!important}'},function(i,a,d){var h=d(1),f=d(72);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=".ck-content blockquote{overflow:hidden;padding-right:1.5em;padding-left:1.5em;margin-left:0;margin-right:0;font-style:italic;border-left:5px solid #ccc}.ck-content[dir=rtl] blockquote{border-left:0;border-right:5px solid #ccc}"},function(i,a){i.exports=".ck.ck-heading_heading1{font-size:20px}.ck.ck-heading_heading2{font-size:17px}.ck.ck-heading_heading3{font-size:14px}.ck[class*=ck-heading_heading]{font-weight:700}.ck.ck-dropdown.ck-heading-dropdown .ck-dropdown__button .ck-button__label{width:8em}.ck.ck-dropdown.ck-heading-dropdown .ck-dropdown__panel .ck-list__item{min-width:18em}"},function(i,a,d){var h=d(1),f=d(75);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=".ck .ck-widget_with-resizer{position:relative}.ck .ck-widget__resizer{display:none;position:absolute;pointer-events:none;left:0;top:0}.ck-focused .ck-widget_with-resizer.ck-widget_selected>.ck-widget__resizer{display:block}.ck .ck-widget__resizer__handle{position:absolute;pointer-events:all}.ck .ck-widget__resizer__handle.ck-widget__resizer__handle-bottom-right,.ck .ck-widget__resizer__handle.ck-widget__resizer__handle-top-left{cursor:nwse-resize}.ck .ck-widget__resizer__handle.ck-widget__resizer__handle-bottom-left,.ck .ck-widget__resizer__handle.ck-widget__resizer__handle-top-right{cursor:nesw-resize}:root{--ck-resizer-size:10px;--ck-resizer-offset:calc(var(--ck-resizer-size)/-2 - 2px);--ck-resizer-border-width:1px}.ck .ck-widget__resizer{outline:1px solid var(--ck-color-resizer)}.ck .ck-widget__resizer__handle{width:var(--ck-resizer-size);height:var(--ck-resizer-size);background:var(--ck-color-focus-border);border:var(--ck-resizer-border-width) solid #fff;border-radius:var(--ck-resizer-border-radius)}.ck .ck-widget__resizer__handle.ck-widget__resizer__handle-top-left{top:var(--ck-resizer-offset);left:var(--ck-resizer-offset)}.ck .ck-widget__resizer__handle.ck-widget__resizer__handle-top-right{top:var(--ck-resizer-offset);right:var(--ck-resizer-offset)}.ck .ck-widget__resizer__handle.ck-widget__resizer__handle-bottom-right{bottom:var(--ck-resizer-offset);right:var(--ck-resizer-offset)}.ck .ck-widget__resizer__handle.ck-widget__resizer__handle-bottom-left{bottom:var(--ck-resizer-offset);left:var(--ck-resizer-offset)}"},function(i,a,d){var h=d(1),f=d(77);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=".ck.ck-text-alternative-form{display:flex;flex-direction:row;flex-wrap:nowrap}.ck.ck-text-alternative-form .ck-labeled-field-view{display:inline-block}.ck.ck-text-alternative-form .ck-label{display:none}@media screen and (max-width:600px){.ck.ck-text-alternative-form{flex-wrap:wrap}.ck.ck-text-alternative-form .ck-labeled-field-view{flex-basis:100%}.ck.ck-text-alternative-form .ck-button{flex-basis:50%}}"},function(i,a){i.exports='.ck-vertical-form .ck-button:after{content:"";width:0;position:absolute;right:-1px;top:var(--ck-spacing-small);bottom:var(--ck-spacing-small);z-index:1}@media screen and (max-width:600px){.ck.ck-responsive-form .ck-button:after{content:"";width:0;position:absolute;right:-1px;top:var(--ck-spacing-small);bottom:var(--ck-spacing-small);z-index:1}}.ck-vertical-form>.ck-button:nth-last-child(2):after{border-right:1px solid var(--ck-color-base-border)}.ck.ck-responsive-form{padding:var(--ck-spacing-large)}.ck.ck-responsive-form:focus{outline:none}[dir=ltr] .ck.ck-responsive-form>:not(:first-child),[dir=rtl] .ck.ck-responsive-form>:not(:last-child){margin-left:var(--ck-spacing-standard)}@media screen and (max-width:600px){.ck.ck-responsive-form{padding:0;width:calc(var(--ck-input-text-width)*0.8)}.ck.ck-responsive-form .ck-labeled-field-view{margin:var(--ck-spacing-large) var(--ck-spacing-large) 0}.ck.ck-responsive-form .ck-labeled-field-view .ck-input-text{min-width:0;width:100%}.ck.ck-responsive-form .ck-labeled-field-view .ck-labeled-field-view__error{white-space:normal}.ck.ck-responsive-form>.ck-button:last-child,.ck.ck-responsive-form>.ck-button:nth-last-child(2){padding:var(--ck-spacing-standard);margin-top:var(--ck-spacing-large);border-radius:0;border:0;border-top:1px solid var(--ck-color-base-border)}[dir=ltr] .ck.ck-responsive-form>.ck-button:last-child,[dir=ltr] .ck.ck-responsive-form>.ck-button:nth-last-child(2),[dir=rtl] .ck.ck-responsive-form>.ck-button:last-child,[dir=rtl] .ck.ck-responsive-form>.ck-button:nth-last-child(2){margin-left:0}.ck.ck-responsive-form>.ck-button:nth-last-child(2):after,[dir=rtl] .ck.ck-responsive-form>.ck-button:last-child:last-of-type,[dir=rtl] .ck.ck-responsive-form>.ck-button:nth-last-child(2):last-of-type{border-right:1px solid var(--ck-color-base-border)}}'},function(i,a){i.exports=".ck-content .image{display:table;clear:both;text-align:center;margin:.9em auto;min-width:50px}.ck-content .image img{display:block;margin:0 auto;max-width:100%;min-width:100%}.ck-content .image-inline{display:inline-flex;max-width:100%;align-items:flex-start}.ck-content .image-inline picture{display:flex}.ck-content .image-inline img,.ck-content .image-inline picture{flex-grow:1;flex-shrink:1;max-width:100%}.ck.ck-editor__editable .image>figcaption.ck-placeholder:before{padding-left:inherit;padding-right:inherit;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ck.ck-editor__editable .image-inline.ck-widget_selected,.ck.ck-editor__editable .image.ck-widget_selected{z-index:1}.ck.ck-editor__editable .image-inline.ck-widget_selected ::selection{display:none}.ck.ck-editor__editable td .image-inline img,.ck.ck-editor__editable th .image-inline img{max-width:none}"},function(i,a,d){var h=d(1),f=d(81);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=":root{--ck-color-image-caption-background:#f7f7f7;--ck-color-image-caption-text:#333;--ck-color-image-caption-highligted-background:#fd0}.ck-content .image>figcaption{display:table-caption;caption-side:bottom;word-break:break-word;color:var(--ck-color-image-caption-text);background-color:var(--ck-color-image-caption-background);padding:.6em;font-size:.75em;outline-offset:-1px}.ck.ck-editor__editable .image>figcaption.image__caption_highlighted{animation:ck-image-caption-highlight .6s ease-out}@keyframes ck-image-caption-highlight{0%{background-color:var(--ck-color-image-caption-highligted-background)}to{background-color:var(--ck-color-image-caption-background)}}"},function(i,a,d){var h=d(1),f=d(83);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=":root{--ck-image-style-spacing:1.5em;--ck-inline-image-style-spacing:calc(var(--ck-image-style-spacing)/2)}.ck-content .image-style-block-align-left,.ck-content .image-style-block-align-right{max-width:calc(100% - var(--ck-image-style-spacing))}.ck-content .image-style-align-left,.ck-content .image-style-align-right{clear:none}.ck-content .image-style-side{float:right;margin-left:var(--ck-image-style-spacing);max-width:50%}.ck-content .image-style-align-left{float:left;margin-right:var(--ck-image-style-spacing)}.ck-content .image-style-align-center{margin-left:auto;margin-right:auto}.ck-content .image-style-align-right{float:right;margin-left:var(--ck-image-style-spacing)}.ck-content .image-style-block-align-right{margin-right:0;margin-left:auto}.ck-content .image-style-block-align-left{margin-left:0;margin-right:auto}.ck-content p+.image-style-align-left,.ck-content p+.image-style-align-right,.ck-content p+.image-style-side{margin-top:0}.ck-content .image-inline.image-style-align-left,.ck-content .image-inline.image-style-align-right{margin-top:var(--ck-inline-image-style-spacing);margin-bottom:var(--ck-inline-image-style-spacing)}.ck-content .image-inline.image-style-align-left{margin-right:var(--ck-inline-image-style-spacing)}.ck-content .image-inline.image-style-align-right{margin-left:var(--ck-inline-image-style-spacing)}.ck.ck-splitbutton.ck-splitbutton_flatten.ck-splitbutton_open>.ck-splitbutton__action:not(.ck-disabled),.ck.ck-splitbutton.ck-splitbutton_flatten.ck-splitbutton_open>.ck-splitbutton__arrow:not(.ck-disabled),.ck.ck-splitbutton.ck-splitbutton_flatten.ck-splitbutton_open>.ck-splitbutton__arrow:not(.ck-disabled):not(:hover),.ck.ck-splitbutton.ck-splitbutton_flatten:hover>.ck-splitbutton__action:not(.ck-disabled),.ck.ck-splitbutton.ck-splitbutton_flatten:hover>.ck-splitbutton__arrow:not(.ck-disabled),.ck.ck-splitbutton.ck-splitbutton_flatten:hover>.ck-splitbutton__arrow:not(.ck-disabled):not(:hover){background-color:var(--ck-color-button-on-background)}.ck.ck-splitbutton.ck-splitbutton_flatten.ck-splitbutton_open>.ck-splitbutton__action:not(.ck-disabled):after,.ck.ck-splitbutton.ck-splitbutton_flatten.ck-splitbutton_open>.ck-splitbutton__arrow:not(.ck-disabled):after,.ck.ck-splitbutton.ck-splitbutton_flatten.ck-splitbutton_open>.ck-splitbutton__arrow:not(.ck-disabled):not(:hover):after,.ck.ck-splitbutton.ck-splitbutton_flatten:hover>.ck-splitbutton__action:not(.ck-disabled):after,.ck.ck-splitbutton.ck-splitbutton_flatten:hover>.ck-splitbutton__arrow:not(.ck-disabled):after,.ck.ck-splitbutton.ck-splitbutton_flatten:hover>.ck-splitbutton__arrow:not(.ck-disabled):not(:hover):after{display:none}.ck.ck-splitbutton.ck-splitbutton_flatten.ck-splitbutton_open:hover>.ck-splitbutton__action:not(.ck-disabled),.ck.ck-splitbutton.ck-splitbutton_flatten.ck-splitbutton_open:hover>.ck-splitbutton__arrow:not(.ck-disabled),.ck.ck-splitbutton.ck-splitbutton_flatten.ck-splitbutton_open:hover>.ck-splitbutton__arrow:not(.ck-disabled):not(:hover){background-color:var(--ck-color-button-on-hover-background)}"},function(i,a,d){var h=d(1),f=d(85);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=".ck.ck-editor__editable .image,.ck.ck-editor__editable .image-inline{position:relative}.ck.ck-editor__editable .image-inline .ck-progress-bar,.ck.ck-editor__editable .image .ck-progress-bar{position:absolute;top:0;left:0}.ck.ck-editor__editable .image-inline.ck-appear,.ck.ck-editor__editable .image.ck-appear{animation:fadeIn .7s}.ck.ck-editor__editable .image-inline .ck-progress-bar,.ck.ck-editor__editable .image .ck-progress-bar{height:2px;width:0;background:var(--ck-color-upload-bar-background);transition:width .1s}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}"},function(i,a,d){var h=d(1),f=d(87);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports='.ck-image-upload-complete-icon{display:block;position:absolute;top:min(var(--ck-spacing-medium),6%);right:min(var(--ck-spacing-medium),6%);border-radius:50%;z-index:1}.ck-image-upload-complete-icon:after{content:"";position:absolute}:root{--ck-color-image-upload-icon:#fff;--ck-color-image-upload-icon-background:#008a00;--ck-image-upload-icon-size:20;--ck-image-upload-icon-width:2px;--ck-image-upload-icon-is-visible:clamp(0px,100% - 50px,1px)}.ck-image-upload-complete-icon{opacity:0;background:var(--ck-color-image-upload-icon-background);animation-name:ck-upload-complete-icon-show,ck-upload-complete-icon-hide;animation-fill-mode:forwards,forwards;animation-duration:.5s,.5s;font-size:calc(1px*var(--ck-image-upload-icon-size));animation-delay:0ms,3s;overflow:hidden;width:calc(var(--ck-image-upload-icon-is-visible)*var(--ck-image-upload-icon-size));height:calc(var(--ck-image-upload-icon-is-visible)*var(--ck-image-upload-icon-size))}.ck-image-upload-complete-icon:after{left:25%;top:50%;opacity:0;height:0;width:0;transform:scaleX(-1) rotate(135deg);transform-origin:left top;border-top:var(--ck-image-upload-icon-width) solid var(--ck-color-image-upload-icon);border-right:var(--ck-image-upload-icon-width) solid var(--ck-color-image-upload-icon);animation-name:ck-upload-complete-icon-check;animation-duration:.5s;animation-delay:.5s;animation-fill-mode:forwards;box-sizing:border-box}@keyframes ck-upload-complete-icon-show{0%{opacity:0}to{opacity:1}}@keyframes ck-upload-complete-icon-hide{0%{opacity:1}to{opacity:0}}@keyframes ck-upload-complete-icon-check{0%{opacity:1;width:0;height:0}33%{width:.3em;height:0}to{opacity:1;width:.3em;height:.45em}}'},function(i,a,d){var h=d(1),f=d(89);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports='.ck .ck-upload-placeholder-loader{position:absolute;display:flex;align-items:center;justify-content:center;top:0;left:0}.ck .ck-upload-placeholder-loader:before{content:"";position:relative}:root{--ck-color-upload-placeholder-loader:#b3b3b3;--ck-upload-placeholder-loader-size:32px;--ck-upload-placeholder-image-aspect-ratio:2.8}.ck .ck-image-upload-placeholder{width:100%;margin:0}.ck .ck-image-upload-placeholder.image-inline{width:calc(var(--ck-upload-placeholder-loader-size)*2*var(--ck-upload-placeholder-image-aspect-ratio))}.ck .ck-image-upload-placeholder img{aspect-ratio:var(--ck-upload-placeholder-image-aspect-ratio)}.ck .ck-upload-placeholder-loader{width:100%;height:100%}.ck .ck-upload-placeholder-loader:before{width:var(--ck-upload-placeholder-loader-size);height:var(--ck-upload-placeholder-loader-size);border-radius:50%;border-top:3px solid var(--ck-color-upload-placeholder-loader);border-right:2px solid transparent;animation:ck-upload-placeholder-loader 1s linear infinite}@keyframes ck-upload-placeholder-loader{to{transform:rotate(1turn)}}'},function(i,a,d){var h=d(1),f=d(91);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=".ck .ck-link_selected{background:var(--ck-color-link-selected-background)}.ck .ck-link_selected span.image-inline{outline:var(--ck-widget-outline-thickness) solid var(--ck-color-link-selected-background)}.ck .ck-fake-link-selection{background:var(--ck-color-link-fake-selection)}.ck .ck-fake-link-selection_collapsed{height:100%;border-right:1px solid var(--ck-color-base-text);margin-right:-1px;outline:1px solid hsla(0,0%,100%,.5)}"},function(i,a,d){var h=d(1),f=d(93);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=".ck.ck-link-form{display:flex}.ck.ck-link-form .ck-label{display:none}@media screen and (max-width:600px){.ck.ck-link-form{flex-wrap:wrap}.ck.ck-link-form .ck-labeled-field-view{flex-basis:100%}.ck.ck-link-form .ck-button{flex-basis:50%}}.ck.ck-link-form_layout-vertical{display:block}.ck.ck-link-form_layout-vertical .ck-button.ck-button-cancel,.ck.ck-link-form_layout-vertical .ck-button.ck-button-save{margin-top:var(--ck-spacing-medium)}.ck.ck-link-form_layout-vertical{padding:0;min-width:var(--ck-input-text-width)}.ck.ck-link-form_layout-vertical .ck-labeled-field-view{margin:var(--ck-spacing-large) var(--ck-spacing-large) var(--ck-spacing-small)}.ck.ck-link-form_layout-vertical .ck-labeled-field-view .ck-input-text{min-width:0;width:100%}.ck.ck-link-form_layout-vertical .ck-button{padding:var(--ck-spacing-standard);margin:0;border-radius:0;border:0;border-top:1px solid var(--ck-color-base-border);width:50%}[dir=ltr] .ck.ck-link-form_layout-vertical .ck-button,[dir=rtl] .ck.ck-link-form_layout-vertical .ck-button{margin-left:0}[dir=rtl] .ck.ck-link-form_layout-vertical .ck-button:last-of-type{border-right:1px solid var(--ck-color-base-border)}.ck.ck-link-form_layout-vertical .ck.ck-list{margin:var(--ck-spacing-standard) var(--ck-spacing-large)}.ck.ck-link-form_layout-vertical .ck.ck-list .ck-button.ck-switchbutton{border:0;padding:0;width:100%}.ck.ck-link-form_layout-vertical .ck.ck-list .ck-button.ck-switchbutton:hover{background:none}"},function(i,a,d){var h=d(1),f=d(95);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=".ck.ck-link-actions{display:flex;flex-direction:row;flex-wrap:nowrap}.ck.ck-link-actions .ck-link-actions__preview{display:inline-block}.ck.ck-link-actions .ck-link-actions__preview .ck-button__label{overflow:hidden}@media screen and (max-width:600px){.ck.ck-link-actions{flex-wrap:wrap}.ck.ck-link-actions .ck-link-actions__preview{flex-basis:100%}.ck.ck-link-actions .ck-button:not(.ck-link-actions__preview){flex-basis:50%}}.ck.ck-link-actions .ck-button.ck-link-actions__preview{padding-left:0;padding-right:0}.ck.ck-link-actions .ck-button.ck-link-actions__preview .ck-button__label{padding:0 var(--ck-spacing-medium);color:var(--ck-color-link-default);text-overflow:ellipsis;cursor:pointer;max-width:var(--ck-input-text-width);min-width:3em;text-align:center}.ck.ck-link-actions .ck-button.ck-link-actions__preview .ck-button__label:hover{text-decoration:underline}.ck.ck-link-actions .ck-button.ck-link-actions__preview,.ck.ck-link-actions .ck-button.ck-link-actions__preview:active,.ck.ck-link-actions .ck-button.ck-link-actions__preview:focus,.ck.ck-link-actions .ck-button.ck-link-actions__preview:hover{background:none}.ck.ck-link-actions .ck-button.ck-link-actions__preview:active{box-shadow:none}.ck.ck-link-actions .ck-button.ck-link-actions__preview:focus .ck-button__label{text-decoration:underline}[dir=ltr] .ck.ck-link-actions .ck-button:not(:first-child),[dir=rtl] .ck.ck-link-actions .ck-button:not(:last-child){margin-left:var(--ck-spacing-standard)}@media screen and (max-width:600px){.ck.ck-link-actions .ck-button.ck-link-actions__preview{margin:var(--ck-spacing-standard) var(--ck-spacing-standard) 0}.ck.ck-link-actions .ck-button.ck-link-actions__preview .ck-button__label{min-width:0;max-width:100%}[dir=ltr] .ck.ck-link-actions .ck-button:not(.ck-link-actions__preview),[dir=rtl] .ck.ck-link-actions .ck-button:not(.ck-link-actions__preview){margin-left:0}}"},function(i,a,d){var h=d(1),f=d(97);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports='.ck-media__wrapper .ck-media__placeholder{display:flex;flex-direction:column;align-items:center}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url .ck-tooltip{display:block}@media (hover:none){.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url .ck-tooltip{display:none}}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url{max-width:100%;position:relative}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url:hover .ck-tooltip{visibility:visible;opacity:1}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url .ck-media__placeholder__url__text{overflow:hidden;display:block}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder__icon *,.ck-media__wrapper[data-oembed-url*="goo.gl/maps"] .ck-media__placeholder__icon *,.ck-media__wrapper[data-oembed-url*="google.com/maps"] .ck-media__placeholder__icon *,.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder__icon *,.ck-media__wrapper[data-oembed-url*="maps.app.goo.gl"] .ck-media__placeholder__icon *,.ck-media__wrapper[data-oembed-url*="maps.google.com"] .ck-media__placeholder__icon *,.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck-media__placeholder__icon *{display:none}.ck-editor__editable:not(.ck-read-only) .ck-media__wrapper>:not(.ck-media__placeholder),.ck-editor__editable:not(.ck-read-only) .ck-widget:not(.ck-widget_selected) .ck-media__placeholder{pointer-events:none}:root{--ck-media-embed-placeholder-icon-size:3em;--ck-color-media-embed-placeholder-url-text:#757575;--ck-color-media-embed-placeholder-url-text-hover:var(--ck-color-base-text)}.ck-media__wrapper{margin:0 auto}.ck-media__wrapper .ck-media__placeholder{padding:calc(var(--ck-spacing-standard)*3);background:var(--ck-color-base-foreground)}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__icon{min-width:var(--ck-media-embed-placeholder-icon-size);height:var(--ck-media-embed-placeholder-icon-size);margin-bottom:var(--ck-spacing-large);background-position:50%;background-size:cover}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__icon .ck-icon{width:100%;height:100%}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url__text{color:var(--ck-color-media-embed-placeholder-url-text);white-space:nowrap;text-align:center;font-style:italic;text-overflow:ellipsis}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url__text:hover{color:var(--ck-color-media-embed-placeholder-url-text-hover);cursor:pointer;text-decoration:underline}.ck-media__wrapper[data-oembed-url*="open.spotify.com"]{max-width:300px;max-height:380px}.ck-media__wrapper[data-oembed-url*="goo.gl/maps"] .ck-media__placeholder__icon,.ck-media__wrapper[data-oembed-url*="google.com/maps"] .ck-media__placeholder__icon,.ck-media__wrapper[data-oembed-url*="maps.app.goo.gl"] .ck-media__placeholder__icon,.ck-media__wrapper[data-oembed-url*="maps.google.com"] .ck-media__placeholder__icon{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNTAuMzc4IiBoZWlnaHQ9IjI1NC4xNjciIHZpZXdCb3g9IjAgMCA2Ni4yNDYgNjcuMjQ4Ij48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTcyLjUzMSAtMjE4LjQ1NSkgc2NhbGUoLjk4MDEyKSI+PHJlY3Qgcnk9IjUuMjM4IiByeD0iNS4yMzgiIHk9IjIzMS4zOTkiIHg9IjE3Ni4wMzEiIGhlaWdodD0iNjAuMDk5IiB3aWR0aD0iNjAuMDk5IiBmaWxsPSIjMzRhNjY4IiBwYWludC1vcmRlcj0ibWFya2VycyBzdHJva2UgZmlsbCIvPjxwYXRoIGQ9Ik0yMDYuNDc3IDI2MC45bC0yOC45ODcgMjguOTg3YTUuMjE4IDUuMjE4IDAgMDAzLjc4IDEuNjFoNDkuNjIxYzEuNjk0IDAgMy4xOS0uNzk4IDQuMTQ2LTIuMDM3eiIgZmlsbD0iIzVjODhjNSIvPjxwYXRoIGQ9Ik0yMjYuNzQyIDIyMi45ODhjLTkuMjY2IDAtMTYuNzc3IDcuMTctMTYuNzc3IDE2LjAxNC4wMDcgMi43NjIuNjYzIDUuNDc0IDIuMDkzIDcuODc1LjQzLjcwMy44MyAxLjQwOCAxLjE5IDIuMTA3LjMzMy41MDIuNjUgMS4wMDUuOTUgMS41MDguMzQzLjQ3Ny42NzMuOTU3Ljk4OCAxLjQ0IDEuMzEgMS43NjkgMi41IDMuNTAyIDMuNjM3IDUuMTY4Ljc5MyAxLjI3NSAxLjY4MyAyLjY0IDIuNDY2IDMuOTkgMi4zNjMgNC4wOTQgNC4wMDcgOC4wOTIgNC42IDEzLjkxNHYuMDEyYy4xODIuNDEyLjUxNi42NjYuODc5LjY2Ny40MDMtLjAwMS43NjgtLjMxNC45My0uNzk5LjYwMy01Ljc1NiAyLjIzOC05LjcyOSA0LjU4NS0xMy43OTQuNzgyLTEuMzUgMS42NzMtMi43MTUgMi40NjUtMy45OSAxLjEzNy0xLjY2NiAyLjMyOC0zLjQgMy42MzgtNS4xNjkuMzE1LS40ODIuNjQ1LS45NjIuOTg4LTEuNDM5LjMtLjUwMy42MTctMS4wMDYuOTUtMS41MDguMzU5LS43Ljc2LTEuNDA0IDEuMTktMi4xMDcgMS40MjYtMi40MDIgMi01LjExNCAyLjAwNC03Ljg3NSAwLTguODQ0LTcuNTExLTE2LjAxNC0xNi43NzYtMTYuMDE0eiIgZmlsbD0iI2RkNGIzZSIgcGFpbnQtb3JkZXI9Im1hcmtlcnMgc3Ryb2tlIGZpbGwiLz48ZWxsaXBzZSByeT0iNS41NjQiIHJ4PSI1LjgyOCIgY3k9IjIzOS4wMDIiIGN4PSIyMjYuNzQyIiBmaWxsPSIjODAyZDI3IiBwYWludC1vcmRlcj0ibWFya2VycyBzdHJva2UgZmlsbCIvPjxwYXRoIGQ9Ik0xOTAuMzAxIDIzNy4yODNjLTQuNjcgMC04LjQ1NyAzLjg1My04LjQ1NyA4LjYwNnMzLjc4NiA4LjYwNyA4LjQ1NyA4LjYwN2MzLjA0MyAwIDQuODA2LS45NTggNi4zMzctMi41MTYgMS41My0xLjU1NyAyLjA4Ny0zLjkxMyAyLjA4Ny02LjI5IDAtLjM2Mi0uMDIzLS43MjItLjA2NC0xLjA3OWgtOC4yNTd2My4wNDNoNC44NWMtLjE5Ny43NTktLjUzMSAxLjQ1LTEuMDU4IDEuOTg2LS45NDIuOTU4LTIuMDI4IDEuNTQ4LTMuOTAxIDEuNTQ4LTIuODc2IDAtNS4yMDgtMi4zNzItNS4yMDgtNS4yOTkgMC0yLjkyNiAyLjMzMi01LjI5OSA1LjIwOC01LjI5OSAxLjM5OSAwIDIuNjE4LjQwNyAzLjU4NCAxLjI5M2wyLjM4MS0yLjM4YzAtLjAwMi0uMDAzLS4wMDQtLjAwNC0uMDA1LTEuNTg4LTEuNTI0LTMuNjItMi4yMTUtNS45NTUtMi4yMTV6bTQuNDMgNS42NmwuMDAzLjAwNnYtLjAwM3oiIGZpbGw9IiNmZmYiIHBhaW50LW9yZGVyPSJtYXJrZXJzIHN0cm9rZSBmaWxsIi8+PHBhdGggZD0iTTIxNS4xODQgMjUxLjkyOWwtNy45OCA3Ljk3OSAyOC40NzcgMjguNDc1YTUuMjMzIDUuMjMzIDAgMDAuNDQ5LTIuMTIzdi0zMS4xNjVjLS40NjkuNjc1LS45MzQgMS4zNDktMS4zODIgMi4wMDUtLjc5MiAxLjI3NS0xLjY4MiAyLjY0LTIuNDY1IDMuOTktMi4zNDcgNC4wNjUtMy45ODIgOC4wMzgtNC41ODUgMTMuNzk0LS4xNjIuNDg1LS41MjcuNzk4LS45My43OTktLjM2My0uMDAxLS42OTctLjI1NS0uODc5LS42Njd2LS4wMTJjLS41OTMtNS44MjItMi4yMzctOS44Mi00LjYtMTMuOTE0LS43ODMtMS4zNS0xLjY3My0yLjcxNS0yLjQ2Ni0zLjk5LTEuMTM3LTEuNjY2LTIuMzI3LTMuNC0zLjYzNy01LjE2OWwtLjAwMi0uMDAzeiIgZmlsbD0iI2MzYzNjMyIvPjxwYXRoIGQ9Ik0yMTIuOTgzIDI0OC40OTVsLTM2Ljk1MiAzNi45NTN2LjgxMmE1LjIyNyA1LjIyNyAwIDAwNS4yMzggNS4yMzhoMS4wMTVsMzUuNjY2LTM1LjY2NmExMzYuMjc1IDEzNi4yNzUgMCAwMC0yLjc2NC0zLjkgMzcuNTc1IDM3LjU3NSAwIDAwLS45ODktMS40NCAzNS4xMjcgMzUuMTI3IDAgMDAtLjk1LTEuNTA4Yy0uMDgzLS4xNjItLjE3Ni0uMzI2LS4yNjQtLjQ4OXoiIGZpbGw9IiNmZGRjNGYiIHBhaW50LW9yZGVyPSJtYXJrZXJzIHN0cm9rZSBmaWxsIi8+PHBhdGggZD0iTTIxMS45OTggMjYxLjA4M2wtNi4xNTIgNi4xNTEgMjQuMjY0IDI0LjI2NGguNzgxYTUuMjI3IDUuMjI3IDAgMDA1LjIzOS01LjIzOHYtMS4wNDV6IiBmaWxsPSIjZmZmIiBwYWludC1vcmRlcj0ibWFya2VycyBzdHJva2UgZmlsbCIvPjwvZz48L3N2Zz4=)}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder{background:#4268b3}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder .ck-media__placeholder__icon{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAyNCIgaGVpZ2h0PSIxMDI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik05NjcuNDg0IDBINTYuNTE3QzI1LjMwNCAwIDAgMjUuMzA0IDAgNTYuNTE3djkxMC45NjZDMCA5OTguNjk0IDI1LjI5NyAxMDI0IDU2LjUyMiAxMDI0SDU0N1Y2MjhINDE0VjQ3M2gxMzNWMzU5LjAyOWMwLTEzMi4yNjIgODAuNzczLTIwNC4yODIgMTk4Ljc1Ni0yMDQuMjgyIDU2LjUxMyAwIDEwNS4wODYgNC4yMDggMTE5LjI0NCA2LjA4OVYyOTlsLTgxLjYxNi4wMzdjLTYzLjk5MyAwLTc2LjM4NCAzMC40OTItNzYuMzg0IDc1LjIzNlY0NzNoMTUzLjQ4N2wtMTkuOTg2IDE1NUg3MDd2Mzk2aDI2MC40ODRjMzEuMjEzIDAgNTYuNTE2LTI1LjMwMyA1Ni41MTYtNTYuNTE2VjU2LjUxNUMxMDI0IDI1LjMwMyA5OTguNjk3IDAgOTY3LjQ4NCAwIiBmaWxsPSIjRkZGRkZFIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder .ck-media__placeholder__url__text{color:#cdf}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder .ck-media__placeholder__url__text:hover{color:#fff}.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder{background:linear-gradient(-135deg,#1400c7,#b800b1,#f50000)}.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder .ck-media__placeholder__icon{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTA0IiBoZWlnaHQ9IjUwNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PGRlZnM+PHBhdGggaWQ9ImEiIGQ9Ik0wIC4xNTloNTAzLjg0MVY1MDMuOTRIMHoiLz48L2RlZnM+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48bWFzayBpZD0iYiIgZmlsbD0iI2ZmZiI+PHVzZSB4bGluazpocmVmPSIjYSIvPjwvbWFzaz48cGF0aCBkPSJNMjUxLjkyMS4xNTljLTY4LjQxOCAwLTc2Ljk5Ny4yOS0xMDMuODY3IDEuNTE2LTI2LjgxNCAxLjIyMy00NS4xMjcgNS40ODItNjEuMTUxIDExLjcxLTE2LjU2NiA2LjQzNy0zMC42MTUgMTUuMDUxLTQ0LjYyMSAyOS4wNTYtMTQuMDA1IDE0LjAwNi0yMi42MTkgMjguMDU1LTI5LjA1NiA0NC42MjEtNi4yMjggMTYuMDI0LTEwLjQ4NyAzNC4zMzctMTEuNzEgNjEuMTUxQy4yOSAxNzUuMDgzIDAgMTgzLjY2MiAwIDI1Mi4wOGMwIDY4LjQxNy4yOSA3Ni45OTYgMS41MTYgMTAzLjg2NiAxLjIyMyAyNi44MTQgNS40ODIgNDUuMTI3IDExLjcxIDYxLjE1MSA2LjQzNyAxNi41NjYgMTUuMDUxIDMwLjYxNSAyOS4wNTYgNDQuNjIxIDE0LjAwNiAxNC4wMDUgMjguMDU1IDIyLjYxOSA0NC42MjEgMjkuMDU3IDE2LjAyNCA2LjIyNyAzNC4zMzcgMTAuNDg2IDYxLjE1MSAxMS43MDkgMjYuODcgMS4yMjYgMzUuNDQ5IDEuNTE2IDEwMy44NjcgMS41MTYgNjguNDE3IDAgNzYuOTk2LS4yOSAxMDMuODY2LTEuNTE2IDI2LjgxNC0xLjIyMyA0NS4xMjctNS40ODIgNjEuMTUxLTExLjcwOSAxNi41NjYtNi40MzggMzAuNjE1LTE1LjA1MiA0NC42MjEtMjkuMDU3IDE0LjAwNS0xNC4wMDYgMjIuNjE5LTI4LjA1NSAyOS4wNTctNDQuNjIxIDYuMjI3LTE2LjAyNCAxMC40ODYtMzQuMzM3IDExLjcwOS02MS4xNTEgMS4yMjYtMjYuODcgMS41MTYtMzUuNDQ5IDEuNTE2LTEwMy44NjYgMC02OC40MTgtLjI5LTc2Ljk5Ny0xLjUxNi0xMDMuODY3LTEuMjIzLTI2LjgxNC01LjQ4Mi00NS4xMjctMTEuNzA5LTYxLjE1MS02LjQzOC0xNi41NjYtMTUuMDUyLTMwLjYxNS0yOS4wNTctNDQuNjIxLTE0LjAwNi0xNC4wMDUtMjguMDU1LTIyLjYxOS00NC42MjEtMjkuMDU2LTE2LjAyNC02LjIyOC0zNC4zMzctMTAuNDg3LTYxLjE1MS0xMS43MUMzMjguOTE3LjQ0OSAzMjAuMzM4LjE1OSAyNTEuOTIxLjE1OXptMCA0NS4zOTFjNjcuMjY1IDAgNzUuMjMzLjI1NyAxMDEuNzk3IDEuNDY5IDI0LjU2MiAxLjEyIDM3LjkwMSA1LjIyNCA0Ni43NzggOC42NzQgMTEuNzU5IDQuNTcgMjAuMTUxIDEwLjAyOSAyOC45NjYgMTguODQ1IDguODE2IDguODE1IDE0LjI3NSAxNy4yMDcgMTguODQ1IDI4Ljk2NiAzLjQ1IDguODc3IDcuNTU0IDIyLjIxNiA4LjY3NCA0Ni43NzggMS4yMTIgMjYuNTY0IDEuNDY5IDM0LjUzMiAxLjQ2OSAxMDEuNzk4IDAgNjcuMjY1LS4yNTcgNzUuMjMzLTEuNDY5IDEwMS43OTctMS4xMiAyNC41NjItNS4yMjQgMzcuOTAxLTguNjc0IDQ2Ljc3OC00LjU3IDExLjc1OS0xMC4wMjkgMjAuMTUxLTE4Ljg0NSAyOC45NjYtOC44MTUgOC44MTYtMTcuMjA3IDE0LjI3NS0yOC45NjYgMTguODQ1LTguODc3IDMuNDUtMjIuMjE2IDcuNTU0LTQ2Ljc3OCA4LjY3NC0yNi41NiAxLjIxMi0zNC41MjcgMS40NjktMTAxLjc5NyAxLjQ2OS02Ny4yNzEgMC03NS4yMzctLjI1Ny0xMDEuNzk4LTEuNDY5LTI0LjU2Mi0xLjEyLTM3LjkwMS01LjIyNC00Ni43NzgtOC42NzQtMTEuNzU5LTQuNTctMjAuMTUxLTEwLjAyOS0yOC45NjYtMTguODQ1LTguODE1LTguODE1LTE0LjI3NS0xNy4yMDctMTguODQ1LTI4Ljk2Ni0zLjQ1LTguODc3LTcuNTU0LTIyLjIxNi04LjY3NC00Ni43NzgtMS4yMTItMjYuNTY0LTEuNDY5LTM0LjUzMi0xLjQ2OS0xMDEuNzk3IDAtNjcuMjY2LjI1Ny03NS4yMzQgMS40NjktMTAxLjc5OCAxLjEyLTI0LjU2MiA1LjIyNC0zNy45MDEgOC42NzQtNDYuNzc4IDQuNTctMTEuNzU5IDEwLjAyOS0yMC4xNTEgMTguODQ1LTI4Ljk2NiA4LjgxNS04LjgxNiAxNy4yMDctMTQuMjc1IDI4Ljk2Ni0xOC44NDUgOC44NzctMy40NSAyMi4yMTYtNy41NTQgNDYuNzc4LTguNjc0IDI2LjU2NC0xLjIxMiAzNC41MzItMS40NjkgMTAxLjc5OC0xLjQ2OXoiIGZpbGw9IiNGRkYiIG1hc2s9InVybCgjYikiLz48cGF0aCBkPSJNMjUxLjkyMSAzMzYuMDUzYy00Ni4zNzggMC04My45NzQtMzcuNTk2LTgzLjk3NC04My45NzMgMC00Ni4zNzggMzcuNTk2LTgzLjk3NCA4My45NzQtODMuOTc0IDQ2LjM3NyAwIDgzLjk3MyAzNy41OTYgODMuOTczIDgzLjk3NCAwIDQ2LjM3Ny0zNy41OTYgODMuOTczLTgzLjk3MyA4My45NzN6bTAtMjEzLjMzOGMtNzEuNDQ3IDAtMTI5LjM2NSA1Ny45MTgtMTI5LjM2NSAxMjkuMzY1IDAgNzEuNDQ2IDU3LjkxOCAxMjkuMzY0IDEyOS4zNjUgMTI5LjM2NCA3MS40NDYgMCAxMjkuMzY0LTU3LjkxOCAxMjkuMzY0LTEyOS4zNjQgMC03MS40NDctNTcuOTE4LTEyOS4zNjUtMTI5LjM2NC0xMjkuMzY1ek00MTYuNjI3IDExNy42MDRjMCAxNi42OTYtMTMuNTM1IDMwLjIzLTMwLjIzMSAzMC4yMy0xNi42OTUgMC0zMC4yMy0xMy41MzQtMzAuMjMtMzAuMjMgMC0xNi42OTYgMTMuNTM1LTMwLjIzMSAzMC4yMy0zMC4yMzEgMTYuNjk2IDAgMzAuMjMxIDEzLjUzNSAzMC4yMzEgMzAuMjMxIiBmaWxsPSIjRkZGIi8+PC9nPjwvc3ZnPg==)}.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder .ck-media__placeholder__url__text{color:#ffe0fe}.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder .ck-media__placeholder__url__text:hover{color:#fff}.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck.ck-media__placeholder{background:linear-gradient(90deg,#71c6f4,#0d70a5)}.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck.ck-media__placeholder .ck-media__placeholder__icon{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0MDAgNDAwIj48cGF0aCBkPSJNNDAwIDIwMGMwIDExMC41LTg5LjUgMjAwLTIwMCAyMDBTMCAzMTAuNSAwIDIwMCA4OS41IDAgMjAwIDBzMjAwIDg5LjUgMjAwIDIwMHpNMTYzLjQgMzA1LjVjODguNyAwIDEzNy4yLTczLjUgMTM3LjItMTM3LjIgMC0yLjEgMC00LjItLjEtNi4yIDkuNC02LjggMTcuNi0xNS4zIDI0LjEtMjUtOC42IDMuOC0xNy45IDYuNC0yNy43IDcuNiAxMC02IDE3LjYtMTUuNCAyMS4yLTI2LjctOS4zIDUuNS0xOS42IDkuNS0zMC42IDExLjctOC44LTkuNC0yMS4zLTE1LjItMzUuMi0xNS4yLTI2LjYgMC00OC4yIDIxLjYtNDguMiA0OC4yIDAgMy44LjQgNy41IDEuMyAxMS00MC4xLTItNzUuNi0yMS4yLTk5LjQtNTAuNC00LjEgNy4xLTYuNSAxNS40LTYuNSAyNC4yIDAgMTYuNyA4LjUgMzEuNSAyMS41IDQwLjEtNy45LS4yLTE1LjMtMi40LTIxLjgtNnYuNmMwIDIzLjQgMTYuNiA0Mi44IDM4LjcgNDcuMy00IDEuMS04LjMgMS43LTEyLjcgMS43LTMuMSAwLTYuMS0uMy05LjEtLjkgNi4xIDE5LjIgMjMuOSAzMy4xIDQ1IDMzLjUtMTYuNSAxMi45LTM3LjMgMjAuNi01OS45IDIwLjYtMy45IDAtNy43LS4yLTExLjUtLjcgMjEuMSAxMy44IDQ2LjUgMjEuOCA3My43IDIxLjgiIGZpbGw9IiNmZmYiLz48L3N2Zz4=)}.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck.ck-media__placeholder .ck-media__placeholder__url__text{color:#b8e6ff}.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck.ck-media__placeholder .ck-media__placeholder__url__text:hover{color:#fff}'},function(i,a,d){var h=d(1),f=d(99);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=".ck.ck-media-form{display:flex;align-items:flex-start;flex-direction:row;flex-wrap:nowrap}.ck.ck-media-form .ck-labeled-field-view{display:inline-block}.ck.ck-media-form .ck-label{display:none}@media screen and (max-width:600px){.ck.ck-media-form{flex-wrap:wrap}.ck.ck-media-form .ck-labeled-field-view{flex-basis:100%}.ck.ck-media-form .ck-button{flex-basis:50%}}"},function(i,a,d){var h=d(1),f=d(101);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=".ck-content .media{clear:both;margin:.9em 0;display:block;min-width:15em}"},function(i,a,d){var h=d(1),f=d(103);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=":root{--ck-color-table-focused-cell-background:rgba(158,207,250,0.3)}.ck-widget.table td.ck-editor__nested-editable.ck-editor__nested-editable_focused,.ck-widget.table td.ck-editor__nested-editable:focus,.ck-widget.table th.ck-editor__nested-editable.ck-editor__nested-editable_focused,.ck-widget.table th.ck-editor__nested-editable:focus{background:var(--ck-color-table-focused-cell-background);border-style:none;outline:1px solid var(--ck-color-focus-border);outline-offset:-1px}"},function(i,a,d){var h=d(1),f=d(105);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=".ck .ck-insert-table-dropdown__grid{display:flex;flex-direction:row;flex-wrap:wrap}:root{--ck-insert-table-dropdown-padding:10px;--ck-insert-table-dropdown-box-height:11px;--ck-insert-table-dropdown-box-width:12px;--ck-insert-table-dropdown-box-margin:1px}.ck .ck-insert-table-dropdown__grid{width:calc(var(--ck-insert-table-dropdown-box-width)*10 + var(--ck-insert-table-dropdown-box-margin)*20 + var(--ck-insert-table-dropdown-padding)*2);padding:var(--ck-insert-table-dropdown-padding) var(--ck-insert-table-dropdown-padding) 0}.ck .ck-insert-table-dropdown__label{text-align:center}.ck .ck-insert-table-dropdown-grid-box{width:var(--ck-insert-table-dropdown-box-width);height:var(--ck-insert-table-dropdown-box-height);margin:var(--ck-insert-table-dropdown-box-margin);border:1px solid var(--ck-color-base-border);border-radius:1px}.ck .ck-insert-table-dropdown-grid-box.ck-on{border-color:var(--ck-color-focus-border);background:var(--ck-color-focus-outer-shadow)}"},function(i,a,d){var h=d(1),f=d(107);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=':root{--ck-table-selected-cell-background:rgba(158,207,250,0.3)}.ck.ck-editor__editable .table table td.ck-editor__editable_selected,.ck.ck-editor__editable .table table th.ck-editor__editable_selected{position:relative;caret-color:transparent;outline:unset;box-shadow:unset}.ck.ck-editor__editable .table table td.ck-editor__editable_selected:after,.ck.ck-editor__editable .table table th.ck-editor__editable_selected:after{content:"";pointer-events:none;background-color:var(--ck-table-selected-cell-background);position:absolute;top:0;left:0;right:0;bottom:0}.ck.ck-editor__editable .table table td.ck-editor__editable_selected ::selection,.ck.ck-editor__editable .table table td.ck-editor__editable_selected:focus,.ck.ck-editor__editable .table table th.ck-editor__editable_selected ::selection,.ck.ck-editor__editable .table table th.ck-editor__editable_selected:focus{background-color:transparent}.ck.ck-editor__editable .table table td.ck-editor__editable_selected .ck-widget,.ck.ck-editor__editable .table table th.ck-editor__editable_selected .ck-widget{outline:unset}.ck.ck-editor__editable .table table td.ck-editor__editable_selected .ck-widget>.ck-widget__selection-handle,.ck.ck-editor__editable .table table th.ck-editor__editable_selected .ck-widget>.ck-widget__selection-handle{display:none}'},function(i,a,d){var h=d(1),f=d(109);typeof(f=f.__esModule?f.default:f)=="string"&&(f=[[i.i,f,""]]);var b={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};h(f,b),i.exports=f.locals||{}},function(i,a){i.exports=".ck-content .table{margin:.9em auto;display:table}.ck-content .table table{border-collapse:collapse;border-spacing:0;width:100%;height:100%;border:1px double #b3b3b3}.ck-content .table table td,.ck-content .table table th{min-width:2em;padding:.4em;border:1px solid #bfbfbf}.ck-content .table table th{font-weight:700;background:hsla(0,0%,0%,5%)}.ck-content[dir=rtl] .table th{text-align:right}.ck-content[dir=ltr] .table th{text-align:left}.ck-editor__editable .ck-table-bogus-paragraph{display:inline-block;width:100%}"},function(i,a,d){d.r(a),d.d(a,"default",function(){return pd});var h=function(){return function l(){l.called=!0}};class f{constructor(t,n){this.source=t,this.name=n,this.path=[],this.stop=h(),this.off=h()}}const b=new Array(256).fill().map((l,t)=>("0"+t.toString(16)).slice(-2));function k(){const l=4294967296*Math.random()>>>0,t=4294967296*Math.random()>>>0,n=4294967296*Math.random()>>>0,o=4294967296*Math.random()>>>0;return"e"+b[l>>0&255]+b[l>>8&255]+b[l>>16&255]+b[l>>24&255]+b[t>>0&255]+b[t>>8&255]+b[t>>16&255]+b[t>>24&255]+b[n>>0&255]+b[n>>8&255]+b[n>>16&255]+b[n>>24&255]+b[o>>0&255]+b[o>>8&255]+b[o>>16&255]+b[o>>24&255]}var C={get(l){return typeof l!="number"?this[l]||this.normal:l},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5},y=(d(6),d(0));const P=Symbol("listeningTo"),R=Symbol("emitterId");var D={on(l,t,n={}){this.listenTo(this,l,t,n)},once(l,t,n){let o=!1;this.listenTo(this,l,function(r,...c){o||(o=!0,r.off(),t.call(this,r,...c))},n)},off(l,t){this.stopListening(this,l,t)},listenTo(l,t,n,o={}){let r,c;this[P]||(this[P]={});const u=this[P];Z(l)||$(l);const g=Z(l);(r=u[g])||(r=u[g]={emitter:l,callbacks:{}}),(c=r.callbacks[t])||(c=r.callbacks[t]=[]),c.push(n),function(m,p,w,_,v){p._addEventListener?p._addEventListener(w,_,v):m._addEventListener.call(p,w,_,v)}(this,l,t,n,o)},stopListening(l,t,n){const o=this[P];let r=l&&Z(l);const c=o&&r&&o[r],u=c&&t&&c.callbacks[t];if(!(!o||l&&!c||t&&!u))if(n)J(this,l,t,n),u.indexOf(n)!==-1&&(u.length===1?delete c.callbacks[t]:J(this,l,t,n));else if(u){for(;n=u.pop();)J(this,l,t,n);delete c.callbacks[t]}else if(c){for(t in c.callbacks)this.stopListening(l,t);delete o[r]}else{for(r in o)this.stopListening(o[r].emitter);delete this[P]}},fire(l,...t){try{const n=l instanceof f?l:new f(this,l),o=n.name;let r=function c(u,g){let m;return!u._events||!(m=u._events[g])||!m.callbacks.length?g.indexOf(":")>-1?c(u,g.substr(0,g.lastIndexOf(":"))):null:m.callbacks}(this,o);if(n.path.push(this),r){const c=[n,...t];r=Array.from(r);for(let u=0;u<r.length&&(r[u].callback.apply(this,c),n.off.called&&(delete n.off.called,this._removeEventListener(o,r[u].callback)),!n.stop.called);u++);}if(this._delegations){const c=this._delegations.get(o),u=this._delegations.get("*");c&&Lt(c,n,t),u&&Lt(u,n,t)}return n.return}catch(n){y.a.rethrowUnexpectedError(n,this)}},delegate(...l){return{to:(t,n)=>{this._delegations||(this._delegations=new Map),l.forEach(o=>{const r=this._delegations.get(o);r?r.set(t,n):this._delegations.set(o,new Map([[t,n]]))})}}},stopDelegating(l,t){if(this._delegations)if(l)if(t){const n=this._delegations.get(l);n&&n.delete(t)}else this._delegations.delete(l);else this._delegations.clear()},_addEventListener(l,t,n){(function(u,g){const m=nt(u);if(m[g])return;let p=g,w=null;const _=[];for(;p!==""&&!m[p];)m[p]={callbacks:[],childEvents:[]},_.push(m[p]),w&&m[p].childEvents.push(w),w=p,p=p.substr(0,p.lastIndexOf(":"));if(p!==""){for(const v of _)v.callbacks=m[p].callbacks.slice();m[p].childEvents.push(w)}})(this,l);const o=ot(this,l),r=C.get(n.priority),c={callback:t,priority:r};for(const u of o){let g=!1;for(let m=0;m<u.length;m++)if(u[m].priority<r){u.splice(m,0,c),g=!0;break}g||u.push(c)}},_removeEventListener(l,t){const n=ot(this,l);for(const o of n)for(let r=0;r<o.length;r++)o[r].callback==t&&(o.splice(r,1),r--)}};function $(l,t){l[R]||(l[R]=t||k())}function Z(l){return l[R]}function nt(l){return l._events||Object.defineProperty(l,"_events",{value:{}}),l._events}function ot(l,t){const n=nt(l)[t];if(!n)return[];let o=[n.callbacks];for(let r=0;r<n.childEvents.length;r++){const c=ot(l,n.childEvents[r]);o=o.concat(c)}return o}function Lt(l,t,n){for(let[o,r]of l){r?typeof r=="function"&&(r=r(t.name)):r=t.name;const c=new f(t.source,r);c.path=[...t.path],o.fire(c,...n)}}function J(l,t,n,o){t._removeEventListener?t._removeEventListener(n,o):l._removeEventListener.call(t,n,o)}var G=function(l){var t=typeof l;return l!=null&&(t=="object"||t=="function")},Q=d(3),B=Q.a.Symbol,K=Object.prototype,W=K.hasOwnProperty,it=K.toString,Ht=B?B.toStringTag:void 0,Te=function(l){var t=W.call(l,Ht),n=l[Ht];try{l[Ht]=void 0;var o=!0}catch{}var r=it.call(l);return o&&(t?l[Ht]=n:delete l[Ht]),r},qo=Object.prototype.toString,kr=function(l){return qo.call(l)},Zu=B?B.toStringTag:void 0,Nn=function(l){return l==null?l===void 0?"[object Undefined]":"[object Null]":Zu&&Zu in Object(l)?Te(l):kr(l)},th,Qn=function(l){if(!G(l))return!1;var t=Nn(l);return t=="[object Function]"||t=="[object GeneratorFunction]"||t=="[object AsyncFunction]"||t=="[object Proxy]"},hl=Q.a["__core-js_shared__"],eh=(th=/[^.]+$/.exec(hl&&hl.keys&&hl.keys.IE_PROTO||""))?"Symbol(src)_1."+th:"",ny=function(l){return!!eh&&eh in l},iy=Function.prototype.toString,Xn=function(l){if(l!=null){try{return iy.call(l)}catch{}try{return l+""}catch{}}return""},oy=/^\[object .+?Constructor\]$/,sy=Function.prototype,ry=Object.prototype,ay=sy.toString,ly=ry.hasOwnProperty,cy=RegExp("^"+ay.call(ly).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),dy=function(l){return!(!G(l)||ny(l))&&(Qn(l)?cy:oy).test(Xn(l))},uy=function(l,t){return l==null?void 0:l[t]},Zn=function(l,t){var n=uy(l,t);return dy(n)?n:void 0},vr=function(){try{var l=Zn(Object,"defineProperty");return l({},"",{}),l}catch{}}(),fl=function(l,t,n){t=="__proto__"&&vr?vr(l,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):l[t]=n},Uo=function(l,t){return l===t||l!=l&&t!=t},hy=Object.prototype.hasOwnProperty,gl=function(l,t,n){var o=l[t];hy.call(l,t)&&Uo(o,n)&&(n!==void 0||t in l)||fl(l,t,n)},Fi=function(l,t,n,o){var r=!n;n||(n={});for(var c=-1,u=t.length;++c<u;){var g=t[c],m=o?o(n[g],l[g],g,n,l):void 0;m===void 0&&(m=l[g]),r?fl(n,g,m):gl(n,g,m)}return n},ti=function(l){return l},fy=function(l,t,n){switch(n.length){case 0:return l.call(t);case 1:return l.call(t,n[0]);case 2:return l.call(t,n[0],n[1]);case 3:return l.call(t,n[0],n[1],n[2])}return l.apply(t,n)},nh=Math.max,gy=function(l,t,n){return t=nh(t===void 0?l.length-1:t,0),function(){for(var o=arguments,r=-1,c=nh(o.length-t,0),u=Array(c);++r<c;)u[r]=o[t+r];r=-1;for(var g=Array(t+1);++r<t;)g[r]=o[r];return g[t]=n(u),fy(l,this,g)}},my=function(l){return function(){return l}},py=vr?function(l,t){return vr(l,"toString",{configurable:!0,enumerable:!1,value:my(t),writable:!0})}:ti,by=Date.now,wy=function(l){var t=0,n=0;return function(){var o=by(),r=16-(o-n);if(n=o,r>0){if(++t>=800)return arguments[0]}else t=0;return l.apply(void 0,arguments)}}(py),_y=function(l,t){return wy(gy(l,t,ti),l+"")},ih=function(l){return typeof l=="number"&&l>-1&&l%1==0&&l<=9007199254740991},yr=function(l){return l!=null&&ih(l.length)&&!Qn(l)},ky=/^(?:0|[1-9]\d*)$/,ml=function(l,t){var n=typeof l;return!!(t=t??9007199254740991)&&(n=="number"||n!="symbol"&&ky.test(l))&&l>-1&&l%1==0&&l<t},vy=function(l,t,n){if(!G(n))return!1;var o=typeof t;return!!(o=="number"?yr(n)&&ml(t,n.length):o=="string"&&t in n)&&Uo(n[t],l)},oh=function(l){return _y(function(t,n){var o=-1,r=n.length,c=r>1?n[r-1]:void 0,u=r>2?n[2]:void 0;for(c=l.length>3&&typeof c=="function"?(r--,c):void 0,u&&vy(n[0],n[1],u)&&(c=r<3?void 0:c,r=1),t=Object(t);++o<r;){var g=n[o];g&&l(t,g,o,c)}return t})},yy=function(l,t){for(var n=-1,o=Array(l);++n<l;)o[n]=t(n);return o},Se=function(l){return l!=null&&typeof l=="object"},sh=function(l){return Se(l)&&Nn(l)=="[object Arguments]"},rh=Object.prototype,Ay=rh.hasOwnProperty,Cy=rh.propertyIsEnumerable,pl=sh(function(){return arguments}())?sh:function(l){return Se(l)&&Ay.call(l,"callee")&&!Cy.call(l,"callee")},ce=Array.isArray,Go=d(4),Tt={};Tt["[object Float32Array]"]=Tt["[object Float64Array]"]=Tt["[object Int8Array]"]=Tt["[object Int16Array]"]=Tt["[object Int32Array]"]=Tt["[object Uint8Array]"]=Tt["[object Uint8ClampedArray]"]=Tt["[object Uint16Array]"]=Tt["[object Uint32Array]"]=!0,Tt["[object Arguments]"]=Tt["[object Array]"]=Tt["[object ArrayBuffer]"]=Tt["[object Boolean]"]=Tt["[object DataView]"]=Tt["[object Date]"]=Tt["[object Error]"]=Tt["[object Function]"]=Tt["[object Map]"]=Tt["[object Number]"]=Tt["[object Object]"]=Tt["[object RegExp]"]=Tt["[object Set]"]=Tt["[object String]"]=Tt["[object WeakMap]"]=!1;var xy=function(l){return Se(l)&&ih(l.length)&&!!Tt[Nn(l)]},bl=function(l){return function(t){return l(t)}},zi=d(5),ah=zi.a&&zi.a.isTypedArray,wl=ah?bl(ah):xy,Ey=Object.prototype.hasOwnProperty,lh=function(l,t){var n=ce(l),o=!n&&pl(l),r=!n&&!o&&Object(Go.a)(l),c=!n&&!o&&!r&&wl(l),u=n||o||r||c,g=u?yy(l.length,String):[],m=g.length;for(var p in l)!t&&!Ey.call(l,p)||u&&(p=="length"||r&&(p=="offset"||p=="parent")||c&&(p=="buffer"||p=="byteLength"||p=="byteOffset")||ml(p,m))||g.push(p);return g},Ty=Object.prototype,_l=function(l){var t=l&&l.constructor;return l===(typeof t=="function"&&t.prototype||Ty)},Sy=function(l){var t=[];if(l!=null)for(var n in Object(l))t.push(n);return t},Py=Object.prototype.hasOwnProperty,Iy=function(l){if(!G(l))return Sy(l);var t=_l(l),n=[];for(var o in l)(o!="constructor"||!t&&Py.call(l,o))&&n.push(o);return n},ji=function(l){return yr(l)?lh(l,!0):Iy(l)},Ko=oh(function(l,t){Fi(t,ji(t),l)});const Ar=Symbol("observableProperties"),Cr=Symbol("boundObservables"),xr=Symbol("boundProperties"),$i=Symbol("decoratedMethods"),ch=Symbol("decoratedOriginal"),kl={set(l,t){if(G(l))return void Object.keys(l).forEach(o=>{this.set(o,l[o])},this);dh(this);const n=this[Ar];if(l in this&&!n.has(l))throw new y.a("observable-set-cannot-override",this);Object.defineProperty(this,l,{enumerable:!0,configurable:!0,get:()=>n.get(l),set(o){const r=n.get(l);let c=this.fire("set:"+l,l,o,r);c===void 0&&(c=o),r===c&&n.has(l)||(n.set(l,c),this.fire("change:"+l,l,c,r))}}),this[l]=t},bind(...l){if(!l.length||!uh(l))throw new y.a("observable-bind-wrong-properties",this);if(new Set(l).size!==l.length)throw new y.a("observable-bind-duplicate-properties",this);dh(this);const t=this[xr];l.forEach(o=>{if(t.has(o))throw new y.a("observable-bind-rebind",this)});const n=new Map;return l.forEach(o=>{const r={property:o,to:[]};t.set(o,r),n.set(o,r)}),{to:My,toMany:Ry,_observable:this,_bindProperties:l,_to:[],_bindings:n}},unbind(...l){if(!this[Ar])return;const t=this[xr],n=this[Cr];if(l.length){if(!uh(l))throw new y.a("observable-unbind-wrong-properties",this);l.forEach(o=>{const r=t.get(o);if(!r)return;let c,u,g,m;r.to.forEach(p=>{c=p[0],u=p[1],g=n.get(c),m=g[u],m.delete(r),m.size||delete g[u],Object.keys(g).length||(n.delete(c),this.stopListening(c,"change"))}),t.delete(o)})}else n.forEach((o,r)=>{this.stopListening(r,"change")}),n.clear(),t.clear()},decorate(l){const t=this[l];if(!t)throw new y.a("observablemixin-cannot-decorate-undefined",this,{object:this,methodName:l});this.on(l,(n,o)=>{n.return=t.apply(this,o)}),this[l]=function(...n){return this.fire(l,n)},this[l][ch]=t,this[$i]||(this[$i]=[]),this[$i].push(l)}};Ko(kl,D),kl.stopListening=function(l,t,n){if(!l&&this[$i]){for(const o of this[$i])this[o]=this[o][ch];delete this[$i]}D.stopListening.call(this,l,t,n)};var yt=kl;function dh(l){l[Ar]||(Object.defineProperty(l,Ar,{value:new Map}),Object.defineProperty(l,Cr,{value:new Map}),Object.defineProperty(l,xr,{value:new Map}))}function My(...l){const t=function(...c){if(!c.length)throw new y.a("observable-bind-to-parse-error",null);const u={to:[]};let g;return typeof c[c.length-1]=="function"&&(u.callback=c.pop()),c.forEach(m=>{if(typeof m=="string")g.properties.push(m);else{if(typeof m!="object")throw new y.a("observable-bind-to-parse-error",null);g={observable:m,properties:[]},u.to.push(g)}}),u}(...l),n=Array.from(this._bindings.keys()),o=n.length;if(!t.callback&&t.to.length>1)throw new y.a("observable-bind-to-no-callback",this);if(o>1&&t.callback)throw new y.a("observable-bind-to-extra-callback",this);var r;t.to.forEach(c=>{if(c.properties.length&&c.properties.length!==o)throw new y.a("observable-bind-to-properties-length",this);c.properties.length||(c.properties=this._bindProperties)}),this._to=t.to,t.callback&&(this._bindings.get(n[0]).callback=t.callback),r=this._observable,this._to.forEach(c=>{const u=r[Cr];let g;u.get(c.observable)||r.listenTo(c.observable,"change",(m,p)=>{g=u.get(c.observable)[p],g&&g.forEach(w=>{hh(r,w.property)})})}),function(c){let u;c._bindings.forEach((g,m)=>{c._to.forEach(p=>{u=p.properties[g.callback?0:c._bindProperties.indexOf(m)],g.to.push([p.observable,u]),function(w,_,v,A){const x=w[Cr],E=x.get(v),T=E||{};T[A]||(T[A]=new Set),T[A].add(_),E||x.set(v,T)}(c._observable,g,p.observable,u)})})}(this),this._bindProperties.forEach(c=>{hh(this._observable,c)})}function Ry(l,t,n){if(this._bindings.size>1)throw new y.a("observable-bind-to-many-not-one-binding",this);this.to(...function(o,r){const c=o.map(u=>[u,r]);return Array.prototype.concat.apply([],c)}(l,t),n)}function uh(l){return l.every(t=>typeof t=="string")}function hh(l,t){const n=l[xr].get(t);let o;n.callback?o=n.callback.apply(l,n.to.map(r=>r[0][r[1]])):(o=n.to[0],o=o[0][o[1]]),Object.prototype.hasOwnProperty.call(l,t)?l[t]=o:l.set(t,o)}function tt(l,...t){t.forEach(n=>{Object.getOwnPropertyNames(n).concat(Object.getOwnPropertySymbols(n)).forEach(o=>{if(o in l.prototype)return;const r=Object.getOwnPropertyDescriptor(n,o);r.enumerable=!1,Object.defineProperty(l.prototype,o,r)})})}class z{constructor(t){this.editor=t,this.set("isEnabled",!0),this._disableStack=new Set}forceDisabled(t){this._disableStack.add(t),this._disableStack.size==1&&(this.on("set:isEnabled",fh,{priority:"highest"}),this.isEnabled=!1)}clearForceDisabled(t){this._disableStack.delete(t),this._disableStack.size==0&&(this.off("set:isEnabled",fh),this.isEnabled=!0)}destroy(){this.stopListening()}static get isContextPlugin(){return!1}}function fh(l){l.return=!1,l.stop()}tt(z,yt);class lt{constructor(t){this.editor=t,this.set("value",void 0),this.set("isEnabled",!1),this.affectsData=!0,this._disableStack=new Set,this.decorate("execute"),this.listenTo(this.editor.model.document,"change",()=>{this.refresh()}),this.on("execute",n=>{this.isEnabled||n.stop()},{priority:"high"}),this.listenTo(t,"change:isReadOnly",(n,o,r)=>{r&&this.affectsData?this.forceDisabled("readOnlyMode"):this.clearForceDisabled("readOnlyMode")})}refresh(){this.isEnabled=!0}forceDisabled(t){this._disableStack.add(t),this._disableStack.size==1&&(this.on("set:isEnabled",gh,{priority:"highest"}),this.isEnabled=!1)}clearForceDisabled(t){this._disableStack.delete(t),this._disableStack.size==0&&(this.off("set:isEnabled",gh),this.refresh())}execute(){}destroy(){this.stopListening()}}function gh(l){l.return=!1,l.stop()}tt(lt,yt);class mh extends lt{constructor(t){super(t),this._childCommands=[]}refresh(){}execute(...t){const n=this._getFirstEnabledCommand();return n!=null&&n.execute(t)}registerChildCommand(t){this._childCommands.push(t),t.on("change:isEnabled",()=>this._checkEnabled()),this._checkEnabled()}_checkEnabled(){this.isEnabled=!!this._getFirstEnabledCommand()}_getFirstEnabledCommand(){return this._childCommands.find(t=>t.isEnabled)}}var ph=function(l,t){return function(n){return l(t(n))}},vl=ph(Object.getPrototypeOf,Object),Oy=Function.prototype,Ny=Object.prototype,bh=Oy.toString,Dy=Ny.hasOwnProperty,Ly=bh.call(Object),Pe=function(l){if(!Se(l)||Nn(l)!="[object Object]")return!1;var t=vl(l);if(t===null)return!0;var n=Dy.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&bh.call(n)==Ly},Vy=function(){this.__data__=[],this.size=0},Er=function(l,t){for(var n=l.length;n--;)if(Uo(l[n][0],t))return n;return-1},By=Array.prototype.splice,Fy=function(l){var t=this.__data__,n=Er(t,l);return!(n<0)&&(n==t.length-1?t.pop():By.call(t,n,1),--this.size,!0)},zy=function(l){var t=this.__data__,n=Er(t,l);return n<0?void 0:t[n][1]},jy=function(l){return Er(this.__data__,l)>-1},$y=function(l,t){var n=this.__data__,o=Er(n,l);return o<0?(++this.size,n.push([l,t])):n[o][1]=t,this};function Hi(l){var t=-1,n=l==null?0:l.length;for(this.clear();++t<n;){var o=l[t];this.set(o[0],o[1])}}Hi.prototype.clear=Vy,Hi.prototype.delete=Fy,Hi.prototype.get=zy,Hi.prototype.has=jy,Hi.prototype.set=$y;var Tr=Hi,Hy=function(){this.__data__=new Tr,this.size=0},Wy=function(l){var t=this.__data__,n=t.delete(l);return this.size=t.size,n},qy=function(l){return this.__data__.get(l)},Uy=function(l){return this.__data__.has(l)},Yo=Zn(Q.a,"Map"),Jo=Zn(Object,"create"),Gy=function(){this.__data__=Jo?Jo(null):{},this.size=0},Ky=function(l){var t=this.has(l)&&delete this.__data__[l];return this.size-=t?1:0,t},Yy=Object.prototype.hasOwnProperty,Jy=function(l){var t=this.__data__;if(Jo){var n=t[l];return n==="__lodash_hash_undefined__"?void 0:n}return Yy.call(t,l)?t[l]:void 0},Qy=Object.prototype.hasOwnProperty,Xy=function(l){var t=this.__data__;return Jo?t[l]!==void 0:Qy.call(t,l)},Zy=function(l,t){var n=this.__data__;return this.size+=this.has(l)?0:1,n[l]=Jo&&t===void 0?"__lodash_hash_undefined__":t,this};function Wi(l){var t=-1,n=l==null?0:l.length;for(this.clear();++t<n;){var o=l[t];this.set(o[0],o[1])}}Wi.prototype.clear=Gy,Wi.prototype.delete=Ky,Wi.prototype.get=Jy,Wi.prototype.has=Xy,Wi.prototype.set=Zy;var wh=Wi,t0=function(){this.size=0,this.__data__={hash:new wh,map:new(Yo||Tr),string:new wh}},e0=function(l){var t=typeof l;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?l!=="__proto__":l===null},Sr=function(l,t){var n=l.__data__;return e0(t)?n[typeof t=="string"?"string":"hash"]:n.map},n0=function(l){var t=Sr(this,l).delete(l);return this.size-=t?1:0,t},i0=function(l){return Sr(this,l).get(l)},o0=function(l){return Sr(this,l).has(l)},s0=function(l,t){var n=Sr(this,l),o=n.size;return n.set(l,t),this.size+=n.size==o?0:1,this};function qi(l){var t=-1,n=l==null?0:l.length;for(this.clear();++t<n;){var o=l[t];this.set(o[0],o[1])}}qi.prototype.clear=t0,qi.prototype.delete=n0,qi.prototype.get=i0,qi.prototype.has=o0,qi.prototype.set=s0;var Pr=qi,r0=function(l,t){var n=this.__data__;if(n instanceof Tr){var o=n.__data__;if(!Yo||o.length<199)return o.push([l,t]),this.size=++n.size,this;n=this.__data__=new Pr(o)}return n.set(l,t),this.size=n.size,this};function Ui(l){var t=this.__data__=new Tr(l);this.size=t.size}Ui.prototype.clear=Hy,Ui.prototype.delete=Wy,Ui.prototype.get=qy,Ui.prototype.has=Uy,Ui.prototype.set=r0;var Qo=Ui,a0=function(l,t){for(var n=-1,o=l==null?0:l.length;++n<o&&t(l[n],n,l)!==!1;);return l},l0=ph(Object.keys,Object),c0=Object.prototype.hasOwnProperty,d0=function(l){if(!_l(l))return l0(l);var t=[];for(var n in Object(l))c0.call(l,n)&&n!="constructor"&&t.push(n);return t},yl=function(l){return yr(l)?lh(l):d0(l)},u0=function(l,t){return l&&Fi(t,yl(t),l)},h0=function(l,t){return l&&Fi(t,ji(t),l)},_h=d(9),kh=function(l,t){var n=-1,o=l.length;for(t||(t=Array(o));++n<o;)t[n]=l[n];return t},f0=function(l,t){for(var n=-1,o=l==null?0:l.length,r=0,c=[];++n<o;){var u=l[n];t(u,n,l)&&(c[r++]=u)}return c},vh=function(){return[]},g0=Object.prototype.propertyIsEnumerable,yh=Object.getOwnPropertySymbols,Al=yh?function(l){return l==null?[]:(l=Object(l),f0(yh(l),function(t){return g0.call(l,t)}))}:vh,m0=function(l,t){return Fi(l,Al(l),t)},Ah=function(l,t){for(var n=-1,o=t.length,r=l.length;++n<o;)l[r+n]=t[n];return l},Ch=Object.getOwnPropertySymbols?function(l){for(var t=[];l;)Ah(t,Al(l)),l=vl(l);return t}:vh,p0=function(l,t){return Fi(l,Ch(l),t)},xh=function(l,t,n){var o=t(l);return ce(l)?o:Ah(o,n(l))},Cl=function(l){return xh(l,yl,Al)},b0=function(l){return xh(l,ji,Ch)},xl=Zn(Q.a,"DataView"),El=Zn(Q.a,"Promise"),Tl=Zn(Q.a,"Set"),Sl=Zn(Q.a,"WeakMap"),w0=Xn(xl),_0=Xn(Yo),k0=Xn(El),v0=Xn(Tl),y0=Xn(Sl),ei=Nn;(xl&&ei(new xl(new ArrayBuffer(1)))!="[object DataView]"||Yo&&ei(new Yo)!="[object Map]"||El&&ei(El.resolve())!="[object Promise]"||Tl&&ei(new Tl)!="[object Set]"||Sl&&ei(new Sl)!="[object WeakMap]")&&(ei=function(l){var t=Nn(l),n=t=="[object Object]"?l.constructor:void 0,o=n?Xn(n):"";if(o)switch(o){case w0:return"[object DataView]";case _0:return"[object Map]";case k0:return"[object Promise]";case v0:return"[object Set]";case y0:return"[object WeakMap]"}return t});var Xo=ei,A0=Object.prototype.hasOwnProperty,C0=function(l){var t=l.length,n=new l.constructor(t);return t&&typeof l[0]=="string"&&A0.call(l,"index")&&(n.index=l.index,n.input=l.input),n},Ir=Q.a.Uint8Array,Pl=function(l){var t=new l.constructor(l.byteLength);return new Ir(t).set(new Ir(l)),t},x0=function(l,t){var n=t?Pl(l.buffer):l.buffer;return new l.constructor(n,l.byteOffset,l.byteLength)},E0=/\w*$/,T0=function(l){var t=new l.constructor(l.source,E0.exec(l));return t.lastIndex=l.lastIndex,t},Eh=B?B.prototype:void 0,Th=Eh?Eh.valueOf:void 0,S0=function(l){return Th?Object(Th.call(l)):{}},Sh=function(l,t){var n=t?Pl(l.buffer):l.buffer;return new l.constructor(n,l.byteOffset,l.length)},P0=function(l,t,n){var o=l.constructor;switch(t){case"[object ArrayBuffer]":return Pl(l);case"[object Boolean]":case"[object Date]":return new o(+l);case"[object DataView]":return x0(l,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Sh(l,n);case"[object Map]":return new o;case"[object Number]":case"[object String]":return new o(l);case"[object RegExp]":return T0(l);case"[object Set]":return new o;case"[object Symbol]":return S0(l)}},Ph=Object.create,I0=function(){function l(){}return function(t){if(!G(t))return{};if(Ph)return Ph(t);l.prototype=t;var n=new l;return l.prototype=void 0,n}}(),Ih=function(l){return typeof l.constructor!="function"||_l(l)?{}:I0(vl(l))},M0=function(l){return Se(l)&&Xo(l)=="[object Map]"},Mh=zi.a&&zi.a.isMap,R0=Mh?bl(Mh):M0,O0=function(l){return Se(l)&&Xo(l)=="[object Set]"},Rh=zi.a&&zi.a.isSet,N0=Rh?bl(Rh):O0,At={};At["[object Arguments]"]=At["[object Array]"]=At["[object ArrayBuffer]"]=At["[object DataView]"]=At["[object Boolean]"]=At["[object Date]"]=At["[object Float32Array]"]=At["[object Float64Array]"]=At["[object Int8Array]"]=At["[object Int16Array]"]=At["[object Int32Array]"]=At["[object Map]"]=At["[object Number]"]=At["[object Object]"]=At["[object RegExp]"]=At["[object Set]"]=At["[object String]"]=At["[object Symbol]"]=At["[object Uint8Array]"]=At["[object Uint8ClampedArray]"]=At["[object Uint16Array]"]=At["[object Uint32Array]"]=!0,At["[object Error]"]=At["[object Function]"]=At["[object WeakMap]"]=!1;var Il=function l(t,n,o,r,c,u){var g,m=1&n,p=2&n,w=4&n;if(o&&(g=c?o(t,r,c,u):o(t)),g!==void 0)return g;if(!G(t))return t;var _=ce(t);if(_){if(g=C0(t),!m)return kh(t,g)}else{var v=Xo(t),A=v=="[object Function]"||v=="[object GeneratorFunction]";if(Object(Go.a)(t))return Object(_h.a)(t,m);if(v=="[object Object]"||v=="[object Arguments]"||A&&!c){if(g=p||A?{}:Ih(t),!m)return p?p0(t,h0(g,t)):m0(t,u0(g,t))}else{if(!At[v])return c?t:{};g=P0(t,v,m)}}u||(u=new Qo);var x=u.get(t);if(x)return x;u.set(t,g),N0(t)?t.forEach(function(T){g.add(l(T,n,o,T,t,u))}):R0(t)&&t.forEach(function(T,S){g.set(S,l(T,n,o,S,t,u))});var E=_?void 0:(w?p?b0:Cl:p?ji:yl)(t);return a0(E||t,function(T,S){E&&(T=t[S=T]),gl(g,S,l(T,n,o,S,t,u))}),g},Oh=function(l,t){return Il(l,5,t=typeof t=="function"?t:void 0)},Dn=function(l){return Se(l)&&l.nodeType===1&&!Pe(l)};class Nh{constructor(t,n){this._config={},n&&this.define(Dh(n)),t&&this._setObjectToTarget(this._config,t)}set(t,n){this._setToTarget(this._config,t,n)}define(t,n){this._setToTarget(this._config,t,n,!0)}get(t){return this._getFromSource(this._config,t)}*names(){for(const t of Object.keys(this._config))yield t}_setToTarget(t,n,o,r=!1){if(Pe(n))return void this._setObjectToTarget(t,n,r);const c=n.split(".");n=c.pop();for(const u of c)Pe(t[u])||(t[u]={}),t=t[u];if(Pe(o))return Pe(t[n])||(t[n]={}),t=t[n],void this._setObjectToTarget(t,o,r);r&&t[n]!==void 0||(t[n]=o)}_getFromSource(t,n){const o=n.split(".");n=o.pop();for(const r of o){if(!Pe(t[r])){t=null;break}t=t[r]}return t?Dh(t[n]):void 0}_setObjectToTarget(t,n,o){Object.keys(n).forEach(r=>{this._setToTarget(t,r,n[r],o)})}}function Dh(l){return Oh(l,D0)}function D0(l){return Dn(l)?l:void 0}function Ie(l){return!(!l||!l[Symbol.iterator])}class Me{constructor(t={},n={}){const o=Ie(t);if(o||(n=t),this._items=[],this._itemMap=new Map,this._idProperty=n.idProperty||"id",this._bindToExternalToInternalMap=new WeakMap,this._bindToInternalToExternalMap=new WeakMap,this._skippedIndexesFromExternal=[],o)for(const r of t)this._items.push(r),this._itemMap.set(this._getItemIdBeforeAdding(r),r)}get length(){return this._items.length}get first(){return this._items[0]||null}get last(){return this._items[this.length-1]||null}add(t,n){return this.addMany([t],n)}addMany(t,n){if(n===void 0)n=this._items.length;else if(n>this._items.length||n<0)throw new y.a("collection-add-item-invalid-index",this);for(let o=0;o<t.length;o++){const r=t[o],c=this._getItemIdBeforeAdding(r),u=n+o;this._items.splice(u,0,r),this._itemMap.set(c,r),this.fire("add",r,u)}return this.fire("change",{added:t,removed:[],index:n}),this}get(t){let n;if(typeof t=="string")n=this._itemMap.get(t);else{if(typeof t!="number")throw new y.a("collection-get-invalid-arg",this);n=this._items[t]}return n||null}has(t){if(typeof t=="string")return this._itemMap.has(t);{const n=t[this._idProperty];return this._itemMap.has(n)}}getIndex(t){let n;return n=typeof t=="string"?this._itemMap.get(t):t,this._items.indexOf(n)}remove(t){const[n,o]=this._remove(t);return this.fire("change",{added:[],removed:[n],index:o}),n}map(t,n){return this._items.map(t,n)}find(t,n){return this._items.find(t,n)}filter(t,n){return this._items.filter(t,n)}clear(){this._bindToCollection&&(this.stopListening(this._bindToCollection),this._bindToCollection=null);const t=Array.from(this._items);for(;this.length;)this._remove(0);this.fire("change",{added:[],removed:t,index:0})}bindTo(t){if(this._bindToCollection)throw new y.a("collection-bind-to-rebind",this);return this._bindToCollection=t,{as:n=>{this._setUpBindToBinding(o=>new n(o))},using:n=>{typeof n=="function"?this._setUpBindToBinding(o=>n(o)):this._setUpBindToBinding(o=>o[n])}}}_setUpBindToBinding(t){const n=this._bindToCollection,o=(r,c,u)=>{const g=n._bindToCollection==this,m=n._bindToInternalToExternalMap.get(c);if(g&&m)this._bindToExternalToInternalMap.set(c,m),this._bindToInternalToExternalMap.set(m,c);else{const p=t(c);if(!p)return void this._skippedIndexesFromExternal.push(u);let w=u;for(const _ of this._skippedIndexesFromExternal)u>_&&w--;for(const _ of n._skippedIndexesFromExternal)w>=_&&w++;this._bindToExternalToInternalMap.set(c,p),this._bindToInternalToExternalMap.set(p,c),this.add(p,w);for(let _=0;_<n._skippedIndexesFromExternal.length;_++)w<=n._skippedIndexesFromExternal[_]&&n._skippedIndexesFromExternal[_]++}};for(const r of n)o(0,r,n.getIndex(r));this.listenTo(n,"add",o),this.listenTo(n,"remove",(r,c,u)=>{const g=this._bindToExternalToInternalMap.get(c);g&&this.remove(g),this._skippedIndexesFromExternal=this._skippedIndexesFromExternal.reduce((m,p)=>(u<p&&m.push(p-1),u>p&&m.push(p),m),[])})}_getItemIdBeforeAdding(t){const n=this._idProperty;let o;if(n in t){if(o=t[n],typeof o!="string")throw new y.a("collection-add-invalid-id",this);if(this.get(o))throw new y.a("collection-add-item-already-exists",this)}else t[n]=o=k();return o}_remove(t){let n,o,r,c=!1;const u=this._idProperty;if(typeof t=="string"?(o=t,r=this._itemMap.get(o),c=!r,r&&(n=this._items.indexOf(r))):typeof t=="number"?(n=t,r=this._items[n],c=!r,r&&(o=r[u])):(r=t,o=r[u],n=this._items.indexOf(r),c=n==-1||!this._itemMap.get(o)),c)throw new y.a("collection-remove-404",this);this._items.splice(n,1),this._itemMap.delete(o);const g=this._bindToInternalToExternalMap.get(r);return this._bindToInternalToExternalMap.delete(r),this._bindToExternalToInternalMap.delete(g),this.fire("remove",r,n),[r,n]}[Symbol.iterator](){return this._items[Symbol.iterator]()}}tt(Me,D);class Ml{constructor(t,n=[],o=[]){this._context=t,this._plugins=new Map,this._availablePlugins=new Map;for(const r of n)r.pluginName&&this._availablePlugins.set(r.pluginName,r);this._contextPlugins=new Map;for(const[r,c]of o)this._contextPlugins.set(r,c),this._contextPlugins.set(c,r),r.pluginName&&this._availablePlugins.set(r.pluginName,r)}*[Symbol.iterator](){for(const t of this._plugins)typeof t[0]=="function"&&(yield t)}get(t){const n=this._plugins.get(t);if(!n){let o=t;throw typeof t=="function"&&(o=t.pluginName||t.name),new y.a("plugincollection-plugin-not-loaded",this._context,{plugin:o})}return n}has(t){return this._plugins.has(t)}init(t,n=[],o=[]){const r=this,c=this._context;(function x(E,T=new Set){E.forEach(S=>{m(S)&&(T.has(S)||(T.add(S),S.pluginName&&!r._availablePlugins.has(S.pluginName)&&r._availablePlugins.set(S.pluginName,S),S.requires&&x(S.requires,T)))})})(t),v(t);const u=[...function x(E,T=new Set){return E.map(S=>m(S)?S:r._availablePlugins.get(S)).reduce((S,I)=>T.has(I)?S:(T.add(I),I.requires&&(v(I.requires,I),x(I.requires,T).forEach(N=>S.add(N))),S.add(I)),new Set)}(t.filter(x=>!w(x,n)))];(function(x,E){for(const T of E){if(typeof T!="function")throw new y.a("plugincollection-replace-plugin-invalid-type",null,{pluginItem:T});const S=T.pluginName;if(!S)throw new y.a("plugincollection-replace-plugin-missing-name",null,{pluginItem:T});if(T.requires&&T.requires.length)throw new y.a("plugincollection-plugin-for-replacing-cannot-have-dependencies",null,{pluginName:S});const I=r._availablePlugins.get(S);if(!I)throw new y.a("plugincollection-plugin-for-replacing-not-exist",null,{pluginName:S});const N=x.indexOf(I);if(N===-1){if(r._contextPlugins.has(I))return;throw new y.a("plugincollection-plugin-for-replacing-not-loaded",null,{pluginName:S})}if(I.requires&&I.requires.length)throw new y.a("plugincollection-replaced-plugin-cannot-have-dependencies",null,{pluginName:S});x.splice(N,1,T),r._availablePlugins.set(S,T)}})(u,o);const g=function(x){return x.map(E=>{const T=r._contextPlugins.get(E)||new E(c);return r._add(E,T),T})}(u);return A(g,"init").then(()=>A(g,"afterInit")).then(()=>g);function m(x){return typeof x=="function"}function p(x){return m(x)&&x.isContextPlugin}function w(x,E){return E.some(T=>T===x||_(x)===T||_(T)===x)}function _(x){return m(x)?x.pluginName||x.name:x}function v(x,E=null){x.map(T=>m(T)?T:r._availablePlugins.get(T)||T).forEach(T=>{(function(S,I){if(!m(S))throw I?new y.a("plugincollection-soft-required",c,{missingPlugin:S,requiredBy:_(I)}):new y.a("plugincollection-plugin-not-found",c,{plugin:S})})(T,E),function(S,I){if(p(I)&&!p(S))throw new y.a("plugincollection-context-required",c,{plugin:_(S),requiredBy:_(I)})}(T,E),function(S,I){if(I&&w(S,n))throw new y.a("plugincollection-required",c,{plugin:_(S),requiredBy:_(I)})}(T,E)})}function A(x,E){return x.reduce((T,S)=>S[E]?r._contextPlugins.has(S)?T:T.then(S[E].bind(S)):T,Promise.resolve())}}destroy(){const t=[];for(const[,n]of this)typeof n.destroy!="function"||this._contextPlugins.has(n)||t.push(n.destroy());return Promise.all(t)}_add(t,n){this._plugins.set(t,n);const o=t.pluginName;if(o){if(this._plugins.has(o))throw new y.a("plugincollection-plugin-name-conflict",null,{pluginName:o,plugin1:this._plugins.get(o).constructor,plugin2:t});this._plugins.set(o,n)}}}function Kt(l){return Array.isArray(l)?l:[l]}function L0(l,t,n=1){if(typeof n!="number")throw new y.a("translation-service-quantity-not-a-number",null,{quantity:n});const o=Object.keys(window.CKEDITOR_TRANSLATIONS).length;o===1&&(l=Object.keys(window.CKEDITOR_TRANSLATIONS)[0]);const r=t.id||t.string;if(o===0||!function(m,p){return!!window.CKEDITOR_TRANSLATIONS[m]&&!!window.CKEDITOR_TRANSLATIONS[m].dictionary[p]}(l,r))return n!==1?t.plural:t.string;const c=window.CKEDITOR_TRANSLATIONS[l].dictionary,u=window.CKEDITOR_TRANSLATIONS[l].getPluralForm||(m=>m===1?0:1);if(typeof c[r]=="string")return c[r];const g=Number(u(n));return c[r][g]}tt(Ml,D),window.CKEDITOR_TRANSLATIONS||(window.CKEDITOR_TRANSLATIONS={});const V0=["ar","ara","fa","per","fas","he","heb","ku","kur","ug","uig"];function Lh(l){return V0.includes(l)?"rtl":"ltr"}class B0{constructor(t={}){this.uiLanguage=t.uiLanguage||"en",this.contentLanguage=t.contentLanguage||this.uiLanguage,this.uiLanguageDirection=Lh(this.uiLanguage),this.contentLanguageDirection=Lh(this.contentLanguage),this.t=(n,o)=>this._t(n,o)}get language(){return console.warn("locale-deprecated-language-property: The Locale#language property has been deprecated and will be removed in the near future. Please use #uiLanguage and #contentLanguage properties instead."),this.uiLanguage}_t(t,n=[]){n=Kt(n),typeof t=="string"&&(t={string:t});const o=t.plural?n[0]:1;return function(r,c){return r.replace(/%(\d+)/g,(u,g)=>g<c.length?c[g]:u)}(L0(this.uiLanguage,t,o),n)}}class F0{constructor(t){this.config=new Nh(t,this.constructor.defaultConfig);const n=this.constructor.builtinPlugins;this.config.define("plugins",n),this.plugins=new Ml(this,n);const o=this.config.get("language")||{};this.locale=new B0({uiLanguage:typeof o=="string"?o:o.ui,contentLanguage:this.config.get("language.content")}),this.t=this.locale.t,this.editors=new Me,this._contextOwner=null}initPlugins(){const t=this.config.get("plugins")||[],n=this.config.get("substitutePlugins")||[];for(const o of t.concat(n)){if(typeof o!="function")throw new y.a("context-initplugins-constructor-only",null,{Plugin:o});if(o.isContextPlugin!==!0)throw new y.a("context-initplugins-invalid-plugin",null,{Plugin:o})}return this.plugins.init(t,[],n)}destroy(){return Promise.all(Array.from(this.editors,t=>t.destroy())).then(()=>this.plugins.destroy())}_addEditor(t,n){if(this._contextOwner)throw new y.a("context-addeditor-private-context");this.editors.add(t),n&&(this._contextOwner=t)}_removeEditor(t){return this.editors.has(t)&&this.editors.remove(t),this._contextOwner===t?this.destroy():Promise.resolve()}_getEditorConfig(){const t={};for(const n of this.config.names())["plugins","removePlugins","extraPlugins"].includes(n)||(t[n]=this.config.get(n));return t}static create(t){return new Promise(n=>{const o=new this(t);n(o.initPlugins().then(()=>o))})}}class Zo{constructor(t){this.context=t}destroy(){this.stopListening()}static get isContextPlugin(){return!0}}function se(l,t){const n=Math.min(l.length,t.length);for(let o=0;o<n;o++)if(l[o]!=t[o])return o;return l.length==t.length?"same":l.length<t.length?"prefix":"extension"}tt(Zo,yt);var Vh=function(l){return Il(l,4)};class ni{constructor(t){this.document=t,this.parent=null}get index(){let t;if(!this.parent)return null;if((t=this.parent.getChildIndex(this))==-1)throw new y.a("view-node-not-found-in-parent",this);return t}get nextSibling(){const t=this.index;return t!==null&&this.parent.getChild(t+1)||null}get previousSibling(){const t=this.index;return t!==null&&this.parent.getChild(t-1)||null}get root(){let t=this;for(;t.parent;)t=t.parent;return t}isAttached(){return this.root.is("rootElement")}getPath(){const t=[];let n=this;for(;n.parent;)t.unshift(n.index),n=n.parent;return t}getAncestors(t={includeSelf:!1,parentFirst:!1}){const n=[];let o=t.includeSelf?this:this.parent;for(;o;)n[t.parentFirst?"push":"unshift"](o),o=o.parent;return n}getCommonAncestor(t,n={}){const o=this.getAncestors(n),r=t.getAncestors(n);let c=0;for(;o[c]==r[c]&&o[c];)c++;return c===0?null:o[c-1]}isBefore(t){if(this==t||this.root!==t.root)return!1;const n=this.getPath(),o=t.getPath(),r=se(n,o);switch(r){case"prefix":return!0;case"extension":return!1;default:return n[r]<o[r]}}isAfter(t){return this!=t&&this.root===t.root&&!this.isBefore(t)}_remove(){this.parent._removeChildren(this.index)}_fireChange(t,n){this.fire("change:"+t,n),this.parent&&this.parent._fireChange(t,n)}toJSON(){const t=Vh(this);return delete t.parent,t}is(t){return t==="node"||t==="view:node"}}tt(ni,D);class _t extends ni{constructor(t,n){super(t),this._textData=n}is(t){return t==="$text"||t==="view:$text"||t==="text"||t==="view:text"||t==="node"||t==="view:node"}get data(){return this._textData}get _data(){return this.data}set _data(t){this._fireChange("text",this),this._textData=t}isSimilar(t){return t instanceof _t&&(this===t||this.data===t.data)}_clone(){return new _t(this.document,this.data)}}class pn{constructor(t,n,o){if(this.textNode=t,n<0||n>t.data.length)throw new y.a("view-textproxy-wrong-offsetintext",this);if(o<0||n+o>t.data.length)throw new y.a("view-textproxy-wrong-length",this);this.data=t.data.substring(n,n+o),this.offsetInText=n}get offsetSize(){return this.data.length}get isPartial(){return this.data.length!==this.textNode.data.length}get parent(){return this.textNode.parent}get root(){return this.textNode.root}get document(){return this.textNode.document}is(t){return t==="$textProxy"||t==="view:$textProxy"||t==="textProxy"||t==="view:textProxy"}getAncestors(t={includeSelf:!1,parentFirst:!1}){const n=[];let o=t.includeSelf?this.textNode:this.parent;for(;o!==null;)n[t.parentFirst?"push":"unshift"](o),o=o.parent;return n}}function bn(l){return Ie(l)?new Map(l):function(t){const n=new Map;for(const o in t)n.set(o,t[o]);return n}(l)}class tn{constructor(...t){this._patterns=[],this.add(...t)}add(...t){for(let n of t)(typeof n=="string"||n instanceof RegExp)&&(n={name:n}),this._patterns.push(n)}match(...t){for(const n of t)for(const o of this._patterns){const r=Bh(n,o);if(r)return{element:n,pattern:o,match:r}}return null}matchAll(...t){const n=[];for(const o of t)for(const r of this._patterns){const c=Bh(o,r);c&&n.push({element:o,pattern:r,match:c})}return n.length>0?n:null}getElementName(){if(this._patterns.length!==1)return null;const t=this._patterns[0],n=t.name;return typeof t=="function"||!n||n instanceof RegExp?null:n}}function Bh(l,t){if(typeof t=="function")return t(l);const n={};return t.name&&(n.name=function(o,r){return o instanceof RegExp?!!r.match(o):o===r}(t.name,l.name),!n.name)||t.attributes&&(n.attributes=function(o,r){const c=new Set(r.getAttributeKeys());return Pe(o)?(o.style!==void 0&&Object(y.b)("matcher-pattern-deprecated-attributes-style-key",o),o.class!==void 0&&Object(y.b)("matcher-pattern-deprecated-attributes-class-key",o)):(c.delete("style"),c.delete("class")),Rl(o,c,u=>r.getAttribute(u))}(t.attributes,l),!n.attributes)?null:!(t.classes&&(n.classes=function(o,r){return Rl(o,r.getClassNames())}(t.classes,l),!n.classes))&&!(t.styles&&(n.styles=function(o,r){return Rl(o,r.getStyleNames(!0),c=>r.getStyle(c))}(t.styles,l),!n.styles))&&n}function Rl(l,t,n){const o=function(u){return Array.isArray(u)?u.map(g=>Pe(g)?(g.key!==void 0&&g.value!==void 0||Object(y.b)("matcher-pattern-missing-key-or-value",g),[g.key,g.value]):[g,!0]):Pe(u)?Object.entries(u):[[u,!0]]}(l),r=Array.from(t),c=[];return o.forEach(([u,g])=>{r.forEach(m=>{(function(p,w){return p===!0||p===w||p instanceof RegExp&&w.match(p)})(u,m)&&function(p,w,_){if(p===!0)return!0;const v=_(w);return p===v||p instanceof RegExp&&!!String(v).match(p)}(g,m,n)&&c.push(m)})}),!o.length||c.length<o.length?null:c}var Mr=function(l){return typeof l=="symbol"||Se(l)&&Nn(l)=="[object Symbol]"},z0=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,j0=/^\w*$/,$0=function(l,t){if(ce(l))return!1;var n=typeof l;return!(n!="number"&&n!="symbol"&&n!="boolean"&&l!=null&&!Mr(l))||j0.test(l)||!z0.test(l)||t!=null&&l in Object(t)};function Ol(l,t){if(typeof l!="function"||t!=null&&typeof t!="function")throw new TypeError("Expected a function");var n=function(){var o=arguments,r=t?t.apply(this,o):o[0],c=n.cache;if(c.has(r))return c.get(r);var u=l.apply(this,o);return n.cache=c.set(r,u)||c,u};return n.cache=new(Ol.Cache||Pr),n}Ol.Cache=Pr;var H0=Ol,W0=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,q0=/\\(\\)?/g,U0=function(l){var t=H0(l,function(o){return n.size===500&&n.clear(),o}),n=t.cache;return t}(function(l){var t=[];return l.charCodeAt(0)===46&&t.push(""),l.replace(W0,function(n,o,r,c){t.push(r?c.replace(q0,"$1"):o||n)}),t}),G0=function(l,t){for(var n=-1,o=l==null?0:l.length,r=Array(o);++n<o;)r[n]=t(l[n],n,l);return r},Fh=B?B.prototype:void 0,zh=Fh?Fh.toString:void 0,K0=function l(t){if(typeof t=="string")return t;if(ce(t))return G0(t,l)+"";if(Mr(t))return zh?zh.call(t):"";var n=t+"";return n=="0"&&1/t==-1/0?"-0":n},Nl=function(l){return l==null?"":K0(l)},Dl=function(l,t){return ce(l)?l:$0(l,t)?[l]:U0(Nl(l))},Y0=function(l){var t=l==null?0:l.length;return t?l[t-1]:void 0},Ll=function(l){if(typeof l=="string"||Mr(l))return l;var t=l+"";return t=="0"&&1/l==-1/0?"-0":t},jh=function(l,t){for(var n=0,o=(t=Dl(t,l)).length;l!=null&&n<o;)l=l[Ll(t[n++])];return n&&n==o?l:void 0},$h=function(l,t,n){var o=-1,r=l.length;t<0&&(t=-t>r?0:r+t),(n=n>r?r:n)<0&&(n+=r),r=t>n?0:n-t>>>0,t>>>=0;for(var c=Array(r);++o<r;)c[o]=l[o+t];return c},J0=function(l,t){return t.length<2?l:jh(l,$h(t,0,-1))},Q0=function(l,t){return t=Dl(t,l),(l=J0(l,t))==null||delete l[Ll(Y0(t))]},X0=function(l,t){return l==null||Q0(l,t)},Rr=function(l,t,n){var o=l==null?void 0:jh(l,t);return o===void 0?n:o},Vl=function(l,t,n){(n!==void 0&&!Uo(l[t],n)||n===void 0&&!(t in l))&&fl(l,t,n)},Z0=function(l){return function(t,n,o){for(var r=-1,c=Object(t),u=o(t),g=u.length;g--;){var m=u[l?g:++r];if(n(c[m],m,c)===!1)break}return t}}(),t1=function(l){return Se(l)&&yr(l)},Bl=function(l,t){if((t!=="constructor"||typeof l[t]!="function")&&t!="__proto__")return l[t]},e1=function(l){return Fi(l,ji(l))},n1=function(l,t,n,o,r,c,u){var g=Bl(l,n),m=Bl(t,n),p=u.get(m);if(p)Vl(l,n,p);else{var w=c?c(g,m,n+"",l,t,u):void 0,_=w===void 0;if(_){var v=ce(m),A=!v&&Object(Go.a)(m),x=!v&&!A&&wl(m);w=m,v||A||x?ce(g)?w=g:t1(g)?w=kh(g):A?(_=!1,w=Object(_h.a)(m,!0)):x?(_=!1,w=Sh(m,!0)):w=[]:Pe(m)||pl(m)?(w=g,pl(g)?w=e1(g):G(g)&&!Qn(g)||(w=Ih(m))):_=!1}_&&(u.set(m,w),r(w,m,o,c,u),u.delete(m)),Vl(l,n,w)}},i1=function l(t,n,o,r,c){t!==n&&Z0(n,function(u,g){if(c||(c=new Qo),G(u))n1(t,n,g,o,l,r,c);else{var m=r?r(Bl(t,g),u,g+"",t,n,c):void 0;m===void 0&&(m=u),Vl(t,g,m)}},ji)},Hh=oh(function(l,t,n){i1(l,t,n)}),o1=function(l,t,n,o){if(!G(l))return l;for(var r=-1,c=(t=Dl(t,l)).length,u=c-1,g=l;g!=null&&++r<c;){var m=Ll(t[r]),p=n;if(m==="__proto__"||m==="constructor"||m==="prototype")return l;if(r!=u){var w=g[m];(p=o?o(w,m,g):void 0)===void 0&&(p=G(w)?w:ml(t[r+1])?[]:{})}gl(g,m,p),g=g[m]}return l},s1=function(l,t,n){return l==null?l:o1(l,t,n)};class r1{constructor(t){this._styles={},this._styleProcessor=t}get isEmpty(){const t=Object.entries(this._styles);return!Array.from(t).length}get size(){return this.isEmpty?0:this.getStyleNames().length}setTo(t){this.clear();const n=Array.from(function(o){let r=null,c=0,u=0,g=null;const m=new Map;if(o==="")return m;o.charAt(o.length-1)!=";"&&(o+=";");for(let p=0;p<o.length;p++){const w=o.charAt(p);if(r===null)switch(w){case":":g||(g=o.substr(c,p-c),u=p+1);break;case'"':case"'":r=w;break;case";":{const _=o.substr(u,p-u);g&&m.set(g.trim(),_.trim()),g=null,c=p+1;break}}else w===r&&(r=null)}return m}(t).entries());for(const[o,r]of n)this._styleProcessor.toNormalizedForm(o,r,this._styles)}has(t){if(this.isEmpty)return!1;const n=this._styleProcessor.getReducedForm(t,this._styles).find(([o])=>o===t);return Array.isArray(n)}set(t,n){if(G(t))for(const[o,r]of Object.entries(t))this._styleProcessor.toNormalizedForm(o,r,this._styles);else this._styleProcessor.toNormalizedForm(t,n,this._styles)}remove(t){const n=Fl(t);X0(this._styles,n),delete this._styles[t],this._cleanEmptyObjectsOnPath(n)}getNormalized(t){return this._styleProcessor.getNormalized(t,this._styles)}toString(){return this.isEmpty?"":this._getStylesEntries().map(t=>t.join(":")).sort().join(";")+";"}getAsString(t){if(this.isEmpty)return;if(this._styles[t]&&!G(this._styles[t]))return this._styles[t];const n=this._styleProcessor.getReducedForm(t,this._styles).find(([o])=>o===t);return Array.isArray(n)?n[1]:void 0}getStyleNames(t=!1){return this.isEmpty?[]:t?this._styleProcessor.getStyleNames(this._styles):this._getStylesEntries().map(([n])=>n)}clear(){this._styles={}}_getStylesEntries(){const t=[],n=Object.keys(this._styles);for(const o of n)t.push(...this._styleProcessor.getReducedForm(o,this._styles));return t}_cleanEmptyObjectsOnPath(t){const n=t.split(".");if(!(n.length>1))return;const o=n.splice(0,n.length-1).join("."),r=Rr(this._styles,o);r&&!Array.from(Object.keys(r)).length&&this.remove(o)}}class a1{constructor(){this._normalizers=new Map,this._extractors=new Map,this._reducers=new Map,this._consumables=new Map}toNormalizedForm(t,n,o){if(G(n))zl(o,Fl(t),n);else if(this._normalizers.has(t)){const r=this._normalizers.get(t),{path:c,value:u}=r(n);zl(o,c,u)}else zl(o,t,n)}getNormalized(t,n){if(!t)return Hh({},n);if(n[t]!==void 0)return n[t];if(this._extractors.has(t)){const o=this._extractors.get(t);if(typeof o=="string")return Rr(n,o);const r=o(t,n);if(r)return r}return Rr(n,Fl(t))}getReducedForm(t,n){const o=this.getNormalized(t,n);return o===void 0?[]:this._reducers.has(t)?this._reducers.get(t)(o):[[t,o]]}getStyleNames(t){const n=Array.from(this._consumables.keys()).filter(r=>{const c=this.getNormalized(r,t);return c&&typeof c=="object"?Object.keys(c).length:c}),o=new Set([...n,...Object.keys(t)]);return Array.from(o.values())}getRelatedStyles(t){return this._consumables.get(t)||[]}setNormalizer(t,n){this._normalizers.set(t,n)}setExtractor(t,n){this._extractors.set(t,n)}setReducer(t,n){this._reducers.set(t,n)}setStyleRelation(t,n){this._mapStyleNames(t,n);for(const o of n)this._mapStyleNames(o,[t])}_mapStyleNames(t,n){this._consumables.has(t)||this._consumables.set(t,[]),this._consumables.get(t).push(...n)}}function Fl(l){return l.replace("-",".")}function zl(l,t,n){let o=n;G(n)&&(o=Hh({},Rr(l,t),n)),s1(l,t,o)}class Re extends ni{constructor(t,n,o,r){if(super(t),this.name=n,this._attrs=function(c){c=bn(c);for(const[u,g]of c)g===null?c.delete(u):typeof g!="string"&&c.set(u,String(g));return c}(o),this._children=[],r&&this._insertChild(0,r),this._classes=new Set,this._attrs.has("class")){const c=this._attrs.get("class");Wh(this._classes,c),this._attrs.delete("class")}this._styles=new r1(this.document.stylesProcessor),this._attrs.has("style")&&(this._styles.setTo(this._attrs.get("style")),this._attrs.delete("style")),this._customProperties=new Map,this._isAllowedInsideAttributeElement=!1,this._unsafeAttributesToRender=[]}get childCount(){return this._children.length}get isEmpty(){return this._children.length===0}get isAllowedInsideAttributeElement(){return this._isAllowedInsideAttributeElement}is(t,n=null){return n?n===this.name&&(t==="element"||t==="view:element"):t==="element"||t==="view:element"||t==="node"||t==="view:node"}getChild(t){return this._children[t]}getChildIndex(t){return this._children.indexOf(t)}getChildren(){return this._children[Symbol.iterator]()}*getAttributeKeys(){this._classes.size>0&&(yield"class"),this._styles.isEmpty||(yield"style"),yield*this._attrs.keys()}*getAttributes(){yield*this._attrs.entries(),this._classes.size>0&&(yield["class",this.getAttribute("class")]),this._styles.isEmpty||(yield["style",this.getAttribute("style")])}getAttribute(t){if(t=="class")return this._classes.size>0?[...this._classes].join(" "):void 0;if(t=="style"){const n=this._styles.toString();return n==""?void 0:n}return this._attrs.get(t)}hasAttribute(t){return t=="class"?this._classes.size>0:t=="style"?!this._styles.isEmpty:this._attrs.has(t)}isSimilar(t){if(!(t instanceof Re))return!1;if(this===t)return!0;if(this.name!=t.name||this.isAllowedInsideAttributeElement!=t.isAllowedInsideAttributeElement||this._attrs.size!==t._attrs.size||this._classes.size!==t._classes.size||this._styles.size!==t._styles.size)return!1;for(const[n,o]of this._attrs)if(!t._attrs.has(n)||t._attrs.get(n)!==o)return!1;for(const n of this._classes)if(!t._classes.has(n))return!1;for(const n of this._styles.getStyleNames())if(!t._styles.has(n)||t._styles.getAsString(n)!==this._styles.getAsString(n))return!1;return!0}hasClass(...t){for(const n of t)if(!this._classes.has(n))return!1;return!0}getClassNames(){return this._classes.keys()}getStyle(t){return this._styles.getAsString(t)}getNormalizedStyle(t){return this._styles.getNormalized(t)}getStyleNames(t=!1){return this._styles.getStyleNames(t)}hasStyle(...t){for(const n of t)if(!this._styles.has(n))return!1;return!0}findAncestor(...t){const n=new tn(...t);let o=this.parent;for(;o;){if(n.match(o))return o;o=o.parent}return null}getCustomProperty(t){return this._customProperties.get(t)}*getCustomProperties(){yield*this._customProperties.entries()}getIdentity(){const t=Array.from(this._classes).sort().join(","),n=this._styles.toString(),o=Array.from(this._attrs).map(r=>`${r[0]}="${r[1]}"`).sort().join(" ");return this.name+(t==""?"":` class="${t}"`)+(n?` style="${n}"`:"")+(o==""?"":" "+o)}shouldRenderUnsafeAttribute(t){return this._unsafeAttributesToRender.includes(t)}_clone(t=!1){const n=[];if(t)for(const r of this.getChildren())n.push(r._clone(t));const o=new this.constructor(this.document,this.name,this._attrs,n);return o._classes=new Set(this._classes),o._styles.set(this._styles.getNormalized()),o._customProperties=new Map(this._customProperties),o.getFillerOffset=this.getFillerOffset,o._isAllowedInsideAttributeElement=this.isAllowedInsideAttributeElement,o}_appendChild(t){return this._insertChild(this.childCount,t)}_insertChild(t,n){this._fireChange("children",this);let o=0;const r=function(c,u){return typeof u=="string"?[new _t(c,u)]:(Ie(u)||(u=[u]),Array.from(u).map(g=>typeof g=="string"?new _t(c,g):g instanceof pn?new _t(c,g.data):g))}(this.document,n);for(const c of r)c.parent!==null&&c._remove(),c.parent=this,c.document=this.document,this._children.splice(t,0,c),t++,o++;return o}_removeChildren(t,n=1){this._fireChange("children",this);for(let o=t;o<t+n;o++)this._children[o].parent=null;return this._children.splice(t,n)}_setAttribute(t,n){n=String(n),this._fireChange("attributes",this),t=="class"?Wh(this._classes,n):t=="style"?this._styles.setTo(n):this._attrs.set(t,n)}_removeAttribute(t){return this._fireChange("attributes",this),t=="class"?this._classes.size>0&&(this._classes.clear(),!0):t=="style"?!this._styles.isEmpty&&(this._styles.clear(),!0):this._attrs.delete(t)}_addClass(t){this._fireChange("attributes",this);for(const n of Kt(t))this._classes.add(n)}_removeClass(t){this._fireChange("attributes",this);for(const n of Kt(t))this._classes.delete(n)}_setStyle(t,n){this._fireChange("attributes",this),this._styles.set(t,n)}_removeStyle(t){this._fireChange("attributes",this);for(const n of Kt(t))this._styles.remove(n)}_setCustomProperty(t,n){this._customProperties.set(t,n)}_removeCustomProperty(t){return this._customProperties.delete(t)}}function Wh(l,t){const n=t.split(/\s+/);l.clear(),n.forEach(o=>l.add(o))}class Or extends Re{constructor(t,n,o,r){super(t,n,o,r),this.getFillerOffset=qh}is(t,n=null){return n?n===this.name&&(t==="containerElement"||t==="view:containerElement"||t==="element"||t==="view:element"):t==="containerElement"||t==="view:containerElement"||t==="element"||t==="view:element"||t==="node"||t==="view:node"}}function qh(){const l=[...this.getChildren()],t=l[this.childCount-1];if(t&&t.is("element","br"))return this.childCount;for(const n of l)if(!n.is("uiElement"))return null;return this.childCount}class Nr extends Or{constructor(t,n,o,r){super(t,n,o,r),this.set("isReadOnly",!1),this.set("isFocused",!1),this.bind("isReadOnly").to(t),this.bind("isFocused").to(t,"isFocused",c=>c&&t.selection.editableElement==this),this.listenTo(t.selection,"change",()=>{this.isFocused=t.isFocused&&t.selection.editableElement==this})}is(t,n=null){return n?n===this.name&&(t==="editableElement"||t==="view:editableElement"||t==="containerElement"||t==="view:containerElement"||t==="element"||t==="view:element"):t==="editableElement"||t==="view:editableElement"||t==="containerElement"||t==="view:containerElement"||t==="element"||t==="view:element"||t==="node"||t==="view:node"}destroy(){this.stopListening()}}tt(Nr,yt);const Uh=Symbol("rootName");class l1 extends Nr{constructor(t,n){super(t,n),this.rootName="main"}is(t,n=null){return n?n===this.name&&(t==="rootElement"||t==="view:rootElement"||t==="editableElement"||t==="view:editableElement"||t==="containerElement"||t==="view:containerElement"||t==="element"||t==="view:element"):t==="rootElement"||t==="view:rootElement"||t==="editableElement"||t==="view:editableElement"||t==="containerElement"||t==="view:containerElement"||t==="element"||t==="view:element"||t==="node"||t==="view:node"}get rootName(){return this.getCustomProperty(Uh)}set rootName(t){this._setCustomProperty(Uh,t)}set _name(t){this.name=t}}class ii{constructor(t={}){if(!t.boundaries&&!t.startPosition)throw new y.a("view-tree-walker-no-start-position",null);if(t.direction&&t.direction!="forward"&&t.direction!="backward")throw new y.a("view-tree-walker-unknown-direction",t.startPosition,{direction:t.direction});this.boundaries=t.boundaries||null,t.startPosition?this.position=H._createAt(t.startPosition):this.position=H._createAt(t.boundaries[t.direction=="backward"?"end":"start"]),this.direction=t.direction||"forward",this.singleCharacters=!!t.singleCharacters,this.shallow=!!t.shallow,this.ignoreElementEnd=!!t.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null}[Symbol.iterator](){return this}skip(t){let n,o,r;do r=this.position,{done:n,value:o}=this.next();while(!n&&t(o));n||(this.position=r)}next(){return this.direction=="forward"?this._next():this._previous()}_next(){let t=this.position.clone();const n=this.position,o=t.parent;if(o.parent===null&&t.offset===o.childCount)return{done:!0};if(o===this._boundaryEndParent&&t.offset==this.boundaries.end.offset)return{done:!0};let r;if(o instanceof _t){if(t.isAtEnd)return this.position=H._createAfter(o),this._next();r=o.data[t.offset]}else r=o.getChild(t.offset);if(r instanceof Re)return this.shallow?t.offset++:t=new H(r,0),this.position=t,this._formatReturnValue("elementStart",r,n,t,1);if(r instanceof _t){if(this.singleCharacters)return t=new H(r,0),this.position=t,this._next();{let c,u=r.data.length;return r==this._boundaryEndParent?(u=this.boundaries.end.offset,c=new pn(r,0,u),t=H._createAfter(c)):(c=new pn(r,0,r.data.length),t.offset++),this.position=t,this._formatReturnValue("text",c,n,t,u)}}if(typeof r=="string"){let c;this.singleCharacters?c=1:c=(o===this._boundaryEndParent?this.boundaries.end.offset:o.data.length)-t.offset;const u=new pn(o,t.offset,c);return t.offset+=c,this.position=t,this._formatReturnValue("text",u,n,t,c)}return t=H._createAfter(o),this.position=t,this.ignoreElementEnd?this._next():this._formatReturnValue("elementEnd",o,n,t)}_previous(){let t=this.position.clone();const n=this.position,o=t.parent;if(o.parent===null&&t.offset===0)return{done:!0};if(o==this._boundaryStartParent&&t.offset==this.boundaries.start.offset)return{done:!0};let r;if(o instanceof _t){if(t.isAtStart)return this.position=H._createBefore(o),this._previous();r=o.data[t.offset-1]}else r=o.getChild(t.offset-1);if(r instanceof Re)return this.shallow?(t.offset--,this.position=t,this._formatReturnValue("elementStart",r,n,t,1)):(t=new H(r,r.childCount),this.position=t,this.ignoreElementEnd?this._previous():this._formatReturnValue("elementEnd",r,n,t));if(r instanceof _t){if(this.singleCharacters)return t=new H(r,r.data.length),this.position=t,this._previous();{let c,u=r.data.length;if(r==this._boundaryStartParent){const g=this.boundaries.start.offset;c=new pn(r,g,r.data.length-g),u=c.data.length,t=H._createBefore(c)}else c=new pn(r,0,r.data.length),t.offset--;return this.position=t,this._formatReturnValue("text",c,n,t,u)}}if(typeof r=="string"){let c;if(this.singleCharacters)c=1;else{const g=o===this._boundaryStartParent?this.boundaries.start.offset:0;c=t.offset-g}t.offset-=c;const u=new pn(o,t.offset,c);return this.position=t,this._formatReturnValue("text",u,n,t,c)}return t=H._createBefore(o),this.position=t,this._formatReturnValue("elementStart",o,n,t,1)}_formatReturnValue(t,n,o,r,c){return n instanceof pn&&(n.offsetInText+n.data.length==n.textNode.data.length&&(this.direction!="forward"||this.boundaries&&this.boundaries.end.isEqual(this.position)?o=H._createAfter(n.textNode):(r=H._createAfter(n.textNode),this.position=r)),n.offsetInText===0&&(this.direction!="backward"||this.boundaries&&this.boundaries.start.isEqual(this.position)?o=H._createBefore(n.textNode):(r=H._createBefore(n.textNode),this.position=r))),{done:!1,value:{type:t,item:n,previousPosition:o,nextPosition:r,length:c}}}}class H{constructor(t,n){this.parent=t,this.offset=n}get nodeAfter(){return this.parent.is("$text")?null:this.parent.getChild(this.offset)||null}get nodeBefore(){return this.parent.is("$text")?null:this.parent.getChild(this.offset-1)||null}get isAtStart(){return this.offset===0}get isAtEnd(){const t=this.parent.is("$text")?this.parent.data.length:this.parent.childCount;return this.offset===t}get root(){return this.parent.root}get editableElement(){let t=this.parent;for(;!(t instanceof Nr);){if(!t.parent)return null;t=t.parent}return t}getShiftedBy(t){const n=H._createAt(this),o=n.offset+t;return n.offset=o<0?0:o,n}getLastMatchingPosition(t,n={}){n.startPosition=this;const o=new ii(n);return o.skip(t),o.position}getAncestors(){return this.parent.is("documentFragment")?[this.parent]:this.parent.getAncestors({includeSelf:!0})}getCommonAncestor(t){const n=this.getAncestors(),o=t.getAncestors();let r=0;for(;n[r]==o[r]&&n[r];)r++;return r===0?null:n[r-1]}is(t){return t==="position"||t==="view:position"}isEqual(t){return this.parent==t.parent&&this.offset==t.offset}isBefore(t){return this.compareWith(t)=="before"}isAfter(t){return this.compareWith(t)=="after"}compareWith(t){if(this.root!==t.root)return"different";if(this.isEqual(t))return"same";const n=this.parent.is("node")?this.parent.getPath():[],o=t.parent.is("node")?t.parent.getPath():[];n.push(this.offset),o.push(t.offset);const r=se(n,o);switch(r){case"prefix":return"before";case"extension":return"after";default:return n[r]<o[r]?"before":"after"}}getWalker(t={}){return t.startPosition=this,new ii(t)}clone(){return new H(this.parent,this.offset)}static _createAt(t,n){if(t instanceof H)return new this(t.parent,t.offset);{const o=t;if(n=="end")n=o.is("$text")?o.data.length:o.childCount;else{if(n=="before")return this._createBefore(o);if(n=="after")return this._createAfter(o);if(n!==0&&!n)throw new y.a("view-createpositionat-offset-required",o)}return new H(o,n)}}static _createAfter(t){if(t.is("$textProxy"))return new H(t.textNode,t.offsetInText+t.data.length);if(!t.parent)throw new y.a("view-position-after-root",t,{root:t});return new H(t.parent,t.index+1)}static _createBefore(t){if(t.is("$textProxy"))return new H(t.textNode,t.offsetInText);if(!t.parent)throw new y.a("view-position-before-root",t,{root:t});return new H(t.parent,t.index)}}class et{constructor(t,n=null){this.start=t.clone(),this.end=n?n.clone():t.clone()}*[Symbol.iterator](){yield*new ii({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return this.start.parent===this.end.parent}get root(){return this.start.root}getEnlarged(){let t=this.start.getLastMatchingPosition(Dr,{direction:"backward"}),n=this.end.getLastMatchingPosition(Dr);return t.parent.is("$text")&&t.isAtStart&&(t=H._createBefore(t.parent)),n.parent.is("$text")&&n.isAtEnd&&(n=H._createAfter(n.parent)),new et(t,n)}getTrimmed(){let t=this.start.getLastMatchingPosition(Dr);if(t.isAfter(this.end)||t.isEqual(this.end))return new et(t,t);let n=this.end.getLastMatchingPosition(Dr,{direction:"backward"});const o=t.nodeAfter,r=n.nodeBefore;return o&&o.is("$text")&&(t=new H(o,0)),r&&r.is("$text")&&(n=new H(r,r.data.length)),new et(t,n)}isEqual(t){return this==t||this.start.isEqual(t.start)&&this.end.isEqual(t.end)}containsPosition(t){return t.isAfter(this.start)&&t.isBefore(this.end)}containsRange(t,n=!1){t.isCollapsed&&(n=!1);const o=this.containsPosition(t.start)||n&&this.start.isEqual(t.start),r=this.containsPosition(t.end)||n&&this.end.isEqual(t.end);return o&&r}getDifference(t){const n=[];return this.isIntersecting(t)?(this.containsPosition(t.start)&&n.push(new et(this.start,t.start)),this.containsPosition(t.end)&&n.push(new et(t.end,this.end))):n.push(this.clone()),n}getIntersection(t){if(this.isIntersecting(t)){let n=this.start,o=this.end;return this.containsPosition(t.start)&&(n=t.start),this.containsPosition(t.end)&&(o=t.end),new et(n,o)}return null}getWalker(t={}){return t.boundaries=this,new ii(t)}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;let t=this.start.nodeAfter,n=this.end.nodeBefore;return this.start.parent.is("$text")&&this.start.isAtEnd&&this.start.parent.nextSibling&&(t=this.start.parent.nextSibling),this.end.parent.is("$text")&&this.end.isAtStart&&this.end.parent.previousSibling&&(n=this.end.parent.previousSibling),t&&t.is("element")&&t===n?t:null}clone(){return new et(this.start,this.end)}*getItems(t={}){t.boundaries=this,t.ignoreElementEnd=!0;const n=new ii(t);for(const o of n)yield o.item}*getPositions(t={}){t.boundaries=this;const n=new ii(t);yield n.position;for(const o of n)yield o.nextPosition}is(t){return t==="range"||t==="view:range"}isIntersecting(t){return this.start.isBefore(t.end)&&this.end.isAfter(t.start)}static _createFromParentsAndOffsets(t,n,o,r){return new this(new H(t,n),new H(o,r))}static _createFromPositionAndShift(t,n){const o=t,r=t.getShiftedBy(n);return n>0?new this(o,r):new this(r,o)}static _createIn(t){return this._createFromParentsAndOffsets(t,0,t,t.childCount)}static _createOn(t){const n=t.is("$textProxy")?t.offsetSize:1;return this._createFromPositionAndShift(H._createBefore(t),n)}}function Dr(l){return!(!l.item.is("attributeElement")&&!l.item.is("uiElement"))}function jl(l){let t=0;for(const n of l)t++;return t}class We{constructor(t=null,n,o){this._ranges=[],this._lastRangeBackward=!1,this._isFake=!1,this._fakeSelectionLabel="",this.setTo(t,n,o)}get isFake(){return this._isFake}get fakeSelectionLabel(){return this._fakeSelectionLabel}get anchor(){if(!this._ranges.length)return null;const t=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?t.end:t.start).clone()}get focus(){if(!this._ranges.length)return null;const t=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?t.start:t.end).clone()}get isCollapsed(){return this.rangeCount===1&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}get editableElement(){return this.anchor?this.anchor.editableElement:null}*getRanges(){for(const t of this._ranges)yield t.clone()}getFirstRange(){let t=null;for(const n of this._ranges)t&&!n.start.isBefore(t.start)||(t=n);return t?t.clone():null}getLastRange(){let t=null;for(const n of this._ranges)t&&!n.end.isAfter(t.end)||(t=n);return t?t.clone():null}getFirstPosition(){const t=this.getFirstRange();return t?t.start.clone():null}getLastPosition(){const t=this.getLastRange();return t?t.end.clone():null}isEqual(t){if(this.isFake!=t.isFake||this.isFake&&this.fakeSelectionLabel!=t.fakeSelectionLabel||this.rangeCount!=t.rangeCount)return!1;if(this.rangeCount===0)return!0;if(!this.anchor.isEqual(t.anchor)||!this.focus.isEqual(t.focus))return!1;for(const n of this._ranges){let o=!1;for(const r of t._ranges)if(n.isEqual(r)){o=!0;break}if(!o)return!1}return!0}isSimilar(t){if(this.isBackward!=t.isBackward)return!1;const n=jl(this.getRanges());if(n!=jl(t.getRanges()))return!1;if(n==0)return!0;for(let o of this.getRanges()){o=o.getTrimmed();let r=!1;for(let c of t.getRanges())if(c=c.getTrimmed(),o.start.isEqual(c.start)&&o.end.isEqual(c.end)){r=!0;break}if(!r)return!1}return!0}getSelectedElement(){return this.rangeCount!==1?null:this.getFirstRange().getContainedElement()}setTo(t,n,o){if(t===null)this._setRanges([]),this._setFakeOptions(n);else if(t instanceof We||t instanceof $l)this._setRanges(t.getRanges(),t.isBackward),this._setFakeOptions({fake:t.isFake,label:t.fakeSelectionLabel});else if(t instanceof et)this._setRanges([t],n&&n.backward),this._setFakeOptions(n);else if(t instanceof H)this._setRanges([new et(t)]),this._setFakeOptions(n);else if(t instanceof ni){const r=!!o&&!!o.backward;let c;if(n===void 0)throw new y.a("view-selection-setto-required-second-parameter",this);c=n=="in"?et._createIn(t):n=="on"?et._createOn(t):new et(H._createAt(t,n)),this._setRanges([c],r),this._setFakeOptions(o)}else{if(!Ie(t))throw new y.a("view-selection-setto-not-selectable",this);this._setRanges(t,n&&n.backward),this._setFakeOptions(n)}this.fire("change")}setFocus(t,n){if(this.anchor===null)throw new y.a("view-selection-setfocus-no-ranges",this);const o=H._createAt(t,n);if(o.compareWith(this.focus)=="same")return;const r=this.anchor;this._ranges.pop(),o.compareWith(r)=="before"?this._addRange(new et(o,r),!0):this._addRange(new et(r,o)),this.fire("change")}is(t){return t==="selection"||t==="view:selection"}_setRanges(t,n=!1){t=Array.from(t),this._ranges=[];for(const o of t)this._addRange(o);this._lastRangeBackward=!!n}_setFakeOptions(t={}){this._isFake=!!t.fake,this._fakeSelectionLabel=t.fake&&t.label||""}_addRange(t,n=!1){if(!(t instanceof et))throw new y.a("view-selection-add-range-not-range",this);this._pushRange(t),this._lastRangeBackward=!!n}_pushRange(t){for(const n of this._ranges)if(t.isIntersecting(n))throw new y.a("view-selection-range-intersects",this,{addedRange:t,intersectingRange:n});this._ranges.push(new et(t.start,t.end))}}tt(We,D);class $l{constructor(t=null,n,o){this._selection=new We,this._selection.delegate("change").to(this),this._selection.setTo(t,n,o)}get isFake(){return this._selection.isFake}get fakeSelectionLabel(){return this._selection.fakeSelectionLabel}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get isCollapsed(){return this._selection.isCollapsed}get rangeCount(){return this._selection.rangeCount}get isBackward(){return this._selection.isBackward}get editableElement(){return this._selection.editableElement}get _ranges(){return this._selection._ranges}*getRanges(){yield*this._selection.getRanges()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getSelectedElement(){return this._selection.getSelectedElement()}isEqual(t){return this._selection.isEqual(t)}isSimilar(t){return this._selection.isSimilar(t)}is(t){return t==="selection"||t=="documentSelection"||t=="view:selection"||t=="view:documentSelection"}_setTo(t,n,o){this._selection.setTo(t,n,o)}_setFocus(t,n){this._selection.setFocus(t,n)}}tt($l,D);class Lr extends f{constructor(t,n,o){super(t,n),this.startRange=o,this._eventPhase="none",this._currentTarget=null}get eventPhase(){return this._eventPhase}get currentTarget(){return this._currentTarget}}const Hl=Symbol("bubbling contexts");var c1={fire(l,...t){try{const n=l instanceof f?l:new f(this,l),o=Wl(this);if(!o.size)return;if(ts(n,"capturing",this),Gi(o,"$capture",n,...t))return n.return;const r=n.startRange||this.selection.getFirstRange(),c=r?r.getContainedElement():null,u=!!c&&!!Gh(o,c);let g=c||function(m){if(!m)return null;const p=m.start.parent,w=m.end.parent,_=p.getPath(),v=w.getPath();return _.length>v.length?p:w}(r);if(ts(n,"atTarget",g),!u){if(Gi(o,"$text",n,...t))return n.return;ts(n,"bubbling",g)}for(;g;){if(g.is("rootElement")){if(Gi(o,"$root",n,...t))return n.return}else if(g.is("element")&&Gi(o,g.name,n,...t))return n.return;if(Gi(o,g,n,...t))return n.return;g=g.parent,ts(n,"bubbling",g)}return ts(n,"bubbling",this),Gi(o,"$document",n,...t),n.return}catch(n){y.a.rethrowUnexpectedError(n,this)}},_addEventListener(l,t,n){const o=Kt(n.context||"$document"),r=Wl(this);for(const c of o){let u=r.get(c);u||(u=Object.create(D),r.set(c,u)),this.listenTo(u,l,t,n)}},_removeEventListener(l,t){const n=Wl(this);for(const o of n.values())this.stopListening(o,l,t)}};function ts(l,t,n){l instanceof Lr&&(l._eventPhase=t,l._currentTarget=n)}function Gi(l,t,n,...o){const r=typeof t=="string"?l.get(t):Gh(l,t);return!!r&&(r.fire(n,...o),n.stop.called)}function Gh(l,t){for(const[n,o]of l)if(typeof n=="function"&&n(t))return o;return null}function Wl(l){return l[Hl]||(l[Hl]=new Map),l[Hl]}class es{constructor(t){this.selection=new $l,this.roots=new Me({idProperty:"rootName"}),this.stylesProcessor=t,this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("isSelecting",!1),this.set("isComposing",!1),this._postFixers=new Set}getRoot(t="main"){return this.roots.get(t)}registerPostFixer(t){this._postFixers.add(t)}destroy(){this.roots.map(t=>t.destroy()),this.stopListening()}_callPostFixers(t){let n=!1;do for(const o of this._postFixers)if(n=o(t),n)break;while(n)}}tt(es,c1),tt(es,yt);class Ki extends Re{constructor(t,n,o,r){super(t,n,o,r),this.getFillerOffset=d1,this._priority=10,this._id=null,this._clonesGroup=null}get priority(){return this._priority}get id(){return this._id}getElementsWithSameId(){if(this.id===null)throw new y.a("attribute-element-get-elements-with-same-id-no-id",this);return new Set(this._clonesGroup)}is(t,n=null){return n?n===this.name&&(t==="attributeElement"||t==="view:attributeElement"||t==="element"||t==="view:element"):t==="attributeElement"||t==="view:attributeElement"||t==="element"||t==="view:element"||t==="node"||t==="view:node"}isSimilar(t){return this.id!==null||t.id!==null?this.id===t.id:super.isSimilar(t)&&this.priority==t.priority}_clone(t){const n=super._clone(t);return n._priority=this._priority,n._id=this._id,n}}function d1(){if(ql(this))return null;let l=this.parent;for(;l&&l.is("attributeElement");){if(ql(l)>1)return null;l=l.parent}return!l||ql(l)>1?null:this.childCount}function ql(l){return Array.from(l.getChildren()).filter(t=>!t.is("uiElement")).length}Ki.DEFAULT_PRIORITY=10;class Kh extends Re{constructor(t,n,o,r){super(t,n,o,r),this._isAllowedInsideAttributeElement=!0,this.getFillerOffset=u1}is(t,n=null){return n?n===this.name&&(t==="emptyElement"||t==="view:emptyElement"||t==="element"||t==="view:element"):t==="emptyElement"||t==="view:emptyElement"||t==="element"||t==="view:element"||t==="node"||t==="view:node"}_insertChild(t,n){if(n&&(n instanceof ni||Array.from(n).length>0))throw new y.a("view-emptyelement-cannot-add",[this,n])}}function u1(){return null}const oi=navigator.userAgent.toLowerCase();var bt={isMac:Yh(oi),isWindows:function(l){return l.indexOf("windows")>-1}(oi),isGecko:function(l){return!!l.match(/gecko\/\d+/)}(oi),isSafari:function(l){return l.indexOf(" applewebkit/")>-1&&l.indexOf("chrome")===-1}(oi),isiOS:function(l){return!!l.match(/iphone|ipad/i)||Yh(l)&&navigator.maxTouchPoints>0}(oi),isAndroid:function(l){return l.indexOf("android")>-1}(oi),isBlink:function(l){return l.indexOf("chrome/")>-1&&l.indexOf("edge/")<0}(oi),features:{isRegExpUnicodePropertySupported:function(){let l=!1;try{l="ć".search(new RegExp("[\\p{L}]","u"))===0}catch{}return l}()}};function Yh(l){return l.indexOf("macintosh")>-1}const h1={ctrl:"⌃",cmd:"⌘",alt:"⌥",shift:"⇧"},f1={ctrl:"Ctrl+",alt:"Alt+",shift:"Shift+"},rt=function(){const l={arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,delete:46,enter:13,space:32,esc:27,tab:9,ctrl:1114112,shift:2228224,alt:4456448,cmd:8912896};for(let t=65;t<=90;t++){const n=String.fromCharCode(t);l[n.toLowerCase()]=t}for(let t=48;t<=57;t++)l[t-48]=t;for(let t=112;t<=123;t++)l["f"+(t-111)]=t;for(const t of"`-=[];',./\\")l[t]=t.charCodeAt(0);return l}(),g1=Object.fromEntries(Object.entries(rt).map(([l,t])=>[t,l.charAt(0).toUpperCase()+l.slice(1)]));function en(l){let t;if(typeof l=="string"){if(t=rt[l.toLowerCase()],!t)throw new y.a("keyboard-unknown-key",null,{key:l})}else t=l.keyCode+(l.altKey?rt.alt:0)+(l.ctrlKey?rt.ctrl:0)+(l.shiftKey?rt.shift:0)+(l.metaKey?rt.cmd:0);return t}function Ul(l){return typeof l=="string"&&(l=function(t){return t.split("+").map(n=>n.trim())}(l)),l.map(t=>typeof t=="string"?function(n){if(n.endsWith("!"))return en(n.slice(0,-1));const o=en(n);return bt.isMac&&o==rt.ctrl?rt.cmd:o}(t):t).reduce((t,n)=>n+t,0)}function Jh(l){let t=Ul(l);return Object.entries(bt.isMac?h1:f1).reduce((n,[o,r])=>(t&rt[o]&&(t&=~rt[o],n+=r),n),"")+(t?g1[t]:"")}function Gl(l,t){const n=t==="ltr";switch(l){case rt.arrowleft:return n?"left":"right";case rt.arrowright:return n?"right":"left";case rt.arrowup:return"up";case rt.arrowdown:return"down"}}class Kl extends Re{constructor(t,n,o,r){super(t,n,o,r),this._isAllowedInsideAttributeElement=!0,this.getFillerOffset=p1}is(t,n=null){return n?n===this.name&&(t==="uiElement"||t==="view:uiElement"||t==="element"||t==="view:element"):t==="uiElement"||t==="view:uiElement"||t==="element"||t==="view:element"||t==="node"||t==="view:node"}_insertChild(t,n){if(n&&(n instanceof ni||Array.from(n).length>0))throw new y.a("view-uielement-cannot-add",this)}render(t){return this.toDomElement(t)}toDomElement(t){const n=t.createElement(this.name);for(const o of this.getAttributeKeys())n.setAttribute(o,this.getAttribute(o));return n}}function m1(l){l.document.on("arrowKey",(t,n)=>function(o,r,c){if(r.keyCode==rt.arrowright){const u=r.domTarget.ownerDocument.defaultView.getSelection(),g=u.rangeCount==1&&u.getRangeAt(0).collapsed;if(g||r.shiftKey){const m=u.focusNode,p=u.focusOffset,w=c.domPositionToView(m,p);if(w===null)return;let _=!1;const v=w.getLastMatchingPosition(A=>(A.item.is("uiElement")&&(_=!0),!(!A.item.is("uiElement")&&!A.item.is("attributeElement"))));if(_){const A=c.viewPositionToDom(v);g?u.collapse(A.parent,A.offset):u.extend(A.parent,A.offset)}}}}(0,n,l.domConverter),{priority:"low"})}function p1(){return null}class Qh extends Re{constructor(t,n,o,r){super(t,n,o,r),this._isAllowedInsideAttributeElement=!0,this.getFillerOffset=b1}is(t,n=null){return n?n===this.name&&(t==="rawElement"||t==="view:rawElement"||t==="element"||t==="view:element"):t==="rawElement"||t==="view:rawElement"||t===this.name||t==="view:"+this.name||t==="element"||t==="view:element"||t==="node"||t==="view:node"}_insertChild(t,n){if(n&&(n instanceof ni||Array.from(n).length>0))throw new y.a("view-rawelement-cannot-add",[this,n])}}function b1(){return null}class si{constructor(t,n){this.document=t,this._children=[],n&&this._insertChild(0,n)}[Symbol.iterator](){return this._children[Symbol.iterator]()}get childCount(){return this._children.length}get isEmpty(){return this.childCount===0}get root(){return this}get parent(){return null}is(t){return t==="documentFragment"||t==="view:documentFragment"}_appendChild(t){return this._insertChild(this.childCount,t)}getChild(t){return this._children[t]}getChildIndex(t){return this._children.indexOf(t)}getChildren(){return this._children[Symbol.iterator]()}_insertChild(t,n){this._fireChange("children",this);let o=0;const r=function(c,u){return typeof u=="string"?[new _t(c,u)]:(Ie(u)||(u=[u]),Array.from(u).map(g=>typeof g=="string"?new _t(c,g):g instanceof pn?new _t(c,g.data):g))}(this.document,n);for(const c of r)c.parent!==null&&c._remove(),c.parent=this,this._children.splice(t,0,c),t++,o++;return o}_removeChildren(t,n=1){this._fireChange("children",this);for(let o=t;o<t+n;o++)this._children[o].parent=null;return this._children.splice(t,n)}_fireChange(t,n){this.fire("change:"+t,n)}}tt(si,D);class Xh{constructor(t){this.document=t,this._cloneGroups=new Map}setSelection(t,n,o){this.document.selection._setTo(t,n,o)}setSelectionFocus(t,n){this.document.selection._setFocus(t,n)}createDocumentFragment(t){return new si(this.document,t)}createText(t){return new _t(this.document,t)}createAttributeElement(t,n,o={}){const r=new Ki(this.document,t,n);return typeof o.priority=="number"&&(r._priority=o.priority),o.id&&(r._id=o.id),o.renderUnsafeAttributes&&r._unsafeAttributesToRender.push(...o.renderUnsafeAttributes),r}createContainerElement(t,n,o={}){const r=new Or(this.document,t,n);return o.isAllowedInsideAttributeElement!==void 0&&(r._isAllowedInsideAttributeElement=o.isAllowedInsideAttributeElement),o.renderUnsafeAttributes&&r._unsafeAttributesToRender.push(...o.renderUnsafeAttributes),r}createEditableElement(t,n,o={}){const r=new Nr(this.document,t,n);return r._document=this.document,o.renderUnsafeAttributes&&r._unsafeAttributesToRender.push(...o.renderUnsafeAttributes),r}createEmptyElement(t,n,o={}){const r=new Kh(this.document,t,n);return o.isAllowedInsideAttributeElement!==void 0&&(r._isAllowedInsideAttributeElement=o.isAllowedInsideAttributeElement),o.renderUnsafeAttributes&&r._unsafeAttributesToRender.push(...o.renderUnsafeAttributes),r}createUIElement(t,n,o,r={}){const c=new Kl(this.document,t,n);return o&&(c.render=o),r.isAllowedInsideAttributeElement!==void 0&&(c._isAllowedInsideAttributeElement=r.isAllowedInsideAttributeElement),c}createRawElement(t,n,o,r={}){const c=new Qh(this.document,t,n);return c.render=o||(()=>{}),r.isAllowedInsideAttributeElement!==void 0&&(c._isAllowedInsideAttributeElement=r.isAllowedInsideAttributeElement),r.renderUnsafeAttributes&&c._unsafeAttributesToRender.push(...r.renderUnsafeAttributes),c}setAttribute(t,n,o){o._setAttribute(t,n)}removeAttribute(t,n){n._removeAttribute(t)}addClass(t,n){n._addClass(t)}removeClass(t,n){n._removeClass(t)}setStyle(t,n,o){Pe(t)&&o===void 0&&(o=n),o._setStyle(t,n)}removeStyle(t,n){n._removeStyle(t)}setCustomProperty(t,n,o){o._setCustomProperty(t,n)}removeCustomProperty(t,n){return n._removeCustomProperty(t)}breakAttributes(t){return t instanceof H?this._breakAttributes(t):this._breakAttributesRange(t)}breakContainer(t){const n=t.parent;if(!n.is("containerElement"))throw new y.a("view-writer-break-non-container-element",this.document);if(!n.parent)throw new y.a("view-writer-break-root",this.document);if(t.isAtStart)return H._createBefore(n);if(!t.isAtEnd){const o=n._clone(!1);this.insert(H._createAfter(n),o);const r=new et(t,H._createAt(n,"end")),c=new H(o,0);this.move(r,c)}return H._createAfter(n)}mergeAttributes(t){const n=t.offset,o=t.parent;if(o.is("$text"))return t;if(o.is("attributeElement")&&o.childCount===0){const u=o.parent,g=o.index;return o._remove(),this._removeFromClonedElementsGroup(o),this.mergeAttributes(new H(u,g))}const r=o.getChild(n-1),c=o.getChild(n);if(!r||!c)return t;if(r.is("$text")&&c.is("$text"))return tf(r,c);if(r.is("attributeElement")&&c.is("attributeElement")&&r.isSimilar(c)){const u=r.childCount;return r._appendChild(c.getChildren()),c._remove(),this._removeFromClonedElementsGroup(c),this.mergeAttributes(new H(r,u))}return t}mergeContainers(t){const n=t.nodeBefore,o=t.nodeAfter;if(!(n&&o&&n.is("containerElement")&&o.is("containerElement")))throw new y.a("view-writer-merge-containers-invalid-position",this.document);const r=n.getChild(n.childCount-1),c=r instanceof _t?H._createAt(r,"end"):H._createAt(n,"end");return this.move(et._createIn(o),H._createAt(n,"end")),this.remove(et._createOn(o)),c}insert(t,n){(function u(g,m){for(const p of g){if(!_1.some(w=>p instanceof w))throw new y.a("view-writer-insert-invalid-node-type",m);p.is("$text")||u(p.getChildren(),m)}})(n=Ie(n)?[...n]:[n],this.document);const o=n.reduce((u,g)=>{const m=u[u.length-1],p=!(g.is("uiElement")&&g.isAllowedInsideAttributeElement);return m&&m.breakAttributes==p?m.nodes.push(g):u.push({breakAttributes:p,nodes:[g]}),u},[]);let r=null,c=t;for(const{nodes:u,breakAttributes:g}of o){const m=this._insertNodes(c,u,g);r||(r=m.start),c=m.end}return r?new et(r,c):new et(t)}remove(t){const n=t instanceof et?t:et._createOn(t);if(ns(n,this.document),n.isCollapsed)return new si(this.document);const{start:o,end:r}=this._breakAttributesRange(n,!0),c=o.parent,u=r.offset-o.offset,g=c._removeChildren(o.offset,u);for(const p of g)this._removeFromClonedElementsGroup(p);const m=this.mergeAttributes(o);return n.start=m,n.end=m.clone(),new si(this.document,g)}clear(t,n){ns(t,this.document);const o=t.getWalker({direction:"backward",ignoreElementEnd:!0});for(const r of o){const c=r.item;let u;if(c.is("element")&&n.isSimilar(c))u=et._createOn(c);else if(!r.nextPosition.isAfter(t.start)&&c.is("$textProxy")){const g=c.getAncestors().find(m=>m.is("element")&&n.isSimilar(m));g&&(u=et._createIn(g))}u&&(u.end.isAfter(t.end)&&(u.end=t.end),u.start.isBefore(t.start)&&(u.start=t.start),this.remove(u))}}move(t,n){let o;if(n.isAfter(t.end)){const r=(n=this._breakAttributes(n,!0)).parent,c=r.childCount;t=this._breakAttributesRange(t,!0),o=this.remove(t),n.offset+=r.childCount-c}else o=this.remove(t);return this.insert(n,o)}wrap(t,n){if(!(n instanceof Ki))throw new y.a("view-writer-wrap-invalid-attribute",this.document);if(ns(t,this.document),t.isCollapsed){let r=t.start;r.parent.is("element")&&(o=r.parent,!Array.from(o.getChildren()).some(u=>!u.is("uiElement")))&&(r=r.getLastMatchingPosition(u=>u.item.is("uiElement"))),r=this._wrapPosition(r,n);const c=this.document.selection;return c.isCollapsed&&c.getFirstPosition().isEqual(t.start)&&this.setSelection(r),new et(r)}return this._wrapRange(t,n);var o}unwrap(t,n){if(!(n instanceof Ki))throw new y.a("view-writer-unwrap-invalid-attribute",this.document);if(ns(t,this.document),t.isCollapsed)return t;const{start:o,end:r}=this._breakAttributesRange(t,!0),c=o.parent,u=this._unwrapChildren(c,o.offset,r.offset,n),g=this.mergeAttributes(u.start);g.isEqual(u.start)||u.end.offset--;const m=this.mergeAttributes(u.end);return new et(g,m)}rename(t,n){const o=new Or(this.document,t,n.getAttributes());return this.insert(H._createAfter(n),o),this.move(et._createIn(n),H._createAt(o,0)),this.remove(et._createOn(n)),o}clearClonedElementsGroup(t){this._cloneGroups.delete(t)}createPositionAt(t,n){return H._createAt(t,n)}createPositionAfter(t){return H._createAfter(t)}createPositionBefore(t){return H._createBefore(t)}createRange(t,n){return new et(t,n)}createRangeOn(t){return et._createOn(t)}createRangeIn(t){return et._createIn(t)}createSelection(t,n,o){return new We(t,n,o)}_insertNodes(t,n,o){let r,c;if(r=o?Yl(t):t.parent.is("$text")?t.parent.parent:t.parent,!r)throw new y.a("view-writer-invalid-position-container",this.document);c=o?this._breakAttributes(t,!0):t.parent.is("$text")?Jl(t):t;const u=r._insertChild(c.offset,n);for(const w of n)this._addToClonedElementsGroup(w);const g=c.getShiftedBy(u),m=this.mergeAttributes(c);m.isEqual(c)||g.offset--;const p=this.mergeAttributes(g);return new et(m,p)}_wrapChildren(t,n,o,r){let c=n;const u=[];for(;c<o;){const m=t.getChild(c),p=m.is("$text"),w=m.is("attributeElement"),_=m.isAllowedInsideAttributeElement;if(w&&this._wrapAttributeElement(r,m))u.push(new H(t,c));else if(p||_||w&&w1(r,m)){const v=r._clone();m._remove(),v._appendChild(m),t._insertChild(c,v),this._addToClonedElementsGroup(v),u.push(new H(t,c))}else w&&this._wrapChildren(m,0,m.childCount,r);c++}let g=0;for(const m of u)m.offset-=g,m.offset!=n&&(this.mergeAttributes(m).isEqual(m)||(g++,o--));return et._createFromParentsAndOffsets(t,n,t,o)}_unwrapChildren(t,n,o,r){let c=n;const u=[];for(;c<o;){const m=t.getChild(c);if(m.is("attributeElement"))if(m.isSimilar(r)){const p=m.getChildren(),w=m.childCount;m._remove(),t._insertChild(c,p),this._removeFromClonedElementsGroup(m),u.push(new H(t,c),new H(t,c+w)),c+=w,o+=w-1}else this._unwrapAttributeElement(r,m)?(u.push(new H(t,c),new H(t,c+1)),c++):(this._unwrapChildren(m,0,m.childCount,r),c++);else c++}let g=0;for(const m of u)m.offset-=g,!(m.offset==n||m.offset==o)&&(this.mergeAttributes(m).isEqual(m)||(g++,o--));return et._createFromParentsAndOffsets(t,n,t,o)}_wrapRange(t,n){const{start:o,end:r}=this._breakAttributesRange(t,!0),c=o.parent,u=this._wrapChildren(c,o.offset,r.offset,n),g=this.mergeAttributes(u.start);g.isEqual(u.start)||u.end.offset--;const m=this.mergeAttributes(u.end);return new et(g,m)}_wrapPosition(t,n){if(n.isSimilar(t.parent))return Zh(t.clone());t.parent.is("$text")&&(t=Jl(t));const o=this.createAttributeElement();o._priority=Number.POSITIVE_INFINITY,o.isSimilar=()=>!1,t.parent._insertChild(t.offset,o);const r=new et(t,t.getShiftedBy(1));this.wrap(r,n);const c=new H(o.parent,o.index);o._remove();const u=c.nodeBefore,g=c.nodeAfter;return u instanceof _t&&g instanceof _t?tf(u,g):Zh(c)}_wrapAttributeElement(t,n){if(!ef(t,n)||t.name!==n.name||t.priority!==n.priority)return!1;for(const o of t.getAttributeKeys())if(o!=="class"&&o!=="style"&&n.hasAttribute(o)&&n.getAttribute(o)!==t.getAttribute(o))return!1;for(const o of t.getStyleNames())if(n.hasStyle(o)&&n.getStyle(o)!==t.getStyle(o))return!1;for(const o of t.getAttributeKeys())o!=="class"&&o!=="style"&&(n.hasAttribute(o)||this.setAttribute(o,t.getAttribute(o),n));for(const o of t.getStyleNames())n.hasStyle(o)||this.setStyle(o,t.getStyle(o),n);for(const o of t.getClassNames())n.hasClass(o)||this.addClass(o,n);return!0}_unwrapAttributeElement(t,n){if(!ef(t,n)||t.name!==n.name||t.priority!==n.priority)return!1;for(const o of t.getAttributeKeys())if(o!=="class"&&o!=="style"&&(!n.hasAttribute(o)||n.getAttribute(o)!==t.getAttribute(o)))return!1;if(!n.hasClass(...t.getClassNames()))return!1;for(const o of t.getStyleNames())if(!n.hasStyle(o)||n.getStyle(o)!==t.getStyle(o))return!1;for(const o of t.getAttributeKeys())o!=="class"&&o!=="style"&&this.removeAttribute(o,n);return this.removeClass(Array.from(t.getClassNames()),n),this.removeStyle(Array.from(t.getStyleNames()),n),!0}_breakAttributesRange(t,n=!1){const o=t.start,r=t.end;if(ns(t,this.document),t.isCollapsed){const m=this._breakAttributes(t.start,n);return new et(m,m)}const c=this._breakAttributes(r,n),u=c.parent.childCount,g=this._breakAttributes(o,n);return c.offset+=c.parent.childCount-u,new et(g,c)}_breakAttributes(t,n=!1){const o=t.offset,r=t.parent;if(t.parent.is("emptyElement"))throw new y.a("view-writer-cannot-break-empty-element",this.document);if(t.parent.is("uiElement"))throw new y.a("view-writer-cannot-break-ui-element",this.document);if(t.parent.is("rawElement"))throw new y.a("view-writer-cannot-break-raw-element",this.document);if(!n&&r.is("$text")&&Ql(r.parent)||Ql(r))return t.clone();if(r.is("$text"))return this._breakAttributes(Jl(t),n);if(o==r.childCount){const c=new H(r.parent,r.index+1);return this._breakAttributes(c,n)}if(o===0){const c=new H(r.parent,r.index);return this._breakAttributes(c,n)}{const c=r.index+1,u=r._clone();r.parent._insertChild(c,u),this._addToClonedElementsGroup(u);const g=r.childCount-o,m=r._removeChildren(o,g);u._appendChild(m);const p=new H(r.parent,c);return this._breakAttributes(p,n)}}_addToClonedElementsGroup(t){if(!t.root.is("rootElement"))return;if(t.is("element"))for(const r of t.getChildren())this._addToClonedElementsGroup(r);const n=t.id;if(!n)return;let o=this._cloneGroups.get(n);o||(o=new Set,this._cloneGroups.set(n,o)),o.add(t),t._clonesGroup=o}_removeFromClonedElementsGroup(t){if(t.is("element"))for(const r of t.getChildren())this._removeFromClonedElementsGroup(r);const n=t.id;if(!n)return;const o=this._cloneGroups.get(n);o&&o.delete(t)}}function Yl(l){let t=l.parent;for(;!Ql(t);){if(!t)return;t=t.parent}return t}function w1(l,t){return l.priority<t.priority||!(l.priority>t.priority)&&l.getIdentity()<t.getIdentity()}function Zh(l){const t=l.nodeBefore;if(t&&t.is("$text"))return new H(t,t.data.length);const n=l.nodeAfter;return n&&n.is("$text")?new H(n,0):l}function Jl(l){if(l.offset==l.parent.data.length)return new H(l.parent.parent,l.parent.index+1);if(l.offset===0)return new H(l.parent.parent,l.parent.index);const t=l.parent.data.slice(l.offset);return l.parent._data=l.parent.data.slice(0,l.offset),l.parent.parent._insertChild(l.parent.index+1,new _t(l.root.document,t)),new H(l.parent.parent,l.parent.index+1)}function tf(l,t){const n=l.data.length;return l._data+=t.data,t._remove(),new H(l,n)}const _1=[_t,Ki,Or,Kh,Qh,Kl];function Ql(l){return l&&(l.is("containerElement")||l.is("documentFragment"))}function ns(l,t){const n=Yl(l.start),o=Yl(l.end);if(!n||!o||n!==o)throw new y.a("view-writer-invalid-range-container",t)}function ef(l,t){return l.id===null&&t.id===null}function Zt(l){return Object.prototype.toString.call(l)=="[object Text]"}const nf=l=>l.createTextNode(" "),of=l=>{const t=l.createElement("span");return t.dataset.ckeFiller=!0,t.innerHTML=" ",t},sf=l=>{const t=l.createElement("br");return t.dataset.ckeFiller=!0,t},Vr="⁠".repeat(7);function ve(l){return Zt(l)&&l.data.substr(0,7)===Vr}function Br(l){return l.data.length==7&&ve(l)}function Xl(l){return ve(l)?l.data.slice(7):l.data}function k1(l,t){if(t.keyCode==rt.arrowleft){const n=t.domTarget.ownerDocument.defaultView.getSelection();if(n.rangeCount==1&&n.getRangeAt(0).collapsed){const o=n.getRangeAt(0).startContainer,r=n.getRangeAt(0).startOffset;ve(o)&&r<=7&&n.collapse(o,0)}}}function rf(l,t,n,o=!1){n=n||function(c,u){return c===u},Array.isArray(l)||(l=Array.prototype.slice.call(l)),Array.isArray(t)||(t=Array.prototype.slice.call(t));const r=function(c,u,g){const m=af(c,u,g);if(m===-1)return{firstIndex:-1,lastIndexOld:-1,lastIndexNew:-1};const p=lf(c,m),w=lf(u,m),_=af(p,w,g),v=c.length-_,A=u.length-_;return{firstIndex:m,lastIndexOld:v,lastIndexNew:A}}(l,t,n);return o?function(c,u){const{firstIndex:g,lastIndexOld:m,lastIndexNew:p}=c;if(g===-1)return Array(u).fill("equal");let w=[];return g>0&&(w=w.concat(Array(g).fill("equal"))),p-g>0&&(w=w.concat(Array(p-g).fill("insert"))),m-g>0&&(w=w.concat(Array(m-g).fill("delete"))),p<u&&(w=w.concat(Array(u-p).fill("equal"))),w}(r,t.length):function(c,u){const g=[],{firstIndex:m,lastIndexOld:p,lastIndexNew:w}=u;return w-m>0&&g.push({index:m,type:"insert",values:c.slice(m,w)}),p-m>0&&g.push({index:m+(w-m),type:"delete",howMany:p-m}),g}(t,r)}function af(l,t,n){for(let o=0;o<Math.max(l.length,t.length);o++)if(l[o]===void 0||t[o]===void 0||!n(l[o],t[o]))return o;return-1}function lf(l,t){return l.slice(t).reverse()}function Ln(l,t,n){n=n||function(E,T){return E===T};const o=l.length,r=t.length;if(o>200||r>200||o+r>300)return Ln.fastDiff(l,t,n,!0);let c,u;if(r<o){const E=l;l=t,t=E,c="delete",u="insert"}else c="insert",u="delete";const g=l.length,m=t.length,p=m-g,w={},_={};function v(E){const T=(_[E-1]!==void 0?_[E-1]:-1)+1,S=_[E+1]!==void 0?_[E+1]:-1,I=T>S?-1:1;w[E+I]&&(w[E]=w[E+I].slice(0)),w[E]||(w[E]=[]),w[E].push(T>S?c:u);let N=Math.max(T,S),j=N-E;for(;j<g&&N<m&&n(l[j],t[N]);)j++,N++,w[E].push("equal");return N}let A,x=0;do{for(A=-x;A<p;A++)_[A]=v(A);for(A=p+x;A>p;A--)_[A]=v(A);_[p]=v(p),x++}while(_[p]!==m);return w[p].slice(1)}function cf(l,t,n){l.insertBefore(n,l.childNodes[t]||null)}function df(l){const t=l.parentNode;t&&t.removeChild(l)}function Yi(l){if(l){if(l.defaultView)return l instanceof l.defaultView.Document;if(l.ownerDocument&&l.ownerDocument.defaultView)return l instanceof l.ownerDocument.defaultView.Node}return!1}Ln.fastDiff=rf,d(15);class uf{constructor(t,n){this.domDocuments=new Set,this.domConverter=t,this.markedAttributes=new Set,this.markedChildren=new Set,this.markedTexts=new Set,this.selection=n,this.set("isFocused",!1),this.set("isSelecting",!1),bt.isBlink&&!bt.isAndroid&&this.on("change:isSelecting",()=>{this.isSelecting||this.render()}),this._inlineFiller=null,this._fakeSelectionContainer=null}markToSync(t,n){if(t==="text")this.domConverter.mapViewToDom(n.parent)&&this.markedTexts.add(n);else{if(!this.domConverter.mapViewToDom(n))return;if(t==="attributes")this.markedAttributes.add(n);else{if(t!=="children")throw new y.a("view-renderer-unknown-type",this);this.markedChildren.add(n)}}}render(){let t;const n=!(bt.isBlink&&!bt.isAndroid)||!this.isSelecting;for(const o of this.markedChildren)this._updateChildrenMappings(o);n?(this._inlineFiller&&!this._isSelectionInInlineFiller()&&this._removeInlineFiller(),this._inlineFiller?t=this._getInlineFillerPosition():this._needsInlineFillerAtSelection()&&(t=this.selection.getFirstPosition(),this.markedChildren.add(t.parent))):this._inlineFiller&&this._inlineFiller.parentNode&&(t=this.domConverter.domPositionToView(this._inlineFiller));for(const o of this.markedAttributes)this._updateAttrs(o);for(const o of this.markedChildren)this._updateChildren(o,{inlineFillerPosition:t});for(const o of this.markedTexts)!this.markedChildren.has(o.parent)&&this.domConverter.mapViewToDom(o.parent)&&this._updateText(o,{inlineFillerPosition:t});if(n)if(t){const o=this.domConverter.viewPositionToDom(t),r=o.parent.ownerDocument;ve(o.parent)?this._inlineFiller=o.parent:this._inlineFiller=hf(r,o.parent,o.offset)}else this._inlineFiller=null;this._updateFocus(),this._updateSelection(),this.markedTexts.clear(),this.markedAttributes.clear(),this.markedChildren.clear()}_updateChildrenMappings(t){const n=this.domConverter.mapViewToDom(t);if(!n)return;const o=Array.from(this.domConverter.mapViewToDom(t).childNodes),r=Array.from(this.domConverter.viewChildrenToDom(t,n.ownerDocument,{withChildren:!1})),c=this._diffNodeLists(o,r),u=this._findReplaceActions(c,o,r);if(u.indexOf("replace")!==-1){const g={equal:0,insert:0,delete:0};for(const m of u)if(m==="replace"){const p=g.equal+g.insert,w=g.equal+g.delete,_=t.getChild(p);!_||_.is("uiElement")||_.is("rawElement")||this._updateElementMappings(_,o[w]),df(r[p]),g.equal++}else g[m]++}}_updateElementMappings(t,n){this.domConverter.unbindDomElement(n),this.domConverter.bindElements(n,t),this.markedChildren.add(t),this.markedAttributes.add(t)}_getInlineFillerPosition(){const t=this.selection.getFirstPosition();return t.parent.is("$text")?H._createBefore(this.selection.getFirstPosition().parent):t}_isSelectionInInlineFiller(){if(this.selection.rangeCount!=1||!this.selection.isCollapsed)return!1;const t=this.selection.getFirstPosition(),n=this.domConverter.viewPositionToDom(t);return!!(n&&Zt(n.parent)&&ve(n.parent))}_removeInlineFiller(){const t=this._inlineFiller;if(!ve(t))throw new y.a("view-renderer-filler-was-lost",this);Br(t)?t.remove():t.data=t.data.substr(7),this._inlineFiller=null}_needsInlineFillerAtSelection(){if(this.selection.rangeCount!=1||!this.selection.isCollapsed)return!1;const t=this.selection.getFirstPosition(),n=t.parent,o=t.offset;if(!this.domConverter.mapViewToDom(n.root)||!n.is("element")||!function(u){if(u.getAttribute("contenteditable")=="false")return!1;const g=u.findAncestor(m=>m.hasAttribute("contenteditable"));return!g||g.getAttribute("contenteditable")=="true"}(n)||o===n.getFillerOffset())return!1;const r=t.nodeBefore,c=t.nodeAfter;return!(r instanceof _t||c instanceof _t)}_updateText(t,n){const o=this.domConverter.findCorrespondingDomText(t),r=this.domConverter.viewToDom(t,o.ownerDocument),c=o.data;let u=r.data;const g=n.inlineFillerPosition;if(g&&g.parent==t.parent&&g.offset==t.index&&(u=Vr+u),c!=u){const m=rf(c,u);for(const p of m)p.type==="insert"?o.insertData(p.index,p.values.join("")):o.deleteData(p.index,p.howMany)}}_updateAttrs(t){const n=this.domConverter.mapViewToDom(t);if(!n)return;const o=Array.from(n.attributes).map(c=>c.name),r=t.getAttributeKeys();for(const c of r)this.domConverter.setDomElementAttribute(n,c,t.getAttribute(c),t);for(const c of o)t.hasAttribute(c)||this.domConverter.removeDomElementAttribute(n,c)}_updateChildren(t,n){const o=this.domConverter.mapViewToDom(t);if(!o)return;const r=n.inlineFillerPosition,c=this.domConverter.mapViewToDom(t).childNodes,u=Array.from(this.domConverter.viewChildrenToDom(t,o.ownerDocument,{bind:!0}));r&&r.parent===t&&hf(o.ownerDocument,u,r.offset);const g=this._diffNodeLists(c,u);let m=0;const p=new Set;for(const w of g)w==="delete"?(p.add(c[m]),df(c[m])):w==="equal"&&m++;m=0;for(const w of g)w==="insert"?(cf(o,m,u[m]),m++):w==="equal"&&(this._markDescendantTextToSync(this.domConverter.domToView(u[m])),m++);for(const w of p)w.parentNode||this.domConverter.unbindDomElement(w)}_diffNodeLists(t,n){return Ln(t=function(o,r){const c=Array.from(o);return c.length==0||!r||c[c.length-1]==r&&c.pop(),c}(t,this._fakeSelectionContainer),n,v1.bind(null,this.domConverter))}_findReplaceActions(t,n,o){if(t.indexOf("insert")===-1||t.indexOf("delete")===-1)return t;let r=[],c=[],u=[];const g={equal:0,insert:0,delete:0};for(const m of t)m==="insert"?u.push(o[g.equal+g.insert]):m==="delete"?c.push(n[g.equal+g.delete]):(r=r.concat(Ln(c,u,ff).map(p=>p==="equal"?"replace":p)),r.push("equal"),c=[],u=[]),g[m]++;return r.concat(Ln(c,u,ff).map(m=>m==="equal"?"replace":m))}_markDescendantTextToSync(t){if(t){if(t.is("$text"))this.markedTexts.add(t);else if(t.is("element"))for(const n of t.getChildren())this._markDescendantTextToSync(n)}}_updateSelection(){if(bt.isBlink&&!bt.isAndroid&&this.isSelecting&&!this.markedChildren.size)return;if(this.selection.rangeCount===0)return this._removeDomSelection(),void this._removeFakeSelection();const t=this.domConverter.mapViewToDom(this.selection.editableElement);this.isFocused&&t&&(this.selection.isFake?this._updateFakeSelection(t):(this._removeFakeSelection(),this._updateDomSelection(t)))}_updateFakeSelection(t){const n=t.ownerDocument;this._fakeSelectionContainer||(this._fakeSelectionContainer=function(u){const g=u.createElement("div");return g.className="ck-fake-selection-container",Object.assign(g.style,{position:"fixed",top:0,left:"-9999px",width:"42px"}),g.textContent=" ",g}(n));const o=this._fakeSelectionContainer;if(this.domConverter.bindFakeSelection(o,this.selection),!this._fakeSelectionNeedsUpdate(t))return;o.parentElement&&o.parentElement==t||t.appendChild(o),o.textContent=this.selection.fakeSelectionLabel||" ";const r=n.getSelection(),c=n.createRange();r.removeAllRanges(),c.selectNodeContents(o),r.addRange(c)}_updateDomSelection(t){const n=t.ownerDocument.defaultView.getSelection();if(!this._domSelectionNeedsUpdate(n))return;const o=this.domConverter.viewPositionToDom(this.selection.anchor),r=this.domConverter.viewPositionToDom(this.selection.focus);n.collapse(o.parent,o.offset),n.extend(r.parent,r.offset),bt.isGecko&&function(c,u){const g=c.parent;if(g.nodeType!=Node.ELEMENT_NODE||c.offset!=g.childNodes.length-1)return;const m=g.childNodes[c.offset];m&&m.tagName=="BR"&&u.addRange(u.getRangeAt(0))}(r,n)}_domSelectionNeedsUpdate(t){if(!this.domConverter.isDomSelectionCorrect(t))return!0;const n=t&&this.domConverter.domSelectionToView(t);return(!n||!this.selection.isEqual(n))&&!(!this.selection.isCollapsed&&this.selection.isSimilar(n))}_fakeSelectionNeedsUpdate(t){const n=this._fakeSelectionContainer,o=t.ownerDocument.getSelection();return!n||n.parentElement!==t||o.anchorNode!==n&&!n.contains(o.anchorNode)||n.textContent!==this.selection.fakeSelectionLabel}_removeDomSelection(){for(const t of this.domDocuments)if(t.getSelection().rangeCount){const n=t.activeElement,o=this.domConverter.mapDomToView(n);n&&o&&t.getSelection().removeAllRanges()}}_removeFakeSelection(){const t=this._fakeSelectionContainer;t&&t.remove()}_updateFocus(){if(this.isFocused){const t=this.selection.editableElement;t&&this.domConverter.focus(t)}}}function hf(l,t,n){const o=t instanceof Array?t:t.childNodes,r=o[n];if(Zt(r))return r.data=Vr+r.data,r;{const c=l.createTextNode(Vr);return Array.isArray(t)?o.splice(n,0,c):cf(t,n,c),c}}function ff(l,t){return Yi(l)&&Yi(t)&&!Zt(l)&&!Zt(t)&&l.nodeType!==Node.COMMENT_NODE&&t.nodeType!==Node.COMMENT_NODE&&l.tagName.toLowerCase()===t.tagName.toLowerCase()}function v1(l,t,n){return t===n||(Zt(t)&&Zt(n)?t.data===n.data:!(!l.isBlockFiller(t)||!l.isBlockFiller(n)))}tt(uf,yt);var Pt={window,document};function Zl(l){let t=0;for(;l.previousSibling;)l=l.previousSibling,t++;return t}function gf(l){const t=[];for(;l&&l.nodeType!=Node.DOCUMENT_NODE;)t.unshift(l),l=l.parentNode;return t}const y1=sf(document),A1=nf(document),C1=of(document);class Fr{constructor(t,n={}){this.document=t,this.renderingMode=n.renderingMode||"editing",this.blockFillerMode=n.blockFillerMode||(this.renderingMode==="editing"?"br":"nbsp"),this.preElements=["pre"],this.blockElements=["address","article","aside","blockquote","caption","center","dd","details","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","legend","li","main","menu","nav","ol","p","pre","section","summary","table","tbody","td","tfoot","th","thead","tr","ul"],this.inlineObjectElements=["object","iframe","input","button","textarea","select","option","video","embed","audio","img","canvas"],this._domToViewMapping=new WeakMap,this._viewToDomMapping=new WeakMap,this._fakeSelectionMapping=new WeakMap,this._rawContentElementMatcher=new tn,this._encounteredRawContentDomNodes=new WeakSet}bindFakeSelection(t,n){this._fakeSelectionMapping.set(t,new We(n))}fakeSelectionToView(t){return this._fakeSelectionMapping.get(t)}bindElements(t,n){this._domToViewMapping.set(t,n),this._viewToDomMapping.set(n,t)}unbindDomElement(t){const n=this._domToViewMapping.get(t);if(n){this._domToViewMapping.delete(t),this._viewToDomMapping.delete(n);for(const o of t.childNodes)this.unbindDomElement(o)}}bindDocumentFragments(t,n){this._domToViewMapping.set(t,n),this._viewToDomMapping.set(n,t)}shouldRenderAttribute(t,n,o){return this.renderingMode==="data"||!(t=t.toLowerCase()).startsWith("on")&&(t!=="srcdoc"||!n.match(/\bon\S+\s*=|javascript:|<\s*\/*script/i))&&(o==="img"&&(t==="src"||t==="srcset")||o==="source"&&t==="srcset"||!n.match(/^\s*(javascript:|data:(image\/svg|text\/x?html))/i))}setContentOf(t,n){if(this.renderingMode==="data")return void(t.innerHTML=n);const o=new DOMParser().parseFromString(n,"text/html"),r=o.createDocumentFragment(),c=o.body.childNodes;for(;c.length>0;)r.appendChild(c[0]);const u=o.createTreeWalker(r,NodeFilter.SHOW_ELEMENT),g=[];let m;for(;m=u.nextNode();)g.push(m);for(const p of g){for(const _ of p.getAttributeNames())this.setDomElementAttribute(p,_,p.getAttribute(_));const w=p.tagName.toLowerCase();this._shouldRenameElement(w)&&(Object(y.b)("domconverter-unsafe-element-detected",{unsafeElement:p}),p.replaceWith(this._createReplacementDomElement(w,p)))}for(;t.firstChild;)t.firstChild.remove();t.append(r)}viewToDom(t,n,o={}){if(t.is("$text")){const r=this._processDataFromViewText(t);return n.createTextNode(r)}{if(this.mapViewToDom(t))return this.mapViewToDom(t);let r;if(t.is("documentFragment"))r=n.createDocumentFragment(),o.bind&&this.bindDocumentFragments(r,t);else{if(t.is("uiElement"))return r=t.name==="$comment"?n.createComment(t.getCustomProperty("$rawContent")):t.render(n,this),o.bind&&this.bindElements(r,t),r;this._shouldRenameElement(t.name)?(Object(y.b)("domconverter-unsafe-element-detected",{unsafeElement:t}),r=this._createReplacementDomElement(t.name)):r=t.hasAttribute("xmlns")?n.createElementNS(t.getAttribute("xmlns"),t.name):n.createElement(t.name),t.is("rawElement")&&t.render(r,this),o.bind&&this.bindElements(r,t);for(const c of t.getAttributeKeys())this.setDomElementAttribute(r,c,t.getAttribute(c),t)}if(o.withChildren!==!1)for(const c of this.viewChildrenToDom(t,n,o))r.appendChild(c);return r}}setDomElementAttribute(t,n,o,r=null){const c=this.shouldRenderAttribute(n,o,t.tagName.toLowerCase())||r&&r.shouldRenderUnsafeAttribute(n);c||Object(y.b)("domconverter-unsafe-attribute-detected",{domElement:t,key:n,value:o}),t.hasAttribute(n)&&!c?t.removeAttribute(n):t.hasAttribute("data-ck-unsafe-attribute-"+n)&&c&&t.removeAttribute("data-ck-unsafe-attribute-"+n),t.setAttribute(c?n:"data-ck-unsafe-attribute-"+n,o)}removeDomElementAttribute(t,n){n!="data-ck-unsafe-element"&&(t.removeAttribute(n),t.removeAttribute("data-ck-unsafe-attribute-"+n))}*viewChildrenToDom(t,n,o={}){const r=t.getFillerOffset&&t.getFillerOffset();let c=0;for(const u of t.getChildren())r===c&&(yield this._getBlockFiller(n)),yield this.viewToDom(u,n,o),c++;r===c&&(yield this._getBlockFiller(n))}viewRangeToDom(t){const n=this.viewPositionToDom(t.start),o=this.viewPositionToDom(t.end),r=document.createRange();return r.setStart(n.parent,n.offset),r.setEnd(o.parent,o.offset),r}viewPositionToDom(t){const n=t.parent;if(n.is("$text")){const o=this.findCorrespondingDomText(n);if(!o)return null;let r=t.offset;return ve(o)&&(r+=7),{parent:o,offset:r}}{let o,r,c;if(t.offset===0){if(o=this.mapViewToDom(n),!o)return null;c=o.childNodes[0]}else{const u=t.nodeBefore;if(r=u.is("$text")?this.findCorrespondingDomText(u):this.mapViewToDom(t.nodeBefore),!r)return null;o=r.parentNode,c=r.nextSibling}return Zt(c)&&ve(c)?{parent:c,offset:7}:{parent:o,offset:r?Zl(r)+1:0}}}domToView(t,n={}){if(this.isBlockFiller(t))return null;const o=this.getHostViewElement(t);if(o)return o;if(this.isComment(t)&&n.skipComments)return null;if(Zt(t)){if(Br(t))return null;{const r=this._processDataFromDomText(t);return r===""?null:new _t(this.document,r)}}{if(this.mapDomToView(t))return this.mapDomToView(t);let r;if(this.isDocumentFragment(t))r=new si(this.document),n.bind&&this.bindDocumentFragments(t,r);else{r=this._createViewElement(t,n),n.bind&&this.bindElements(t,r);const c=t.attributes;if(c)for(let u=c.length-1;u>=0;u--)r._setAttribute(c[u].name,c[u].value);if(this._isViewElementWithRawContent(r,n)||this.isComment(t)){const u=this.isComment(t)?t.data:t.innerHTML;return r._setCustomProperty("$rawContent",u),this._encounteredRawContentDomNodes.add(t),r}}if(n.withChildren!==!1)for(const c of this.domChildrenToView(t,n))r._appendChild(c);return r}}*domChildrenToView(t,n={}){for(let o=0;o<t.childNodes.length;o++){const r=t.childNodes[o],c=this.domToView(r,n);c!==null&&(yield c)}}domSelectionToView(t){if(t.rangeCount===1){let r=t.getRangeAt(0).startContainer;Zt(r)&&(r=r.parentNode);const c=this.fakeSelectionToView(r);if(c)return c}const n=this.isDomSelectionBackward(t),o=[];for(let r=0;r<t.rangeCount;r++){const c=t.getRangeAt(r),u=this.domRangeToView(c);u&&o.push(u)}return new We(o,{backward:n})}domRangeToView(t){const n=this.domPositionToView(t.startContainer,t.startOffset),o=this.domPositionToView(t.endContainer,t.endOffset);return n&&o?new et(n,o):null}domPositionToView(t,n=0){if(this.isBlockFiller(t))return this.domPositionToView(t.parentNode,Zl(t));const o=this.mapDomToView(t);if(o&&(o.is("uiElement")||o.is("rawElement")))return H._createBefore(o);if(Zt(t)){if(Br(t))return this.domPositionToView(t.parentNode,Zl(t));const r=this.findCorrespondingViewText(t);let c=n;return r?(ve(t)&&(c-=7,c=c<0?0:c),new H(r,c)):null}if(n===0){const r=this.mapDomToView(t);if(r)return new H(r,0)}else{const r=t.childNodes[n-1],c=Zt(r)?this.findCorrespondingViewText(r):this.mapDomToView(r);if(c&&c.parent)return new H(c.parent,c.index+1)}return null}mapDomToView(t){return this.getHostViewElement(t)||this._domToViewMapping.get(t)}findCorrespondingViewText(t){if(Br(t))return null;const n=this.getHostViewElement(t);if(n)return n;const o=t.previousSibling;if(o){if(!this.isElement(o))return null;const r=this.mapDomToView(o);if(r)return r.nextSibling instanceof _t?r.nextSibling:null}else{const r=this.mapDomToView(t.parentNode);if(r){const c=r.getChild(0);return c instanceof _t?c:null}}return null}mapViewToDom(t){return this._viewToDomMapping.get(t)}findCorrespondingDomText(t){const n=t.previousSibling;return n&&this.mapViewToDom(n)?this.mapViewToDom(n).nextSibling:!n&&t.parent&&this.mapViewToDom(t.parent)?this.mapViewToDom(t.parent).childNodes[0]:null}focus(t){const n=this.mapViewToDom(t);if(n&&n.ownerDocument.activeElement!==n){const{scrollX:o,scrollY:r}=Pt.window,c=[];mf(n,u=>{const{scrollLeft:g,scrollTop:m}=u;c.push([g,m])}),n.focus(),mf(n,u=>{const[g,m]=c.shift();u.scrollLeft=g,u.scrollTop=m}),Pt.window.scrollTo(o,r)}}isElement(t){return t&&t.nodeType==Node.ELEMENT_NODE}isDocumentFragment(t){return t&&t.nodeType==Node.DOCUMENT_FRAGMENT_NODE}isComment(t){return t&&t.nodeType==Node.COMMENT_NODE}isBlockFiller(t){return this.blockFillerMode=="br"?t.isEqualNode(y1):!(t.tagName!=="BR"||!pf(t,this.blockElements)||t.parentNode.childNodes.length!==1)||t.isEqualNode(C1)||function(n,o){return n.isEqualNode(A1)&&pf(n,o)&&n.parentNode.childNodes.length===1}(t,this.blockElements)}isDomSelectionBackward(t){if(t.isCollapsed)return!1;const n=document.createRange();n.setStart(t.anchorNode,t.anchorOffset),n.setEnd(t.focusNode,t.focusOffset);const o=n.collapsed;return n.detach(),o}getHostViewElement(t){const n=gf(t);for(n.pop();n.length;){const o=n.pop(),r=this._domToViewMapping.get(o);if(r&&(r.is("uiElement")||r.is("rawElement")))return r}return null}isDomSelectionCorrect(t){return this._isDomSelectionPositionCorrect(t.anchorNode,t.anchorOffset)&&this._isDomSelectionPositionCorrect(t.focusNode,t.focusOffset)}registerRawContentMatcher(t){this._rawContentElementMatcher.add(t)}_getBlockFiller(t){switch(this.blockFillerMode){case"nbsp":return nf(t);case"markedNbsp":return of(t);case"br":return sf(t)}}_isDomSelectionPositionCorrect(t,n){if(Zt(t)&&ve(t)&&n<7||this.isElement(t)&&ve(t.childNodes[n]))return!1;const o=this.mapDomToView(t);return!o||!o.is("uiElement")&&!o.is("rawElement")}_processDataFromViewText(t){let n=t.data;if(t.getAncestors().some(o=>this.preElements.includes(o.name)))return n;if(n.charAt(0)==" "){const o=this._getTouchingInlineViewNode(t,!1);!(o&&o.is("$textProxy")&&this._nodeEndsWithSpace(o))&&o||(n=" "+n.substr(1))}if(n.charAt(n.length-1)==" "){const o=this._getTouchingInlineViewNode(t,!0),r=o&&o.is("$textProxy")&&o.data.charAt(0)==" ";n.charAt(n.length-2)!=" "&&o&&!r||(n=n.substr(0,n.length-1)+" ")}return n.replace(/ {2}/g,"  ")}_nodeEndsWithSpace(t){if(t.getAncestors().some(o=>this.preElements.includes(o.name)))return!1;const n=this._processDataFromViewText(t);return n.charAt(n.length-1)==" "}_processDataFromDomText(t){let n=t.data;if(function(p,w){return gf(p).some(_=>_.tagName&&w.includes(_.tagName.toLowerCase()))}(t,this.preElements))return Xl(t);n=n.replace(/[ \n\t\r]{1,}/g," ");const o=this._getTouchingInlineDomNode(t,!1),r=this._getTouchingInlineDomNode(t,!0),c=this._checkShouldLeftTrimDomText(t,o),u=this._checkShouldRightTrimDomText(t,r);c&&(n=n.replace(/^ /,"")),u&&(n=n.replace(/ $/,"")),n=Xl(new Text(n)),n=n.replace(/ \u00A0/g,"  ");const g=r&&this.isElement(r)&&r.tagName!="BR",m=r&&Zt(r)&&r.data.charAt(0)==" ";return(/( |\u00A0)\u00A0$/.test(n)||!r||g||m)&&(n=n.replace(/\u00A0$/," ")),(c||o&&this.isElement(o)&&o.tagName!="BR")&&(n=n.replace(/^\u00A0/," ")),n}_checkShouldLeftTrimDomText(t,n){return!n||(this.isElement(n)?n.tagName==="BR":!this._encounteredRawContentDomNodes.has(t.previousSibling)&&/[^\S\u00A0]/.test(n.data.charAt(n.data.length-1)))}_checkShouldRightTrimDomText(t,n){return!n&&!ve(t)}_getTouchingInlineViewNode(t,n){const o=new ii({startPosition:n?H._createAfter(t):H._createBefore(t),direction:n?"forward":"backward"});for(const r of o){if(r.item.is("element")&&this.inlineObjectElements.includes(r.item.name))return r.item;if(r.item.is("containerElement")||r.item.is("element","br"))return null;if(r.item.is("$textProxy"))return r.item}return null}_getTouchingInlineDomNode(t,n){if(!t.parentNode)return null;const o=n?"firstChild":"lastChild",r=n?"nextSibling":"previousSibling";let c=!0;do if(!c&&t[o]?t=t[o]:t[r]?(t=t[r],c=!1):(t=t.parentNode,c=!0),!t||this._isBlockElement(t))return null;while(!Zt(t)&&t.tagName!="BR"&&!this._isInlineObjectElement(t));return t}_isBlockElement(t){return this.isElement(t)&&this.blockElements.includes(t.tagName.toLowerCase())}_isInlineObjectElement(t){return this.isElement(t)&&this.inlineObjectElements.includes(t.tagName.toLowerCase())}_createViewElement(t,n){if(this.isComment(t))return new Kl(this.document,"$comment");const o=n.keepOriginalCase?t.tagName:t.tagName.toLowerCase();return new Re(this.document,o)}_isViewElementWithRawContent(t,n){return n.withChildren!==!1&&this._rawContentElementMatcher.match(t)}_shouldRenameElement(t){return this.renderingMode=="editing"&&t.toLowerCase()=="script"}_createReplacementDomElement(t,n=null){const o=document.createElement("span");if(o.setAttribute("data-ck-unsafe-element",t),n){for(;n.firstChild;)o.appendChild(n.firstChild);for(const r of n.getAttributeNames())o.setAttribute(r,n.getAttribute(r))}return o}}function mf(l,t){for(;l&&l!=Pt.document;)t(l),l=l.parentNode}function pf(l,t){const n=l.parentNode;return n&&n.tagName&&t.includes(n.tagName.toLowerCase())}function zr(l){const t=Object.prototype.toString.apply(l);return t=="[object Window]"||t=="[object global]"}var Ji=Ko({},D,{listenTo(l,t,n,o={}){if(Yi(l)||zr(l)){const r={capture:!!o.useCapture,passive:!!o.usePassive},c=this._getProxyEmitter(l,r)||new bf(l,r);this.listenTo(c,t,n,o)}else D.listenTo.call(this,l,t,n,o)},stopListening(l,t,n){if(Yi(l)||zr(l)){const o=this._getAllProxyEmitters(l);for(const r of o)this.stopListening(r,t,n)}else D.stopListening.call(this,l,t,n)},_getProxyEmitter(l,t){return n=this,o=wf(l,t),n[P]&&n[P][o]?n[P][o].emitter:null;var n,o},_getAllProxyEmitters(l){return[{capture:!1,passive:!1},{capture:!1,passive:!0},{capture:!0,passive:!1},{capture:!0,passive:!0}].map(t=>this._getProxyEmitter(l,t)).filter(t=>!!t)}});class bf{constructor(t,n){$(this,wf(t,n)),this._domNode=t,this._options=n}}function wf(l,t){let n=function(o){return o["data-ck-expando"]||(o["data-ck-expando"]=k())}(l);for(const o of Object.keys(t).sort())t[o]&&(n+="-"+o);return n}Ko(bf.prototype,D,{attach(l){if(this._domListeners&&this._domListeners[l])return;const t=this._createDomListener(l);this._domNode.addEventListener(l,t,this._options),this._domListeners||(this._domListeners={}),this._domListeners[l]=t},detach(l){let t;!this._domListeners[l]||(t=this._events[l])&&t.callbacks.length||this._domListeners[l].removeListener()},_addEventListener(l,t,n){this.attach(l),D._addEventListener.call(this,l,t,n)},_removeEventListener(l,t){D._removeEventListener.call(this,l,t),this.detach(l)},_createDomListener(l){const t=n=>{this.fire(l,n)};return t.removeListener=()=>{this._domNode.removeEventListener(l,t,this._options),delete this._domListeners[l]},t}});class wn{constructor(t){this.view=t,this.document=t.document,this.isEnabled=!1}enable(){this.isEnabled=!0}disable(){this.isEnabled=!1}destroy(){this.disable(),this.stopListening()}checkShouldIgnoreEventFromTarget(t){return t&&t.nodeType===3&&(t=t.parentNode),!(!t||t.nodeType!==1)&&t.matches("[data-cke-ignore-events], [data-cke-ignore-events] *")}}tt(wn,Ji);var x1=function(l){return this.__data__.set(l,"__lodash_hash_undefined__"),this},E1=function(l){return this.__data__.has(l)};function jr(l){var t=-1,n=l==null?0:l.length;for(this.__data__=new Pr;++t<n;)this.add(l[t])}jr.prototype.add=jr.prototype.push=x1,jr.prototype.has=E1;var T1=jr,S1=function(l,t){for(var n=-1,o=l==null?0:l.length;++n<o;)if(t(l[n],n,l))return!0;return!1},P1=function(l,t){return l.has(t)},_f=function(l,t,n,o,r,c){var u=1&n,g=l.length,m=t.length;if(g!=m&&!(u&&m>g))return!1;var p=c.get(l),w=c.get(t);if(p&&w)return p==t&&w==l;var _=-1,v=!0,A=2&n?new T1:void 0;for(c.set(l,t),c.set(t,l);++_<g;){var x=l[_],E=t[_];if(o)var T=u?o(E,x,_,t,l,c):o(x,E,_,l,t,c);if(T!==void 0){if(T)continue;v=!1;break}if(A){if(!S1(t,function(S,I){if(!P1(A,I)&&(x===S||r(x,S,n,o,c)))return A.push(I)})){v=!1;break}}else if(x!==E&&!r(x,E,n,o,c)){v=!1;break}}return c.delete(l),c.delete(t),v},I1=function(l){var t=-1,n=Array(l.size);return l.forEach(function(o,r){n[++t]=[r,o]}),n},M1=function(l){var t=-1,n=Array(l.size);return l.forEach(function(o){n[++t]=o}),n},kf=B?B.prototype:void 0,tc=kf?kf.valueOf:void 0,R1=function(l,t,n,o,r,c,u){switch(n){case"[object DataView]":if(l.byteLength!=t.byteLength||l.byteOffset!=t.byteOffset)return!1;l=l.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(l.byteLength!=t.byteLength||!c(new Ir(l),new Ir(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Uo(+l,+t);case"[object Error]":return l.name==t.name&&l.message==t.message;case"[object RegExp]":case"[object String]":return l==t+"";case"[object Map]":var g=I1;case"[object Set]":var m=1&o;if(g||(g=M1),l.size!=t.size&&!m)return!1;var p=u.get(l);if(p)return p==t;o|=2,u.set(l,t);var w=_f(g(l),g(t),o,r,c,u);return u.delete(l),w;case"[object Symbol]":if(tc)return tc.call(l)==tc.call(t)}return!1},O1=Object.prototype.hasOwnProperty,N1=function(l,t,n,o,r,c){var u=1&n,g=Cl(l),m=g.length;if(m!=Cl(t).length&&!u)return!1;for(var p=m;p--;){var w=g[p];if(!(u?w in t:O1.call(t,w)))return!1}var _=c.get(l),v=c.get(t);if(_&&v)return _==t&&v==l;var A=!0;c.set(l,t),c.set(t,l);for(var x=u;++p<m;){var E=l[w=g[p]],T=t[w];if(o)var S=u?o(T,E,w,t,l,c):o(E,T,w,l,t,c);if(!(S===void 0?E===T||r(E,T,n,o,c):S)){A=!1;break}x||(x=w=="constructor")}if(A&&!x){var I=l.constructor,N=t.constructor;I==N||!("constructor"in l)||!("constructor"in t)||typeof I=="function"&&I instanceof I&&typeof N=="function"&&N instanceof N||(A=!1)}return c.delete(l),c.delete(t),A},vf=Object.prototype.hasOwnProperty,D1=function(l,t,n,o,r,c){var u=ce(l),g=ce(t),m=u?"[object Array]":Xo(l),p=g?"[object Array]":Xo(t),w=(m=m=="[object Arguments]"?"[object Object]":m)=="[object Object]",_=(p=p=="[object Arguments]"?"[object Object]":p)=="[object Object]",v=m==p;if(v&&Object(Go.a)(l)){if(!Object(Go.a)(t))return!1;u=!0,w=!1}if(v&&!w)return c||(c=new Qo),u||wl(l)?_f(l,t,n,o,r,c):R1(l,t,m,n,o,r,c);if(!(1&n)){var A=w&&vf.call(l,"__wrapped__"),x=_&&vf.call(t,"__wrapped__");if(A||x){var E=A?l.value():l,T=x?t.value():t;return c||(c=new Qo),r(E,T,n,o,c)}}return!!v&&(c||(c=new Qo),N1(l,t,n,o,r,c))},yf=function l(t,n,o,r,c){return t===n||(t==null||n==null||!Se(t)&&!Se(n)?t!=t&&n!=n:D1(t,n,o,r,l,c))},L1=function(l,t,n){var o=(n=typeof n=="function"?n:void 0)?n(l,t):void 0;return o===void 0?yf(l,t,void 0,n):!!o};class Af extends wn{constructor(t){super(t),this._config={childList:!0,characterData:!0,characterDataOldValue:!0,subtree:!0},this.domConverter=t.domConverter,this.renderer=t._renderer,this._domElements=[],this._mutationObserver=new window.MutationObserver(this._onMutations.bind(this))}flush(){this._onMutations(this._mutationObserver.takeRecords())}observe(t){this._domElements.push(t),this.isEnabled&&this._mutationObserver.observe(t,this._config)}enable(){super.enable();for(const t of this._domElements)this._mutationObserver.observe(t,this._config)}disable(){super.disable(),this._mutationObserver.disconnect()}destroy(){super.destroy(),this._mutationObserver.disconnect()}_onMutations(t){if(t.length===0)return;const n=this.domConverter,o=new Map,r=new Set;for(const p of t)if(p.type==="childList"){const w=n.mapDomToView(p.target);if(w&&(w.is("uiElement")||w.is("rawElement")))continue;w&&!this._isBogusBrMutation(p)&&r.add(w)}for(const p of t){const w=n.mapDomToView(p.target);if((!w||!w.is("uiElement")&&!w.is("rawElement"))&&p.type==="characterData"){const _=n.findCorrespondingViewText(p.target);_&&!r.has(_.parent)?o.set(_,{type:"text",oldText:_.data,newText:Xl(p.target),node:_}):!_&&ve(p.target)&&r.add(n.mapDomToView(p.target.parentNode))}}const c=[];for(const p of o.values())this.renderer.markToSync("text",p.node),c.push(p);for(const p of r){const w=n.mapViewToDom(p),_=Array.from(p.getChildren()),v=Array.from(n.domChildrenToView(w,{withChildren:!1}));L1(_,v,m)||(this.renderer.markToSync("children",p),c.push({type:"children",oldChildren:_,newChildren:v,node:p}))}const u=t[0].target.ownerDocument.getSelection();let g=null;if(u&&u.anchorNode){const p=n.domPositionToView(u.anchorNode,u.anchorOffset),w=n.domPositionToView(u.focusNode,u.focusOffset);p&&w&&(g=new We(p),g.setFocus(w))}function m(p,w){if(!Array.isArray(p))return p===w||!(!p.is("$text")||!w.is("$text"))&&p.data===w.data}c.length&&(this.document.fire("mutations",c,g),this.view.forceRender())}_isBogusBrMutation(t){let n=null;return t.nextSibling===null&&t.removedNodes.length===0&&t.addedNodes.length==1&&(n=this.domConverter.domToView(t.addedNodes[0],{withChildren:!1})),n&&n.is("element","br")}}class ec{constructor(t,n,o){this.view=t,this.document=t.document,this.domEvent=n,this.domTarget=n.target,Ko(this,o)}get target(){return this.view.domConverter.mapDomToView(this.domTarget)}preventDefault(){this.domEvent.preventDefault()}stopPropagation(){this.domEvent.stopPropagation()}}class Vn extends wn{constructor(t){super(t),this.useCapture=!1}observe(t){(typeof this.domEventType=="string"?[this.domEventType]:this.domEventType).forEach(n=>{this.listenTo(t,n,(o,r)=>{this.isEnabled&&!this.checkShouldIgnoreEventFromTarget(r.target)&&this.onDomEvent(r)},{useCapture:this.useCapture})})}fire(t,n,o){this.isEnabled&&this.document.fire(t,new ec(this.view,n,o))}}class V1 extends Vn{constructor(t){super(t),this.domEventType=["keydown","keyup"]}onDomEvent(t){this.fire(t.type,t,{keyCode:t.keyCode,altKey:t.altKey,ctrlKey:t.ctrlKey,shiftKey:t.shiftKey,metaKey:t.metaKey,get keystroke(){return en(this)}})}}var nc=function(){return Q.a.Date.now()},B1=/\s/,F1=function(l){for(var t=l.length;t--&&B1.test(l.charAt(t)););return t},z1=/^\s+/,j1=function(l){return l&&l.slice(0,F1(l)+1).replace(z1,"")},$1=/^[-+]0x[0-9a-f]+$/i,H1=/^0b[01]+$/i,W1=/^0o[0-7]+$/i,q1=parseInt,Cf=function(l){if(typeof l=="number")return l;if(Mr(l))return NaN;if(G(l)){var t=typeof l.valueOf=="function"?l.valueOf():l;l=G(t)?t+"":t}if(typeof l!="string")return l===0?l:+l;l=j1(l);var n=H1.test(l);return n||W1.test(l)?q1(l.slice(2),n?2:8):$1.test(l)?NaN:+l},U1=Math.max,G1=Math.min,$r=function(l,t,n){var o,r,c,u,g,m,p=0,w=!1,_=!1,v=!0;if(typeof l!="function")throw new TypeError("Expected a function");function A(N){var j=o,X=r;return o=r=void 0,p=N,u=l.apply(X,j)}function x(N){return p=N,g=setTimeout(T,t),w?A(N):u}function E(N){var j=N-m;return m===void 0||j>=t||j<0||_&&N-p>=c}function T(){var N=nc();if(E(N))return S(N);g=setTimeout(T,function(j){var X=t-(j-m);return _?G1(X,c-(j-p)):X}(N))}function S(N){return g=void 0,v&&o?A(N):(o=r=void 0,u)}function I(){var N=nc(),j=E(N);if(o=arguments,r=this,m=N,j){if(g===void 0)return x(m);if(_)return clearTimeout(g),g=setTimeout(T,t),A(m)}return g===void 0&&(g=setTimeout(T,t)),u}return t=Cf(t)||0,G(n)&&(w=!!n.leading,c=(_="maxWait"in n)?U1(Cf(n.maxWait)||0,t):c,v="trailing"in n?!!n.trailing:v),I.cancel=function(){g!==void 0&&clearTimeout(g),p=0,o=m=r=g=void 0},I.flush=function(){return g===void 0?u:S(nc())},I};class K1 extends wn{constructor(t){super(t),this._fireSelectionChangeDoneDebounced=$r(n=>this.document.fire("selectionChangeDone",n),200)}observe(){const t=this.document;t.on("arrowKey",(n,o)=>{t.selection.isFake&&this.isEnabled&&o.preventDefault()},{context:"$capture"}),t.on("arrowKey",(n,o)=>{t.selection.isFake&&this.isEnabled&&this._handleSelectionMove(o.keyCode)},{priority:"lowest"})}destroy(){super.destroy(),this._fireSelectionChangeDoneDebounced.cancel()}_handleSelectionMove(t){const n=this.document.selection,o=new We(n.getRanges(),{backward:n.isBackward,fake:!1});t!=rt.arrowleft&&t!=rt.arrowup||o.setTo(o.getFirstPosition()),t!=rt.arrowright&&t!=rt.arrowdown||o.setTo(o.getLastPosition());const r={oldSelection:n,newSelection:o,domSelection:null};this.document.fire("selectionChange",r),this._fireSelectionChangeDoneDebounced(r)}}class Y1 extends wn{constructor(t){super(t),this.mutationObserver=t.getObserver(Af),this.selection=this.document.selection,this.domConverter=t.domConverter,this._documents=new WeakSet,this._fireSelectionChangeDoneDebounced=$r(n=>this.document.fire("selectionChangeDone",n),200),this._clearInfiniteLoopInterval=setInterval(()=>this._clearInfiniteLoop(),1e3),this._documentIsSelectingInactivityTimeoutDebounced=$r(()=>this.document.isSelecting=!1,5e3),this._loopbackCounter=0}observe(t){const n=t.ownerDocument,o=()=>{this.document.isSelecting=!1,this._documentIsSelectingInactivityTimeoutDebounced.cancel()};this.listenTo(t,"selectstart",()=>{this.document.isSelecting=!0,this._documentIsSelectingInactivityTimeoutDebounced()},{priority:"highest"}),this.listenTo(t,"keydown",o,{priority:"highest"}),this.listenTo(t,"keyup",o,{priority:"highest"}),this._documents.has(n)||(this.listenTo(n,"mouseup",o,{priority:"highest"}),this.listenTo(n,"selectionchange",(r,c)=>{this._handleSelectionChange(c,n),this._documentIsSelectingInactivityTimeoutDebounced()}),this._documents.add(n))}destroy(){super.destroy(),clearInterval(this._clearInfiniteLoopInterval),this._fireSelectionChangeDoneDebounced.cancel(),this._documentIsSelectingInactivityTimeoutDebounced.cancel()}_handleSelectionChange(t,n){if(!this.isEnabled)return;const o=n.defaultView.getSelection();if(this.checkShouldIgnoreEventFromTarget(o.anchorNode))return;this.mutationObserver.flush();const r=this.domConverter.domSelectionToView(o);if(r.rangeCount!=0){if(this.view.hasDomSelection=!0,!(this.selection.isEqual(r)&&this.domConverter.isDomSelectionCorrect(o)||++this._loopbackCounter>60))if(this.selection.isSimilar(r))this.view.forceRender();else{const c={oldSelection:this.selection,newSelection:r,domSelection:o};this.document.fire("selectionChange",c),this._fireSelectionChangeDoneDebounced(c)}}else this.view.hasDomSelection=!1}_clearInfiniteLoop(){this._loopbackCounter=0}}class J1 extends Vn{constructor(t){super(t),this.domEventType=["focus","blur"],this.useCapture=!0;const n=this.document;n.on("focus",()=>{n.isFocused=!0,this._renderTimeoutId=setTimeout(()=>t.change(()=>{}),50)}),n.on("blur",(o,r)=>{const c=n.selection.editableElement;c!==null&&c!==r.target||(n.isFocused=!1,t.change(()=>{}))})}onDomEvent(t){this.fire(t.type,t)}destroy(){this._renderTimeoutId&&clearTimeout(this._renderTimeoutId),super.destroy()}}class Q1 extends Vn{constructor(t){super(t),this.domEventType=["compositionstart","compositionupdate","compositionend"];const n=this.document;n.on("compositionstart",()=>{n.isComposing=!0}),n.on("compositionend",()=>{n.isComposing=!1})}onDomEvent(t){this.fire(t.type,t)}}class X1 extends Vn{constructor(t){super(t),this.domEventType=["beforeinput"]}onDomEvent(t){this.fire(t.type,t)}}class Z1{constructor(){this._replacedElements=[]}replace(t,n){this._replacedElements.push({element:t,newElement:n}),t.style.display="none",n&&t.parentNode.insertBefore(n,t.nextSibling)}restore(){this._replacedElements.forEach(({element:t,newElement:n})=>{t.style.display="",n&&n.remove()}),this._replacedElements=[]}}var xf=function(l){return typeof l=="string"||!ce(l)&&Se(l)&&Nn(l)=="[object String]"};function Hr(l){return Object.prototype.toString.apply(l)=="[object Range]"}function Ef(l){const t=l.ownerDocument.defaultView.getComputedStyle(l);return{top:parseInt(t.borderTopWidth,10),right:parseInt(t.borderRightWidth,10),bottom:parseInt(t.borderBottomWidth,10),left:parseInt(t.borderLeftWidth,10)}}const Tf=["top","right","bottom","left","width","height"];class gt{constructor(t){const n=Hr(t);if(Object.defineProperty(this,"_source",{value:t._source||t,writable:!0,enumerable:!1}),Dn(t)||n)if(n){const o=gt.getDomRangeRects(t);Wr(this,gt.getBoundingRect(o))}else Wr(this,t.getBoundingClientRect());else if(zr(t)){const{innerWidth:o,innerHeight:r}=t;Wr(this,{top:0,right:o,bottom:r,left:0,width:o,height:r})}else Wr(this,t)}clone(){return new gt(this)}moveTo(t,n){return this.top=n,this.right=t+this.width,this.bottom=n+this.height,this.left=t,this}moveBy(t,n){return this.top+=n,this.right+=t,this.left+=t,this.bottom+=n,this}getIntersection(t){const n={top:Math.max(this.top,t.top),right:Math.min(this.right,t.right),bottom:Math.min(this.bottom,t.bottom),left:Math.max(this.left,t.left)};return n.width=n.right-n.left,n.height=n.bottom-n.top,n.width<0||n.height<0?null:new gt(n)}getIntersectionArea(t){const n=this.getIntersection(t);return n?n.getArea():0}getArea(){return this.width*this.height}getVisible(){const t=this._source;let n=this.clone();if(!Sf(t)){let o=t.parentNode||t.commonAncestorContainer;for(;o&&!Sf(o);){const r=new gt(o),c=n.getIntersection(r);if(!c)return null;c.getArea()<n.getArea()&&(n=c),o=o.parentNode}}return n}isEqual(t){for(const n of Tf)if(this[n]!==t[n])return!1;return!0}contains(t){const n=this.getIntersection(t);return!(!n||!n.isEqual(t))}excludeScrollbarsAndBorders(){const t=this._source;let n,o,r;if(zr(t))n=t.innerWidth-t.document.documentElement.clientWidth,o=t.innerHeight-t.document.documentElement.clientHeight,r=t.getComputedStyle(t.document.documentElement).direction;else{const c=Ef(this._source);n=t.offsetWidth-t.clientWidth-c.left-c.right,o=t.offsetHeight-t.clientHeight-c.top-c.bottom,r=t.ownerDocument.defaultView.getComputedStyle(t).direction,this.left+=c.left,this.top+=c.top,this.right-=c.right,this.bottom-=c.bottom,this.width=this.right-this.left,this.height=this.bottom-this.top}return this.width-=n,r==="ltr"?this.right-=n:this.left+=n,this.height-=o,this.bottom-=o,this}static getDomRangeRects(t){const n=[],o=Array.from(t.getClientRects());if(o.length)for(const r of o)n.push(new gt(r));else{let r=t.startContainer;Zt(r)&&(r=r.parentNode);const c=new gt(r.getBoundingClientRect());c.right=c.left,c.width=0,n.push(c)}return n}static getBoundingRect(t){const n={left:Number.POSITIVE_INFINITY,top:Number.POSITIVE_INFINITY,right:Number.NEGATIVE_INFINITY,bottom:Number.NEGATIVE_INFINITY};let o=0;for(const r of t)o++,n.left=Math.min(n.left,r.left),n.top=Math.min(n.top,r.top),n.right=Math.max(n.right,r.right),n.bottom=Math.max(n.bottom,r.bottom);return o==0?null:(n.width=n.right-n.left,n.height=n.bottom-n.top,new gt(n))}}function Wr(l,t){for(const n of Tf)l[n]=t[n]}function Sf(l){return!!Dn(l)&&l===l.ownerDocument.body}class It{constructor(t,n){It._observerInstance||It._createObserver(),this._element=t,this._callback=n,It._addElementCallback(t,n),It._observerInstance.observe(t)}destroy(){It._deleteElementCallback(this._element,this._callback)}static _addElementCallback(t,n){It._elementCallbacks||(It._elementCallbacks=new Map);let o=It._elementCallbacks.get(t);o||(o=new Set,It._elementCallbacks.set(t,o)),o.add(n)}static _deleteElementCallback(t,n){const o=It._getElementCallbacks(t);o&&(o.delete(n),o.size||(It._elementCallbacks.delete(t),It._observerInstance.unobserve(t))),It._elementCallbacks&&!It._elementCallbacks.size&&(It._observerInstance=null,It._elementCallbacks=null)}static _getElementCallbacks(t){return It._elementCallbacks?It._elementCallbacks.get(t):null}static _createObserver(){let t;t=typeof Pt.window.ResizeObserver=="function"?Pt.window.ResizeObserver:Pf,It._observerInstance=new t(n=>{for(const o of n){const r=It._getElementCallbacks(o.target);if(r)for(const c of r)c(o)}})}}It._observerInstance=null,It._elementCallbacks=null;class Pf{constructor(t){this._callback=t,this._elements=new Set,this._previousRects=new Map,this._periodicCheckTimeout=null}observe(t){this._elements.add(t),this._checkElementRectsAndExecuteCallback(),this._elements.size===1&&this._startPeriodicCheck()}unobserve(t){this._elements.delete(t),this._previousRects.delete(t),this._elements.size||this._stopPeriodicCheck()}_startPeriodicCheck(){const t=()=>{this._checkElementRectsAndExecuteCallback(),this._periodicCheckTimeout=setTimeout(t,100)};this.listenTo(Pt.window,"resize",()=>{this._checkElementRectsAndExecuteCallback()}),this._periodicCheckTimeout=setTimeout(t,100)}_stopPeriodicCheck(){clearTimeout(this._periodicCheckTimeout),this.stopListening(),this._previousRects.clear()}_checkElementRectsAndExecuteCallback(){const t=[];for(const n of this._elements)this._hasRectChanged(n)&&t.push({target:n,contentRect:this._previousRects.get(n)});t.length&&this._callback(t)}_hasRectChanged(t){if(!t.ownerDocument.body.contains(t))return!1;const n=new gt(t),o=this._previousRects.get(t),r=!o||!o.isEqual(n);return this._previousRects.set(t,n),r}}function ic(l){return t=>t+l}function de(l){const t=l.next();return t.done?null:t.value}tt(Pf,Ji);class Oe{constructor(){this.set("isFocused",!1),this.set("focusedElement",null),this._elements=new Set,this._nextEventLoopTimeout=null}add(t){if(this._elements.has(t))throw new y.a("focustracker-add-element-already-exist",this);this.listenTo(t,"focus",()=>this._focus(t),{useCapture:!0}),this.listenTo(t,"blur",()=>this._blur(),{useCapture:!0}),this._elements.add(t)}remove(t){t===this.focusedElement&&this._blur(t),this._elements.has(t)&&(this.stopListening(t),this._elements.delete(t))}destroy(){this.stopListening()}_focus(t){clearTimeout(this._nextEventLoopTimeout),this.focusedElement=t,this.isFocused=!0}_blur(){clearTimeout(this._nextEventLoopTimeout),this._nextEventLoopTimeout=setTimeout(()=>{this.focusedElement=null,this.isFocused=!1},0)}}tt(Oe,Ji),tt(Oe,yt);class _n{constructor(){this._listener=Object.create(Ji)}listenTo(t){this._listener.listenTo(t,"keydown",(n,o)=>{this._listener.fire("_keydown:"+en(o),o)})}set(t,n,o={}){const r=Ul(t),c=o.priority;this._listener.listenTo(this._listener,"_keydown:"+r,(u,g)=>{n(g,()=>{g.preventDefault(),g.stopPropagation(),u.stop()}),u.return=!0},{priority:c})}press(t){return!!this._listener.fire("_keydown:"+en(t),t)}destroy(){this._listener.stopListening()}}class tA extends wn{constructor(t){super(t),this.document.on("keydown",(n,o)=>{if(this.isEnabled&&((r=o.keyCode)==rt.arrowright||r==rt.arrowleft||r==rt.arrowup||r==rt.arrowdown)){const c=new Lr(this.document,"arrowKey",this.document.selection.getFirstRange());this.document.fire(c,o),c.stop.called&&n.stop()}var r})}observe(){}}function If({target:l,viewportOffset:t=0}){const n=oc(l);let o=n,r=null;for(;o;){let c;c=Lf(o==n?l:r),Mf(c,()=>Vf(l,o));const u=Vf(l,o);if(eA(o,u,t),o.parent!=o){if(r=o.frameElement,o=o.parent,!r)return}else o=null}}function eA(l,t,n){const o=t.clone().moveBy(0,n),r=t.clone().moveBy(0,-n),c=new gt(l).excludeScrollbarsAndBorders();if(![r,o].every(u=>c.contains(u))){let{scrollX:u,scrollY:g}=l;Of(r,c)?g-=c.top-t.top+n:Rf(o,c)&&(g+=t.bottom-c.bottom+n),Nf(t,c)?u-=c.left-t.left+n:Df(t,c)&&(u+=t.right-c.right+n),l.scrollTo(u,g)}}function Mf(l,t){const n=oc(l);let o,r;for(;l!=n.document.body;)r=t(),o=new gt(l).excludeScrollbarsAndBorders(),o.contains(r)||(Of(r,o)?l.scrollTop-=o.top-r.top:Rf(r,o)&&(l.scrollTop+=r.bottom-o.bottom),Nf(r,o)?l.scrollLeft-=o.left-r.left:Df(r,o)&&(l.scrollLeft+=r.right-o.right)),l=l.parentNode}function Rf(l,t){return l.bottom>t.bottom}function Of(l,t){return l.top<t.top}function Nf(l,t){return l.left<t.left}function Df(l,t){return l.right>t.right}function oc(l){return Hr(l)?l.startContainer.ownerDocument.defaultView:l.ownerDocument.defaultView}function Lf(l){if(Hr(l)){let t=l.commonAncestorContainer;return Zt(t)&&(t=t.parentNode),t}return l.parentNode}function Vf(l,t){const n=oc(l),o=new gt(l);if(n===t)return o;{let r=n;for(;r!=t;){const c=r.frameElement,u=new gt(c).excludeScrollbarsAndBorders();o.moveBy(u.left,u.top),r=r.parent}}return o}Object.assign({},{scrollViewportToShowTarget:If,scrollAncestorsToShowTarget:function(l){Mf(Lf(l),()=>new gt(l))}});class Bf{constructor(t){this.document=new es(t),this.domConverter=new Fr(this.document),this.domRoots=new Map,this.set("isRenderingInProgress",!1),this.set("hasDomSelection",!1),this._renderer=new uf(this.domConverter,this.document.selection),this._renderer.bind("isFocused","isSelecting").to(this.document),this._initialDomRootAttributes=new WeakMap,this._observers=new Map,this._ongoingChange=!1,this._postFixersInProgress=!1,this._renderingDisabled=!1,this._hasChangedSinceTheLastRendering=!1,this._writer=new Xh(this.document),this.addObserver(Af),this.addObserver(Y1),this.addObserver(J1),this.addObserver(V1),this.addObserver(K1),this.addObserver(Q1),this.addObserver(tA),bt.isAndroid&&this.addObserver(X1),this.document.on("arrowKey",k1,{priority:"low"}),m1(this),this.on("render",()=>{this._render(),this.document.fire("layoutChanged"),this._hasChangedSinceTheLastRendering=!1}),this.listenTo(this.document.selection,"change",()=>{this._hasChangedSinceTheLastRendering=!0}),this.listenTo(this.document,"change:isFocused",()=>{this._hasChangedSinceTheLastRendering=!0})}attachDomRoot(t,n="main"){const o=this.document.getRoot(n);o._name=t.tagName.toLowerCase();const r={};for(const{name:u,value:g}of Array.from(t.attributes))r[u]=g,u==="class"?this._writer.addClass(g.split(" "),o):this._writer.setAttribute(u,g,o);this._initialDomRootAttributes.set(t,r);const c=()=>{this._writer.setAttribute("contenteditable",!o.isReadOnly,o),o.isReadOnly?this._writer.addClass("ck-read-only",o):this._writer.removeClass("ck-read-only",o)};c(),this.domRoots.set(n,t),this.domConverter.bindElements(t,o),this._renderer.markToSync("children",o),this._renderer.markToSync("attributes",o),this._renderer.domDocuments.add(t.ownerDocument),o.on("change:children",(u,g)=>this._renderer.markToSync("children",g)),o.on("change:attributes",(u,g)=>this._renderer.markToSync("attributes",g)),o.on("change:text",(u,g)=>this._renderer.markToSync("text",g)),o.on("change:isReadOnly",()=>this.change(c)),o.on("change",()=>{this._hasChangedSinceTheLastRendering=!0});for(const u of this._observers.values())u.observe(t,n)}detachDomRoot(t){const n=this.domRoots.get(t);Array.from(n.attributes).forEach(({name:r})=>n.removeAttribute(r));const o=this._initialDomRootAttributes.get(n);for(const r in o)n.setAttribute(r,o[r]);this.domRoots.delete(t),this.domConverter.unbindDomElement(n)}getDomRoot(t="main"){return this.domRoots.get(t)}addObserver(t){let n=this._observers.get(t);if(n)return n;n=new t(this),this._observers.set(t,n);for(const[o,r]of this.domRoots)n.observe(r,o);return n.enable(),n}getObserver(t){return this._observers.get(t)}disableObservers(){for(const t of this._observers.values())t.disable()}enableObservers(){for(const t of this._observers.values())t.enable()}scrollToTheSelection(){const t=this.document.selection.getFirstRange();t&&If({target:this.domConverter.viewRangeToDom(t),viewportOffset:20})}focus(){if(!this.document.isFocused){const t=this.document.selection.editableElement;t&&(this.domConverter.focus(t),this.forceRender())}}change(t){if(this.isRenderingInProgress||this._postFixersInProgress)throw new y.a("cannot-change-view-tree",this);try{if(this._ongoingChange)return t(this._writer);this._ongoingChange=!0;const n=t(this._writer);return this._ongoingChange=!1,!this._renderingDisabled&&this._hasChangedSinceTheLastRendering&&(this._postFixersInProgress=!0,this.document._callPostFixers(this._writer),this._postFixersInProgress=!1,this.fire("render")),n}catch(n){y.a.rethrowUnexpectedError(n,this)}}forceRender(){this._hasChangedSinceTheLastRendering=!0,this.change(()=>{})}destroy(){for(const t of this._observers.values())t.destroy();this.document.destroy(),this.stopListening()}createPositionAt(t,n){return H._createAt(t,n)}createPositionAfter(t){return H._createAfter(t)}createPositionBefore(t){return H._createBefore(t)}createRange(t,n){return new et(t,n)}createRangeOn(t){return et._createOn(t)}createRangeIn(t){return et._createIn(t)}createSelection(t,n,o){return new We(t,n,o)}_disableRendering(t){this._renderingDisabled=t,t==0&&this.change(()=>{})}_render(){this.isRenderingInProgress=!0,this.disableObservers(),this._renderer.render(),this.enableObservers(),this.isRenderingInProgress=!1}}tt(Bf,yt);class ri{constructor(t){this.parent=null,this._attrs=bn(t)}get index(){let t;if(!this.parent)return null;if((t=this.parent.getChildIndex(this))===null)throw new y.a("model-node-not-found-in-parent",this);return t}get startOffset(){let t;if(!this.parent)return null;if((t=this.parent.getChildStartOffset(this))===null)throw new y.a("model-node-not-found-in-parent",this);return t}get offsetSize(){return 1}get endOffset(){return this.parent?this.startOffset+this.offsetSize:null}get nextSibling(){const t=this.index;return t!==null&&this.parent.getChild(t+1)||null}get previousSibling(){const t=this.index;return t!==null&&this.parent.getChild(t-1)||null}get root(){let t=this;for(;t.parent;)t=t.parent;return t}isAttached(){return this.root.is("rootElement")}getPath(){const t=[];let n=this;for(;n.parent;)t.unshift(n.startOffset),n=n.parent;return t}getAncestors(t={includeSelf:!1,parentFirst:!1}){const n=[];let o=t.includeSelf?this:this.parent;for(;o;)n[t.parentFirst?"push":"unshift"](o),o=o.parent;return n}getCommonAncestor(t,n={}){const o=this.getAncestors(n),r=t.getAncestors(n);let c=0;for(;o[c]==r[c]&&o[c];)c++;return c===0?null:o[c-1]}isBefore(t){if(this==t||this.root!==t.root)return!1;const n=this.getPath(),o=t.getPath(),r=se(n,o);switch(r){case"prefix":return!0;case"extension":return!1;default:return n[r]<o[r]}}isAfter(t){return this!=t&&this.root===t.root&&!this.isBefore(t)}hasAttribute(t){return this._attrs.has(t)}getAttribute(t){return this._attrs.get(t)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}toJSON(){const t={};return this._attrs.size&&(t.attributes=Array.from(this._attrs).reduce((n,o)=>(n[o[0]]=o[1],n),{})),t}is(t){return t==="node"||t==="model:node"}_clone(){return new ri(this._attrs)}_remove(){this.parent._removeChildren(this.index)}_setAttribute(t,n){this._attrs.set(t,n)}_setAttributesTo(t){this._attrs=bn(t)}_removeAttribute(t){return this._attrs.delete(t)}_clearAttributes(){this._attrs.clear()}}class kt extends ri{constructor(t,n){super(n),this._data=t||""}get offsetSize(){return this.data.length}get data(){return this._data}is(t){return t==="$text"||t==="model:$text"||t==="text"||t==="model:text"||t==="node"||t==="model:node"}toJSON(){const t=super.toJSON();return t.data=this.data,t}_clone(){return new kt(this.data,this.getAttributes())}static fromJSON(t){return new kt(t.data,t.attributes)}}class nn{constructor(t,n,o){if(this.textNode=t,n<0||n>t.offsetSize)throw new y.a("model-textproxy-wrong-offsetintext",this);if(o<0||n+o>t.offsetSize)throw new y.a("model-textproxy-wrong-length",this);this.data=t.data.substring(n,n+o),this.offsetInText=n}get startOffset(){return this.textNode.startOffset!==null?this.textNode.startOffset+this.offsetInText:null}get offsetSize(){return this.data.length}get endOffset(){return this.startOffset!==null?this.startOffset+this.offsetSize:null}get isPartial(){return this.offsetSize!==this.textNode.offsetSize}get parent(){return this.textNode.parent}get root(){return this.textNode.root}is(t){return t==="$textProxy"||t==="model:$textProxy"||t==="textProxy"||t==="model:textProxy"}getPath(){const t=this.textNode.getPath();return t.length>0&&(t[t.length-1]+=this.offsetInText),t}getAncestors(t={includeSelf:!1,parentFirst:!1}){const n=[];let o=t.includeSelf?this:this.parent;for(;o;)n[t.parentFirst?"push":"unshift"](o),o=o.parent;return n}hasAttribute(t){return this.textNode.hasAttribute(t)}getAttribute(t){return this.textNode.getAttribute(t)}getAttributes(){return this.textNode.getAttributes()}getAttributeKeys(){return this.textNode.getAttributeKeys()}}class Qi{constructor(t){this._nodes=[],t&&this._insertNodes(0,t)}[Symbol.iterator](){return this._nodes[Symbol.iterator]()}get length(){return this._nodes.length}get maxOffset(){return this._nodes.reduce((t,n)=>t+n.offsetSize,0)}getNode(t){return this._nodes[t]||null}getNodeIndex(t){const n=this._nodes.indexOf(t);return n==-1?null:n}getNodeStartOffset(t){const n=this.getNodeIndex(t);return n===null?null:this._nodes.slice(0,n).reduce((o,r)=>o+r.offsetSize,0)}indexToOffset(t){if(t==this._nodes.length)return this.maxOffset;const n=this._nodes[t];if(!n)throw new y.a("model-nodelist-index-out-of-bounds",this);return this.getNodeStartOffset(n)}offsetToIndex(t){let n=0;for(const o of this._nodes){if(t>=n&&t<n+o.offsetSize)return this.getNodeIndex(o);n+=o.offsetSize}if(n!=t)throw new y.a("model-nodelist-offset-out-of-bounds",this,{offset:t,nodeList:this});return this.length}_insertNodes(t,n){for(const o of n)if(!(o instanceof ri))throw new y.a("model-nodelist-insertnodes-not-node",this);this._nodes.splice(t,0,...n)}_removeNodes(t,n=1){return this._nodes.splice(t,n)}toJSON(){return this._nodes.map(t=>t.toJSON())}}class mt extends ri{constructor(t,n,o){super(n),this.name=t,this._children=new Qi,o&&this._insertChild(0,o)}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return this.childCount===0}is(t,n=null){return n?n===this.name&&(t==="element"||t==="model:element"):t==="element"||t==="model:element"||t==="node"||t==="model:node"}getChild(t){return this._children.getNode(t)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(t){return this._children.getNodeIndex(t)}getChildStartOffset(t){return this._children.getNodeStartOffset(t)}offsetToIndex(t){return this._children.offsetToIndex(t)}getNodeByPath(t){let n=this;for(const o of t)n=n.getChild(n.offsetToIndex(o));return n}findAncestor(t,n={includeSelf:!1}){let o=n.includeSelf?this:this.parent;for(;o;){if(o.name===t)return o;o=o.parent}return null}toJSON(){const t=super.toJSON();if(t.name=this.name,this._children.length>0){t.children=[];for(const n of this._children)t.children.push(n.toJSON())}return t}_clone(t=!1){const n=t?Array.from(this._children).map(o=>o._clone(!0)):null;return new mt(this.name,this.getAttributes(),n)}_appendChild(t){this._insertChild(this.childCount,t)}_insertChild(t,n){const o=function(r){return typeof r=="string"?[new kt(r)]:(Ie(r)||(r=[r]),Array.from(r).map(c=>typeof c=="string"?new kt(c):c instanceof nn?new kt(c.data,c.getAttributes()):c))}(n);for(const r of o)r.parent!==null&&r._remove(),r.parent=this;this._children._insertNodes(t,o)}_removeChildren(t,n=1){const o=this._children._removeNodes(t,n);for(const r of o)r.parent=null;return o}static fromJSON(t){let n=null;if(t.children){n=[];for(const o of t.children)o.name?n.push(mt.fromJSON(o)):n.push(kt.fromJSON(o))}return new mt(t.name,t.attributes,n)}}class kn{constructor(t={}){if(!t.boundaries&&!t.startPosition)throw new y.a("model-tree-walker-no-start-position",null);const n=t.direction||"forward";if(n!="forward"&&n!="backward")throw new y.a("model-tree-walker-unknown-direction",t,{direction:n});this.direction=n,this.boundaries=t.boundaries||null,t.startPosition?this.position=t.startPosition.clone():this.position=L._createAt(this.boundaries[this.direction=="backward"?"end":"start"]),this.position.stickiness="toNone",this.singleCharacters=!!t.singleCharacters,this.shallow=!!t.shallow,this.ignoreElementEnd=!!t.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null,this._visitedParent=this.position.parent}[Symbol.iterator](){return this}skip(t){let n,o,r,c;do r=this.position,c=this._visitedParent,{done:n,value:o}=this.next();while(!n&&t(o));n||(this.position=r,this._visitedParent=c)}next(){return this.direction=="forward"?this._next():this._previous()}_next(){const t=this.position,n=this.position.clone(),o=this._visitedParent;if(o.parent===null&&n.offset===o.maxOffset)return{done:!0};if(o===this._boundaryEndParent&&n.offset==this.boundaries.end.offset)return{done:!0};const r=n.parent,c=Xi(n,r),u=c||sc(n,r,c);if(u instanceof mt)return this.shallow?n.offset++:(n.path.push(0),this._visitedParent=u),this.position=n,ai("elementStart",u,t,n,1);if(u instanceof kt){let g;if(this.singleCharacters)g=1;else{let w=u.endOffset;this._boundaryEndParent==o&&this.boundaries.end.offset<w&&(w=this.boundaries.end.offset),g=w-n.offset}const m=n.offset-u.startOffset,p=new nn(u,m,g);return n.offset+=g,this.position=n,ai("text",p,t,n,g)}return n.path.pop(),n.offset++,this.position=n,this._visitedParent=o.parent,this.ignoreElementEnd?this._next():ai("elementEnd",o,t,n)}_previous(){const t=this.position,n=this.position.clone(),o=this._visitedParent;if(o.parent===null&&n.offset===0)return{done:!0};if(o==this._boundaryStartParent&&n.offset==this.boundaries.start.offset)return{done:!0};const r=n.parent,c=Xi(n,r),u=c||Ff(n,r,c);if(u instanceof mt)return n.offset--,this.shallow?(this.position=n,ai("elementStart",u,t,n,1)):(n.path.push(u.maxOffset),this.position=n,this._visitedParent=u,this.ignoreElementEnd?this._previous():ai("elementEnd",u,t,n));if(u instanceof kt){let g;if(this.singleCharacters)g=1;else{let w=u.startOffset;this._boundaryStartParent==o&&this.boundaries.start.offset>w&&(w=this.boundaries.start.offset),g=n.offset-w}const m=n.offset-u.startOffset,p=new nn(u,m-g,g);return n.offset-=g,this.position=n,ai("text",p,t,n,g)}return n.path.pop(),this.position=n,this._visitedParent=o.parent,ai("elementStart",o,t,n,1)}}function ai(l,t,n,o,r){return{done:!1,value:{type:l,item:t,previousPosition:n,nextPosition:o,length:r}}}class L{constructor(t,n,o="toNone"){if(!t.is("element")&&!t.is("documentFragment"))throw new y.a("model-position-root-invalid",t);if(!(n instanceof Array)||n.length===0)throw new y.a("model-position-path-incorrect-format",t,{path:n});t.is("rootElement")?n=n.slice():(n=[...t.getPath(),...n],t=t.root),this.root=t,this.path=n,this.stickiness=o}get offset(){return this.path[this.path.length-1]}set offset(t){this.path[this.path.length-1]=t}get parent(){let t=this.root;for(let n=0;n<this.path.length-1;n++)if(t=t.getChild(t.offsetToIndex(this.path[n])),!t)throw new y.a("model-position-path-incorrect",this,{position:this});if(t.is("$text"))throw new y.a("model-position-path-incorrect",this,{position:this});return t}get index(){return this.parent.offsetToIndex(this.offset)}get textNode(){return Xi(this,this.parent)}get nodeAfter(){const t=this.parent;return sc(this,t,Xi(this,t))}get nodeBefore(){const t=this.parent;return Ff(this,t,Xi(this,t))}get isAtStart(){return this.offset===0}get isAtEnd(){return this.offset==this.parent.maxOffset}compareWith(t){if(this.root!=t.root)return"different";const n=se(this.path,t.path);switch(n){case"same":return"same";case"prefix":return"before";case"extension":return"after";default:return this.path[n]<t.path[n]?"before":"after"}}getLastMatchingPosition(t,n={}){n.startPosition=this;const o=new kn(n);return o.skip(t),o.position}getParentPath(){return this.path.slice(0,-1)}getAncestors(){const t=this.parent;return t.is("documentFragment")?[t]:t.getAncestors({includeSelf:!0})}findAncestor(t){const n=this.parent;return n.is("element")?n.findAncestor(t,{includeSelf:!0}):null}getCommonPath(t){if(this.root!=t.root)return[];const n=se(this.path,t.path),o=typeof n=="string"?Math.min(this.path.length,t.path.length):n;return this.path.slice(0,o)}getCommonAncestor(t){const n=this.getAncestors(),o=t.getAncestors();let r=0;for(;n[r]==o[r]&&n[r];)r++;return r===0?null:n[r-1]}getShiftedBy(t){const n=this.clone(),o=n.offset+t;return n.offset=o<0?0:o,n}isAfter(t){return this.compareWith(t)=="after"}isBefore(t){return this.compareWith(t)=="before"}isEqual(t){return this.compareWith(t)=="same"}isTouching(t){let n=null,o=null;switch(this.compareWith(t)){case"same":return!0;case"before":n=L._createAt(this),o=L._createAt(t);break;case"after":n=L._createAt(t),o=L._createAt(this);break;default:return!1}let r=n.parent;for(;n.path.length+o.path.length;){if(n.isEqual(o))return!0;if(n.path.length>o.path.length){if(n.offset!==r.maxOffset)return!1;n.path=n.path.slice(0,-1),r=r.parent,n.offset++}else{if(o.offset!==0)return!1;o.path=o.path.slice(0,-1)}}}is(t){return t==="position"||t==="model:position"}hasSameParentAs(t){return this.root!==t.root?!1:se(this.getParentPath(),t.getParentPath())=="same"}getTransformedByOperation(t){let n;switch(t.type){case"insert":n=this._getTransformedByInsertOperation(t);break;case"move":case"remove":case"reinsert":n=this._getTransformedByMoveOperation(t);break;case"split":n=this._getTransformedBySplitOperation(t);break;case"merge":n=this._getTransformedByMergeOperation(t);break;default:n=L._createAt(this)}return n}_getTransformedByInsertOperation(t){return this._getTransformedByInsertion(t.position,t.howMany)}_getTransformedByMoveOperation(t){return this._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany)}_getTransformedBySplitOperation(t){const n=t.movedRange;return n.containsPosition(this)||n.start.isEqual(this)&&this.stickiness=="toNext"?this._getCombined(t.splitPosition,t.moveTargetPosition):t.graveyardPosition?this._getTransformedByMove(t.graveyardPosition,t.insertionPosition,1):this._getTransformedByInsertion(t.insertionPosition,1)}_getTransformedByMergeOperation(t){const n=t.movedRange;let o;return n.containsPosition(this)||n.start.isEqual(this)?(o=this._getCombined(t.sourcePosition,t.targetPosition),t.sourcePosition.isBefore(t.targetPosition)&&(o=o._getTransformedByDeletion(t.deletionPosition,1))):o=this.isEqual(t.deletionPosition)?L._createAt(t.deletionPosition):this._getTransformedByMove(t.deletionPosition,t.graveyardPosition,1),o}_getTransformedByDeletion(t,n){const o=L._createAt(this);if(this.root!=t.root)return o;if(se(t.getParentPath(),this.getParentPath())=="same"){if(t.offset<this.offset){if(t.offset+n>this.offset)return null;o.offset-=n}}else if(se(t.getParentPath(),this.getParentPath())=="prefix"){const r=t.path.length-1;if(t.offset<=this.path[r]){if(t.offset+n>this.path[r])return null;o.path[r]-=n}}return o}_getTransformedByInsertion(t,n){const o=L._createAt(this);if(this.root!=t.root)return o;if(se(t.getParentPath(),this.getParentPath())=="same")(t.offset<this.offset||t.offset==this.offset&&this.stickiness!="toPrevious")&&(o.offset+=n);else if(se(t.getParentPath(),this.getParentPath())=="prefix"){const r=t.path.length-1;t.offset<=this.path[r]&&(o.path[r]+=n)}return o}_getTransformedByMove(t,n,o){if(n=n._getTransformedByDeletion(t,o),t.isEqual(n))return L._createAt(this);const r=this._getTransformedByDeletion(t,o);return r===null||t.isEqual(this)&&this.stickiness=="toNext"||t.getShiftedBy(o).isEqual(this)&&this.stickiness=="toPrevious"?this._getCombined(t,n):r._getTransformedByInsertion(n,o)}_getCombined(t,n){const o=t.path.length-1,r=L._createAt(n);return r.stickiness=this.stickiness,r.offset=r.offset+this.path[o]-t.offset,r.path=[...r.path,...this.path.slice(o+1)],r}toJSON(){return{root:this.root.toJSON(),path:Array.from(this.path),stickiness:this.stickiness}}clone(){return new this.constructor(this.root,this.path,this.stickiness)}static _createAt(t,n,o="toNone"){if(t instanceof L)return new L(t.root,t.path,t.stickiness);{const r=t;if(n=="end")n=r.maxOffset;else{if(n=="before")return this._createBefore(r,o);if(n=="after")return this._createAfter(r,o);if(n!==0&&!n)throw new y.a("model-createpositionat-offset-required",[this,t])}if(!r.is("element")&&!r.is("documentFragment"))throw new y.a("model-position-parent-incorrect",[this,t]);const c=r.getPath();return c.push(n),new this(r.root,c,o)}}static _createAfter(t,n){if(!t.parent)throw new y.a("model-position-after-root",[this,t],{root:t});return this._createAt(t.parent,t.endOffset,n)}static _createBefore(t,n){if(!t.parent)throw new y.a("model-position-before-root",t,{root:t});return this._createAt(t.parent,t.startOffset,n)}static fromJSON(t,n){if(t.root==="$graveyard"){const o=new L(n.graveyard,t.path);return o.stickiness=t.stickiness,o}if(!n.getRoot(t.root))throw new y.a("model-position-fromjson-no-root",n,{rootName:t.root});return new L(n.getRoot(t.root),t.path,t.stickiness)}}function Xi(l,t){const n=t.getChild(t.offsetToIndex(l.offset));return n&&n.is("$text")&&n.startOffset<l.offset?n:null}function sc(l,t,n){return n!==null?null:t.getChild(t.offsetToIndex(l.offset))}function Ff(l,t,n){return n!==null?null:t.getChild(t.offsetToIndex(l.offset)-1)}class O{constructor(t,n=null){this.start=L._createAt(t),this.end=n?L._createAt(n):L._createAt(t),this.start.stickiness=this.isCollapsed?"toNone":"toNext",this.end.stickiness=this.isCollapsed?"toNone":"toPrevious"}*[Symbol.iterator](){yield*new kn({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return se(this.start.getParentPath(),this.end.getParentPath())=="same"}get root(){return this.start.root}containsPosition(t){return t.isAfter(this.start)&&t.isBefore(this.end)}containsRange(t,n=!1){t.isCollapsed&&(n=!1);const o=this.containsPosition(t.start)||n&&this.start.isEqual(t.start),r=this.containsPosition(t.end)||n&&this.end.isEqual(t.end);return o&&r}containsItem(t){const n=L._createBefore(t);return this.containsPosition(n)||this.start.isEqual(n)}is(t){return t==="range"||t==="model:range"}isEqual(t){return this.start.isEqual(t.start)&&this.end.isEqual(t.end)}isIntersecting(t){return this.start.isBefore(t.end)&&this.end.isAfter(t.start)}getDifference(t){const n=[];return this.isIntersecting(t)?(this.containsPosition(t.start)&&n.push(new O(this.start,t.start)),this.containsPosition(t.end)&&n.push(new O(t.end,this.end))):n.push(new O(this.start,this.end)),n}getIntersection(t){if(this.isIntersecting(t)){let n=this.start,o=this.end;return this.containsPosition(t.start)&&(n=t.start),this.containsPosition(t.end)&&(o=t.end),new O(n,o)}return null}getJoined(t,n=!1){let o=this.isIntersecting(t);if(o||(o=this.start.isBefore(t.start)?n?this.end.isTouching(t.start):this.end.isEqual(t.start):n?t.end.isTouching(this.start):t.end.isEqual(this.start)),!o)return null;let r=this.start,c=this.end;return t.start.isBefore(r)&&(r=t.start),t.end.isAfter(c)&&(c=t.end),new O(r,c)}getMinimalFlatRanges(){const t=[],n=this.start.getCommonPath(this.end).length,o=L._createAt(this.start);let r=o.parent;for(;o.path.length>n+1;){const c=r.maxOffset-o.offset;c!==0&&t.push(new O(o,o.getShiftedBy(c))),o.path=o.path.slice(0,-1),o.offset++,r=r.parent}for(;o.path.length<=this.end.path.length;){const c=this.end.path[o.path.length-1],u=c-o.offset;u!==0&&t.push(new O(o,o.getShiftedBy(u))),o.offset=c,o.path.push(0)}return t}getWalker(t={}){return t.boundaries=this,new kn(t)}*getItems(t={}){t.boundaries=this,t.ignoreElementEnd=!0;const n=new kn(t);for(const o of n)yield o.item}*getPositions(t={}){t.boundaries=this;const n=new kn(t);yield n.position;for(const o of n)yield o.nextPosition}getTransformedByOperation(t){switch(t.type){case"insert":return this._getTransformedByInsertOperation(t);case"move":case"remove":case"reinsert":return this._getTransformedByMoveOperation(t);case"split":return[this._getTransformedBySplitOperation(t)];case"merge":return[this._getTransformedByMergeOperation(t)]}return[new O(this.start,this.end)]}getTransformedByOperations(t){const n=[new O(this.start,this.end)];for(const o of t)for(let r=0;r<n.length;r++){const c=n[r].getTransformedByOperation(o);n.splice(r,1,...c),r+=c.length-1}for(let o=0;o<n.length;o++){const r=n[o];for(let c=o+1;c<n.length;c++){const u=n[c];(r.containsRange(u)||u.containsRange(r)||r.isEqual(u))&&n.splice(c,1)}}return n}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;const t=this.start.nodeAfter,n=this.end.nodeBefore;return t&&t.is("element")&&t===n?t:null}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}clone(){return new this.constructor(this.start,this.end)}_getTransformedByInsertOperation(t,n=!1){return this._getTransformedByInsertion(t.position,t.howMany,n)}_getTransformedByMoveOperation(t,n=!1){const o=t.sourcePosition,r=t.howMany,c=t.targetPosition;return this._getTransformedByMove(o,c,r,n)}_getTransformedBySplitOperation(t){const n=this.start._getTransformedBySplitOperation(t);let o=this.end._getTransformedBySplitOperation(t);return this.end.isEqual(t.insertionPosition)&&(o=this.end.getShiftedBy(1)),n.root!=o.root&&(o=this.end.getShiftedBy(-1)),new O(n,o)}_getTransformedByMergeOperation(t){if(this.start.isEqual(t.targetPosition)&&this.end.isEqual(t.deletionPosition))return new O(this.start);let n=this.start._getTransformedByMergeOperation(t),o=this.end._getTransformedByMergeOperation(t);return n.root!=o.root&&(o=this.end.getShiftedBy(-1)),n.isAfter(o)?(t.sourcePosition.isBefore(t.targetPosition)?(n=L._createAt(o),n.offset=0):(t.deletionPosition.isEqual(n)||(o=t.deletionPosition),n=t.targetPosition),new O(n,o)):new O(n,o)}_getTransformedByInsertion(t,n,o=!1){if(o&&this.containsPosition(t))return[new O(this.start,t),new O(t.getShiftedBy(n),this.end._getTransformedByInsertion(t,n))];{const r=new O(this.start,this.end);return r.start=r.start._getTransformedByInsertion(t,n),r.end=r.end._getTransformedByInsertion(t,n),[r]}}_getTransformedByMove(t,n,o,r=!1){if(this.isCollapsed){const _=this.start._getTransformedByMove(t,n,o);return[new O(_)]}const c=O._createFromPositionAndShift(t,o),u=n._getTransformedByDeletion(t,o);if(this.containsPosition(n)&&!r&&(c.containsPosition(this.start)||c.containsPosition(this.end))){const _=this.start._getTransformedByMove(t,n,o),v=this.end._getTransformedByMove(t,n,o);return[new O(_,v)]}let g;const m=this.getDifference(c);let p=null;const w=this.getIntersection(c);if(m.length==1?p=new O(m[0].start._getTransformedByDeletion(t,o),m[0].end._getTransformedByDeletion(t,o)):m.length==2&&(p=new O(this.start,this.end._getTransformedByDeletion(t,o))),g=p?p._getTransformedByInsertion(u,o,w!==null||r):[],w){const _=new O(w.start._getCombined(c.start,u),w.end._getCombined(c.start,u));g.length==2?g.splice(1,0,_):g.push(_)}return g}_getTransformedByDeletion(t,n){let o=this.start._getTransformedByDeletion(t,n),r=this.end._getTransformedByDeletion(t,n);return o==null&&r==null?null:(o==null&&(o=t),r==null&&(r=t),new O(o,r))}static _createFromPositionAndShift(t,n){const o=t,r=t.getShiftedBy(n);return n>0?new this(o,r):new this(r,o)}static _createIn(t){return new this(L._createAt(t,0),L._createAt(t,t.maxOffset))}static _createOn(t){return this._createFromPositionAndShift(L._createBefore(t),t.offsetSize)}static _createFromRanges(t){if(t.length===0)throw new y.a("range-create-from-ranges-empty-array",null);if(t.length==1)return t[0].clone();const n=t[0];t.sort((c,u)=>c.start.isAfter(u.start)?1:-1);const o=t.indexOf(n),r=new this(n.start,n.end);if(o>0)for(let c=o-1;t[c].end.isEqual(r.start);c++)r.start=L._createAt(t[c].start);for(let c=o+1;c<t.length&&t[c].start.isEqual(r.end);c++)r.end=L._createAt(t[c].end);return r}static fromJSON(t,n){return new this(L.fromJSON(t.start,n),L.fromJSON(t.end,n))}}class rc{constructor(){this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._viewToModelLengthCallbacks=new Map,this._markerNameToElements=new Map,this._elementToMarkerNames=new Map,this._unboundMarkerNames=new Set,this.on("modelToViewPosition",(t,n)=>{if(n.viewPosition)return;const o=this._modelToViewMapping.get(n.modelPosition.parent);n.viewPosition=this.findPositionIn(o,n.modelPosition.offset)},{priority:"low"}),this.on("viewToModelPosition",(t,n)=>{if(n.modelPosition)return;const o=this.findMappedViewAncestor(n.viewPosition),r=this._viewToModelMapping.get(o),c=this._toModelOffset(n.viewPosition.parent,n.viewPosition.offset,o);n.modelPosition=L._createAt(r,c)},{priority:"low"})}bindElements(t,n){this._modelToViewMapping.set(t,n),this._viewToModelMapping.set(n,t)}unbindViewElement(t){const n=this.toModelElement(t);if(this._viewToModelMapping.delete(t),this._elementToMarkerNames.has(t))for(const o of this._elementToMarkerNames.get(t))this._unboundMarkerNames.add(o);this._modelToViewMapping.get(n)==t&&this._modelToViewMapping.delete(n)}unbindModelElement(t){const n=this.toViewElement(t);this._modelToViewMapping.delete(t),this._viewToModelMapping.get(n)==t&&this._viewToModelMapping.delete(n)}bindElementToMarker(t,n){const o=this._markerNameToElements.get(n)||new Set;o.add(t);const r=this._elementToMarkerNames.get(t)||new Set;r.add(n),this._markerNameToElements.set(n,o),this._elementToMarkerNames.set(t,r)}unbindElementFromMarkerName(t,n){const o=this._markerNameToElements.get(n);o&&(o.delete(t),o.size==0&&this._markerNameToElements.delete(n));const r=this._elementToMarkerNames.get(t);r&&(r.delete(n),r.size==0&&this._elementToMarkerNames.delete(t))}flushUnboundMarkerNames(){const t=Array.from(this._unboundMarkerNames);return this._unboundMarkerNames.clear(),t}clearBindings(){this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._markerNameToElements=new Map,this._elementToMarkerNames=new Map,this._unboundMarkerNames=new Set}toModelElement(t){return this._viewToModelMapping.get(t)}toViewElement(t){return this._modelToViewMapping.get(t)}toModelRange(t){return new O(this.toModelPosition(t.start),this.toModelPosition(t.end))}toViewRange(t){return new et(this.toViewPosition(t.start),this.toViewPosition(t.end))}toModelPosition(t){const n={viewPosition:t,mapper:this};return this.fire("viewToModelPosition",n),n.modelPosition}toViewPosition(t,n={isPhantom:!1}){const o={modelPosition:t,mapper:this,isPhantom:n.isPhantom};return this.fire("modelToViewPosition",o),o.viewPosition}markerNameToElements(t){const n=this._markerNameToElements.get(t);if(!n)return null;const o=new Set;for(const r of n)if(r.is("attributeElement"))for(const c of r.getElementsWithSameId())o.add(c);else o.add(r);return o}registerViewToModelLength(t,n){this._viewToModelLengthCallbacks.set(t,n)}findMappedViewAncestor(t){let n=t.parent;for(;!this._viewToModelMapping.has(n);)n=n.parent;return n}_toModelOffset(t,n,o){if(o!=t)return this._toModelOffset(t.parent,t.index,o)+this._toModelOffset(t,n,t);if(t.is("$text"))return n;let r=0;for(let c=0;c<n;c++)r+=this.getModelLength(t.getChild(c));return r}getModelLength(t){if(this._viewToModelLengthCallbacks.get(t.name))return this._viewToModelLengthCallbacks.get(t.name)(t);if(this._viewToModelMapping.has(t))return 1;if(t.is("$text"))return t.data.length;if(t.is("uiElement"))return 0;{let n=0;for(const o of t.getChildren())n+=this.getModelLength(o);return n}}findPositionIn(t,n){let o,r=0,c=0,u=0;if(t.is("$text"))return new H(t,n);for(;c<n;)o=t.getChild(u),r=this.getModelLength(o),c+=r,u++;return c==n?this._moveViewPositionToTextNode(new H(t,u)):this.findPositionIn(o,n-(c-r))}_moveViewPositionToTextNode(t){const n=t.nodeBefore,o=t.nodeAfter;return n instanceof _t?new H(n,n.data.length):o instanceof _t?new H(o,0):t}}tt(rc,D);class qr{constructor(){this._consumable=new Map,this._textProxyRegistry=new Map}add(t,n){n=Ur(n),t instanceof nn&&(t=this._getSymbolForTextProxy(t)),this._consumable.has(t)||this._consumable.set(t,new Map),this._consumable.get(t).set(n,!0)}consume(t,n){return n=Ur(n),t instanceof nn&&(t=this._getSymbolForTextProxy(t)),!!this.test(t,n)&&(this._consumable.get(t).set(n,!1),!0)}test(t,n){n=Ur(n),t instanceof nn&&(t=this._getSymbolForTextProxy(t));const o=this._consumable.get(t);if(o===void 0)return null;const r=o.get(n);return r===void 0?null:r}revert(t,n){n=Ur(n),t instanceof nn&&(t=this._getSymbolForTextProxy(t));const o=this.test(t,n);return o===!1?(this._consumable.get(t).set(n,!0),!0):o!==!0&&null}_getSymbolForTextProxy(t){let n=null;const o=this._textProxyRegistry.get(t.startOffset);if(o){const r=o.get(t.endOffset);r&&(n=r.get(t.parent))}return n||(n=this._addSymbolForTextProxy(t.startOffset,t.endOffset,t.parent)),n}_addSymbolForTextProxy(t,n,o){const r=Symbol("textProxySymbol");let c,u;return c=this._textProxyRegistry.get(t),c||(c=new Map,this._textProxyRegistry.set(t,c)),u=c.get(n),u||(u=new Map,c.set(n,u)),u.set(o,r),r}}function Ur(l){const t=l.split(":");return t[0]=="addMarker"||t[0]=="removeMarker"?l:t.length>1?t[0]+":"+t[1]:t[0]}class ac{constructor(t){this.conversionApi=Object.assign({dispatcher:this},t),this._reconversionEventsMapping=new Map}convertChanges(t,n,o){for(const c of t.getMarkersToRemove())this.convertMarkerRemove(c.name,c.range,o);const r=this._mapChangesWithAutomaticReconversion(t);for(const c of r)c.type==="insert"?this.convertInsert(O._createFromPositionAndShift(c.position,c.length),o):c.type==="remove"?this.convertRemove(c.position,c.length,c.name,o):c.type==="reconvert"?this.reconvertElement(c.element,o):this.convertAttribute(c.range,c.attributeKey,c.attributeOldValue,c.attributeNewValue,o);for(const c of this.conversionApi.mapper.flushUnboundMarkerNames()){const u=n.get(c).getRange();this.convertMarkerRemove(c,u,o),this.convertMarkerAdd(c,u,o)}for(const c of t.getMarkersToAdd())this.convertMarkerAdd(c.name,c.range,o)}convertInsert(t,n){this.conversionApi.writer=n,this.conversionApi.consumable=this._createInsertConsumable(t);for(const o of Array.from(t).map(zf))this._convertInsertWithAttributes(o);this._clearConversionApi()}convertRemove(t,n,o,r){this.conversionApi.writer=r,this.fire("remove:"+o,{position:t,length:n},this.conversionApi),this._clearConversionApi()}convertAttribute(t,n,o,r,c){this.conversionApi.writer=c,this.conversionApi.consumable=this._createConsumableForRange(t,"attribute:"+n);for(const u of t){const g={item:u.item,range:O._createFromPositionAndShift(u.previousPosition,u.length),attributeKey:n,attributeOldValue:o,attributeNewValue:r};this._testAndFire("attribute:"+n,g)}this._clearConversionApi()}reconvertElement(t,n){const o=O._createOn(t);this.conversionApi.writer=n,this.conversionApi.consumable=this._createInsertConsumable(o);const r=this.conversionApi.mapper,c=r.toViewElement(t);n.remove(c),this._convertInsertWithAttributes({item:t,range:o});const u=r.toViewElement(t);for(const g of O._createIn(t)){const{item:m}=g,p=iA(m,r);p?p.root!==u.root&&n.move(n.createRangeOn(p),r.toViewPosition(L._createBefore(m))):this._convertInsertWithAttributes(zf(g))}r.unbindViewElement(c),this._clearConversionApi()}convertSelection(t,n,o){const r=Array.from(n.getMarkersAtPosition(t.getFirstPosition()));if(this.conversionApi.writer=o,this.conversionApi.consumable=this._createSelectionConsumable(t,r),this.fire("selection",{selection:t},this.conversionApi),t.isCollapsed){for(const c of r){const u=c.getRange();if(!nA(t.getFirstPosition(),c,this.conversionApi.mapper))continue;const g={item:t,markerName:c.name,markerRange:u};this.conversionApi.consumable.test(t,"addMarker:"+c.name)&&this.fire("addMarker:"+c.name,g,this.conversionApi)}for(const c of t.getAttributeKeys()){const u={item:t,range:t.getFirstRange(),attributeKey:c,attributeOldValue:null,attributeNewValue:t.getAttribute(c)};this.conversionApi.consumable.test(t,"attribute:"+u.attributeKey)&&this.fire("attribute:"+u.attributeKey+":$text",u,this.conversionApi)}this._clearConversionApi()}else this._clearConversionApi()}convertMarkerAdd(t,n,o){if(n.root.rootName=="$graveyard")return;this.conversionApi.writer=o;const r="addMarker:"+t,c=new qr;if(c.add(n,r),this.conversionApi.consumable=c,this.fire(r,{markerName:t,markerRange:n},this.conversionApi),c.test(n,r)){this.conversionApi.consumable=this._createConsumableForRange(n,r);for(const u of n.getItems()){if(!this.conversionApi.consumable.test(u,r))continue;const g={item:u,range:O._createOn(u),markerName:t,markerRange:n};this.fire(r,g,this.conversionApi)}this._clearConversionApi()}else this._clearConversionApi()}convertMarkerRemove(t,n,o){n.root.rootName!="$graveyard"&&(this.conversionApi.writer=o,this.fire("removeMarker:"+t,{markerName:t,markerRange:n},this.conversionApi),this._clearConversionApi())}_mapReconversionTriggerEvent(t,n){this._reconversionEventsMapping.set(n,t)}_createInsertConsumable(t){const n=new qr;for(const o of t){const r=o.item;n.add(r,"insert");for(const c of r.getAttributeKeys())n.add(r,"attribute:"+c)}return n}_createConsumableForRange(t,n){const o=new qr;for(const r of t.getItems())o.add(r,n);return o}_createSelectionConsumable(t,n){const o=new qr;o.add(t,"selection");for(const r of n)o.add(t,"addMarker:"+r.name);for(const r of t.getAttributeKeys())o.add(t,"attribute:"+r);return o}_testAndFire(t,n){this.conversionApi.consumable.test(n.item,t)&&this.fire(function(o,r){const c=r.item.name||"$text";return`${o}:${c}`}(t,n),n,this.conversionApi)}_clearConversionApi(){delete this.conversionApi.writer,delete this.conversionApi.consumable}_convertInsertWithAttributes(t){this._testAndFire("insert",t);for(const n of t.item.getAttributeKeys())t.attributeKey=n,t.attributeOldValue=null,t.attributeNewValue=t.item.getAttribute(n),this._testAndFire("attribute:"+n,t)}_mapChangesWithAutomaticReconversion(t){const n=new Set,o=[];for(const r of t.getChanges()){const c=r.position||r.range.start,u=c.parent;if(Xi(c,u)){o.push(r);continue}const g=r.type==="attribute"?sc(c,u,null):u;if(g.is("$text")){o.push(r);continue}let m;if(m=r.type==="attribute"?`attribute:${r.attributeKey}:${g.name}`:`${r.type}:${r.name}`,this._isReconvertTriggerEvent(m,g.name)){if(n.has(g))continue;n.add(g),o.push({type:"reconvert",element:g})}else o.push(r)}return o}_isReconvertTriggerEvent(t,n){return this._reconversionEventsMapping.get(t)===n}}function nA(l,t,n){const o=t.getRange(),r=Array.from(l.getAncestors());return r.shift(),r.reverse(),!r.some(c=>{if(o.containsItem(c))return!!n.toViewElement(c).getCustomProperty("addHighlight")})}function zf(l){return{item:l.item,range:O._createFromPositionAndShift(l.previousPosition,l.length)}}function iA(l,t){if(l.is("textProxy")){const n=t.toViewPosition(L._createBefore(l)).parent;return n.is("$text")?n:null}return t.toViewElement(l)}tt(ac,D);class vn{constructor(t,n,o){this._lastRangeBackward=!1,this._ranges=[],this._attrs=new Map,t&&this.setTo(t,n,o)}get anchor(){if(this._ranges.length>0){const t=this._ranges[this._ranges.length-1];return this._lastRangeBackward?t.end:t.start}return null}get focus(){if(this._ranges.length>0){const t=this._ranges[this._ranges.length-1];return this._lastRangeBackward?t.start:t.end}return null}get isCollapsed(){return this._ranges.length===1&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}isEqual(t){if(this.rangeCount!=t.rangeCount)return!1;if(this.rangeCount===0)return!0;if(!this.anchor.isEqual(t.anchor)||!this.focus.isEqual(t.focus))return!1;for(const n of this._ranges){let o=!1;for(const r of t._ranges)if(n.isEqual(r)){o=!0;break}if(!o)return!1}return!0}*getRanges(){for(const t of this._ranges)yield new O(t.start,t.end)}getFirstRange(){let t=null;for(const n of this._ranges)t&&!n.start.isBefore(t.start)||(t=n);return t?new O(t.start,t.end):null}getLastRange(){let t=null;for(const n of this._ranges)t&&!n.end.isAfter(t.end)||(t=n);return t?new O(t.start,t.end):null}getFirstPosition(){const t=this.getFirstRange();return t?t.start.clone():null}getLastPosition(){const t=this.getLastRange();return t?t.end.clone():null}setTo(t,n,o){if(t===null)this._setRanges([]);else if(t instanceof vn)this._setRanges(t.getRanges(),t.isBackward);else if(t&&typeof t.getRanges=="function")this._setRanges(t.getRanges(),t.isBackward);else if(t instanceof O)this._setRanges([t],!!n&&!!n.backward);else if(t instanceof L)this._setRanges([new O(t)]);else if(t instanceof ri){const r=!!o&&!!o.backward;let c;if(n=="in")c=O._createIn(t);else if(n=="on")c=O._createOn(t);else{if(n===void 0)throw new y.a("model-selection-setto-required-second-parameter",[this,t]);c=new O(L._createAt(t,n))}this._setRanges([c],r)}else{if(!Ie(t))throw new y.a("model-selection-setto-not-selectable",[this,t]);this._setRanges(t,n&&!!n.backward)}}_setRanges(t,n=!1){const o=(t=Array.from(t)).some(r=>{if(!(r instanceof O))throw new y.a("model-selection-set-ranges-not-range",[this,t]);return this._ranges.every(c=>!c.isEqual(r))});if(t.length!==this._ranges.length||o){this._removeAllRanges();for(const r of t)this._pushRange(r);this._lastRangeBackward=!!n,this.fire("change:range",{directChange:!0})}}setFocus(t,n){if(this.anchor===null)throw new y.a("model-selection-setfocus-no-ranges",[this,t]);const o=L._createAt(t,n);if(o.compareWith(this.focus)=="same")return;const r=this.anchor;this._ranges.length&&this._popRange(),o.compareWith(r)=="before"?(this._pushRange(new O(o,r)),this._lastRangeBackward=!0):(this._pushRange(new O(r,o)),this._lastRangeBackward=!1),this.fire("change:range",{directChange:!0})}getAttribute(t){return this._attrs.get(t)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}hasAttribute(t){return this._attrs.has(t)}removeAttribute(t){this.hasAttribute(t)&&(this._attrs.delete(t),this.fire("change:attribute",{attributeKeys:[t],directChange:!0}))}setAttribute(t,n){this.getAttribute(t)!==n&&(this._attrs.set(t,n),this.fire("change:attribute",{attributeKeys:[t],directChange:!0}))}getSelectedElement(){return this.rangeCount!==1?null:this.getFirstRange().getContainedElement()}is(t){return t==="selection"||t==="model:selection"}*getSelectedBlocks(){const t=new WeakSet;for(const n of this.getRanges()){const o=$f(n.start,t);o&&lc(o,n)&&(yield o);for(const c of n.getWalker()){const u=c.item;c.type=="elementEnd"&&oA(u,t,n)&&(yield u)}const r=$f(n.end,t);r&&!n.end.isTouching(L._createAt(r,0))&&lc(r,n)&&(yield r)}}containsEntireContent(t=this.anchor.root){const n=L._createAt(t,0),o=L._createAt(t,"end");return n.isTouching(this.getFirstPosition())&&o.isTouching(this.getLastPosition())}_pushRange(t){this._checkRange(t),this._ranges.push(new O(t.start,t.end))}_checkRange(t){for(let n=0;n<this._ranges.length;n++)if(t.isIntersecting(this._ranges[n]))throw new y.a("model-selection-range-intersects",[this,t],{addedRange:t,intersectingRange:this._ranges[n]})}_removeAllRanges(){for(;this._ranges.length>0;)this._popRange()}_popRange(){this._ranges.pop()}}function jf(l,t){return!t.has(l)&&(t.add(l),l.root.document.model.schema.isBlock(l)&&l.parent)}function oA(l,t,n){return jf(l,t)&&lc(l,n)}function $f(l,t){const n=l.parent.root.document.model.schema,o=l.parent.getAncestors({parentFirst:!0,includeSelf:!0});let r=!1;const c=o.find(u=>!r&&(r=n.isLimit(u),!r&&jf(u,t)));return o.forEach(u=>t.add(u)),c}function lc(l,t){const n=function(o){const r=o.root.document.model.schema;let c=o.parent;for(;c;){if(r.isBlock(c))return c;c=c.parent}}(l);return n?!t.containsRange(O._createOn(n),!0):!0}tt(vn,D);class on extends O{constructor(t,n){super(t,n),sA.call(this)}detach(){this.stopListening()}is(t){return t==="liveRange"||t==="model:liveRange"||t=="range"||t==="model:range"}toRange(){return new O(this.start,this.end)}static fromRange(t){return new on(t.start,t.end)}}function sA(){this.listenTo(this.root.document.model,"applyOperation",(l,t)=>{const n=t[0];n.isDocumentOperation&&rA.call(this,n)},{priority:"low"})}function rA(l){const t=this.getTransformedByOperation(l),n=O._createFromRanges(t),o=!n.isEqual(this),r=function(u,g){switch(g.type){case"insert":return u.containsPosition(g.position);case"move":case"remove":case"reinsert":case"merge":return u.containsPosition(g.sourcePosition)||u.start.isEqual(g.sourcePosition)||u.containsPosition(g.targetPosition);case"split":return u.containsPosition(g.splitPosition)||u.containsPosition(g.insertionPosition)}return!1}(this,l);let c=null;if(o){n.root.rootName=="$graveyard"&&(c=l.type=="remove"?l.sourcePosition:l.deletionPosition);const u=this.toRange();this.start=n.start,this.end=n.end,this.fire("change:range",u,{deletionPosition:c})}else r&&this.fire("change:content",this.toRange(),{deletionPosition:c})}tt(on,D);class qe{constructor(t){this._selection=new aA(t),this._selection.delegate("change:range").to(this),this._selection.delegate("change:attribute").to(this),this._selection.delegate("change:marker").to(this)}get isCollapsed(){return this._selection.isCollapsed}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get rangeCount(){return this._selection.rangeCount}get hasOwnRange(){return this._selection.hasOwnRange}get isBackward(){return this._selection.isBackward}get isGravityOverridden(){return this._selection.isGravityOverridden}get markers(){return this._selection.markers}get _ranges(){return this._selection._ranges}getRanges(){return this._selection.getRanges()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getSelectedBlocks(){return this._selection.getSelectedBlocks()}getSelectedElement(){return this._selection.getSelectedElement()}containsEntireContent(t){return this._selection.containsEntireContent(t)}destroy(){this._selection.destroy()}getAttributeKeys(){return this._selection.getAttributeKeys()}getAttributes(){return this._selection.getAttributes()}getAttribute(t){return this._selection.getAttribute(t)}hasAttribute(t){return this._selection.hasAttribute(t)}refresh(){this._selection._updateMarkers(),this._selection._updateAttributes(!1)}observeMarkers(t){this._selection.observeMarkers(t)}is(t){return t==="selection"||t=="model:selection"||t=="documentSelection"||t=="model:documentSelection"}_setFocus(t,n){this._selection.setFocus(t,n)}_setTo(t,n,o){this._selection.setTo(t,n,o)}_setAttribute(t,n){this._selection.setAttribute(t,n)}_removeAttribute(t){this._selection.removeAttribute(t)}_getStoredAttributes(){return this._selection._getStoredAttributes()}_overrideGravity(){return this._selection.overrideGravity()}_restoreGravity(t){this._selection.restoreGravity(t)}static _getStoreAttributeKey(t){return"selection:"+t}static _isStoreAttributeKey(t){return t.startsWith("selection:")}}tt(qe,D);class aA extends vn{constructor(t){super(),this.markers=new Me({idProperty:"name"}),this._model=t.model,this._document=t,this._attributePriority=new Map,this._selectionRestorePosition=null,this._hasChangedRange=!1,this._overriddenGravityRegister=new Set,this._observedMarkers=new Set,this.listenTo(this._model,"applyOperation",(n,o)=>{const r=o[0];r.isDocumentOperation&&r.type!="marker"&&r.type!="rename"&&r.type!="noop"&&(this._ranges.length==0&&this._selectionRestorePosition&&this._fixGraveyardSelection(this._selectionRestorePosition),this._selectionRestorePosition=null,this._hasChangedRange&&(this._hasChangedRange=!1,this.fire("change:range",{directChange:!1})))},{priority:"lowest"}),this.on("change:range",()=>{for(const n of this.getRanges())if(!this._document._validateSelectionRange(n))throw new y.a("document-selection-wrong-position",this,{range:n})}),this.listenTo(this._model.markers,"update",(n,o,r,c)=>{this._updateMarker(o,c)}),this.listenTo(this._document,"change",(n,o)=>{(function(r,c){const u=r.document.differ;for(const g of u.getChanges()){if(g.type!="insert")continue;const m=g.position.parent;g.length===m.maxOffset&&r.enqueueChange(c,p=>{const w=Array.from(m.getAttributeKeys()).filter(_=>_.startsWith("selection:"));for(const _ of w)p.removeAttribute(_,m)})}})(this._model,o)})}get isCollapsed(){return this._ranges.length===0?this._document._getDefaultRange().isCollapsed:super.isCollapsed}get anchor(){return super.anchor||this._document._getDefaultRange().start}get focus(){return super.focus||this._document._getDefaultRange().end}get rangeCount(){return this._ranges.length?this._ranges.length:1}get hasOwnRange(){return this._ranges.length>0}get isGravityOverridden(){return!!this._overriddenGravityRegister.size}destroy(){for(let t=0;t<this._ranges.length;t++)this._ranges[t].detach();this.stopListening()}*getRanges(){this._ranges.length?yield*super.getRanges():yield this._document._getDefaultRange()}getFirstRange(){return super.getFirstRange()||this._document._getDefaultRange()}getLastRange(){return super.getLastRange()||this._document._getDefaultRange()}setTo(t,n,o){super.setTo(t,n,o),this._updateAttributes(!0),this._updateMarkers()}setFocus(t,n){super.setFocus(t,n),this._updateAttributes(!0),this._updateMarkers()}setAttribute(t,n){if(this._setAttribute(t,n)){const o=[t];this.fire("change:attribute",{attributeKeys:o,directChange:!0})}}removeAttribute(t){if(this._removeAttribute(t)){const n=[t];this.fire("change:attribute",{attributeKeys:n,directChange:!0})}}overrideGravity(){const t=k();return this._overriddenGravityRegister.add(t),this._overriddenGravityRegister.size===1&&this._updateAttributes(!0),t}restoreGravity(t){if(!this._overriddenGravityRegister.has(t))throw new y.a("document-selection-gravity-wrong-restore",this,{uid:t});this._overriddenGravityRegister.delete(t),this.isGravityOverridden||this._updateAttributes(!0)}observeMarkers(t){this._observedMarkers.add(t),this._updateMarkers()}_popRange(){this._ranges.pop().detach()}_pushRange(t){const n=this._prepareRange(t);n&&this._ranges.push(n)}_prepareRange(t){if(this._checkRange(t),t.root==this._document.graveyard)return;const n=on.fromRange(t);return n.on("change:range",(o,r,c)=>{if(this._hasChangedRange=!0,n.root==this._document.graveyard){this._selectionRestorePosition=c.deletionPosition;const u=this._ranges.indexOf(n);this._ranges.splice(u,1),n.detach()}}),n}_updateMarkers(){if(!this._observedMarkers.size)return;const t=[];let n=!1;for(const r of this._model.markers){const c=r.name.split(":",1)[0];if(!this._observedMarkers.has(c))continue;const u=r.getRange();for(const g of this.getRanges())u.containsRange(g,!g.isCollapsed)&&t.push(r)}const o=Array.from(this.markers);for(const r of t)this.markers.has(r)||(this.markers.add(r),n=!0);for(const r of Array.from(this.markers))t.includes(r)||(this.markers.remove(r),n=!0);n&&this.fire("change:marker",{oldMarkers:o,directChange:!1})}_updateMarker(t,n){const o=t.name.split(":",1)[0];if(!this._observedMarkers.has(o))return;let r=!1;const c=Array.from(this.markers),u=this.markers.has(t);if(n){let g=!1;for(const m of this.getRanges())if(n.containsRange(m,!m.isCollapsed)){g=!0;break}g&&!u?(this.markers.add(t),r=!0):!g&&u&&(this.markers.remove(t),r=!0)}else u&&(this.markers.remove(t),r=!0);r&&this.fire("change:marker",{oldMarkers:c,directChange:!1})}_updateAttributes(t){const n=bn(this._getSurroundingAttributes()),o=bn(this.getAttributes());if(t)this._attributePriority=new Map,this._attrs=new Map;else for(const[c,u]of this._attributePriority)u=="low"&&(this._attrs.delete(c),this._attributePriority.delete(c));this._setAttributesTo(n);const r=[];for(const[c,u]of this.getAttributes())o.has(c)&&o.get(c)===u||r.push(c);for(const[c]of o)this.hasAttribute(c)||r.push(c);r.length>0&&this.fire("change:attribute",{attributeKeys:r,directChange:!1})}_setAttribute(t,n,o=!0){const r=o?"normal":"low";return r=="low"&&this._attributePriority.get(t)=="normal"?!1:super.getAttribute(t)!==n&&(this._attrs.set(t,n),this._attributePriority.set(t,r),!0)}_removeAttribute(t,n=!0){const o=n?"normal":"low";return(o!="low"||this._attributePriority.get(t)!="normal")&&(this._attributePriority.set(t,o),!!super.hasAttribute(t)&&(this._attrs.delete(t),!0))}_setAttributesTo(t){const n=new Set;for(const[o,r]of this.getAttributes())t.get(o)!==r&&this._removeAttribute(o,!1);for(const[o,r]of t)this._setAttribute(o,r,!1)&&n.add(o);return n}*_getStoredAttributes(){const t=this.getFirstPosition().parent;if(this.isCollapsed&&t.isEmpty)for(const n of t.getAttributeKeys())n.startsWith("selection:")&&(yield[n.substr(10),t.getAttribute(n)])}_getSurroundingAttributes(){const t=this.getFirstPosition(),n=this._model.schema;let o=null;if(this.isCollapsed){const r=t.textNode?t.textNode:t.nodeBefore,c=t.textNode?t.textNode:t.nodeAfter;if(this.isGravityOverridden||(o=Gr(r)),o||(o=Gr(c)),!this.isGravityOverridden&&!o){let u=r;for(;u&&!n.isInline(u)&&!o;)u=u.previousSibling,o=Gr(u)}if(!o){let u=c;for(;u&&!n.isInline(u)&&!o;)u=u.nextSibling,o=Gr(u)}o||(o=this._getStoredAttributes())}else{const r=this.getFirstRange();for(const c of r){if(c.item.is("element")&&n.isObject(c.item))break;if(c.type=="text"){o=c.item.getAttributes();break}}}return o}_fixGraveyardSelection(t){const n=this._model.schema.getNearestSelectionRange(t);n&&this._pushRange(n)}}function Gr(l){return l instanceof nn||l instanceof kt?l.getAttributes():null}class Hf{constructor(t){this._dispatchers=t}add(t){for(const n of this._dispatchers)t(n);return this}}var sn=function(l){return Il(l,5)};class lA extends Hf{elementToElement(t){return this.add(function(n){return(n=sn(n)).view=Kr(n.view,"container"),o=>{var r;if(o.on("insert:"+n.model,(r=n.view,(c,u,g)=>{const m=r(u.item,g);if(!m||!g.consumable.consume(u.item,"insert"))return;const p=g.mapper.toViewPosition(u.range.start);g.mapper.bindElements(u.item,m),g.writer.insert(p,m)}),{priority:n.converterPriority||"normal"}),n.triggerBy){if(n.triggerBy.attributes)for(const c of n.triggerBy.attributes)o._mapReconversionTriggerEvent(n.model,`attribute:${c}:${n.model}`);if(n.triggerBy.children)for(const c of n.triggerBy.children)o._mapReconversionTriggerEvent(n.model,"insert:"+c),o._mapReconversionTriggerEvent(n.model,"remove:"+c)}}}(t))}attributeToElement(t){return this.add(function(n){n=sn(n);let o="attribute:"+(n.model.key?n.model.key:n.model);if(n.model.name&&(o+=":"+n.model.name),n.model.values)for(const c of n.model.values)n.view[c]=Kr(n.view[c],"attribute");else n.view=Kr(n.view,"attribute");const r=Uf(n);return c=>{c.on(o,function(u){return(g,m,p)=>{const w=u(m.attributeOldValue,p),_=u(m.attributeNewValue,p);if(!w&&!_||!p.consumable.consume(m.item,g.name))return;const v=p.writer,A=v.document.selection;if(m.item instanceof vn||m.item instanceof qe)v.wrap(A.getFirstRange(),_);else{let x=p.mapper.toViewRange(m.range);m.attributeOldValue!==null&&w&&(x=v.unwrap(x,w)),m.attributeNewValue!==null&&_&&v.wrap(x,_)}}}(r),{priority:n.converterPriority||"normal"})}}(t))}attributeToAttribute(t){return this.add(function(n){n=sn(n);let o="attribute:"+(n.model.key?n.model.key:n.model);if(n.model.name&&(o+=":"+n.model.name),n.model.values)for(const c of n.model.values)n.view[c]=Gf(n.view[c]);else n.view=Gf(n.view);const r=Uf(n);return c=>{var u;c.on(o,(u=r,(g,m,p)=>{const w=u(m.attributeOldValue,p),_=u(m.attributeNewValue,p);if(!w&&!_||!p.consumable.consume(m.item,g.name))return;const v=p.mapper.toViewElement(m.item),A=p.writer;if(!v)throw new y.a("conversion-attribute-to-attribute-on-text",[m,p]);if(m.attributeOldValue!==null&&w)if(w.key=="class"){const x=Kt(w.value);for(const E of x)A.removeClass(E,v)}else if(w.key=="style"){const x=Object.keys(w.value);for(const E of x)A.removeStyle(E,v)}else A.removeAttribute(w.key,v);if(m.attributeNewValue!==null&&_)if(_.key=="class"){const x=Kt(_.value);for(const E of x)A.addClass(E,v)}else if(_.key=="style"){const x=Object.keys(_.value);for(const E of x)A.setStyle(E,_.value[E],v)}else A.setAttribute(_.key,_.value,v)}),{priority:n.converterPriority||"normal"})}}(t))}markerToElement(t){return this.add(function(n){return(n=sn(n)).view=Kr(n.view,"ui"),o=>{var r;o.on("addMarker:"+n.model,(r=n.view,(c,u,g)=>{u.isOpening=!0;const m=r(u,g);u.isOpening=!1;const p=r(u,g);if(!m||!p)return;const w=u.markerRange;if(w.isCollapsed&&!g.consumable.consume(w,c.name))return;for(const A of w)if(!g.consumable.consume(A.item,c.name))return;const _=g.mapper,v=g.writer;v.insert(_.toViewPosition(w.start),m),g.mapper.bindElementToMarker(m,u.markerName),w.isCollapsed||(v.insert(_.toViewPosition(w.end),p),g.mapper.bindElementToMarker(p,u.markerName)),c.stop()}),{priority:n.converterPriority||"normal"}),o.on("removeMarker:"+n.model,(n.view,(c,u,g)=>{const m=g.mapper.markerNameToElements(u.markerName);if(m){for(const p of m)g.mapper.unbindElementFromMarkerName(p,u.markerName),g.writer.clear(g.writer.createRangeOn(p),p);g.writer.clearClonedElementsGroup(u.markerName),c.stop()}}),{priority:n.converterPriority||"normal"})}}(t))}markerToHighlight(t){return this.add(function(n){return o=>{var r;o.on("addMarker:"+n.model,(r=n.view,(c,u,g)=>{if(!u.item||!(u.item instanceof vn||u.item instanceof qe||u.item.is("$textProxy")))return;const m=cc(r,u,g);if(!m||!g.consumable.consume(u.item,c.name))return;const p=g.writer,w=Wf(p,m),_=p.document.selection;if(u.item instanceof vn||u.item instanceof qe)p.wrap(_.getFirstRange(),w,_);else{const v=g.mapper.toViewRange(u.range),A=p.wrap(v,w);for(const x of A.getItems())if(x.is("attributeElement")&&x.isSimilar(w)){g.mapper.bindElementToMarker(x,u.markerName);break}}}),{priority:n.converterPriority||"normal"}),o.on("addMarker:"+n.model,function(c){return(u,g,m)=>{if(!g.item||!(g.item instanceof mt))return;const p=cc(c,g,m);if(!p||!m.consumable.test(g.item,u.name))return;const w=m.mapper.toViewElement(g.item);if(w&&w.getCustomProperty("addHighlight")){m.consumable.consume(g.item,u.name);for(const _ of O._createIn(g.item))m.consumable.consume(_.item,u.name);w.getCustomProperty("addHighlight")(w,p,m.writer),m.mapper.bindElementToMarker(w,g.markerName)}}}(n.view),{priority:n.converterPriority||"normal"}),o.on("removeMarker:"+n.model,function(c){return(u,g,m)=>{if(g.markerRange.isCollapsed)return;const p=cc(c,g,m);if(!p)return;const w=Wf(m.writer,p),_=m.mapper.markerNameToElements(g.markerName);if(_){for(const v of _)m.mapper.unbindElementFromMarkerName(v,g.markerName),v.is("attributeElement")?m.writer.unwrap(m.writer.createRangeOn(v),w):v.getCustomProperty("removeHighlight")(v,p.id,m.writer);m.writer.clearClonedElementsGroup(g.markerName),u.stop()}}}(n.view),{priority:n.converterPriority||"normal"})}}(t))}markerToData(t){return this.add(function(n){const o=(n=sn(n)).model;return n.view||(n.view=r=>({group:o,name:r.substr(n.model.length+1)})),r=>{var c;r.on("addMarker:"+o,(c=n.view,(u,g,m)=>{const p=c(g.markerName,m);if(!p)return;const w=g.markerRange;m.consumable.consume(w,u.name)&&(qf(w,!1,m,g,p),qf(w,!0,m,g,p),u.stop())}),{priority:n.converterPriority||"normal"}),r.on("removeMarker:"+o,function(u){return(g,m,p)=>{const w=u(m.markerName,p);if(!w)return;const _=p.mapper.markerNameToElements(m.markerName);if(_){for(const A of _)p.mapper.unbindElementFromMarkerName(A,m.markerName),A.is("containerElement")?(v(`data-${w.group}-start-before`,A),v(`data-${w.group}-start-after`,A),v(`data-${w.group}-end-before`,A),v(`data-${w.group}-end-after`,A)):p.writer.clear(p.writer.createRangeOn(A),A);p.writer.clearClonedElementsGroup(m.markerName),g.stop()}function v(A,x){if(x.hasAttribute(A)){const E=new Set(x.getAttribute(A).split(","));E.delete(w.name),E.size==0?p.writer.removeAttribute(A,x):p.writer.setAttribute(A,Array.from(E).join(","),x)}}}}(n.view),{priority:n.converterPriority||"normal"})}}(t))}}function Wf(l,t){const n=l.createAttributeElement("span",t.attributes);return t.classes&&n._addClass(t.classes),typeof t.priority=="number"&&(n._priority=t.priority),n._id=t.id,n}function qf(l,t,n,o,r){const c=t?l.start:l.end,u=c.nodeAfter&&c.nodeAfter.is("element")?c.nodeAfter:null,g=c.nodeBefore&&c.nodeBefore.is("element")?c.nodeBefore:null;if(u||g){let m,p;t&&u||!t&&!g?(m=u,p=!0):(m=g,p=!1);const w=n.mapper.toViewElement(m);if(w)return void function(_,v,A,x,E,T){const S=`data-${T.group}-${v?"start":"end"}-${A?"before":"after"}`,I=_.hasAttribute(S)?_.getAttribute(S).split(","):[];I.unshift(T.name),x.writer.setAttribute(S,I.join(","),_),x.mapper.bindElementToMarker(_,E.markerName)}(w,t,p,n,o,r)}(function(m,p,w,_,v){const A=`${v.group}-${p?"start":"end"}`,x=v.name?{name:v.name}:null,E=w.writer.createUIElement(A,x);w.writer.insert(m,E),w.mapper.bindElementToMarker(E,_.markerName)})(n.mapper.toViewPosition(c),t,n,o,r)}function Kr(l,t){return typeof l=="function"?l:(n,o)=>function(r,c,u){typeof r=="string"&&(r={name:r});let g;const m=c.writer,p=Object.assign({},r.attributes);if(u=="container")g=m.createContainerElement(r.name,p);else if(u=="attribute"){const w={priority:r.priority||Ki.DEFAULT_PRIORITY};g=m.createAttributeElement(r.name,p,w)}else g=m.createUIElement(r.name,p);if(r.styles){const w=Object.keys(r.styles);for(const _ of w)m.setStyle(_,r.styles[_],g)}if(r.classes){const w=r.classes;if(typeof w=="string")m.addClass(w,g);else for(const _ of w)m.addClass(_,g)}return g}(l,o,t)}function Uf(l){return l.model.values?(t,n)=>{const o=l.view[t];return o?o(t,n):null}:l.view}function Gf(l){return typeof l=="string"?t=>({key:l,value:t}):typeof l=="object"?l.value?()=>l:t=>({key:l.key,value:t}):l}function cc(l,t,n){const o=typeof l=="function"?l(t,n):l;return o?(o.priority||(o.priority=10),o.id||(o.id=t.markerName),o):null}function Kf(l){const{schema:t,document:n}=l.model;for(const o of n.getRootNames()){const r=n.getRoot(o);if(r.isEmpty&&!t.checkChild(r,"$text")&&t.checkChild(r,"paragraph"))return l.insertElement("paragraph",r),!0}return!1}function Yf(l,t,n){const o=n.createContext(l);return!!n.checkChild(o,"paragraph")&&!!n.checkChild(o.push("paragraph"),t)}function Jf(l,t){const n=t.createElement("paragraph");return t.insert(n,l),t.createPositionAt(n,0)}class cA extends Hf{elementToElement(t){return this.add(Qf(t))}elementToAttribute(t){return this.add(function(n){Xf(n=sn(n));const o=Zf(n,!1),r=dc(n.view),c=r?"element:"+r:"element";return u=>{u.on(c,o,{priority:n.converterPriority||"low"})}}(t))}attributeToAttribute(t){return this.add(function(n){n=sn(n);let o=null;(typeof n.view=="string"||n.view.key)&&(o=function(c){typeof c.view=="string"&&(c.view={key:c.view});const u=c.view.key;let g;if(u=="class"||u=="style")g={[u=="class"?"classes":"styles"]:c.view.value};else{const m=c.view.value===void 0?/[\s\S]*/:c.view.value;g={attributes:{[u]:m}}}return c.view.name&&(g.name=c.view.name),c.view=g,u}(n)),Xf(n,o);const r=Zf(n,!0);return c=>{c.on("element",r,{priority:n.converterPriority||"low"})}}(t))}elementToMarker(t){return this.add(function(n){return function(o){const r=o.model;o.model=(c,u)=>{const g=typeof r=="string"?r:r(c,u);return u.writer.createElement("$marker",{"data-name":g})}}(n=sn(n)),Qf(n)}(t))}dataToMarker(t){return this.add(function(n){(n=sn(n)).model||(n.model=c=>c?n.view+":"+c:n.view);const o=uc(tg(n,"start")),r=uc(tg(n,"end"));return c=>{c.on("element:"+n.view+"-start",o,{priority:n.converterPriority||"normal"}),c.on("element:"+n.view+"-end",r,{priority:n.converterPriority||"normal"});const u=C.get("low"),g=C.get("highest"),m=C.get(n.converterPriority)/g;c.on("element",function(p){return(w,_,v)=>{const A="data-"+p.view;function x(E,T){for(const S of T){const I=p.model(S,v),N=v.writer.createElement("$marker",{"data-name":I});v.writer.insert(N,E),_.modelCursor.isEqual(E)?_.modelCursor=_.modelCursor.getShiftedBy(1):_.modelCursor=_.modelCursor._getTransformedByInsertion(E,1),_.modelRange=_.modelRange._getTransformedByInsertion(E,1)[0]}}(v.consumable.test(_.viewItem,{attributes:A+"-end-after"})||v.consumable.test(_.viewItem,{attributes:A+"-start-after"})||v.consumable.test(_.viewItem,{attributes:A+"-end-before"})||v.consumable.test(_.viewItem,{attributes:A+"-start-before"}))&&(_.modelRange||Object.assign(_,v.convertChildren(_.viewItem,_.modelCursor)),v.consumable.consume(_.viewItem,{attributes:A+"-end-after"})&&x(_.modelRange.end,_.viewItem.getAttribute(A+"-end-after").split(",")),v.consumable.consume(_.viewItem,{attributes:A+"-start-after"})&&x(_.modelRange.end,_.viewItem.getAttribute(A+"-start-after").split(",")),v.consumable.consume(_.viewItem,{attributes:A+"-end-before"})&&x(_.modelRange.start,_.viewItem.getAttribute(A+"-end-before").split(",")),v.consumable.consume(_.viewItem,{attributes:A+"-start-before"})&&x(_.modelRange.start,_.viewItem.getAttribute(A+"-start-before").split(",")))}}(n),{priority:u+m})}}(t))}}function Qf(l){const t=uc(l=sn(l)),n=dc(l.view),o=n?"element:"+n:"element";return r=>{r.on(o,t,{priority:l.converterPriority||"normal"})}}function dc(l){return typeof l=="string"?l:typeof l=="object"&&typeof l.name=="string"?l.name:null}function uc(l){const t=new tn(l.view);return(n,o,r)=>{const c=t.match(o.viewItem);if(!c)return;const u=c.match;if(u.name=!0,!r.consumable.test(o.viewItem,u))return;const g=function(m,p,w){return m instanceof Function?m(p,w):w.writer.createElement(m)}(l.model,o.viewItem,r);g&&r.safeInsert(g,o.modelCursor)&&(r.consumable.consume(o.viewItem,u),r.convertChildren(o.viewItem,g),r.updateConversionResult(g,o))}}function Xf(l,t=null){const n=t===null||(c=>c.getAttribute(t)),o=typeof l.model!="object"?l.model:l.model.key,r=typeof l.model!="object"||l.model.value===void 0?n:l.model.value;l.model={key:o,value:r}}function Zf(l,t){const n=new tn(l.view);return(o,r,c)=>{const u=n.match(r.viewItem);if(!u||(function(p,w){const _=typeof p=="function"?p(w):p;return typeof _=="object"&&!dc(_)?!1:!_.classes&&!_.attributes&&!_.styles}(l.view,r.viewItem)?u.match.name=!0:delete u.match.name,!c.consumable.test(r.viewItem,u.match)))return;const g=l.model.key,m=typeof l.model.value=="function"?l.model.value(r.viewItem,c):l.model.value;m!==null&&(r.modelRange||Object.assign(r,c.convertChildren(r.viewItem,r.modelCursor)),function(p,w,_,v){let A=!1;for(const x of Array.from(p.getItems({shallow:_})))v.schema.checkAttribute(x,w.key)&&(A=!0,x.hasAttribute(w.key)||v.writer.setAttribute(w.key,w.value,x));return A}(r.modelRange,{key:g,value:m},t,c)&&c.consumable.consume(r.viewItem,u.match))}}function tg(l,t){const n={};return n.view=l.view+"-"+t,n.model=(o,r)=>{const c=o.getAttribute("name"),u=l.model(c,r);return r.writer.createElement("$marker",{"data-name":u})},n}class eg{constructor(t,n){this.model=t,this.view=new Bf(n),this.mapper=new rc,this.downcastDispatcher=new ac({mapper:this.mapper,schema:t.schema});const o=this.model.document,r=o.selection,c=this.model.markers;this.listenTo(this.model,"_beforeChanges",()=>{this.view._disableRendering(!0)},{priority:"highest"}),this.listenTo(this.model,"_afterChanges",()=>{this.view._disableRendering(!1)},{priority:"lowest"}),this.listenTo(o,"change",()=>{this.view.change(u=>{this.downcastDispatcher.convertChanges(o.differ,c,u),this.downcastDispatcher.convertSelection(r,c,u)})},{priority:"low"}),this.listenTo(this.view.document,"selectionChange",function(u,g){return(m,p)=>{const w=p.newSelection,_=[];for(const A of w.getRanges())_.push(g.toModelRange(A));const v=u.createSelection(_,{backward:w.isBackward});v.isEqual(u.document.selection)||u.change(A=>{A.setSelection(v)})}}(this.model,this.mapper)),this.downcastDispatcher.on("insert:$text",(u,g,m)=>{if(!m.consumable.consume(g.item,"insert"))return;const p=m.writer,w=m.mapper.toViewPosition(g.range.start),_=p.createText(g.item.data);p.insert(w,_)},{priority:"lowest"}),this.downcastDispatcher.on("remove",(u,g,m)=>{const p=m.mapper.toViewPosition(g.position),w=g.position.getShiftedBy(g.length),_=m.mapper.toViewPosition(w,{isPhantom:!0}),v=m.writer.createRange(p,_),A=m.writer.remove(v.getTrimmed());for(const x of m.writer.createRangeIn(A).getItems())m.mapper.unbindViewElement(x)},{priority:"low"}),this.downcastDispatcher.on("selection",(u,g,m)=>{const p=m.writer,w=p.document.selection;for(const _ of w.getRanges())_.isCollapsed&&_.end.parent.isAttached()&&m.writer.mergeAttributes(_.start);p.setSelection(null)},{priority:"high"}),this.downcastDispatcher.on("selection",(u,g,m)=>{const p=g.selection;if(p.isCollapsed||!m.consumable.consume(p,"selection"))return;const w=[];for(const _ of p.getRanges()){const v=m.mapper.toViewRange(_);w.push(v)}m.writer.setSelection(w,{backward:p.isBackward})},{priority:"low"}),this.downcastDispatcher.on("selection",(u,g,m)=>{const p=g.selection;if(!p.isCollapsed||!m.consumable.consume(p,"selection"))return;const w=m.writer,_=p.getFirstPosition(),v=m.mapper.toViewPosition(_),A=w.breakAttributes(v);w.setSelection(A)},{priority:"low"}),this.view.document.roots.bindTo(this.model.document.roots).using(u=>{if(u.rootName=="$graveyard")return null;const g=new l1(this.view.document,u.name);return g.rootName=u.rootName,this.mapper.bindElements(u,g),g})}destroy(){this.view.destroy(),this.stopListening()}}tt(eg,yt);class dA{constructor(){this._commands=new Map}add(t,n){this._commands.set(t,n)}get(t){return this._commands.get(t)}execute(t,...n){const o=this.get(t);if(!o)throw new y.a("commandcollection-command-not-found",this,{commandName:t});return o.execute(...n)}*names(){yield*this._commands.keys()}*commands(){yield*this._commands.values()}[Symbol.iterator](){return this._commands[Symbol.iterator]()}destroy(){for(const t of this.commands())t.destroy()}}class is{constructor(){this._consumables=new Map}add(t,n){let o;t.is("$text")||t.is("documentFragment")?this._consumables.set(t,!0):(this._consumables.has(t)?o=this._consumables.get(t):(o=new uA(t),this._consumables.set(t,o)),o.add(n))}test(t,n){const o=this._consumables.get(t);return o===void 0?null:t.is("$text")||t.is("documentFragment")?o:o.test(n)}consume(t,n){return!!this.test(t,n)&&(t.is("$text")||t.is("documentFragment")?this._consumables.set(t,!1):this._consumables.get(t).consume(n),!0)}revert(t,n){const o=this._consumables.get(t);o!==void 0&&(t.is("$text")||t.is("documentFragment")?this._consumables.set(t,!0):o.revert(n))}static consumablesFromElement(t){const n={element:t,name:!0,attributes:[],classes:[],styles:[]},o=t.getAttributeKeys();for(const u of o)u!="style"&&u!="class"&&n.attributes.push(u);const r=t.getClassNames();for(const u of r)n.classes.push(u);const c=t.getStyleNames();for(const u of c)n.styles.push(u);return n}static createFrom(t,n){if(n||(n=new is(t)),t.is("$text"))return n.add(t),n;t.is("element")&&n.add(t,is.consumablesFromElement(t)),t.is("documentFragment")&&n.add(t);for(const o of t.getChildren())n=is.createFrom(o,n);return n}}class uA{constructor(t){this.element=t,this._canConsumeName=null,this._consumables={attributes:new Map,styles:new Map,classes:new Map}}add(t){t.name&&(this._canConsumeName=!0);for(const n in this._consumables)n in t&&this._add(n,t[n])}test(t){if(t.name&&!this._canConsumeName)return this._canConsumeName;for(const n in this._consumables)if(n in t){const o=this._test(n,t[n]);if(o!==!0)return o}return!0}consume(t){t.name&&(this._canConsumeName=!1);for(const n in this._consumables)n in t&&this._consume(n,t[n])}revert(t){t.name&&(this._canConsumeName=!0);for(const n in this._consumables)n in t&&this._revert(n,t[n])}_add(t,n){const o=ce(n)?n:[n],r=this._consumables[t];for(const c of o){if(t==="attributes"&&(c==="class"||c==="style"))throw new y.a("viewconsumable-invalid-attribute",this);if(r.set(c,!0),t==="styles")for(const u of this.element.document.stylesProcessor.getRelatedStyles(c))r.set(u,!0)}}_test(t,n){const o=ce(n)?n:[n],r=this._consumables[t];for(const c of o)if(t!=="attributes"||c!=="class"&&c!=="style"){const u=r.get(c);if(u===void 0)return null;if(!u)return!1}else{const u=c=="class"?"classes":"styles",g=this._test(u,[...this._consumables[u].keys()]);if(g!==!0)return g}return!0}_consume(t,n){const o=ce(n)?n:[n],r=this._consumables[t];for(const c of o)if(t!=="attributes"||c!=="class"&&c!=="style"){if(r.set(c,!1),t=="styles")for(const u of this.element.document.stylesProcessor.getRelatedStyles(c))r.set(u,!1)}else{const u=c=="class"?"classes":"styles";this._consume(u,[...this._consumables[u].keys()])}}_revert(t,n){const o=ce(n)?n:[n],r=this._consumables[t];for(const c of o)if(t!=="attributes"||c!=="class"&&c!=="style")r.get(c)===!1&&r.set(c,!0);else{const u=c=="class"?"classes":"styles";this._revert(u,[...this._consumables[u].keys()])}}}class ng{constructor(){this._sourceDefinitions={},this._attributeProperties={},this.decorate("checkChild"),this.decorate("checkAttribute"),this.on("checkAttribute",(t,n)=>{n[0]=new li(n[0])},{priority:"highest"}),this.on("checkChild",(t,n)=>{n[0]=new li(n[0]),n[1]=this.getDefinition(n[1])},{priority:"highest"})}register(t,n){if(this._sourceDefinitions[t])throw new y.a("schema-cannot-register-item-twice",this,{itemName:t});this._sourceDefinitions[t]=[Object.assign({},n)],this._clearCache()}extend(t,n){if(!this._sourceDefinitions[t])throw new y.a("schema-cannot-extend-missing-item",this,{itemName:t});this._sourceDefinitions[t].push(Object.assign({},n)),this._clearCache()}getDefinitions(){return this._compiledDefinitions||this._compile(),this._compiledDefinitions}getDefinition(t){let n;return n=typeof t=="string"?t:t.is&&(t.is("$text")||t.is("$textProxy"))?"$text":t.name,this.getDefinitions()[n]}isRegistered(t){return!!this.getDefinition(t)}isBlock(t){const n=this.getDefinition(t);return!(!n||!n.isBlock)}isLimit(t){const n=this.getDefinition(t);return!!n&&!(!n.isLimit&&!n.isObject)}isObject(t){const n=this.getDefinition(t);return!!n&&!!(n.isObject||n.isLimit&&n.isSelectable&&n.isContent)}isInline(t){const n=this.getDefinition(t);return!(!n||!n.isInline)}isSelectable(t){const n=this.getDefinition(t);return!!n&&!(!n.isSelectable&&!n.isObject)}isContent(t){const n=this.getDefinition(t);return!!n&&!(!n.isContent&&!n.isObject)}checkChild(t,n){return!!n&&this._checkContextMatch(n,t)}checkAttribute(t,n){const o=this.getDefinition(t.last);return!!o&&o.allowAttributes.includes(n)}checkMerge(t,n=null){if(t instanceof L){const o=t.nodeBefore,r=t.nodeAfter;if(!(o instanceof mt))throw new y.a("schema-check-merge-no-element-before",this);if(!(r instanceof mt))throw new y.a("schema-check-merge-no-element-after",this);return this.checkMerge(o,r)}for(const o of n.getChildren())if(!this.checkChild(t,o))return!1;return!0}addChildCheck(t){this.on("checkChild",(n,[o,r])=>{if(!r)return;const c=t(o,r);typeof c=="boolean"&&(n.stop(),n.return=c)},{priority:"high"})}addAttributeCheck(t){this.on("checkAttribute",(n,[o,r])=>{const c=t(o,r);typeof c=="boolean"&&(n.stop(),n.return=c)},{priority:"high"})}setAttributeProperties(t,n){this._attributeProperties[t]=Object.assign(this.getAttributeProperties(t),n)}getAttributeProperties(t){return this._attributeProperties[t]||{}}getLimitElement(t){let n;for(t instanceof L?n=t.parent:n=(t instanceof O?[t]:Array.from(t.getRanges())).reduce((o,r)=>{const c=r.getCommonAncestor();return o?o.getCommonAncestor(c,{includeSelf:!0}):c},null);!this.isLimit(n)&&n.parent;)n=n.parent;return n}checkAttributeInSelection(t,n){if(t.isCollapsed){const o=[...t.getFirstPosition().getAncestors(),new kt("",t.getAttributes())];return this.checkAttribute(o,n)}{const o=t.getRanges();for(const r of o)for(const c of r)if(this.checkAttribute(c.item,n))return!0}return!1}*getValidRanges(t,n){t=function*(o){for(const r of o)yield*r.getMinimalFlatRanges()}(t);for(const o of t)yield*this._getValidRangesForRange(o,n)}getNearestSelectionRange(t,n="both"){if(this.checkChild(t,"$text"))return new O(t);let o,r;const c=t.getAncestors().reverse().find(u=>this.isLimit(u))||t.root;n!="both"&&n!="backward"||(o=new kn({boundaries:O._createIn(c),startPosition:t,direction:"backward"})),n!="both"&&n!="forward"||(r=new kn({boundaries:O._createIn(c),startPosition:t}));for(const u of function*(g,m){let p=!1;for(;!p;){if(p=!0,g){const w=g.next();w.done||(p=!1,yield{walker:g,value:w.value})}if(m){const w=m.next();w.done||(p=!1,yield{walker:m,value:w.value})}}}(o,r)){const g=u.walker==o?"elementEnd":"elementStart",m=u.value;if(m.type==g&&this.isObject(m.item))return O._createOn(m.item);if(this.checkChild(m.nextPosition,"$text"))return new O(m.nextPosition)}return null}findAllowedParent(t,n){let o=t.parent;for(;o;){if(this.checkChild(o,n))return o;if(this.isLimit(o))return null;o=o.parent}return null}removeDisallowedAttributes(t,n){for(const o of t)if(o.is("$text"))ig(this,o,n);else{const r=O._createIn(o).getPositions();for(const c of r)ig(this,c.nodeBefore||c.parent,n)}}createContext(t){return new li(t)}_clearCache(){this._compiledDefinitions=null}_compile(){const t={},n=this._sourceDefinitions,o=Object.keys(n);for(const r of o)t[r]=hA(n[r],r);for(const r of o)fA(t,r);for(const r of o)gA(t,r);for(const r of o)mA(t,r);for(const r of o)pA(t,r),bA(t,r);for(const r of o)wA(t,r),_A(t,r),kA(t,r);this._compiledDefinitions=t}_checkContextMatch(t,n,o=n.length-1){const r=n.getItem(o);if(t.allowIn.includes(r.name)){if(o==0)return!0;{const c=this.getDefinition(r);return this._checkContextMatch(c,n,o-1)}}return!1}*_getValidRangesForRange(t,n){let o=t.start,r=t.start;for(const c of t.getItems({shallow:!0}))c.is("element")&&(yield*this._getValidRangesForRange(O._createIn(c),n)),this.checkAttribute(c,n)||(o.isEqual(r)||(yield new O(o,r)),o=L._createAfter(c)),r=L._createAfter(c);o.isEqual(r)||(yield new O(o,r))}}tt(ng,yt);class li{constructor(t){if(t instanceof li)return t;typeof t=="string"?t=[t]:Array.isArray(t)||(t=t.getAncestors({includeSelf:!0})),this._items=t.map(yA)}get length(){return this._items.length}get last(){return this._items[this._items.length-1]}[Symbol.iterator](){return this._items[Symbol.iterator]()}push(t){const n=new li([t]);return n._items=[...this._items,...n._items],n}getItem(t){return this._items[t]}*getNames(){yield*this._items.map(t=>t.name)}endsWith(t){return Array.from(this.getNames()).join(" ").endsWith(t)}startsWith(t){return Array.from(this.getNames()).join(" ").startsWith(t)}}function hA(l,t){const n={name:t,allowIn:[],allowContentOf:[],allowWhere:[],allowAttributes:[],allowAttributesOf:[],allowChildren:[],inheritTypesFrom:[]};return function(o,r){for(const c of o){const u=Object.keys(c).filter(g=>g.startsWith("is"));for(const g of u)r[g]=c[g]}}(l,n),ci(l,n,"allowIn"),ci(l,n,"allowContentOf"),ci(l,n,"allowWhere"),ci(l,n,"allowAttributes"),ci(l,n,"allowAttributesOf"),ci(l,n,"allowChildren"),ci(l,n,"inheritTypesFrom"),function(o,r){for(const c of o){const u=c.inheritAllFrom;u&&(r.allowContentOf.push(u),r.allowWhere.push(u),r.allowAttributesOf.push(u),r.inheritTypesFrom.push(u))}}(l,n),n}function fA(l,t){const n=l[t];for(const o of n.allowChildren){const r=l[o];r&&r.allowIn.push(t)}n.allowChildren.length=0}function gA(l,t){for(const n of l[t].allowContentOf)l[n]&&vA(l,n).forEach(o=>{o.allowIn.push(t)});delete l[t].allowContentOf}function mA(l,t){for(const n of l[t].allowWhere){const o=l[n];if(o){const r=o.allowIn;l[t].allowIn.push(...r)}}delete l[t].allowWhere}function pA(l,t){for(const n of l[t].allowAttributesOf){const o=l[n];if(o){const r=o.allowAttributes;l[t].allowAttributes.push(...r)}}delete l[t].allowAttributesOf}function bA(l,t){const n=l[t];for(const o of n.inheritTypesFrom){const r=l[o];if(r){const c=Object.keys(r).filter(u=>u.startsWith("is"));for(const u of c)u in n||(n[u]=r[u])}}delete n.inheritTypesFrom}function wA(l,t){const n=l[t],o=n.allowIn.filter(r=>l[r]);n.allowIn=Array.from(new Set(o))}function _A(l,t){const n=l[t];for(const o of n.allowIn)l[o].allowChildren.push(t)}function kA(l,t){const n=l[t];n.allowAttributes=Array.from(new Set(n.allowAttributes))}function ci(l,t,n){for(const o of l)typeof o[n]=="string"?t[n].push(o[n]):Array.isArray(o[n])&&t[n].push(...o[n])}function vA(l,t){const n=l[t];return(o=l,Object.keys(o).map(r=>o[r])).filter(r=>r.allowIn.includes(n.name));var o}function yA(l){return typeof l=="string"||l.is("documentFragment")?{name:typeof l=="string"?l:"$documentFragment",*getAttributeKeys(){},getAttribute(){}}:{name:l.is("element")?l.name:"$text",*getAttributeKeys(){yield*l.getAttributeKeys()},getAttribute:t=>l.getAttribute(t)}}function ig(l,t,n){for(const o of t.getAttributeKeys())l.checkAttribute(t,o)||n.removeAttribute(o,t)}class og{constructor(t={}){this._splitParts=new Map,this._cursorParents=new Map,this._modelCursor=null,this.conversionApi=Object.assign({},t),this.conversionApi.convertItem=this._convertItem.bind(this),this.conversionApi.convertChildren=this._convertChildren.bind(this),this.conversionApi.safeInsert=this._safeInsert.bind(this),this.conversionApi.updateConversionResult=this._updateConversionResult.bind(this),this.conversionApi.splitToAllowedParent=this._splitToAllowedParent.bind(this),this.conversionApi.getSplitParts=this._getSplitParts.bind(this)}convert(t,n,o=["$root"]){this.fire("viewCleanup",t),this._modelCursor=function(u,g){let m;for(const p of new li(u)){const w={};for(const v of p.getAttributeKeys())w[v]=p.getAttribute(v);const _=g.createElement(p.name,w);m&&g.append(_,m),m=L._createAt(_,0)}return m}(o,n),this.conversionApi.writer=n,this.conversionApi.consumable=is.createFrom(t),this.conversionApi.store={};const{modelRange:r}=this._convertItem(t,this._modelCursor),c=n.createDocumentFragment();if(r){this._removeEmptyElements();for(const u of Array.from(this._modelCursor.parent.getChildren()))n.append(u,c);c.markers=function(u,g){const m=new Set,p=new Map,w=O._createIn(u).getItems();for(const _ of w)_.name=="$marker"&&m.add(_);for(const _ of m){const v=_.getAttribute("data-name"),A=g.createPositionBefore(_);p.has(v)?p.get(v).end=A.clone():p.set(v,new O(A.clone())),g.remove(_)}return p}(c,n)}return this._modelCursor=null,this._splitParts.clear(),this._cursorParents.clear(),this.conversionApi.writer=null,this.conversionApi.store=null,c}_convertItem(t,n){const o=Object.assign({viewItem:t,modelCursor:n,modelRange:null});if(t.is("element")?this.fire("element:"+t.name,o,this.conversionApi):t.is("$text")?this.fire("text",o,this.conversionApi):this.fire("documentFragment",o,this.conversionApi),o.modelRange&&!(o.modelRange instanceof O))throw new y.a("view-conversion-dispatcher-incorrect-result",this);return{modelRange:o.modelRange,modelCursor:o.modelCursor}}_convertChildren(t,n){let o=n.is("position")?n:L._createAt(n,0);const r=new O(o);for(const c of Array.from(t.getChildren())){const u=this._convertItem(c,o);u.modelRange instanceof O&&(r.end=u.modelRange.end,o=u.modelCursor)}return{modelRange:r,modelCursor:o}}_safeInsert(t,n){const o=this._splitToAllowedParent(t,n);return!!o&&(this.conversionApi.writer.insert(t,o.position),!0)}_updateConversionResult(t,n){const o=this._getSplitParts(t),r=this.conversionApi.writer;n.modelRange||(n.modelRange=r.createRange(r.createPositionBefore(t),r.createPositionAfter(o[o.length-1])));const c=this._cursorParents.get(t);n.modelCursor=c?r.createPositionAt(c,0):n.modelRange.end}_splitToAllowedParent(t,n){const{schema:o,writer:r}=this.conversionApi;let c=o.findAllowedParent(n,t);if(c){if(c===n.parent)return{position:n};this._modelCursor.parent.getAncestors().includes(c)&&(c=null)}if(!c)return Yf(n,t,o)?{position:Jf(n,r)}:null;const u=this.conversionApi.writer.split(n,c),g=[];for(const p of u.range.getWalker())if(p.type=="elementEnd")g.push(p.item);else{const w=g.pop(),_=p.item;this._registerSplitPair(w,_)}const m=u.range.end.parent;return this._cursorParents.set(t,m),{position:u.position,cursorParent:m}}_registerSplitPair(t,n){this._splitParts.has(t)||this._splitParts.set(t,[t]);const o=this._splitParts.get(t);this._splitParts.set(n,o),o.push(n)}_getSplitParts(t){let n;return n=this._splitParts.has(t)?this._splitParts.get(t):[t],n}_removeEmptyElements(){let t=!1;for(const n of this._splitParts.keys())n.isEmpty&&(this.conversionApi.writer.remove(n),this._splitParts.delete(n),t=!0);t&&this._removeEmptyElements()}}tt(og,D);class AA{getHtml(t){const n=document.implementation.createHTMLDocument("").createElement("div");return n.appendChild(t),n.innerHTML}}class CA{constructor(t){this.domParser=new DOMParser,this.domConverter=new Fr(t,{renderingMode:"data"}),this.htmlWriter=new AA}toData(t){const n=this.domConverter.viewToDom(t,document);return this.htmlWriter.getHtml(n)}toView(t){const n=this._toDom(t);return this.domConverter.domToView(n)}registerRawContentMatcher(t){this.domConverter.registerRawContentMatcher(t)}useFillerType(t){this.domConverter.blockFillerMode=t=="marked"?"markedNbsp":"nbsp"}_toDom(t){const n=this.domParser.parseFromString(t,"text/html"),o=n.createDocumentFragment();let r=n.firstChild;for(;!r.isSameNode(n.documentElement);){const u=r;r=r.nextSibling,u.nodeType==Node.COMMENT_NODE&&o.appendChild(u)}const c=n.body.childNodes;for(;c.length>0;)o.appendChild(c[0]);return o}}class sg{constructor(t,n){this.model=t,this.mapper=new rc,this.downcastDispatcher=new ac({mapper:this.mapper,schema:t.schema}),this.downcastDispatcher.on("insert:$text",(o,r,c)=>{if(!c.consumable.consume(r.item,"insert"))return;const u=c.writer,g=c.mapper.toViewPosition(r.range.start),m=u.createText(r.item.data);u.insert(g,m)},{priority:"lowest"}),this.upcastDispatcher=new og({schema:t.schema}),this.viewDocument=new es(n),this.stylesProcessor=n,this.htmlProcessor=new CA(this.viewDocument),this.processor=this.htmlProcessor,this._viewWriter=new Xh(this.viewDocument),this.upcastDispatcher.on("text",(o,r,{schema:c,consumable:u,writer:g})=>{let m=r.modelCursor;if(!u.test(r.viewItem))return;if(!c.checkChild(m,"$text")){if(!Yf(m,"$text",c))return;m=Jf(m,g)}u.consume(r.viewItem);const p=g.createText(r.viewItem.data);g.insert(p,m),r.modelRange=g.createRange(m,m.getShiftedBy(p.offsetSize)),r.modelCursor=r.modelRange.end},{priority:"lowest"}),this.upcastDispatcher.on("element",(o,r,c)=>{if(!r.modelRange&&c.consumable.consume(r.viewItem,{name:!0})){const{modelRange:u,modelCursor:g}=c.convertChildren(r.viewItem,r.modelCursor);r.modelRange=u,r.modelCursor=g}},{priority:"lowest"}),this.upcastDispatcher.on("documentFragment",(o,r,c)=>{if(!r.modelRange&&c.consumable.consume(r.viewItem,{name:!0})){const{modelRange:u,modelCursor:g}=c.convertChildren(r.viewItem,r.modelCursor);r.modelRange=u,r.modelCursor=g}},{priority:"lowest"}),this.decorate("init"),this.decorate("set"),this.decorate("get"),this.on("init",()=>{this.fire("ready")},{priority:"lowest"}),this.on("ready",()=>{this.model.enqueueChange("transparent",Kf)},{priority:"lowest"})}get(t={}){const{rootName:n="main",trim:o="empty"}=t;if(!this._checkIfRootsExists([n]))throw new y.a("datacontroller-get-non-existent-root",this);const r=this.model.document.getRoot(n);return o!=="empty"||this.model.hasContent(r,{ignoreWhitespaces:!0})?this.stringify(r,t):""}stringify(t,n={}){const o=this.toView(t,n);return this.processor.toData(o)}toView(t,n={}){const o=this.viewDocument,r=this._viewWriter;this.mapper.clearBindings();const c=O._createIn(t),u=new si(o);this.mapper.bindElements(t,u),this.downcastDispatcher.conversionApi.options=n,this.downcastDispatcher.convertInsert(c,r);const g=t.is("documentFragment")?Array.from(t.markers):function(m){const p=[],w=m.root.document;if(!w)return[];const _=O._createIn(m);for(const v of w.model.markers){const A=v.getRange(),x=A.isCollapsed,E=A.start.isEqual(_.start)||A.end.isEqual(_.end);if(x&&E)p.push([v.name,A]);else{const T=_.getIntersection(A);T&&p.push([v.name,T])}}return p.sort(([v,A],[x,E])=>{if(A.end.compareWith(E.start)!=="after")return 1;if(A.start.compareWith(E.end)!=="before")return-1;switch(A.start.compareWith(E.start)){case"before":return 1;case"after":return-1;default:switch(A.end.compareWith(E.end)){case"before":return 1;case"after":return-1;default:return x.localeCompare(v)}}})}(t);for(const[m,p]of g)this.downcastDispatcher.convertMarkerAdd(m,p,r);return delete this.downcastDispatcher.conversionApi.options,u}init(t){if(this.model.document.version)throw new y.a("datacontroller-init-document-not-empty",this);let n={};if(typeof t=="string"?n.main=t:n=t,!this._checkIfRootsExists(Object.keys(n)))throw new y.a("datacontroller-init-non-existent-root",this);return this.model.enqueueChange("transparent",o=>{for(const r of Object.keys(n)){const c=this.model.document.getRoot(r);o.insert(this.parse(n[r],c),c,0)}}),Promise.resolve()}set(t,n={}){let o={};if(typeof t=="string"?o.main=t:o=t,!this._checkIfRootsExists(Object.keys(o)))throw new y.a("datacontroller-set-non-existent-root",this);const r=n.batchType||"default";this.model.enqueueChange(r,c=>{c.setSelection(null),c.removeSelectionAttribute(this.model.document.selection.getAttributeKeys());for(const u of Object.keys(o)){const g=this.model.document.getRoot(u);c.remove(c.createRangeIn(g)),c.insert(this.parse(o[u],g),g,0)}})}parse(t,n="$root"){const o=this.processor.toView(t);return this.toModel(o,n)}toModel(t,n="$root"){return this.model.change(o=>this.upcastDispatcher.convert(t,o,n))}addStyleProcessorRules(t){t(this.stylesProcessor)}registerRawContentMatcher(t){this.processor&&this.processor!==this.htmlProcessor&&this.processor.registerRawContentMatcher(t),this.htmlProcessor.registerRawContentMatcher(t)}destroy(){this.stopListening()}_checkIfRootsExists(t){for(const n of t)if(!this.model.document.getRootNames().includes(n))return!1;return!0}}tt(sg,yt);class xA{constructor(t,n){this._helpers=new Map,this._downcast=Kt(t),this._createConversionHelpers({name:"downcast",dispatchers:this._downcast,isDowncast:!0}),this._upcast=Kt(n),this._createConversionHelpers({name:"upcast",dispatchers:this._upcast,isDowncast:!1})}addAlias(t,n){const o=this._downcast.includes(n);if(!this._upcast.includes(n)&&!o)throw new y.a("conversion-add-alias-dispatcher-not-registered",this);this._createConversionHelpers({name:t,dispatchers:[n],isDowncast:o})}for(t){if(!this._helpers.has(t))throw new y.a("conversion-for-unknown-group",this);return this._helpers.get(t)}elementToElement(t){this.for("downcast").elementToElement(t);for(const{model:n,view:o}of hc(t))this.for("upcast").elementToElement({model:n,view:o,converterPriority:t.converterPriority})}attributeToElement(t){this.for("downcast").attributeToElement(t);for(const{model:n,view:o}of hc(t))this.for("upcast").elementToAttribute({view:o,model:n,converterPriority:t.converterPriority})}attributeToAttribute(t){this.for("downcast").attributeToAttribute(t);for(const{model:n,view:o}of hc(t))this.for("upcast").attributeToAttribute({view:o,model:n})}_createConversionHelpers({name:t,dispatchers:n,isDowncast:o}){if(this._helpers.has(t))throw new y.a("conversion-group-exists",this);const r=o?new lA(n):new cA(n);this._helpers.set(t,r)}}function*hc(l){if(l.model.values)for(const t of l.model.values){const n={key:l.model.key,value:t},o=l.view[t],r=l.upcastAlso?l.upcastAlso[t]:void 0;yield*rg(n,o,r)}else yield*rg(l.model,l.view,l.upcastAlso)}function*rg(l,t,n){if(yield{model:l,view:t},n)for(const o of Kt(n))yield{model:l,view:o}}class Yr{constructor(t="default"){this.operations=[],this.type=t}get baseVersion(){for(const t of this.operations)if(t.baseVersion!==null)return t.baseVersion;return null}addOperation(t){return t.batch=this,this.operations.push(t),t}}class Ne{constructor(t){this.baseVersion=t,this.isDocumentOperation=this.baseVersion!==null,this.batch=null}_validate(){}toJSON(){const t=Object.assign({},this);return t.__className=this.constructor.className,delete t.batch,delete t.isDocumentOperation,t}static get className(){return"Operation"}static fromJSON(t){return new this(t.baseVersion)}}class yn{constructor(t){this.markers=new Map,this._children=new Qi,t&&this._insertChild(0,t)}[Symbol.iterator](){return this.getChildren()}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return this.childCount===0}get root(){return this}get parent(){return null}is(t){return t==="documentFragment"||t==="model:documentFragment"}getChild(t){return this._children.getNode(t)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(t){return this._children.getNodeIndex(t)}getChildStartOffset(t){return this._children.getNodeStartOffset(t)}getPath(){return[]}getNodeByPath(t){let n=this;for(const o of t)n=n.getChild(n.offsetToIndex(o));return n}offsetToIndex(t){return this._children.offsetToIndex(t)}toJSON(){const t=[];for(const n of this._children)t.push(n.toJSON());return t}static fromJSON(t){const n=[];for(const o of t)o.name?n.push(mt.fromJSON(o)):n.push(kt.fromJSON(o));return new yn(n)}_appendChild(t){this._insertChild(this.childCount,t)}_insertChild(t,n){const o=function(r){return typeof r=="string"?[new kt(r)]:(Ie(r)||(r=[r]),Array.from(r).map(c=>typeof c=="string"?new kt(c):c instanceof nn?new kt(c.data,c.getAttributes()):c))}(n);for(const r of o)r.parent!==null&&r._remove(),r.parent=this;this._children._insertNodes(t,o)}_removeChildren(t,n=1){const o=this._children._removeNodes(t,n);for(const r of o)r.parent=null;return o}}function fc(l,t){const n=(t=lg(t)).reduce((c,u)=>c+u.offsetSize,0),o=l.parent;rs(l);const r=l.index;return o._insertChild(r,t),ss(o,r+t.length),ss(o,r),new O(l,l.getShiftedBy(n))}function ag(l){if(!l.isFlat)throw new y.a("operation-utils-remove-range-not-flat",this);const t=l.start.parent;rs(l.start),rs(l.end);const n=t._removeChildren(l.start.index,l.end.index-l.start.index);return ss(t,l.start.index),n}function os(l,t){if(!l.isFlat)throw new y.a("operation-utils-move-range-not-flat",this);const n=ag(l);return fc(t=t._getTransformedByDeletion(l.start,l.end.offset-l.start.offset),n)}function lg(l){const t=[];l instanceof Array||(l=[l]);for(let n=0;n<l.length;n++)if(typeof l[n]=="string")t.push(new kt(l[n]));else if(l[n]instanceof nn)t.push(new kt(l[n].data,l[n].getAttributes()));else if(l[n]instanceof yn||l[n]instanceof Qi)for(const o of l[n])t.push(o);else l[n]instanceof ri&&t.push(l[n]);for(let n=1;n<t.length;n++){const o=t[n],r=t[n-1];o instanceof kt&&r instanceof kt&&cg(o,r)&&(t.splice(n-1,2,new kt(r.data+o.data,r.getAttributes())),n--)}return t}function ss(l,t){const n=l.getChild(t-1),o=l.getChild(t);if(n&&o&&n.is("$text")&&o.is("$text")&&cg(n,o)){const r=new kt(n.data+o.data,n.getAttributes());l._removeChildren(t-1,2),l._insertChild(t-1,r)}}function rs(l){const t=l.textNode,n=l.parent;if(t){const o=l.offset-t.startOffset,r=t.index;n._removeChildren(r,1);const c=new kt(t.data.substr(0,o),t.getAttributes()),u=new kt(t.data.substr(o),t.getAttributes());n._insertChild(r,[c,u])}}function cg(l,t){const n=l.getAttributes(),o=t.getAttributes();for(const r of n){if(r[1]!==t.getAttribute(r[0]))return!1;o.next()}return o.next().done}var dg=function(l,t){return yf(l,t)};class Bt extends Ne{constructor(t,n,o,r,c){super(c),this.range=t.clone(),this.key=n,this.oldValue=o===void 0?null:o,this.newValue=r===void 0?null:r}get type(){return this.oldValue===null?"addAttribute":this.newValue===null?"removeAttribute":"changeAttribute"}clone(){return new Bt(this.range,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new Bt(this.range,this.key,this.newValue,this.oldValue,this.baseVersion+1)}toJSON(){const t=super.toJSON();return t.range=this.range.toJSON(),t}_validate(){if(!this.range.isFlat)throw new y.a("attribute-operation-range-not-flat",this);for(const t of this.range.getItems({shallow:!0})){if(this.oldValue!==null&&!dg(t.getAttribute(this.key),this.oldValue))throw new y.a("attribute-operation-wrong-old-value",this,{item:t,key:this.key,value:this.oldValue});if(this.oldValue===null&&this.newValue!==null&&t.hasAttribute(this.key))throw new y.a("attribute-operation-attribute-exists",this,{node:t,key:this.key})}}_execute(){dg(this.oldValue,this.newValue)||function(t,n,o){rs(t.start),rs(t.end);for(const r of t.getItems({shallow:!0})){const c=r.is("$textProxy")?r.textNode:r;o!==null?c._setAttribute(n,o):c._removeAttribute(n),ss(c.parent,c.index)}ss(t.end.parent,t.end.index)}(this.range,this.key,this.newValue)}static get className(){return"AttributeOperation"}static fromJSON(t,n){return new Bt(O.fromJSON(t.range,n),t.key,t.oldValue,t.newValue,t.baseVersion)}}class EA extends Ne{constructor(t,n){super(null),this.sourcePosition=t.clone(),this.howMany=n}get type(){return"detach"}toJSON(){const t=super.toJSON();return t.sourcePosition=this.sourcePosition.toJSON(),t}_validate(){if(this.sourcePosition.root.document)throw new y.a("detach-operation-on-document-node",this)}_execute(){ag(O._createFromPositionAndShift(this.sourcePosition,this.howMany))}static get className(){return"DetachOperation"}}class pt extends Ne{constructor(t,n,o,r){super(r),this.sourcePosition=t.clone(),this.sourcePosition.stickiness="toNext",this.howMany=n,this.targetPosition=o.clone(),this.targetPosition.stickiness="toNone"}get type(){return this.targetPosition.root.rootName=="$graveyard"?"remove":this.sourcePosition.root.rootName=="$graveyard"?"reinsert":"move"}clone(){return new this.constructor(this.sourcePosition,this.howMany,this.targetPosition,this.baseVersion)}getMovedRangeStart(){return this.targetPosition._getTransformedByDeletion(this.sourcePosition,this.howMany)}getReversed(){const t=this.sourcePosition._getTransformedByInsertion(this.targetPosition,this.howMany);return new this.constructor(this.getMovedRangeStart(),this.howMany,t,this.baseVersion+1)}_validate(){const t=this.sourcePosition.parent,n=this.targetPosition.parent,o=this.sourcePosition.offset,r=this.targetPosition.offset;if(o+this.howMany>t.maxOffset)throw new y.a("move-operation-nodes-do-not-exist",this);if(t===n&&o<r&&r<o+this.howMany)throw new y.a("move-operation-range-into-itself",this);if(this.sourcePosition.root==this.targetPosition.root&&se(this.sourcePosition.getParentPath(),this.targetPosition.getParentPath())=="prefix"){const c=this.sourcePosition.path.length-1;if(this.targetPosition.path[c]>=o&&this.targetPosition.path[c]<o+this.howMany)throw new y.a("move-operation-node-into-itself",this)}}_execute(){os(O._createFromPositionAndShift(this.sourcePosition,this.howMany),this.targetPosition)}toJSON(){const t=super.toJSON();return t.sourcePosition=this.sourcePosition.toJSON(),t.targetPosition=this.targetPosition.toJSON(),t}static get className(){return"MoveOperation"}static fromJSON(t,n){const o=L.fromJSON(t.sourcePosition,n),r=L.fromJSON(t.targetPosition,n);return new this(o,t.howMany,r,t.baseVersion)}}class Yt extends Ne{constructor(t,n,o){super(o),this.position=t.clone(),this.position.stickiness="toNone",this.nodes=new Qi(lg(n)),this.shouldReceiveAttributes=!1}get type(){return"insert"}get howMany(){return this.nodes.maxOffset}clone(){const t=new Qi([...this.nodes].map(o=>o._clone(!0))),n=new Yt(this.position,t,this.baseVersion);return n.shouldReceiveAttributes=this.shouldReceiveAttributes,n}getReversed(){const t=this.position.root.document.graveyard,n=new L(t,[0]);return new pt(this.position,this.nodes.maxOffset,n,this.baseVersion+1)}_validate(){const t=this.position.parent;if(!t||t.maxOffset<this.position.offset)throw new y.a("insert-operation-position-invalid",this)}_execute(){const t=this.nodes;this.nodes=new Qi([...t].map(n=>n._clone(!0))),fc(this.position,t)}toJSON(){const t=super.toJSON();return t.position=this.position.toJSON(),t.nodes=this.nodes.toJSON(),t}static get className(){return"InsertOperation"}static fromJSON(t,n){const o=[];for(const c of t.nodes)c.name?o.push(mt.fromJSON(c)):o.push(kt.fromJSON(c));const r=new Yt(L.fromJSON(t.position,n),o,t.baseVersion);return r.shouldReceiveAttributes=t.shouldReceiveAttributes,r}}class me extends Ne{constructor(t,n,o,r,c,u){super(u),this.name=t,this.oldRange=n?n.clone():null,this.newRange=o?o.clone():null,this.affectsData=c,this._markers=r}get type(){return"marker"}clone(){return new me(this.name,this.oldRange,this.newRange,this._markers,this.affectsData,this.baseVersion)}getReversed(){return new me(this.name,this.newRange,this.oldRange,this._markers,this.affectsData,this.baseVersion+1)}_execute(){const t=this.newRange?"_set":"_remove";this._markers[t](this.name,this.newRange,!0,this.affectsData)}toJSON(){const t=super.toJSON();return this.oldRange&&(t.oldRange=this.oldRange.toJSON()),this.newRange&&(t.newRange=this.newRange.toJSON()),delete t._markers,t}static get className(){return"MarkerOperation"}static fromJSON(t,n){return new me(t.name,t.oldRange?O.fromJSON(t.oldRange,n):null,t.newRange?O.fromJSON(t.newRange,n):null,n.model.markers,t.affectsData,t.baseVersion)}}class pe extends Ne{constructor(t,n,o,r){super(r),this.position=t,this.position.stickiness="toNext",this.oldName=n,this.newName=o}get type(){return"rename"}clone(){return new pe(this.position.clone(),this.oldName,this.newName,this.baseVersion)}getReversed(){return new pe(this.position.clone(),this.newName,this.oldName,this.baseVersion+1)}_validate(){const t=this.position.nodeAfter;if(!(t instanceof mt))throw new y.a("rename-operation-wrong-position",this);if(t.name!==this.oldName)throw new y.a("rename-operation-wrong-name",this)}_execute(){this.position.nodeAfter.name=this.newName}toJSON(){const t=super.toJSON();return t.position=this.position.toJSON(),t}static get className(){return"RenameOperation"}static fromJSON(t,n){return new pe(L.fromJSON(t.position,n),t.oldName,t.newName,t.baseVersion)}}class An extends Ne{constructor(t,n,o,r,c){super(c),this.root=t,this.key=n,this.oldValue=o,this.newValue=r}get type(){return this.oldValue===null?"addRootAttribute":this.newValue===null?"removeRootAttribute":"changeRootAttribute"}clone(){return new An(this.root,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new An(this.root,this.key,this.newValue,this.oldValue,this.baseVersion+1)}_validate(){if(this.root!=this.root.root||this.root.is("documentFragment"))throw new y.a("rootattribute-operation-not-a-root",this,{root:this.root,key:this.key});if(this.oldValue!==null&&this.root.getAttribute(this.key)!==this.oldValue)throw new y.a("rootattribute-operation-wrong-old-value",this,{root:this.root,key:this.key});if(this.oldValue===null&&this.newValue!==null&&this.root.hasAttribute(this.key))throw new y.a("rootattribute-operation-attribute-exists",this,{root:this.root,key:this.key})}_execute(){this.newValue!==null?this.root._setAttribute(this.key,this.newValue):this.root._removeAttribute(this.key)}toJSON(){const t=super.toJSON();return t.root=this.root.toJSON(),t}static get className(){return"RootAttributeOperation"}static fromJSON(t,n){if(!n.getRoot(t.root))throw new y.a("rootattribute-operation-fromjson-no-root",this,{rootName:t.root});return new An(n.getRoot(t.root),t.key,t.oldValue,t.newValue,t.baseVersion)}}class Wt extends Ne{constructor(t,n,o,r,c){super(c),this.sourcePosition=t.clone(),this.sourcePosition.stickiness="toPrevious",this.howMany=n,this.targetPosition=o.clone(),this.targetPosition.stickiness="toNext",this.graveyardPosition=r.clone()}get type(){return"merge"}get deletionPosition(){return new L(this.sourcePosition.root,this.sourcePosition.path.slice(0,-1))}get movedRange(){const t=this.sourcePosition.getShiftedBy(Number.POSITIVE_INFINITY);return new O(this.sourcePosition,t)}clone(){return new this.constructor(this.sourcePosition,this.howMany,this.targetPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const t=this.targetPosition._getTransformedByMergeOperation(this),n=this.sourcePosition.path.slice(0,-1),o=new L(this.sourcePosition.root,n)._getTransformedByMergeOperation(this);return new Ct(t,this.howMany,o,this.graveyardPosition,this.baseVersion+1)}_validate(){const t=this.sourcePosition.parent,n=this.targetPosition.parent;if(!t.parent)throw new y.a("merge-operation-source-position-invalid",this);if(!n.parent)throw new y.a("merge-operation-target-position-invalid",this);if(this.howMany!=t.maxOffset)throw new y.a("merge-operation-how-many-invalid",this)}_execute(){const t=this.sourcePosition.parent;os(O._createIn(t),this.targetPosition),os(O._createOn(t),this.graveyardPosition)}toJSON(){const t=super.toJSON();return t.sourcePosition=t.sourcePosition.toJSON(),t.targetPosition=t.targetPosition.toJSON(),t.graveyardPosition=t.graveyardPosition.toJSON(),t}static get className(){return"MergeOperation"}static fromJSON(t,n){const o=L.fromJSON(t.sourcePosition,n),r=L.fromJSON(t.targetPosition,n),c=L.fromJSON(t.graveyardPosition,n);return new this(o,t.howMany,r,c,t.baseVersion)}}class Ct extends Ne{constructor(t,n,o,r,c){super(c),this.splitPosition=t.clone(),this.splitPosition.stickiness="toNext",this.howMany=n,this.insertionPosition=o,this.graveyardPosition=r?r.clone():null,this.graveyardPosition&&(this.graveyardPosition.stickiness="toNext")}get type(){return"split"}get moveTargetPosition(){const t=this.insertionPosition.path.slice();return t.push(0),new L(this.insertionPosition.root,t)}get movedRange(){const t=this.splitPosition.getShiftedBy(Number.POSITIVE_INFINITY);return new O(this.splitPosition,t)}clone(){return new this.constructor(this.splitPosition,this.howMany,this.insertionPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const t=this.splitPosition.root.document.graveyard,n=new L(t,[0]);return new Wt(this.moveTargetPosition,this.howMany,this.splitPosition,n,this.baseVersion+1)}_validate(){const t=this.splitPosition.parent,n=this.splitPosition.offset;if(!t||t.maxOffset<n)throw new y.a("split-operation-position-invalid",this);if(!t.parent)throw new y.a("split-operation-split-in-root",this);if(this.howMany!=t.maxOffset-this.splitPosition.offset)throw new y.a("split-operation-how-many-invalid",this);if(this.graveyardPosition&&!this.graveyardPosition.nodeAfter)throw new y.a("split-operation-graveyard-position-invalid",this)}_execute(){const t=this.splitPosition.parent;if(this.graveyardPosition)os(O._createFromPositionAndShift(this.graveyardPosition,1),this.insertionPosition);else{const n=t._clone();fc(this.insertionPosition,n)}os(new O(L._createAt(t,this.splitPosition.offset),L._createAt(t,t.maxOffset)),this.moveTargetPosition)}toJSON(){const t=super.toJSON();return t.splitPosition=this.splitPosition.toJSON(),t.insertionPosition=this.insertionPosition.toJSON(),this.graveyardPosition&&(t.graveyardPosition=this.graveyardPosition.toJSON()),t}static get className(){return"SplitOperation"}static getInsertionPosition(t){const n=t.path.slice(0,-1);return n[n.length-1]++,new L(t.root,n,"toPrevious")}static fromJSON(t,n){const o=L.fromJSON(t.splitPosition,n),r=L.fromJSON(t.insertionPosition,n),c=t.graveyardPosition?L.fromJSON(t.graveyardPosition,n):null;return new this(o,t.howMany,r,c,t.baseVersion)}}class gc extends mt{constructor(t,n,o="main"){super(n),this._document=t,this.rootName=o}get document(){return this._document}is(t,n){return n?n===this.name&&(t==="rootElement"||t==="model:rootElement"||t==="element"||t==="model:element"):t==="rootElement"||t==="model:rootElement"||t==="element"||t==="model:element"||t==="node"||t==="model:node"}toJSON(){return this.rootName}}class TA{constructor(t,n){this.model=t,this.batch=n}createText(t,n){return new kt(t,n)}createElement(t,n){return new mt(t,n)}createDocumentFragment(){return new yn}cloneElement(t,n=!0){return t._clone(n)}insert(t,n,o=0){if(this._assertWriterUsedCorrectly(),t instanceof kt&&t.data=="")return;const r=L._createAt(n,o);if(t.parent){if(fg(t.root,r.root))return void this.move(O._createOn(t),r);if(t.root.document)throw new y.a("model-writer-insert-forbidden-move",this);this.remove(t)}const c=r.root.document?r.root.document.version:null,u=new Yt(r,t,c);if(t instanceof kt&&(u.shouldReceiveAttributes=!0),this.batch.addOperation(u),this.model.applyOperation(u),t instanceof yn)for(const[g,m]of t.markers){const p=L._createAt(m.root,0),w={range:new O(m.start._getCombined(p,r),m.end._getCombined(p,r)),usingOperation:!0,affectsData:!0};this.model.markers.has(g)?this.updateMarker(g,w):this.addMarker(g,w)}}insertText(t,n,o,r){n instanceof yn||n instanceof mt||n instanceof L?this.insert(this.createText(t),n,o):this.insert(this.createText(t,n),o,r)}insertElement(t,n,o,r){n instanceof yn||n instanceof mt||n instanceof L?this.insert(this.createElement(t),n,o):this.insert(this.createElement(t,n),o,r)}append(t,n){this.insert(t,n,"end")}appendText(t,n,o){n instanceof yn||n instanceof mt?this.insert(this.createText(t),n,"end"):this.insert(this.createText(t,n),o,"end")}appendElement(t,n,o){n instanceof yn||n instanceof mt?this.insert(this.createElement(t),n,"end"):this.insert(this.createElement(t,n),o,"end")}setAttribute(t,n,o){if(this._assertWriterUsedCorrectly(),o instanceof O){const r=o.getMinimalFlatRanges();for(const c of r)ug(this,t,n,c)}else hg(this,t,n,o)}setAttributes(t,n){for(const[o,r]of bn(t))this.setAttribute(o,r,n)}removeAttribute(t,n){if(this._assertWriterUsedCorrectly(),n instanceof O){const o=n.getMinimalFlatRanges();for(const r of o)ug(this,t,null,r)}else hg(this,t,null,n)}clearAttributes(t){this._assertWriterUsedCorrectly();const n=o=>{for(const r of o.getAttributeKeys())this.removeAttribute(r,o)};if(t instanceof O)for(const o of t.getItems())n(o);else n(t)}move(t,n,o){if(this._assertWriterUsedCorrectly(),!(t instanceof O))throw new y.a("writer-move-invalid-range",this);if(!t.isFlat)throw new y.a("writer-move-range-not-flat",this);const r=L._createAt(n,o);if(r.isEqual(t.start))return;if(this._addOperationForAffectedMarkers("move",t),!fg(t.root,r.root))throw new y.a("writer-move-different-document",this);const c=t.root.document?t.root.document.version:null,u=new pt(t.start,t.end.offset-t.start.offset,r,c);this.batch.addOperation(u),this.model.applyOperation(u)}remove(t){this._assertWriterUsedCorrectly();const n=(t instanceof O?t:O._createOn(t)).getMinimalFlatRanges().reverse();for(const o of n)this._addOperationForAffectedMarkers("move",o),SA(o.start,o.end.offset-o.start.offset,this.batch,this.model)}merge(t){this._assertWriterUsedCorrectly();const n=t.nodeBefore,o=t.nodeAfter;if(this._addOperationForAffectedMarkers("merge",t),!(n instanceof mt))throw new y.a("writer-merge-no-element-before",this);if(!(o instanceof mt))throw new y.a("writer-merge-no-element-after",this);t.root.document?this._merge(t):this._mergeDetached(t)}createPositionFromPath(t,n,o){return this.model.createPositionFromPath(t,n,o)}createPositionAt(t,n){return this.model.createPositionAt(t,n)}createPositionAfter(t){return this.model.createPositionAfter(t)}createPositionBefore(t){return this.model.createPositionBefore(t)}createRange(t,n){return this.model.createRange(t,n)}createRangeIn(t){return this.model.createRangeIn(t)}createRangeOn(t){return this.model.createRangeOn(t)}createSelection(t,n,o){return this.model.createSelection(t,n,o)}_mergeDetached(t){const n=t.nodeBefore,o=t.nodeAfter;this.move(O._createIn(o),L._createAt(n,"end")),this.remove(o)}_merge(t){const n=L._createAt(t.nodeBefore,"end"),o=L._createAt(t.nodeAfter,0),r=t.root.document.graveyard,c=new L(r,[0]),u=t.root.document.version,g=new Wt(o,t.nodeAfter.maxOffset,n,c,u);this.batch.addOperation(g),this.model.applyOperation(g)}rename(t,n){if(this._assertWriterUsedCorrectly(),!(t instanceof mt))throw new y.a("writer-rename-not-element-instance",this);const o=t.root.document?t.root.document.version:null,r=new pe(L._createBefore(t),t.name,n,o);this.batch.addOperation(r),this.model.applyOperation(r)}split(t,n){this._assertWriterUsedCorrectly();let o,r,c=t.parent;if(!c.parent)throw new y.a("writer-split-element-no-parent",this);if(n||(n=c.parent),!t.parent.getAncestors({includeSelf:!0}).includes(n))throw new y.a("writer-split-invalid-limit-element",this);do{const u=c.root.document?c.root.document.version:null,g=c.maxOffset-t.offset,m=Ct.getInsertionPosition(t),p=new Ct(t,g,m,null,u);this.batch.addOperation(p),this.model.applyOperation(p),o||r||(o=c,r=t.parent.nextSibling),c=(t=this.createPositionAfter(t.parent)).parent}while(c!==n);return{position:t,range:new O(L._createAt(o,"end"),L._createAt(r,0))}}wrap(t,n){if(this._assertWriterUsedCorrectly(),!t.isFlat)throw new y.a("writer-wrap-range-not-flat",this);const o=n instanceof mt?n:new mt(n);if(o.childCount>0)throw new y.a("writer-wrap-element-not-empty",this);if(o.parent!==null)throw new y.a("writer-wrap-element-attached",this);this.insert(o,t.start);const r=new O(t.start.getShiftedBy(1),t.end.getShiftedBy(1));this.move(r,L._createAt(o,0))}unwrap(t){if(this._assertWriterUsedCorrectly(),t.parent===null)throw new y.a("writer-unwrap-element-no-parent",this);this.move(O._createIn(t),this.createPositionAfter(t)),this.remove(t)}addMarker(t,n){if(this._assertWriterUsedCorrectly(),!n||typeof n.usingOperation!="boolean")throw new y.a("writer-addmarker-no-usingoperation",this);const o=n.usingOperation,r=n.range,c=n.affectsData!==void 0&&n.affectsData;if(this.model.markers.has(t))throw new y.a("writer-addmarker-marker-exists",this);if(!r)throw new y.a("writer-addmarker-no-range",this);return o?(as(this,t,null,r,c),this.model.markers.get(t)):this.model.markers._set(t,r,o,c)}updateMarker(t,n){this._assertWriterUsedCorrectly();const o=typeof t=="string"?t:t.name,r=this.model.markers.get(o);if(!r)throw new y.a("writer-updatemarker-marker-not-exists",this);if(!n)return void this.model.markers._refresh(r);const c=typeof n.usingOperation=="boolean",u=typeof n.affectsData=="boolean",g=u?n.affectsData:r.affectsData;if(!c&&!n.range&&!u)throw new y.a("writer-updatemarker-wrong-options",this);const m=r.getRange(),p=n.range?n.range:m;c&&n.usingOperation!==r.managedUsingOperations?n.usingOperation?as(this,o,null,p,g):(as(this,o,m,null,g),this.model.markers._set(o,p,void 0,g)):r.managedUsingOperations?as(this,o,m,p,g):this.model.markers._set(o,p,void 0,g)}removeMarker(t){this._assertWriterUsedCorrectly();const n=typeof t=="string"?t:t.name;if(!this.model.markers.has(n))throw new y.a("writer-removemarker-no-marker",this);const o=this.model.markers.get(n);if(!o.managedUsingOperations)return void this.model.markers._remove(n);as(this,n,o.getRange(),null,o.affectsData)}setSelection(t,n,o){this._assertWriterUsedCorrectly(),this.model.document.selection._setTo(t,n,o)}setSelectionFocus(t,n){this._assertWriterUsedCorrectly(),this.model.document.selection._setFocus(t,n)}setSelectionAttribute(t,n){if(this._assertWriterUsedCorrectly(),typeof t=="string")this._setSelectionAttribute(t,n);else for(const[o,r]of bn(t))this._setSelectionAttribute(o,r)}removeSelectionAttribute(t){if(this._assertWriterUsedCorrectly(),typeof t=="string")this._removeSelectionAttribute(t);else for(const n of t)this._removeSelectionAttribute(n)}overrideSelectionGravity(){return this.model.document.selection._overrideGravity()}restoreSelectionGravity(t){this.model.document.selection._restoreGravity(t)}_setSelectionAttribute(t,n){const o=this.model.document.selection;if(o.isCollapsed&&o.anchor.parent.isEmpty){const r=qe._getStoreAttributeKey(t);this.setAttribute(r,n,o.anchor.parent)}o._setAttribute(t,n)}_removeSelectionAttribute(t){const n=this.model.document.selection;if(n.isCollapsed&&n.anchor.parent.isEmpty){const o=qe._getStoreAttributeKey(t);this.removeAttribute(o,n.anchor.parent)}n._removeAttribute(t)}_assertWriterUsedCorrectly(){if(this.model._currentWriter!==this)throw new y.a("writer-incorrect-use",this)}_addOperationForAffectedMarkers(t,n){for(const o of this.model.markers){if(!o.managedUsingOperations)continue;const r=o.getRange();let c=!1;if(t==="move")c=n.containsPosition(r.start)||n.start.isEqual(r.start)||n.containsPosition(r.end)||n.end.isEqual(r.end);else{const u=n.nodeBefore,g=n.nodeAfter,m=r.start.parent==u&&r.start.isAtEnd,p=r.end.parent==g&&r.end.offset==0,w=r.end.nodeAfter==g,_=r.start.nodeAfter==g;c=m||p||w||_}c&&this.updateMarker(o.name,{range:r})}}}function ug(l,t,n,o){const r=l.model,c=r.document;let u,g,m,p=o.start;for(const _ of o.getWalker({shallow:!0}))m=_.item.getAttribute(t),u&&g!=m&&(g!=n&&w(),p=u),u=_.nextPosition,g=m;function w(){const _=new O(p,u),v=_.root.document?c.version:null,A=new Bt(_,t,g,n,v);l.batch.addOperation(A),r.applyOperation(A)}u instanceof L&&u!=p&&g!=n&&w()}function hg(l,t,n,o){const r=l.model,c=r.document,u=o.getAttribute(t);let g,m;if(u!=n){if(o.root===o){const p=o.document?c.version:null;m=new An(o,t,u,n,p)}else{g=new O(L._createBefore(o),l.createPositionAfter(o));const p=g.root.document?c.version:null;m=new Bt(g,t,u,n,p)}l.batch.addOperation(m),r.applyOperation(m)}}function as(l,t,n,o,r){const c=l.model,u=c.document,g=new me(t,n,o,c.markers,r,u.version);l.batch.addOperation(g),c.applyOperation(g)}function SA(l,t,n,o){let r;if(l.root.document){const c=o.document,u=new L(c.graveyard,[0]);r=new pt(l,t,u,c.version)}else r=new EA(l,t);n.addOperation(r),o.applyOperation(r)}function fg(l,t){return l===t||l instanceof gc&&t instanceof gc}class PA{constructor(t){this._markerCollection=t,this._changesInElement=new Map,this._elementSnapshots=new Map,this._changedMarkers=new Map,this._changeCount=0,this._cachedChanges=null,this._cachedChangesWithGraveyard=null}get isEmpty(){return this._changesInElement.size==0&&this._changedMarkers.size==0}refreshItem(t){if(this._isInInsertedElement(t.parent))return;this._markRemove(t.parent,t.startOffset,t.offsetSize),this._markInsert(t.parent,t.startOffset,t.offsetSize);const n=O._createOn(t);for(const o of this._markerCollection.getMarkersIntersectingRange(n)){const r=o.getRange();this.bufferMarkerChange(o.name,r,r,o.affectsData)}this._cachedChanges=null}bufferOperation(t){switch(t.type){case"insert":if(this._isInInsertedElement(t.position.parent))return;this._markInsert(t.position.parent,t.position.offset,t.nodes.maxOffset);break;case"addAttribute":case"removeAttribute":case"changeAttribute":for(const n of t.range.getItems({shallow:!0}))this._isInInsertedElement(n.parent)||this._markAttribute(n);break;case"remove":case"move":case"reinsert":{if(t.sourcePosition.isEqual(t.targetPosition)||t.sourcePosition.getShiftedBy(t.howMany).isEqual(t.targetPosition))return;const n=this._isInInsertedElement(t.sourcePosition.parent),o=this._isInInsertedElement(t.targetPosition.parent);n||this._markRemove(t.sourcePosition.parent,t.sourcePosition.offset,t.howMany),o||this._markInsert(t.targetPosition.parent,t.getMovedRangeStart().offset,t.howMany);break}case"rename":{if(this._isInInsertedElement(t.position.parent))return;this._markRemove(t.position.parent,t.position.offset,1),this._markInsert(t.position.parent,t.position.offset,1);const n=O._createFromPositionAndShift(t.position,1);for(const o of this._markerCollection.getMarkersIntersectingRange(n)){const r=o.getRange();this.bufferMarkerChange(o.name,r,r,o.affectsData)}break}case"split":{const n=t.splitPosition.parent;this._isInInsertedElement(n)||this._markRemove(n,t.splitPosition.offset,t.howMany),this._isInInsertedElement(t.insertionPosition.parent)||this._markInsert(t.insertionPosition.parent,t.insertionPosition.offset,1),t.graveyardPosition&&this._markRemove(t.graveyardPosition.parent,t.graveyardPosition.offset,1);break}case"merge":{const n=t.sourcePosition.parent;this._isInInsertedElement(n.parent)||this._markRemove(n.parent,n.startOffset,1);const o=t.graveyardPosition.parent;this._markInsert(o,t.graveyardPosition.offset,1);const r=t.targetPosition.parent;this._isInInsertedElement(r)||this._markInsert(r,t.targetPosition.offset,n.maxOffset);break}}this._cachedChanges=null}bufferMarkerChange(t,n,o,r){const c=this._changedMarkers.get(t);c?(c.newRange=o,c.affectsData=r,c.oldRange==null&&c.newRange==null&&this._changedMarkers.delete(t)):this._changedMarkers.set(t,{oldRange:n,newRange:o,affectsData:r})}getMarkersToRemove(){const t=[];for(const[n,o]of this._changedMarkers)o.oldRange!=null&&t.push({name:n,range:o.oldRange});return t}getMarkersToAdd(){const t=[];for(const[n,o]of this._changedMarkers)o.newRange!=null&&t.push({name:n,range:o.newRange});return t}getChangedMarkers(){return Array.from(this._changedMarkers).map(t=>({name:t[0],data:{oldRange:t[1].oldRange,newRange:t[1].newRange}}))}hasDataChanges(){for(const[,t]of this._changedMarkers)if(t.affectsData)return!0;return this._changesInElement.size>0}getChanges(t={includeChangesInGraveyard:!1}){if(this._cachedChanges)return t.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice();let n=[];for(const o of this._changesInElement.keys()){const r=this._changesInElement.get(o).sort((w,_)=>w.offset===_.offset?w.type!=_.type?w.type=="remove"?-1:1:0:w.offset<_.offset?-1:1),c=this._elementSnapshots.get(o),u=gg(o.getChildren()),g=IA(c.length,r);let m=0,p=0;for(const w of g)if(w==="i")n.push(this._getInsertDiff(o,m,u[m].name)),m++;else if(w==="r")n.push(this._getRemoveDiff(o,m,c[p].name)),p++;else if(w==="a"){const _=u[m].attributes,v=c[p].attributes;let A;if(u[m].name=="$text")A=new O(L._createAt(o,m),L._createAt(o,m+1));else{const x=o.offsetToIndex(m);A=new O(L._createAt(o,m),L._createAt(o.getChild(x),0))}n.push(...this._getAttributesDiff(A,v,_)),m++,p++}else m++,p++}n.sort((o,r)=>o.position.root!=r.position.root?o.position.root.rootName<r.position.root.rootName?-1:1:o.position.isEqual(r.position)?o.changeCount-r.changeCount:o.position.isBefore(r.position)?-1:1);for(let o=1,r=0;o<n.length;o++){const c=n[r],u=n[o],g=c.type=="remove"&&u.type=="remove"&&c.name=="$text"&&u.name=="$text"&&c.position.isEqual(u.position),m=c.type=="insert"&&u.type=="insert"&&c.name=="$text"&&u.name=="$text"&&c.position.parent==u.position.parent&&c.position.offset+c.length==u.position.offset,p=c.type=="attribute"&&u.type=="attribute"&&c.position.parent==u.position.parent&&c.range.isFlat&&u.range.isFlat&&c.position.offset+c.length==u.position.offset&&c.attributeKey==u.attributeKey&&c.attributeOldValue==u.attributeOldValue&&c.attributeNewValue==u.attributeNewValue;g||m||p?(c.length++,p&&(c.range.end=c.range.end.getShiftedBy(1)),n[o]=null):r=o}n=n.filter(o=>o);for(const o of n)delete o.changeCount,o.type=="attribute"&&(delete o.position,delete o.length);return this._changeCount=0,this._cachedChangesWithGraveyard=n.slice(),this._cachedChanges=n.filter(MA),t.includeChangesInGraveyard?this._cachedChangesWithGraveyard:this._cachedChanges}reset(){this._changesInElement.clear(),this._elementSnapshots.clear(),this._changedMarkers.clear(),this._cachedChanges=null}_markInsert(t,n,o){const r={type:"insert",offset:n,howMany:o,count:this._changeCount++};this._markChange(t,r)}_markRemove(t,n,o){const r={type:"remove",offset:n,howMany:o,count:this._changeCount++};this._markChange(t,r),this._removeAllNestedChanges(t,n,o)}_markAttribute(t){const n={type:"attribute",offset:t.startOffset,howMany:t.offsetSize,count:this._changeCount++};this._markChange(t.parent,n)}_markChange(t,n){this._makeSnapshot(t);const o=this._getChangesForElement(t);this._handleChange(n,o),o.push(n);for(let r=0;r<o.length;r++)o[r].howMany<1&&(o.splice(r,1),r--)}_getChangesForElement(t){let n;return this._changesInElement.has(t)?n=this._changesInElement.get(t):(n=[],this._changesInElement.set(t,n)),n}_makeSnapshot(t){this._elementSnapshots.has(t)||this._elementSnapshots.set(t,gg(t.getChildren()))}_handleChange(t,n){t.nodesToHandle=t.howMany;for(const o of n){const r=t.offset+t.howMany,c=o.offset+o.howMany;if(t.type=="insert"&&(o.type=="insert"&&(t.offset<=o.offset?o.offset+=t.howMany:t.offset<c&&(o.howMany+=t.nodesToHandle,t.nodesToHandle=0)),o.type=="remove"&&t.offset<o.offset&&(o.offset+=t.howMany),o.type=="attribute")){if(t.offset<=o.offset)o.offset+=t.howMany;else if(t.offset<c){const u=o.howMany;o.howMany=t.offset-o.offset,n.unshift({type:"attribute",offset:r,howMany:u-o.howMany,count:this._changeCount++})}}if(t.type=="remove"){if(o.type=="insert"){if(r<=o.offset)o.offset-=t.howMany;else if(r<=c)if(t.offset<o.offset){const u=r-o.offset;o.offset=t.offset,o.howMany-=u,t.nodesToHandle-=u}else o.howMany-=t.nodesToHandle,t.nodesToHandle=0;else if(t.offset<=o.offset)t.nodesToHandle-=o.howMany,o.howMany=0;else if(t.offset<c){const u=c-t.offset;o.howMany-=u,t.nodesToHandle-=u}}if(o.type=="remove"&&(r<=o.offset?o.offset-=t.howMany:t.offset<o.offset&&(t.nodesToHandle+=o.howMany,o.howMany=0)),o.type=="attribute"){if(r<=o.offset)o.offset-=t.howMany;else if(t.offset<o.offset){const u=r-o.offset;o.offset=t.offset,o.howMany-=u}else if(t.offset<c)if(r<=c){const u=o.howMany;o.howMany=t.offset-o.offset;const g=u-o.howMany-t.nodesToHandle;n.unshift({type:"attribute",offset:t.offset,howMany:g,count:this._changeCount++})}else o.howMany-=c-t.offset}}if(t.type=="attribute"){if(o.type=="insert")if(t.offset<o.offset&&r>o.offset){if(r>c){const u={type:"attribute",offset:c,howMany:r-c,count:this._changeCount++};this._handleChange(u,n),n.push(u)}t.nodesToHandle=o.offset-t.offset,t.howMany=t.nodesToHandle}else t.offset>=o.offset&&t.offset<c&&(r>c?(t.nodesToHandle=r-c,t.offset=c):t.nodesToHandle=0);if(o.type=="remove"&&t.offset<o.offset&&r>o.offset){const u={type:"attribute",offset:o.offset,howMany:r-o.offset,count:this._changeCount++};this._handleChange(u,n),n.push(u),t.nodesToHandle=o.offset-t.offset,t.howMany=t.nodesToHandle}o.type=="attribute"&&(t.offset>=o.offset&&r<=c?(t.nodesToHandle=0,t.howMany=0,t.offset=0):t.offset<=o.offset&&r>=c&&(o.howMany=0))}}t.howMany=t.nodesToHandle,delete t.nodesToHandle}_getInsertDiff(t,n,o){return{type:"insert",position:L._createAt(t,n),name:o,length:1,changeCount:this._changeCount++}}_getRemoveDiff(t,n,o){return{type:"remove",position:L._createAt(t,n),name:o,length:1,changeCount:this._changeCount++}}_getAttributesDiff(t,n,o){const r=[];o=new Map(o);for(const[c,u]of n){const g=o.has(c)?o.get(c):null;g!==u&&r.push({type:"attribute",position:t.start,range:t.clone(),length:1,attributeKey:c,attributeOldValue:u,attributeNewValue:g,changeCount:this._changeCount++}),o.delete(c)}for(const[c,u]of o)r.push({type:"attribute",position:t.start,range:t.clone(),length:1,attributeKey:c,attributeOldValue:null,attributeNewValue:u,changeCount:this._changeCount++});return r}_isInInsertedElement(t){const n=t.parent;if(!n)return!1;const o=this._changesInElement.get(n),r=t.startOffset;if(o){for(const c of o)if(c.type=="insert"&&r>=c.offset&&r<c.offset+c.howMany)return!0}return this._isInInsertedElement(n)}_removeAllNestedChanges(t,n,o){const r=new O(L._createAt(t,n),L._createAt(t,n+o));for(const c of r.getItems({shallow:!0}))c.is("element")&&(this._elementSnapshots.delete(c),this._changesInElement.delete(c),this._removeAllNestedChanges(c,0,c.maxOffset))}}function gg(l){const t=[];for(const n of l)if(n.is("$text"))for(let o=0;o<n.data.length;o++)t.push({name:"$text",attributes:new Map(n.getAttributes())});else t.push({name:n.name,attributes:new Map(n.getAttributes())});return t}function IA(l,t){const n=[];let o=0,r=0;for(const c of t){if(c.offset>o){for(let u=0;u<c.offset-o;u++)n.push("e");r+=c.offset-o}if(c.type=="insert"){for(let u=0;u<c.howMany;u++)n.push("i");o=c.offset+c.howMany}else if(c.type=="remove"){for(let u=0;u<c.howMany;u++)n.push("r");o=c.offset,r+=c.howMany}else n.push(..."a".repeat(c.howMany).split("")),o=c.offset+c.howMany,r+=c.howMany}if(r<l)for(let c=0;c<l-r-o;c++)n.push("e");return n}function MA(l){const t=l.position&&l.position.root.rootName=="$graveyard",n=l.range&&l.range.root.rootName=="$graveyard";return!t&&!n}class RA{constructor(){this._operations=[],this._undoPairs=new Map,this._undoneOperations=new Set}addOperation(t){this._operations.includes(t)||this._operations.push(t)}getOperations(t=Number.NEGATIVE_INFINITY,n=Number.POSITIVE_INFINITY){const o=[];for(const r of this._operations)r.baseVersion>=t&&r.baseVersion<n&&o.push(r);return o}getOperation(t){for(const n of this._operations)if(n.baseVersion==t)return n}setOperationAsUndone(t,n){this._undoPairs.set(n,t),this._undoneOperations.add(t)}isUndoingOperation(t){return this._undoPairs.has(t)}isUndoneOperation(t){return this._undoneOperations.has(t)}getUndoneOperation(t){return this._undoPairs.get(t)}}function mg(l,t){return!!(n=l.charAt(t-1))&&n.length==1&&/[\ud800-\udbff]/.test(n)&&function(o){return!!o&&o.length==1&&/[\udc00-\udfff]/.test(o)}(l.charAt(t));var n}function pg(l,t){return!!(n=l.charAt(t))&&n.length==1&&/[\u0300-\u036f\u1ab0-\u1aff\u1dc0-\u1dff\u20d0-\u20ff\ufe20-\ufe2f]/.test(n);var n}class bg{constructor(t){this.model=t,this.version=0,this.history=new RA(this),this.selection=new qe(this),this.roots=new Me({idProperty:"rootName"}),this.differ=new PA(t.markers),this._postFixers=new Set,this._hasSelectionChangedFromTheLastChangeBlock=!1,this.createRoot("$root","$graveyard"),this.listenTo(t,"applyOperation",(n,o)=>{const r=o[0];if(r.isDocumentOperation&&r.baseVersion!==this.version)throw new y.a("model-document-applyoperation-wrong-version",this,{operation:r})},{priority:"highest"}),this.listenTo(t,"applyOperation",(n,o)=>{const r=o[0];r.isDocumentOperation&&this.differ.bufferOperation(r)},{priority:"high"}),this.listenTo(t,"applyOperation",(n,o)=>{const r=o[0];r.isDocumentOperation&&(this.version++,this.history.addOperation(r))},{priority:"low"}),this.listenTo(this.selection,"change",()=>{this._hasSelectionChangedFromTheLastChangeBlock=!0}),this.listenTo(t.markers,"update",(n,o,r,c)=>{this.differ.bufferMarkerChange(o.name,r,c,o.affectsData),r===null&&o.on("change",(u,g)=>{this.differ.bufferMarkerChange(o.name,g,o.getRange(),o.affectsData)})})}get graveyard(){return this.getRoot("$graveyard")}createRoot(t="$root",n="main"){if(this.roots.get(n))throw new y.a("model-document-createroot-name-exists",this,{name:n});const o=new gc(this,t,n);return this.roots.add(o),o}destroy(){this.selection.destroy(),this.stopListening()}getRoot(t="main"){return this.roots.get(t)}getRootNames(){return Array.from(this.roots,t=>t.rootName).filter(t=>t!="$graveyard")}registerPostFixer(t){this._postFixers.add(t)}toJSON(){const t=Vh(this);return t.selection="[engine.model.DocumentSelection]",t.model="[engine.model.Model]",t}_handleChangeBlock(t){this._hasDocumentChangedFromTheLastChangeBlock()&&(this._callPostFixers(t),this.selection.refresh(),this.differ.hasDataChanges()?this.fire("change:data",t.batch):this.fire("change",t.batch),this.selection.refresh(),this.differ.reset()),this._hasSelectionChangedFromTheLastChangeBlock=!1}_hasDocumentChangedFromTheLastChangeBlock(){return!this.differ.isEmpty||this._hasSelectionChangedFromTheLastChangeBlock}_getDefaultRoot(){for(const t of this.roots)if(t!==this.graveyard)return t;return this.graveyard}_getDefaultRange(){const t=this._getDefaultRoot(),n=this.model,o=n.schema,r=n.createPositionFromPath(t,[0]);return o.getNearestSelectionRange(r)||n.createRange(r)}_validateSelectionRange(t){return wg(t.start)&&wg(t.end)}_callPostFixers(t){let n=!1;do for(const o of this._postFixers)if(this.selection.refresh(),n=o(t),n)break;while(n)}}function wg(l){const t=l.textNode;if(t){const n=t.data,o=l.offset-t.startOffset;return!mg(n,o)&&!pg(n,o)}return!0}tt(bg,D);class _g{constructor(){this._markers=new Map}[Symbol.iterator](){return this._markers.values()}has(t){const n=t instanceof Zi?t.name:t;return this._markers.has(n)}get(t){return this._markers.get(t)||null}_set(t,n,o=!1,r=!1){const c=t instanceof Zi?t.name:t;if(c.includes(","))throw new y.a("markercollection-incorrect-marker-name",this);const u=this._markers.get(c);if(u){const p=u.getRange();let w=!1;return p.isEqual(n)||(u._attachLiveRange(on.fromRange(n)),w=!0),o!=u.managedUsingOperations&&(u._managedUsingOperations=o,w=!0),typeof r=="boolean"&&r!=u.affectsData&&(u._affectsData=r,w=!0),w&&this.fire("update:"+c,u,p,n),u}const g=on.fromRange(n),m=new Zi(c,g,o,r);return this._markers.set(c,m),this.fire("update:"+c,m,null,n),m}_remove(t){const n=t instanceof Zi?t.name:t,o=this._markers.get(n);return!!o&&(this._markers.delete(n),this.fire("update:"+n,o,o.getRange(),null),this._destroyMarker(o),!0)}_refresh(t){const n=t instanceof Zi?t.name:t,o=this._markers.get(n);if(!o)throw new y.a("markercollection-refresh-marker-not-exists",this);const r=o.getRange();this.fire("update:"+n,o,r,r,o.managedUsingOperations,o.affectsData)}*getMarkersAtPosition(t){for(const n of this)n.getRange().containsPosition(t)&&(yield n)}*getMarkersIntersectingRange(t){for(const n of this)n.getRange().getIntersection(t)!==null&&(yield n)}destroy(){for(const t of this._markers.values())this._destroyMarker(t);this._markers=null,this.stopListening()}*getMarkersGroup(t){for(const n of this._markers.values())n.name.startsWith(t+":")&&(yield n)}_destroyMarker(t){t.stopListening(),t._detachLiveRange()}}tt(_g,D);class Zi{constructor(t,n,o,r){this.name=t,this._liveRange=this._attachLiveRange(n),this._managedUsingOperations=o,this._affectsData=r}get managedUsingOperations(){if(!this._liveRange)throw new y.a("marker-destroyed",this);return this._managedUsingOperations}get affectsData(){if(!this._liveRange)throw new y.a("marker-destroyed",this);return this._affectsData}getStart(){if(!this._liveRange)throw new y.a("marker-destroyed",this);return this._liveRange.start.clone()}getEnd(){if(!this._liveRange)throw new y.a("marker-destroyed",this);return this._liveRange.end.clone()}getRange(){if(!this._liveRange)throw new y.a("marker-destroyed",this);return this._liveRange.toRange()}is(t){return t==="marker"||t==="model:marker"}_attachLiveRange(t){return this._liveRange&&this._detachLiveRange(),t.delegate("change:range").to(this),t.delegate("change:content").to(this),this._liveRange=t,t}_detachLiveRange(){this._liveRange.stopDelegating("change:range",this),this._liveRange.stopDelegating("change:content",this),this._liveRange.detach(),this._liveRange=null}}tt(Zi,D);class Jt extends Ne{get type(){return"noop"}clone(){return new Jt(this.baseVersion)}getReversed(){return new Jt(this.baseVersion+1)}_execute(){}static get className(){return"NoOperation"}}const Ue={};Ue[Bt.className]=Bt,Ue[Yt.className]=Yt,Ue[me.className]=me,Ue[pt.className]=pt,Ue[Jt.className]=Jt,Ue[Ne.className]=Ne,Ue[pe.className]=pe,Ue[An.className]=An,Ue[Ct.className]=Ct,Ue[Wt.className]=Wt;class te extends L{constructor(t,n,o="toNone"){if(super(t,n,o),!this.root.is("rootElement"))throw new y.a("model-liveposition-root-not-rootelement",t);OA.call(this)}detach(){this.stopListening()}is(t){return t==="livePosition"||t==="model:livePosition"||t=="position"||t==="model:position"}toPosition(){return new L(this.root,this.path.slice(),this.stickiness)}static fromPosition(t,n){return new this(t.root,t.path.slice(),n||t.stickiness)}}function OA(){this.listenTo(this.root.document.model,"applyOperation",(l,t)=>{const n=t[0];n.isDocumentOperation&&NA.call(this,n)},{priority:"low"})}function NA(l){const t=this.getTransformedByOperation(l);if(!this.isEqual(t)){const n=this.toPosition();this.path=t.path,this.root=t.root,this.fire("change",n)}}tt(te,D);class DA{constructor(t,n,o){this.model=t,this.writer=n,this.position=o,this.canMergeWith=new Set([this.position.parent]),this.schema=t.schema,this._documentFragment=n.createDocumentFragment(),this._documentFragmentPosition=n.createPositionAt(this._documentFragment,0),this._firstNode=null,this._lastNode=null,this._lastAutoParagraph=null,this._filterAttributesOf=[],this._affectedStart=null,this._affectedEnd=null}handleNodes(t){for(const n of Array.from(t))this._handleNode(n);this._insertPartialFragment(),this._lastAutoParagraph&&this._updateLastNodeFromAutoParagraph(this._lastAutoParagraph),this._mergeOnRight(),this.schema.removeDisallowedAttributes(this._filterAttributesOf,this.writer),this._filterAttributesOf=[]}_updateLastNodeFromAutoParagraph(t){const n=this.writer.createPositionAfter(this._lastNode),o=this.writer.createPositionAfter(t);if(o.isAfter(n)){if(this._lastNode=t,this.position.parent!=t||!this.position.isAtEnd)throw new y.a("insertcontent-invalid-insertion-position",this);this.position=o,this._setAffectedBoundaries(this.position)}}getSelectionRange(){return this.nodeToSelect?O._createOn(this.nodeToSelect):this.model.schema.getNearestSelectionRange(this.position)}getAffectedRange(){return this._affectedStart?new O(this._affectedStart,this._affectedEnd):null}destroy(){this._affectedStart&&this._affectedStart.detach(),this._affectedEnd&&this._affectedEnd.detach()}_handleNode(t){if(this.schema.isObject(t))return void this._handleObject(t);let n=this._checkAndAutoParagraphToAllowedPosition(t);n||(n=this._checkAndSplitToAllowedPosition(t),n)?(this._appendToFragment(t),this._firstNode||(this._firstNode=t),this._lastNode=t):this._handleDisallowedNode(t)}_insertPartialFragment(){if(this._documentFragment.isEmpty)return;const t=te.fromPosition(this.position,"toNext");this._setAffectedBoundaries(this.position),this._documentFragment.getChild(0)==this._firstNode&&(this.writer.insert(this._firstNode,this.position),this._mergeOnLeft(),this.position=t.toPosition()),this._documentFragment.isEmpty||this.writer.insert(this._documentFragment,this.position),this._documentFragmentPosition=this.writer.createPositionAt(this._documentFragment,0),this.position=t.toPosition(),t.detach()}_handleObject(t){this._checkAndSplitToAllowedPosition(t)?this._appendToFragment(t):this._tryAutoparagraphing(t)}_handleDisallowedNode(t){t.is("element")?this.handleNodes(t.getChildren()):this._tryAutoparagraphing(t)}_appendToFragment(t){if(!this.schema.checkChild(this.position,t))throw new y.a("insertcontent-wrong-position",this,{node:t,position:this.position});this.writer.insert(t,this._documentFragmentPosition),this._documentFragmentPosition=this._documentFragmentPosition.getShiftedBy(t.offsetSize),this.schema.isObject(t)&&!this.schema.checkChild(this.position,"$text")?this.nodeToSelect=t:this.nodeToSelect=null,this._filterAttributesOf.push(t)}_setAffectedBoundaries(t){this._affectedStart||(this._affectedStart=te.fromPosition(t,"toPrevious")),this._affectedEnd&&!this._affectedEnd.isBefore(t)||(this._affectedEnd&&this._affectedEnd.detach(),this._affectedEnd=te.fromPosition(t,"toNext"))}_mergeOnLeft(){const t=this._firstNode;if(!(t instanceof mt)||!this._canMergeLeft(t))return;const n=te._createBefore(t);n.stickiness="toNext";const o=te.fromPosition(this.position,"toNext");this._affectedStart.isEqual(n)&&(this._affectedStart.detach(),this._affectedStart=te._createAt(n.nodeBefore,"end","toPrevious")),this._firstNode===this._lastNode&&(this._firstNode=n.nodeBefore,this._lastNode=n.nodeBefore),this.writer.merge(n),n.isEqual(this._affectedEnd)&&this._firstNode===this._lastNode&&(this._affectedEnd.detach(),this._affectedEnd=te._createAt(n.nodeBefore,"end","toNext")),this.position=o.toPosition(),o.detach(),this._filterAttributesOf.push(this.position.parent),n.detach()}_mergeOnRight(){const t=this._lastNode;if(!(t instanceof mt)||!this._canMergeRight(t))return;const n=te._createAfter(t);if(n.stickiness="toNext",!this.position.isEqual(n))throw new y.a("insertcontent-invalid-insertion-position",this);this.position=L._createAt(n.nodeBefore,"end");const o=te.fromPosition(this.position,"toPrevious");this._affectedEnd.isEqual(n)&&(this._affectedEnd.detach(),this._affectedEnd=te._createAt(n.nodeBefore,"end","toNext")),this._firstNode===this._lastNode&&(this._firstNode=n.nodeBefore,this._lastNode=n.nodeBefore),this.writer.merge(n),n.getShiftedBy(-1).isEqual(this._affectedStart)&&this._firstNode===this._lastNode&&(this._affectedStart.detach(),this._affectedStart=te._createAt(n.nodeBefore,0,"toPrevious")),this.position=o.toPosition(),o.detach(),this._filterAttributesOf.push(this.position.parent),n.detach()}_canMergeLeft(t){const n=t.previousSibling;return n instanceof mt&&this.canMergeWith.has(n)&&this.model.schema.checkMerge(n,t)}_canMergeRight(t){const n=t.nextSibling;return n instanceof mt&&this.canMergeWith.has(n)&&this.model.schema.checkMerge(t,n)}_tryAutoparagraphing(t){const n=this.writer.createElement("paragraph");this._getAllowedIn(this.position.parent,n)&&this.schema.checkChild(n,t)&&(n._appendChild(t),this._handleNode(n))}_checkAndAutoParagraphToAllowedPosition(t){if(this.schema.checkChild(this.position.parent,t))return!0;if(!this.schema.checkChild(this.position.parent,"paragraph")||!this.schema.checkChild("paragraph",t))return!1;this._insertPartialFragment();const n=this.writer.createElement("paragraph");return this.writer.insert(n,this.position),this._setAffectedBoundaries(this.position),this._lastAutoParagraph=n,this.position=this.writer.createPositionAt(n,0),!0}_checkAndSplitToAllowedPosition(t){const n=this._getAllowedIn(this.position.parent,t);if(!n)return!1;for(n!=this.position.parent&&this._insertPartialFragment();n!=this.position.parent;)if(this.position.isAtStart){const o=this.position.parent;this.position=this.writer.createPositionBefore(o),o.isEmpty&&o.parent===n&&this.writer.remove(o)}else if(this.position.isAtEnd)this.position=this.writer.createPositionAfter(this.position.parent);else{const o=this.writer.createPositionAfter(this.position.parent);this._setAffectedBoundaries(this.position),this.writer.split(this.position),this.position=o,this.canMergeWith.add(this.position.nodeAfter)}return!0}_getAllowedIn(t,n){return this.schema.checkChild(t,n)?t:this.schema.isLimit(t)?null:this._getAllowedIn(t.parent,n)}}function LA(l,t,n={}){if(t.isCollapsed)return;const o=t.getFirstRange();if(o.root.rootName=="$graveyard")return;const r=l.schema;l.change(c=>{if(!n.doNotResetEntireContent&&function(m,p){const w=m.getLimitElement(p);if(!p.containsEntireContent(w))return!1;const _=p.getFirstRange();return _.start.parent==_.end.parent?!1:m.checkChild(w,"paragraph")}(r,t))return void function(m,p){const w=m.model.schema.getLimitElement(p);m.remove(m.createRangeIn(w)),kg(m,m.createPositionAt(w,0),p)}(c,t);const[u,g]=function(m){const p=m.root.document.model,w=m.start;let _=m.end;if(p.hasContent(m,{ignoreMarkers:!0})){const v=function(A){const x=A.parent,E=x.root.document.model.schema,T=x.getAncestors({parentFirst:!0,includeSelf:!0});for(const S of T){if(E.isLimit(S))return null;if(E.isBlock(S))return S}}(_);if(v&&_.isTouching(p.createPositionAt(v,0))){const A=p.createSelection(m);p.modifySelection(A,{direction:"backward"});const x=A.getLastPosition(),E=p.createRange(x,_);p.hasContent(E,{ignoreMarkers:!0})||(_=x)}}return[te.fromPosition(w,"toPrevious"),te.fromPosition(_,"toNext")]}(o);u.isTouching(g)||c.remove(c.createRange(u,g)),n.leaveUnmerged||(function(m,p,w){const _=m.model;if(!mc(m.model.schema,p,w))return;const[v,A]=function(x,E){const T=x.getAncestors(),S=E.getAncestors();let I=0;for(;T[I]&&T[I]==S[I];)I++;return[T[I],S[I]]}(p,w);!v||!A||(!_.hasContent(v,{ignoreMarkers:!0})&&_.hasContent(A,{ignoreMarkers:!0})?function x(E,T,S,I){const N=T.parent,j=S.parent;if(!(N==I||j==I)){for(T=E.createPositionAfter(N),(S=E.createPositionBefore(j)).isEqual(T)||E.insert(N,S);T.parent.isEmpty;){const X=T.parent;T=E.createPositionBefore(X),E.remove(X)}S=E.createPositionBefore(j),function(X,vt){const dt=vt.nodeBefore,re=vt.nodeAfter;dt.name!=re.name&&X.rename(dt,re.name),X.clearAttributes(dt),X.setAttributes(Object.fromEntries(re.getAttributes()),dt),X.merge(vt)}(E,S),mc(E.model.schema,T,S)&&x(E,T,S,I)}}(m,p,w,v.parent):function x(E,T,S,I){const N=T.parent,j=S.parent;if(!(N==I||j==I)){for(T=E.createPositionAfter(N),(S=E.createPositionBefore(j)).isEqual(T)||E.insert(j,T),E.merge(T);S.parent.isEmpty;){const X=S.parent;S=E.createPositionBefore(X),E.remove(X)}mc(E.model.schema,T,S)&&x(E,T,S,I)}}(m,p,w,v.parent))}(c,u,g),r.removeDisallowedAttributes(u.parent.getChildren(),c)),vg(c,t,u),!n.doNotAutoparagraph&&function(m,p){const w=m.checkChild(p,"$text"),_=m.checkChild(p,"paragraph");return!w&&_}(r,u)&&kg(c,u,t),u.detach(),g.detach()})}function mc(l,t,n){const o=t.parent,r=n.parent;return o!=r&&!l.isLimit(o)&&!l.isLimit(r)&&function(c,u,g){const m=new O(c,u);for(const p of m.getWalker())if(g.isLimit(p.item))return!1;return!0}(t,n,l)}function kg(l,t,n){const o=l.createElement("paragraph");l.insert(o,t),vg(l,n,l.createPositionAt(o,0))}function vg(l,t,n){t instanceof qe?l.setSelection(n):t.setTo(n)}function VA(l,t){const{isForward:n,walker:o,unit:r,schema:c}=l,{type:u,item:g,nextPosition:m}=t;if(u=="text")return l.unit==="word"?function(p,w){let _=p.position.textNode;if(_){let v=p.position.offset-_.startOffset;for(;!FA(_.data,v,w)&&!zA(_,v,w);){p.next();const A=w?p.position.nodeAfter:p.position.nodeBefore;if(A&&A.is("$text")){const x=A.data.charAt(w?0:A.data.length-1);' ,.?!:;"-()'.includes(x)||(p.next(),_=p.position.textNode)}v=p.position.offset-_.startOffset}}return p.position}(o,n):function(p,w){const _=p.position.textNode;if(_){const v=_.data;let A=p.position.offset-_.startOffset;for(;mg(v,A)||w=="character"&&pg(v,A);)p.next(),A=p.position.offset-_.startOffset}return p.position}(o,r);if(u==(n?"elementStart":"elementEnd")){if(c.isSelectable(g))return L._createAt(g,n?"after":"before");if(c.checkChild(m,"$text"))return m}else{if(c.isLimit(g))return void o.skip(()=>!0);if(c.checkChild(m,"$text"))return m}}function BA(l,t){const n=l.root,o=L._createAt(n,t?"end":0);return t?new O(l,o):new O(o,l)}function FA(l,t,n){const o=t+(n?0:-1);return' ,.?!:;"-()'.includes(l.charAt(o))}function zA(l,t,n){return t===(n?l.endOffset:0)}function yg(l,t){const n=[];Array.from(l.getItems({direction:"backward"})).map(o=>t.createRangeOn(o)).filter(o=>(o.start.isAfter(l.start)||o.start.isEqual(l.start))&&(o.end.isBefore(l.end)||o.end.isEqual(l.end))).forEach(o=>{n.push(o.start.parent),t.remove(o)}),n.forEach(o=>{let r=o;for(;r.parent&&r.isEmpty;){const c=t.createRangeOn(r);r=r.parent,t.remove(c)}})}function jA(l){l.document.registerPostFixer(t=>function(n,o){const r=o.document.selection,c=o.schema,u=[];let g=!1;for(const m of r.getRanges()){const p=$A(m,c);p&&!p.isEqual(m)?(u.push(p),g=!0):u.push(m)}g&&n.setSelection(function(m){const p=[...m],w=new Set;let _=1;for(;_<p.length;){const v=p[_],A=p.slice(0,_);for(const[x,E]of A.entries())if(!w.has(x)){if(v.isEqual(E))w.add(x);else if(v.isIntersecting(E)){w.add(x),w.add(_);const T=v.getJoined(E);p.push(T)}}_++}return p.filter((v,A)=>!w.has(A))}(u),{backward:r.isBackward})}(t,l))}function $A(l,t){return l.isCollapsed?function(n,o){const r=n.start,c=o.getNearestSelectionRange(r);if(!c){const g=r.getAncestors().reverse().find(m=>o.isObject(m));return g?O._createOn(g):null}if(!c.isCollapsed)return c;const u=c.start;return r.isEqual(u)?null:new O(u)}(l,t):function(n,o){const{start:r,end:c}=n,u=o.checkChild(r,"$text"),g=o.checkChild(c,"$text"),m=o.getLimitElement(r),p=o.getLimitElement(c);if(m===p){if(u&&g)return null;if(function(v,A,x){const E=v.nodeAfter&&!x.isLimit(v.nodeAfter)||x.checkChild(v,"$text"),T=A.nodeBefore&&!x.isLimit(A.nodeBefore)||x.checkChild(A,"$text");return E||T}(r,c,o)){const v=r.nodeAfter&&o.isSelectable(r.nodeAfter)?null:o.getNearestSelectionRange(r,"forward"),A=c.nodeBefore&&o.isSelectable(c.nodeBefore)?null:o.getNearestSelectionRange(c,"backward"),x=v?v.start:r,E=A?A.end:c;return new O(x,E)}}const w=m&&!m.is("rootElement"),_=p&&!p.is("rootElement");if(w||_){const v=r.nodeAfter&&c.nodeBefore&&r.nodeAfter.parent===c.nodeBefore.parent,A=w&&(!v||!Cg(r.nodeAfter,o)),x=_&&(!v||!Cg(c.nodeBefore,o));let E=r,T=c;return A&&(E=L._createBefore(Ag(m,o))),x&&(T=L._createAfter(Ag(p,o))),new O(E,T)}return null}(l,t)}function Ag(l,t){let n=l,o=n;for(;t.isLimit(o)&&o.parent;)n=o,o=o.parent;return n}function Cg(l,t){return l&&t.isSelectable(l)}class xg{constructor(){this.markers=new _g,this.document=new bg(this),this.schema=new ng,this._pendingChanges=[],this._currentWriter=null,["insertContent","deleteContent","modifySelection","getSelectedContent","applyOperation"].forEach(t=>this.decorate(t)),this.on("applyOperation",(t,n)=>{n[0]._validate()},{priority:"highest"}),this.schema.register("$root",{isLimit:!0}),this.schema.register("$block",{allowIn:"$root",isBlock:!0}),this.schema.register("$text",{allowIn:"$block",isInline:!0,isContent:!0}),this.schema.register("$clipboardHolder",{allowContentOf:"$root",allowChildren:"$text",isLimit:!0}),this.schema.register("$documentFragment",{allowContentOf:"$root",allowChildren:"$text",isLimit:!0}),this.schema.register("$marker"),this.schema.addChildCheck((t,n)=>{if(n.name==="$marker")return!0}),jA(this),this.document.registerPostFixer(Kf)}change(t){try{return this._pendingChanges.length===0?(this._pendingChanges.push({batch:new Yr,callback:t}),this._runPendingChanges()[0]):t(this._currentWriter)}catch(n){y.a.rethrowUnexpectedError(n,this)}}enqueueChange(t,n){try{typeof t=="string"?t=new Yr(t):typeof t=="function"&&(n=t,t=new Yr),this._pendingChanges.push({batch:t,callback:n}),this._pendingChanges.length==1&&this._runPendingChanges()}catch(o){y.a.rethrowUnexpectedError(o,this)}}applyOperation(t){t._execute()}insertContent(t,n,o){return function(r,c,u,g){return r.change(m=>{let p;p=u?u instanceof vn||u instanceof qe?u:m.createSelection(u,g):r.document.selection,p.isCollapsed||r.deleteContent(p,{doNotAutoparagraph:!0});const w=new DA(r,m,p.anchor);let _;_=c.is("documentFragment")?c.getChildren():[c],w.handleNodes(_);const v=w.getSelectionRange();v&&(p instanceof qe?m.setSelection(v):p.setTo(v));const A=w.getAffectedRange()||r.createRange(p.anchor);return w.destroy(),A})}(this,t,n,o)}deleteContent(t,n){LA(this,t,n)}modifySelection(t,n){(function(o,r,c={}){const u=o.schema,g=c.direction!="backward",m=c.unit?c.unit:"character",p=r.focus,w=new kn({boundaries:BA(p,g),singleCharacters:!0,direction:g?"forward":"backward"}),_={walker:w,schema:u,isForward:g,unit:m};let v;for(;v=w.next();){if(v.done)return;const A=VA(_,v.value);if(A)return void(r instanceof qe?o.change(x=>{x.setSelectionFocus(A)}):r.setFocus(A))}})(this,t,n)}getSelectedContent(t){return function(n,o){return n.change(r=>{const c=r.createDocumentFragment(),u=o.getFirstRange();if(!u||u.isCollapsed)return c;const g=u.start.root,m=u.start.getCommonPath(u.end),p=g.getNodeByPath(m);let w;w=u.start.parent==u.end.parent?u:r.createRange(r.createPositionAt(p,u.start.path[m.length]),r.createPositionAt(p,u.end.path[m.length]+1));const _=w.end.offset-w.start.offset;for(const v of w.getItems({shallow:!0}))v.is("$textProxy")?r.appendText(v.data,v.getAttributes(),c):r.append(r.cloneElement(v,!0),c);if(w!=u){const v=u._getTransformedByMove(w.start,r.createPositionAt(c,0),_)[0],A=r.createRange(r.createPositionAt(c,0),v.start);yg(r.createRange(v.end,r.createPositionAt(c,"end")),r),yg(A,r)}return c})}(this,t)}hasContent(t,n={}){const o=t instanceof mt?O._createIn(t):t;if(o.isCollapsed)return!1;const{ignoreWhitespaces:r=!1,ignoreMarkers:c=!1}=n;if(!c){for(const u of this.markers.getMarkersIntersectingRange(o))if(u.affectsData)return!0}for(const u of o.getItems())if(this.schema.isContent(u)&&(!u.is("$textProxy")||!r||u.data.search(/\S/)!==-1))return!0;return!1}createPositionFromPath(t,n,o){return new L(t,n,o)}createPositionAt(t,n){return L._createAt(t,n)}createPositionAfter(t){return L._createAfter(t)}createPositionBefore(t){return L._createBefore(t)}createRange(t,n){return new O(t,n)}createRangeIn(t){return O._createIn(t)}createRangeOn(t){return O._createOn(t)}createSelection(t,n,o){return new vn(t,n,o)}createBatch(t){return new Yr(t)}createOperationFromJSON(t){return(class{static fromJSON(n,o){return Ue[n.__className].fromJSON(n,o)}}).fromJSON(t,this.document)}destroy(){this.document.destroy(),this.stopListening()}_runPendingChanges(){const t=[];for(this.fire("_beforeChanges");this._pendingChanges.length;){const n=this._pendingChanges[0].batch;this._currentWriter=new TA(this,n);const o=this._pendingChanges[0].callback(this._currentWriter);t.push(o),this.document._handleChangeBlock(this._currentWriter),this._pendingChanges.shift(),this._currentWriter=null}return this.fire("_afterChanges"),t}}tt(xg,yt);class HA extends _n{constructor(t){super(),this.editor=t}set(t,n,o={}){if(typeof n=="string"){const r=n;n=(c,u)=>{this.editor.execute(r),u()}}super.set(t,n,o)}}class Eg{constructor(t={}){const n=t.language||this.constructor.defaultConfig&&this.constructor.defaultConfig.language;this._context=t.context||new F0({language:n}),this._context._addEditor(this,!t.context);const o=Array.from(this.constructor.builtinPlugins||[]);this.config=new Nh(t,this.constructor.defaultConfig),this.config.define("plugins",o),this.config.define(this._context._getEditorConfig()),this.plugins=new Ml(this,o,this._context.plugins),this.locale=this._context.locale,this.t=this.locale.t,this.commands=new dA,this.set("state","initializing"),this.once("ready",()=>this.state="ready",{priority:"high"}),this.once("destroy",()=>this.state="destroyed",{priority:"high"}),this.set("isReadOnly",!1),this.model=new xg;const r=new a1;this.data=new sg(this.model,r),this.editing=new eg(this.model,r),this.editing.view.document.bind("isReadOnly").to(this),this.conversion=new xA([this.editing.downcastDispatcher,this.data.downcastDispatcher],this.data.upcastDispatcher),this.conversion.addAlias("dataDowncast",this.data.downcastDispatcher),this.conversion.addAlias("editingDowncast",this.editing.downcastDispatcher),this.keystrokes=new HA(this),this.keystrokes.listenTo(this.editing.view.document)}initPlugins(){const t=this.config,n=t.get("plugins"),o=t.get("removePlugins")||[],r=t.get("extraPlugins")||[],c=t.get("substitutePlugins")||[];return this.plugins.init(n.concat(r),o,c)}destroy(){let t=Promise.resolve();return this.state=="initializing"&&(t=new Promise(n=>this.once("ready",n))),t.then(()=>{this.fire("destroy"),this.stopListening(),this.commands.destroy()}).then(()=>this.plugins.destroy()).then(()=>{this.model.destroy(),this.data.destroy(),this.editing.destroy(),this.keystrokes.destroy()}).then(()=>this._context._removeEditor(this))}execute(...t){try{return this.commands.execute(...t)}catch(n){y.a.rethrowUnexpectedError(n,this)}}focus(){this.editing.view.focus()}}tt(Eg,yt);class WA{constructor(t){this.editor=t,this._components=new Map}*names(){for(const t of this._components.values())yield t.originalName}add(t,n){this._components.set(pc(t),{callback:n,originalName:t})}create(t){if(!this.has(t))throw new y.a("componentfactory-item-missing",this,{name:t});return this._components.get(pc(t)).callback(this.editor.locale)}has(t){return this._components.has(pc(t))}}function pc(l){return String(l).toLowerCase()}class Tg{constructor(t){this.editor=t,this.componentFactory=new WA(t),this.focusTracker=new Oe,this.set("viewportOffset",this._readViewportOffsetFromConfig()),this._editableElementsMap=new Map,this.listenTo(t.editing.view.document,"layoutChanged",()=>this.update())}get element(){return null}update(){this.fire("update")}destroy(){this.stopListening(),this.focusTracker.destroy();for(const t of this._editableElementsMap.values())t.ckeditorInstance=null;this._editableElementsMap=new Map}setEditableElement(t,n){this._editableElementsMap.set(t,n),n.ckeditorInstance||(n.ckeditorInstance=this.editor)}getEditableElement(t="main"){return this._editableElementsMap.get(t)}getEditableElementsNames(){return this._editableElementsMap.keys()}get _editableElements(){return console.warn("editor-ui-deprecated-editable-elements: The EditorUI#_editableElements property has been deprecated and will be removed in the near future.",{editorUI:this}),this._editableElementsMap}_readViewportOffsetFromConfig(){const t=this.editor,n=t.config.get("ui.viewportOffset");if(n)return n;const o=t.config.get("toolbar.viewportTopOffset");return o?(console.warn("editor-ui-deprecated-viewport-offset-config: The `toolbar.vieportTopOffset` configuration option is deprecated. It will be removed from future CKEditor versions. Use `ui.viewportOffset.top` instead."),{top:o}):{top:0}}}tt(Tg,yt);var qA={setData(l){this.data.set(l)},getData(l){return this.data.get(l)}},UA={updateSourceElement(){if(!this.sourceElement)throw new y.a("editor-missing-sourceelement",this);var l,t;l=this.sourceElement,t=this.data.get(),l instanceof HTMLTextAreaElement&&(l.value=t),l.innerHTML=t}};class Sg extends Zo{static get pluginName(){return"PendingActions"}init(){this.set("hasAny",!1),this._actions=new Me({idProperty:"_id"}),this._actions.delegate("add","remove").to(this)}add(t){if(typeof t!="string")throw new y.a("pendingactions-add-invalid-message",this);const n=Object.create(yt);return n.set("message",t),this._actions.add(n),this.hasAny=!0,n}remove(t){this._actions.remove(t),this.hasAny=!!this._actions.length}get first(){return this._actions.get(0)}[Symbol.iterator](){return this._actions[Symbol.iterator]()}}var GA='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.999 2H15a1 1 0 0 1 0 2h-1.004v13a1 1 0 1 1-2 0V4H8.999v13a1 1 0 1 1-2 0v-7A4 4 0 0 1 3 6a4 4 0 0 1 3.999-4z"/></svg>',Pg='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><circle cx="9.5" cy="4.5" r="1.5"/><circle cx="9.5" cy="10.5" r="1.5"/><circle cx="9.5" cy="16.5" r="1.5"/></svg>';const De={cancel:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.591 10.177 4.243 4.242a1 1 0 0 1-1.415 1.415l-4.242-4.243-4.243 4.243a1 1 0 0 1-1.414-1.415l4.243-4.242L4.52 5.934A1 1 0 0 1 5.934 4.52l4.243 4.243 4.242-4.243a1 1 0 1 1 1.415 1.414l-4.243 4.243z"/></svg>',caption:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 16h9a1 1 0 0 1 0 2H2a1 1 0 0 1 0-2z"/><path d="M17 1a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h14zm0 1.5H3a.5.5 0 0 0-.492.41L2.5 3v9a.5.5 0 0 0 .41.492L3 12.5h14a.5.5 0 0 0 .492-.41L17.5 12V3a.5.5 0 0 0-.41-.492L17 2.5z" fill-opacity=".6"/></svg>',check:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.972 16.615a.997.997 0 0 1-.744-.292l-4.596-4.596a1 1 0 1 1 1.414-1.414l3.926 3.926 9.937-9.937a1 1 0 0 1 1.414 1.415L7.717 16.323a.997.997 0 0 1-.745.292z"/></svg>',cog:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.333 2 .19 2.263a5.899 5.899 0 0 1 1.458.604L14.714 3.4 16.6 5.286l-1.467 1.733c.263.452.468.942.605 1.46L18 8.666v2.666l-2.263.19a5.899 5.899 0 0 1-.604 1.458l1.467 1.733-1.886 1.886-1.733-1.467a5.899 5.899 0 0 1-1.46.605L11.334 18H8.667l-.19-2.263a5.899 5.899 0 0 1-1.458-.604L5.286 16.6 3.4 14.714l1.467-1.733a5.899 5.899 0 0 1-.604-1.458L2 11.333V8.667l2.262-.189a5.899 5.899 0 0 1 .605-1.459L3.4 5.286 5.286 3.4l1.733 1.467a5.899 5.899 0 0 1 1.46-.605L8.666 2h2.666zM10 6.267a3.733 3.733 0 1 0 0 7.466 3.733 3.733 0 0 0 0-7.466z"/></svg>',eraser:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m8.636 9.531-2.758 3.94a.5.5 0 0 0 .122.696l3.224 2.284h1.314l2.636-3.736L8.636 9.53zm.288 8.451L5.14 15.396a2 2 0 0 1-.491-2.786l6.673-9.53a2 2 0 0 1 2.785-.49l3.742 2.62a2 2 0 0 1 .491 2.785l-7.269 10.053-2.147-.066z"/><path d="M4 18h5.523v-1H4zm-2 0h1v-1H2z"/></svg>',lowVision:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5.085 6.22 2.943 4.078a.75.75 0 1 1 1.06-1.06l2.592 2.59A11.094 11.094 0 0 1 10 5.068c4.738 0 8.578 3.101 8.578 5.083 0 1.197-1.401 2.803-3.555 3.887l1.714 1.713a.75.75 0 0 1-.09 1.138.488.488 0 0 1-.15.084.75.75 0 0 1-.821-.16L6.17 7.304c-.258.11-.51.233-.757.365l6.239 6.24-.006.005.78.78c-.388.094-.78.166-1.174.215l-1.11-1.11h.011L4.55 8.197a7.2 7.2 0 0 0-.665.514l-.112.098 4.897 4.897-.005.006 1.276 1.276a10.164 10.164 0 0 1-1.477-.117l-.479-.479-.009.009-4.863-4.863-.022.031a2.563 2.563 0 0 0-.124.2c-.043.077-.08.158-.108.241a.534.534 0 0 0-.028.133.29.29 0 0 0 .008.072.927.927 0 0 0 .082.226c.067.133.145.26.234.379l3.242 3.365.025.01.59.623c-3.265-.918-5.59-3.155-5.59-4.668 0-1.194 1.448-2.838 3.663-3.93zm7.07.531a4.632 4.632 0 0 1 1.108 5.992l.345.344.046-.018a9.313 9.313 0 0 0 2-1.112c.256-.187.5-.392.727-.613.137-.134.27-.277.392-.431.072-.091.141-.185.203-.286.057-.093.107-.19.148-.292a.72.72 0 0 0 .036-.12.29.29 0 0 0 .008-.072.492.492 0 0 0-.028-.133.999.999 0 0 0-.036-.096 2.165 2.165 0 0 0-.071-.145 2.917 2.917 0 0 0-.125-.2 3.592 3.592 0 0 0-.263-.335 5.444 5.444 0 0 0-.53-.523 7.955 7.955 0 0 0-1.054-.768 9.766 9.766 0 0 0-1.879-.891c-.337-.118-.68-.219-1.027-.301zm-2.85.21-.069.002a.508.508 0 0 0-.254.097.496.496 0 0 0-.104.679.498.498 0 0 0 .326.199l.045.005c.091.003.181.003.272.012a2.45 2.45 0 0 1 2.017 1.513c.024.061.043.125.069.185a.494.494 0 0 0 .45.287h.008a.496.496 0 0 0 .35-.158.482.482 0 0 0 .13-.335.638.638 0 0 0-.048-.219 3.379 3.379 0 0 0-.36-.723 3.438 3.438 0 0 0-2.791-1.543l-.028-.001h-.013z"/></svg>',image:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.91 10.54c.26-.23.64-.21.88.03l3.36 3.14 2.23-2.06a.64.64 0 0 1 .87 0l2.52 2.97V4.5H3.2v10.12l3.71-4.08zm10.27-7.51c.6 0 1.09.47 1.09 1.05v11.84c0 .59-.49 1.06-1.09 1.06H2.79c-.6 0-1.09-.47-1.09-1.06V4.08c0-.58.49-1.05 1.1-1.05h14.38zm-5.22 5.56a1.96 1.96 0 1 1 3.4-1.96 1.96 1.96 0 0 1-3.4 1.96z"/></svg>',alignBottom:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m9.239 13.938-2.88-1.663a.75.75 0 0 1 .75-1.3L9 12.067V4.75a.75.75 0 1 1 1.5 0v7.318l1.89-1.093a.75.75 0 0 1 .75 1.3l-2.879 1.663a.752.752 0 0 1-.511.187.752.752 0 0 1-.511-.187zM4.25 17a.75.75 0 1 1 0-1.5h10.5a.75.75 0 0 1 0 1.5H4.25z"/></svg>',alignMiddle:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.75 11.875a.752.752 0 0 1 .508.184l2.883 1.666a.75.75 0 0 1-.659 1.344l-.091-.044-1.892-1.093.001 4.318a.75.75 0 1 1-1.5 0v-4.317l-1.89 1.092a.75.75 0 0 1-.75-1.3l2.879-1.663a.752.752 0 0 1 .51-.187zM15.25 9a.75.75 0 1 1 0 1.5H4.75a.75.75 0 1 1 0-1.5h10.5zM9.75.375a.75.75 0 0 1 .75.75v4.318l1.89-1.093.092-.045a.75.75 0 0 1 .659 1.344l-2.883 1.667a.752.752 0 0 1-.508.184.752.752 0 0 1-.511-.187L6.359 5.65a.75.75 0 0 1 .75-1.299L9 5.442V1.125a.75.75 0 0 1 .75-.75z"/></svg>',alignTop:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m10.261 7.062 2.88 1.663a.75.75 0 0 1-.75 1.3L10.5 8.933v7.317a.75.75 0 1 1-1.5 0V8.932l-1.89 1.093a.75.75 0 0 1-.75-1.3l2.879-1.663a.752.752 0 0 1 .511-.187.752.752 0 0 1 .511.187zM15.25 4a.75.75 0 1 1 0 1.5H4.75a.75.75 0 0 1 0-1.5h10.5z"/></svg>',alignLeft:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>',alignCenter:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm2.286 4c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75z"/></svg>',alignRight:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M18 3.75a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 8a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 4a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75zm0-8a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75z"/></svg>',alignJustify:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>',objectLeft:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm11.5 9H18v1.5h-4.5zm0-3H18v1.5h-4.5zm0-3H18v1.5h-4.5zM2 15h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',objectCenter:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M15.003 7v5.5a1 1 0 0 1-1 1H5.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H6.5V12h6.997V7.5z"/></svg>',objectRight:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2zm0-9h5v1.5H2zm0 3h5v1.5H2zm0 3h5v1.5H2z"/><path d="M18.003 7v5.5a1 1 0 0 1-1 1H8.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H9.5V12h6.997V7.5z"/></svg>',objectFullWidth:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M18 7v5.5a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1zm-1.505.5H3.504V12h12.991V7.5z"/></svg>',objectInline:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm11.5 9H18v1.5h-4.5zM2 15h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',objectBlockLeft:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',objectBlockRight:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M18.003 7v5.5a1 1 0 0 1-1 1H8.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H9.5V12h6.997V7.5z"/></svg>',objectSizeFull:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M18.095 2H1.905C.853 2 0 2.895 0 4v12c0 1.105.853 2 1.905 2h16.19C19.147 18 20 17.105 20 16V4c0-1.105-.853-2-1.905-2zm0 1.5c.263 0 .476.224.476.5v12c0 .276-.213.5-.476.5H1.905a.489.489 0 0 1-.476-.5V4c0-.276.213-.5.476-.5h16.19z"/></svg>',objectSizeLarge:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M13 6H2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2zm0 1.5a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5V8a.5.5 0 0 1 .5-.5h11z"/></svg>',objectSizeSmall:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M7 10H2a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h5a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2zm0 1.5a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-4a.5.5 0 0 1 .5-.5h5z"/></svg>',objectSizeMedium:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M10 8H2a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-6a2 2 0 0 0-2-2zm0 1.5a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-6a.5.5 0 0 1 .5-.5h8z"/></svg>',pencil:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m7.3 17.37-.061.088a1.518 1.518 0 0 1-.934.535l-4.178.663-.806-4.153a1.495 1.495 0 0 1 .187-1.058l.056-.086L8.77 2.639c.958-1.351 2.803-1.076 4.296-.03 1.497 1.047 2.387 2.693 1.433 4.055L7.3 17.37zM9.14 4.728l-5.545 8.346 3.277 2.294 5.544-8.346L9.14 4.728zM6.07 16.512l-3.276-2.295.53 2.73 2.746-.435zM9.994 3.506 13.271 5.8c.316-.452-.16-1.333-1.065-1.966-.905-.634-1.895-.78-2.212-.328zM8 18.5 9.375 17H19v1.5H8z"/></svg>',pilcrow:GA,quote:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 10.423a6.5 6.5 0 0 1 6.056-6.408l.038.67C6.448 5.423 5.354 7.663 5.22 10H9c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574zm8 0a6.5 6.5 0 0 1 6.056-6.408l.038.67c-2.646.739-3.74 2.979-3.873 5.315H17c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574z"/></svg>',threeVerticalDots:Pg};function bc({emitter:l,activator:t,callback:n,contextElements:o}){l.listenTo(document,"mousedown",(r,c)=>{if(!t())return;const u=typeof c.composedPath=="function"?c.composedPath():[];for(const g of o)if(g.contains(c.target)||u.includes(g))return;n()})}function wc(l){l.set("_isCssTransitionsDisabled",!1),l.disableCssTransitions=()=>{l._isCssTransitionsDisabled=!0},l.enableCssTransitions=()=>{l._isCssTransitionsDisabled=!1},l.extendTemplate({attributes:{class:[l.bindTemplate.if("_isCssTransitionsDisabled","ck-transitions-disabled")]}})}function _c({view:l}){l.listenTo(l.element,"submit",(t,n)=>{n.preventDefault(),l.fire("submit")},{useCapture:!0})}class di extends Me{constructor(t=[]){super(t,{idProperty:"viewUid"}),this.on("add",(n,o,r)=>{this._renderViewIntoCollectionParent(o,r)}),this.on("remove",(n,o)=>{o.element&&this._parentElement&&o.element.remove()}),this._parentElement=null}destroy(){this.map(t=>t.destroy())}setParent(t){this._parentElement=t;for(const n of this)this._renderViewIntoCollectionParent(n)}delegate(...t){if(!t.length||!t.every(n=>typeof n=="string"))throw new y.a("ui-viewcollection-delegate-wrong-events",this);return{to:n=>{for(const o of this)for(const r of t)o.delegate(r).to(n);this.on("add",(o,r)=>{for(const c of t)r.delegate(c).to(n)}),this.on("remove",(o,r)=>{for(const c of t)r.stopDelegating(c,n)})}}}_renderViewIntoCollectionParent(t,n){t.isRendered||t.render(),t.element&&this._parentElement&&this._parentElement.insertBefore(t.element,this._parentElement.children[n])}}d(17);class st{constructor(t){this.element=null,this.isRendered=!1,this.locale=t,this.t=t&&t.t,this._viewCollections=new Me,this._unboundChildren=this.createCollection(),this._viewCollections.on("add",(n,o)=>{o.locale=t}),this.decorate("render")}get bindTemplate(){return this._bindTemplate?this._bindTemplate:this._bindTemplate=ye.bind(this,this)}createCollection(t){const n=new di(t);return this._viewCollections.add(n),n}registerChild(t){Ie(t)||(t=[t]);for(const n of t)this._unboundChildren.add(n)}deregisterChild(t){Ie(t)||(t=[t]);for(const n of t)this._unboundChildren.remove(n)}setTemplate(t){this.template=new ye(t)}extendTemplate(t){ye.extend(this.template,t)}render(){if(this.isRendered)throw new y.a("ui-view-render-already-rendered",this);this.template&&(this.element=this.template.render(),this.registerChild(this.template.getViews())),this.isRendered=!0}destroy(){this.stopListening(),this._viewCollections.map(t=>t.destroy()),this.template&&this.template._revertData&&this.template.revert(this.element)}}tt(st,Ji),tt(st,yt);class ye{constructor(t){Object.assign(this,Og(Rg(t))),this._isRendered=!1,this._revertData=null}render(){const t=this._renderNode({intoFragment:!0});return this._isRendered=!0,t}apply(t){return this._revertData={children:[],bindings:[],attributes:{}},this._renderNode({node:t,isApplying:!0,revertData:this._revertData}),t}revert(t){if(!this._revertData)throw new y.a("ui-template-revert-not-applied",[this,t]);this._revertTemplateFromNode(t,this._revertData)}*getViews(){yield*function*t(n){if(n.children)for(const o of n.children)Qr(o)?yield o:kc(o)&&(yield*t(o))}(this)}static bind(t,n){return{to:(o,r)=>new KA({eventNameOrFunction:o,attribute:o,observable:t,emitter:n,callback:r}),if:(o,r,c)=>new Ig({observable:t,emitter:n,attribute:o,valueIfTrue:r,callback:c})}}static extend(t,n){if(t._isRendered)throw new y.a("template-extend-render",[this,t]);(function o(r,c){if(c.attributes&&(r.attributes||(r.attributes={}),Lg(r.attributes,c.attributes)),c.eventListeners&&(r.eventListeners||(r.eventListeners={}),Lg(r.eventListeners,c.eventListeners)),c.text&&r.text.push(...c.text),c.children&&c.children.length){if(r.children.length!=c.children.length)throw new y.a("ui-template-extend-children-mismatch",r);let u=0;for(const g of c.children)o(r.children[u++],g)}})(t,Og(Rg(n)))}_renderNode(t){let n;if(n=t.node?this.tag&&this.text:this.tag?this.text:!this.text,n)throw new y.a("ui-template-wrong-syntax",this);return this.text?this._renderText(t):this._renderElement(t)}_renderElement(t){let n=t.node;return n||(n=t.node=document.createElementNS(this.ns||"http://www.w3.org/1999/xhtml",this.tag)),this._renderAttributes(t),this._renderElementChildren(t),this._setUpListeners(t),n}_renderText(t){let n=t.node;return n?t.revertData.text=n.textContent:n=t.node=document.createTextNode(""),Jr(this.text)?this._bindToObservable({schema:this.text,updater:YA(n),data:t}):n.textContent=this.text.join(""),n}_renderAttributes(t){let n,o,r,c;if(!this.attributes)return;const u=t.node,g=t.revertData;for(n in this.attributes)if(r=u.getAttribute(n),o=this.attributes[n],g&&(g.attributes[n]=r),c=G(o[0])&&o[0].ns?o[0].ns:null,Jr(o)){const m=c?o[0].value:o;g&&Vg(n)&&m.unshift(r),this._bindToObservable({schema:m,updater:JA(u,n,c),data:t})}else n=="style"&&typeof o[0]!="string"?this._renderStyleAttribute(o[0],t):(g&&r&&Vg(n)&&o.unshift(r),o=o.map(m=>m&&m.value||m).reduce((m,p)=>m.concat(p),[]).reduce(Dg,""),to(o)||u.setAttributeNS(c,n,o))}_renderStyleAttribute(t,n){const o=n.node;for(const r in t){const c=t[r];Jr(c)?this._bindToObservable({schema:[c],updater:QA(o,r),data:n}):o.style[r]=c}}_renderElementChildren(t){const n=t.node,o=t.intoFragment?document.createDocumentFragment():n,r=t.isApplying;let c=0;for(const u of this.children)if(vc(u)){if(!r){u.setParent(n);for(const g of u)o.appendChild(g.element)}}else if(Qr(u))r||(u.isRendered||u.render(),o.appendChild(u.element));else if(Yi(u))o.appendChild(u);else if(r){const g={children:[],bindings:[],attributes:{}};t.revertData.children.push(g),u._renderNode({node:o.childNodes[c++],isApplying:!0,revertData:g})}else o.appendChild(u.render());t.intoFragment&&n.appendChild(o)}_setUpListeners(t){if(this.eventListeners)for(const n in this.eventListeners){const o=this.eventListeners[n].map(r=>{const[c,u]=n.split("@");return r.activateDomEventListener(c,u,t)});t.revertData&&t.revertData.bindings.push(o)}}_bindToObservable({schema:t,updater:n,data:o}){const r=o.revertData;Mg(t,n,o);const c=t.filter(u=>!to(u)).filter(u=>u.observable).map(u=>u.activateAttributeListener(t,n,o));r&&r.bindings.push(c)}_revertTemplateFromNode(t,n){for(const o of n.bindings)for(const r of o)r();if(n.text)t.textContent=n.text;else{for(const o in n.attributes){const r=n.attributes[o];r===null?t.removeAttribute(o):t.setAttribute(o,r)}for(let o=0;o<n.children.length;++o)this._revertTemplateFromNode(t.childNodes[o],n.children[o])}}}tt(ye,D);class ls{constructor(t){Object.assign(this,t)}getValue(t){const n=this.observable[this.attribute];return this.callback?this.callback(n,t):n}activateAttributeListener(t,n,o){const r=()=>Mg(t,n,o);return this.emitter.listenTo(this.observable,"change:"+this.attribute,r),()=>{this.emitter.stopListening(this.observable,"change:"+this.attribute,r)}}}class KA extends ls{activateDomEventListener(t,n,o){const r=(c,u)=>{n&&!u.target.matches(n)||(typeof this.eventNameOrFunction=="function"?this.eventNameOrFunction(u):this.observable.fire(this.eventNameOrFunction,u))};return this.emitter.listenTo(o.node,t,r),()=>{this.emitter.stopListening(o.node,t,r)}}}class Ig extends ls{getValue(t){return!to(super.getValue(t))&&(this.valueIfTrue||!0)}}function Jr(l){return!!l&&(l.value&&(l=l.value),Array.isArray(l)?l.some(Jr):l instanceof ls)}function Mg(l,t,{node:n}){let o=function(r,c){return r.map(u=>u instanceof ls?u.getValue(c):u)}(l,n);o=l.length==1&&l[0]instanceof Ig?o[0]:o.reduce(Dg,""),to(o)?t.remove():t.set(o)}function YA(l){return{set(t){l.textContent=t},remove(){l.textContent=""}}}function JA(l,t,n){return{set(o){l.setAttributeNS(n,t,o)},remove(){l.removeAttributeNS(n,t)}}}function QA(l,t){return{set(n){l.style[t]=n},remove(){l.style[t]=null}}}function Rg(l){return Oh(l,t=>{if(t&&(t instanceof ls||kc(t)||Qr(t)||vc(t)))return t})}function Og(l){if(typeof l=="string"?l=function(t){return{text:[t]}}(l):l.text&&function(t){t.text=Kt(t.text)}(l),l.on&&(l.eventListeners=function(t){for(const n in t)Ng(t,n);return t}(l.on),delete l.on),!l.text){l.attributes&&function(n){for(const o in n)n[o].value&&(n[o].value=Kt(n[o].value)),Ng(n,o)}(l.attributes);const t=[];if(l.children)if(vc(l.children))t.push(l.children);else for(const n of l.children)kc(n)||Qr(n)||Yi(n)?t.push(n):t.push(new ye(n));l.children=t}return l}function Ng(l,t){l[t]=Kt(l[t])}function Dg(l,t){return to(t)?l:to(l)?t:`${l} ${t}`}function Lg(l,t){for(const n in t)l[n]?l[n].push(...t[n]):l[n]=t[n]}function to(l){return!l&&l!==0}function Qr(l){return l instanceof st}function kc(l){return l instanceof ye}function vc(l){return l instanceof di}function Vg(l){return l=="class"||l=="style"}class XA extends di{constructor(t,n=[]){super(n),this.locale=t}attachToDom(){this._bodyCollectionContainer=new ye({tag:"div",attributes:{class:["ck","ck-reset_all","ck-body","ck-rounded-corners"],dir:this.locale.uiLanguageDirection},children:this}).render();let t=document.querySelector(".ck-body-wrapper");t||(t=function(n,o,r={},c=[]){const u=r&&r.xmlns,g=u?n.createElementNS(u,o):n.createElement(o);for(const m in r)g.setAttribute(m,r[m]);!xf(c)&&Ie(c)||(c=[c]);for(let m of c)xf(m)&&(m=n.createTextNode(m)),g.appendChild(m);return g}(document,"div",{class:"ck-body-wrapper"}),document.body.appendChild(t)),t.appendChild(this._bodyCollectionContainer)}detachFromDom(){super.destroy(),this._bodyCollectionContainer&&this._bodyCollectionContainer.remove();const t=document.querySelector(".ck-body-wrapper");t&&t.childElementCount==0&&t.remove()}}d(19);class Xr extends st{constructor(){super();const t=this.bindTemplate;this.set("content",""),this.set("viewBox","0 0 20 20"),this.set("fillColor",""),this.setTemplate({tag:"svg",ns:"http://www.w3.org/2000/svg",attributes:{class:["ck","ck-icon"],viewBox:t.to("viewBox")}})}render(){super.render(),this._updateXMLContent(),this._colorFillPaths(),this.on("change:content",()=>{this._updateXMLContent(),this._colorFillPaths()}),this.on("change:fillColor",()=>{this._colorFillPaths()})}_updateXMLContent(){if(this.content){const t=new DOMParser().parseFromString(this.content.trim(),"image/svg+xml").querySelector("svg"),n=t.getAttribute("viewBox");for(n&&(this.viewBox=n),this.element.innerHTML="";t.childNodes.length>0;)this.element.appendChild(t.childNodes[0])}}_colorFillPaths(){this.fillColor&&this.element.querySelectorAll(".ck-icon__fill").forEach(t=>{t.style.fill=this.fillColor})}}d(21);class Bg extends st{constructor(t){super(t),this.set("text",""),this.set("position","s");const n=this.bindTemplate;this.setTemplate({tag:"span",attributes:{class:["ck","ck-tooltip",n.to("position",o=>"ck-tooltip_"+o),n.if("text","ck-hidden",o=>!o.trim())]},children:[{tag:"span",attributes:{class:["ck","ck-tooltip__text"]},children:[{text:n.to("text")}]}]})}}d(23);class Mt extends st{constructor(t){super(t);const n=this.bindTemplate,o=k();this.set("class"),this.set("labelStyle"),this.set("icon"),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isVisible",!0),this.set("isToggleable",!1),this.set("keystroke"),this.set("label"),this.set("tabindex",-1),this.set("tooltip"),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.set("withKeystroke",!1),this.children=this.createCollection(),this.tooltipView=this._createTooltipView(),this.labelView=this._createLabelView(o),this.iconView=new Xr,this.iconView.extendTemplate({attributes:{class:"ck-button__icon"}}),this.keystrokeView=this._createKeystrokeView(),this.bind("_tooltipString").to(this,"tooltip",this,"label",this,"keystroke",this._getTooltipString.bind(this)),this.setTemplate({tag:"button",attributes:{class:["ck","ck-button",n.to("class"),n.if("isEnabled","ck-disabled",r=>!r),n.if("isVisible","ck-hidden",r=>!r),n.to("isOn",r=>r?"ck-on":"ck-off"),n.if("withText","ck-button_with-text"),n.if("withKeystroke","ck-button_with-keystroke")],type:n.to("type",r=>r||"button"),tabindex:n.to("tabindex"),"aria-labelledby":"ck-editor__aria-label_"+o,"aria-disabled":n.if("isEnabled",!0,r=>!r),"aria-pressed":n.to("isOn",r=>!!this.isToggleable&&String(r))},children:this.children,on:{mousedown:n.to(r=>{r.preventDefault()}),click:n.to(r=>{this.isEnabled?this.fire("execute"):r.preventDefault()})}})}render(){super.render(),this.icon&&(this.iconView.bind("content").to(this,"icon"),this.children.add(this.iconView)),this.children.add(this.tooltipView),this.children.add(this.labelView),this.withKeystroke&&this.keystroke&&this.children.add(this.keystrokeView)}focus(){this.element.focus()}_createTooltipView(){const t=new Bg;return t.bind("text").to(this,"_tooltipString"),t.bind("position").to(this,"tooltipPosition"),t}_createLabelView(t){const n=new st,o=this.bindTemplate;return n.setTemplate({tag:"span",attributes:{class:["ck","ck-button__label"],style:o.to("labelStyle"),id:"ck-editor__aria-label_"+t},children:[{text:this.bindTemplate.to("label")}]}),n}_createKeystrokeView(){const t=new st;return t.setTemplate({tag:"span",attributes:{class:["ck","ck-button__keystroke"]},children:[{text:this.bindTemplate.to("keystroke",n=>Jh(n))}]}),t}_getTooltipString(t,n,o){return t?typeof t=="string"?t:(o&&(o=Jh(o)),t instanceof Function?t(n,o):`${n}${o?` (${o})`:""}`):""}}d(25);class yc extends Mt{constructor(t){super(t),this.isToggleable=!0,this.toggleSwitchView=this._createToggleView(),this.extendTemplate({attributes:{class:"ck-switchbutton"}})}render(){super.render(),this.children.add(this.toggleSwitchView)}_createToggleView(){const t=new st;return t.setTemplate({tag:"span",attributes:{class:["ck","ck-button__toggle"]},children:[{tag:"span",attributes:{class:["ck","ck-button__toggle__inner"]}}]}),t}}class eo{constructor(t){if(Object.assign(this,t),t.actions&&t.keystrokeHandler)for(const n in t.actions){let o=t.actions[n];typeof o=="string"&&(o=[o]);for(const r of o)t.keystrokeHandler.set(r,(c,u)=>{this[n](),u()})}}get first(){return this.focusables.find(Ac)||null}get last(){return this.focusables.filter(Ac).slice(-1)[0]||null}get next(){return this._getFocusableItem(1)}get previous(){return this._getFocusableItem(-1)}get current(){let t=null;return this.focusTracker.focusedElement===null?null:(this.focusables.find((n,o)=>{const r=n.element===this.focusTracker.focusedElement;return r&&(t=o),r}),t)}focusFirst(){this._focus(this.first)}focusLast(){this._focus(this.last)}focusNext(){this._focus(this.next)}focusPrevious(){this._focus(this.previous)}_focus(t){t&&t.focus()}_getFocusableItem(t){const n=this.current,o=this.focusables.length;if(!o)return null;if(n===null)return this[t===1?"first":"last"];let r=(n+o+t)%o;do{const c=this.focusables.get(r);if(Ac(c))return c;r=(r+o+t)%o}while(r!==n);return null}}function Ac(l){return!(!l.focus||Pt.window.getComputedStyle(l.element).display=="none")}d(27);var Fg='<svg viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg"><path d="M.941 4.523a.75.75 0 1 1 1.06-1.06l3.006 3.005 3.005-3.005a.75.75 0 1 1 1.06 1.06l-3.549 3.55a.75.75 0 0 1-1.168-.136L.941 4.523z"/></svg>';class zg extends Mt{constructor(t){super(t),this.arrowView=this._createArrowView(),this.extendTemplate({attributes:{"aria-haspopup":!0}}),this.delegate("execute").to(this,"open")}render(){super.render(),this.children.add(this.arrowView)}_createArrowView(){const t=new Xr;return t.content=Fg,t.extendTemplate({attributes:{class:"ck-dropdown__arrow"}}),t}}d(29);class jg extends st{constructor(t){super(t);const n=this.bindTemplate;this.set("class"),this.set("icon"),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isToggleable",!1),this.set("isVisible",!0),this.set("keystroke"),this.set("label"),this.set("tabindex",-1),this.set("tooltip"),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.children=this.createCollection(),this.actionView=this._createActionView(),this.arrowView=this._createArrowView(),this.keystrokes=new _n,this.focusTracker=new Oe,this.setTemplate({tag:"div",attributes:{class:["ck","ck-splitbutton",n.to("class"),n.if("isVisible","ck-hidden",o=>!o),this.arrowView.bindTemplate.if("isOn","ck-splitbutton_open")]},children:this.children})}render(){super.render(),this.children.add(this.actionView),this.children.add(this.arrowView),this.focusTracker.add(this.actionView.element),this.focusTracker.add(this.arrowView.element),this.keystrokes.listenTo(this.element),this.keystrokes.set("arrowright",(t,n)=>{this.focusTracker.focusedElement===this.actionView.element&&(this.arrowView.focus(),n())}),this.keystrokes.set("arrowleft",(t,n)=>{this.focusTracker.focusedElement===this.arrowView.element&&(this.actionView.focus(),n())})}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this.actionView.focus()}_createActionView(){const t=new Mt;return t.bind("icon","isEnabled","isOn","isToggleable","keystroke","label","tabindex","tooltip","tooltipPosition","type","withText").to(this),t.extendTemplate({attributes:{class:"ck-splitbutton__action"}}),t.delegate("execute").to(this),t}_createArrowView(){const t=new Mt,n=t.bindTemplate;return t.icon=Fg,t.extendTemplate({attributes:{class:"ck-splitbutton__arrow","aria-haspopup":!0,"aria-expanded":n.to("isOn",o=>String(o))}}),t.bind("isEnabled").to(this),t.delegate("execute").to(this,"open"),t}}class ZA extends st{constructor(t){super(t);const n=this.bindTemplate;this.set("isVisible",!1),this.set("position","se"),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-dropdown__panel",n.to("position",o=>"ck-dropdown__panel_"+o),n.if("isVisible","ck-dropdown__panel-visible")]},children:this.children,on:{selectstart:n.to(o=>o.preventDefault())}})}focus(){this.children.length&&this.children.first.focus()}focusLast(){if(this.children.length){const t=this.children.last;typeof t.focusLast=="function"?t.focusLast():t.focus()}}}d(31);function $g({element:l,target:t,positions:n,limiter:o,fitInViewport:r,viewportOffsetConfig:c}){Qn(t)&&(t=t()),Qn(o)&&(o=o());const u=function(w){return w&&w.parentNode?w.offsetParent===Pt.document.body?null:w.offsetParent:null}(l),g=new gt(l);let m;const p={targetRect:new gt(t),elementRect:g,positionedElementAncestor:u};if(o||r){const w=o&&new gt(o).getVisible(),_=r&&function(v){v=Object.assign({top:0,bottom:0,left:0,right:0},v);const A=new gt(Pt.window);return A.top+=v.top,A.height-=v.top,A.bottom-=v.bottom,A.height-=v.bottom,A}(c);Object.assign(p,{limiterRect:w,viewportRect:_}),m=function(v,A){const{elementRect:x}=A,E=x.getArea(),T=v.map(N=>new Cc(N,A)).filter(N=>!!N.name);let S=0,I=null;for(const N of T){const{_limiterIntersectionArea:j,_viewportIntersectionArea:X}=N;if(j===E)return N;const vt=X**2+j**2;vt>S&&(S=vt,I=N)}return I}(n,p)||new Cc(n[0],p)}else m=new Cc(n[0],p);return m}function Hg(l){const{scrollX:t,scrollY:n}=Pt.window;return l.clone().moveBy(t,n)}class Cc{constructor(t,n){const o=t(n.targetRect,n.elementRect,n.viewportRect);if(!o)return;const{left:r,top:c,name:u,config:g}=o;Object.assign(this,{name:u,config:g}),this._positioningFunctionCorrdinates={left:r,top:c},this._options=n}get left(){return this._absoluteRect.left}get top(){return this._absoluteRect.top}get _limiterIntersectionArea(){const t=this._options.limiterRect;if(t){const n=this._options.viewportRect;if(!n)return t.getIntersectionArea(this._rect);{const o=t.getIntersection(n);if(o)return o.getIntersectionArea(this._rect)}}return 0}get _viewportIntersectionArea(){const t=this._options.viewportRect;return t?t.getIntersectionArea(this._rect):0}get _rect(){return this._cachedRect||(this._cachedRect=this._options.elementRect.clone().moveTo(this._positioningFunctionCorrdinates.left,this._positioningFunctionCorrdinates.top)),this._cachedRect}get _absoluteRect(){return this._cachedAbsoluteRect||(this._cachedAbsoluteRect=Hg(this._rect),this._options.positionedElementAncestor&&function(t,n){const o=Hg(new gt(n)),r=Ef(n);let c=0,u=0;c-=o.left,u-=o.top,c+=n.scrollLeft,u+=n.scrollTop,c-=r.left,u-=r.top,t.moveBy(c,u)}(this._cachedAbsoluteRect,this._options.positionedElementAncestor)),this._cachedAbsoluteRect}}class no extends st{constructor(t,n,o){super(t);const r=this.bindTemplate;this.buttonView=n,this.panelView=o,this.set("isOpen",!1),this.set("isEnabled",!0),this.set("class"),this.set("id"),this.set("panelPosition","auto"),this.keystrokes=new _n,this.setTemplate({tag:"div",attributes:{class:["ck","ck-dropdown",r.to("class"),r.if("isEnabled","ck-disabled",c=>!c)],id:r.to("id"),"aria-describedby":r.to("ariaDescribedById")},children:[n,o]}),n.extendTemplate({attributes:{class:["ck-dropdown__button"]}})}render(){super.render(),this.listenTo(this.buttonView,"open",()=>{this.isOpen=!this.isOpen}),this.panelView.bind("isVisible").to(this,"isOpen"),this.on("change:isOpen",()=>{this.isOpen&&(this.panelPosition==="auto"?this.panelView.position=no._getOptimalPosition({element:this.panelView.element,target:this.buttonView.element,fitInViewport:!0,positions:this._panelPositions}).name:this.panelView.position=this.panelPosition)}),this.keystrokes.listenTo(this.element);const t=(n,o)=>{this.isOpen&&(this.buttonView.focus(),this.isOpen=!1,o())};this.keystrokes.set("arrowdown",(n,o)=>{this.buttonView.isEnabled&&!this.isOpen&&(this.isOpen=!0,o())}),this.keystrokes.set("arrowright",(n,o)=>{this.isOpen&&o()}),this.keystrokes.set("arrowleft",t),this.keystrokes.set("esc",t)}focus(){this.buttonView.focus()}get _panelPositions(){const{south:t,north:n,southEast:o,southWest:r,northEast:c,northWest:u,southMiddleEast:g,southMiddleWest:m,northMiddleEast:p,northMiddleWest:w}=no.defaultPanelPositions;return this.locale.uiLanguageDirection!=="rtl"?[o,r,g,m,t,c,u,p,w,n]:[r,o,m,g,t,u,c,w,p,n]}}no.defaultPanelPositions={south:(l,t)=>({top:l.bottom,left:l.left-(t.width-l.width)/2,name:"s"}),southEast:l=>({top:l.bottom,left:l.left,name:"se"}),southWest:(l,t)=>({top:l.bottom,left:l.left-t.width+l.width,name:"sw"}),southMiddleEast:(l,t)=>({top:l.bottom,left:l.left-(t.width-l.width)/4,name:"sme"}),southMiddleWest:(l,t)=>({top:l.bottom,left:l.left-3*(t.width-l.width)/4,name:"smw"}),north:(l,t)=>({top:l.top-t.height,left:l.left-(t.width-l.width)/2,name:"n"}),northEast:(l,t)=>({top:l.top-t.height,left:l.left,name:"ne"}),northWest:(l,t)=>({top:l.top-t.height,left:l.left-t.width+l.width,name:"nw"}),northMiddleEast:(l,t)=>({top:l.top-t.height,left:l.left-(t.width-l.width)/4,name:"nme"}),northMiddleWest:(l,t)=>({top:l.top-t.height,left:l.left-3*(t.width-l.width)/4,name:"nmw"})},no._getOptimalPosition=$g;class Wg extends st{constructor(t){super(t),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__separator"]}})}}class tC extends st{constructor(t){super(t),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__line-break"]}})}}function qg(l){return Array.isArray(l)?{items:l,removeItems:[]}:l?Object.assign({items:[],removeItems:[]},l):{items:[],removeItems:[]}}d(33);class xc extends st{constructor(t,n){super(t);const o=this.bindTemplate,r=this.t;this.options=n||{},this.set("ariaLabel",r("Editor toolbar")),this.set("maxWidth","auto"),this.items=this.createCollection(),this.focusTracker=new Oe,this.keystrokes=new _n,this.set("class"),this.set("isCompact",!1),this.itemsView=new eC(t),this.children=this.createCollection(),this.children.add(this.itemsView),this.focusables=this.createCollection();const c=t.uiLanguageDirection==="rtl";this._focusCycler=new eo({focusables:this.focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:[c?"arrowright":"arrowleft","arrowup"],focusNext:[c?"arrowleft":"arrowright","arrowdown"]}});const u=["ck","ck-toolbar",o.to("class"),o.if("isCompact","ck-toolbar_compact")];var g;this.options.shouldGroupWhenFull&&this.options.isFloating&&u.push("ck-toolbar_floating"),this.setTemplate({tag:"div",attributes:{class:u,role:"toolbar","aria-label":o.to("ariaLabel"),style:{maxWidth:o.to("maxWidth")}},children:this.children,on:{mousedown:(g=this,g.bindTemplate.to(m=>{m.target===g.element&&m.preventDefault()}))}}),this._behavior=this.options.shouldGroupWhenFull?new iC(this):new nC(this)}render(){super.render();for(const t of this.items)this.focusTracker.add(t.element);this.items.on("add",(t,n)=>{this.focusTracker.add(n.element)}),this.items.on("remove",(t,n)=>{this.focusTracker.remove(n.element)}),this.keystrokes.listenTo(this.element),this._behavior.render(this)}destroy(){return this._behavior.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy(),super.destroy()}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}fillFromConfig(t,n){const o=qg(t),r=o.items.filter((u,g,m)=>u==="|"||o.removeItems.indexOf(u)===-1&&(u==="-"?!this.options.shouldGroupWhenFull||(Object(y.b)("toolbarview-line-break-ignored-when-grouping-items",m),!1):!!n.has(u)||(Object(y.b)("toolbarview-item-unavailable",{name:u}),!1))),c=this._cleanSeparators(r).map(u=>u==="|"?new Wg:u==="-"?new tC:n.create(u));this.items.addMany(c)}_cleanSeparators(t){const n=u=>u!=="-"&&u!=="|",o=t.length,r=t.findIndex(n),c=o-t.slice().reverse().findIndex(n);return t.slice(r,c).filter((u,g,m)=>n(u)?!0:!(g>0&&m[g-1]===u))}}class eC extends st{constructor(t){super(t),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-toolbar__items"]},children:this.children})}}class nC{constructor(t){const n=t.bindTemplate;t.set("isVertical",!1),t.itemsView.children.bindTo(t.items).using(o=>o),t.focusables.bindTo(t.items).using(o=>o),t.extendTemplate({attributes:{class:[n.if("isVertical","ck-toolbar_vertical")]}})}render(){}destroy(){}}class iC{constructor(t){this.view=t,this.viewChildren=t.children,this.viewFocusables=t.focusables,this.viewItemsView=t.itemsView,this.viewFocusTracker=t.focusTracker,this.viewLocale=t.locale,this.ungroupedItems=t.createCollection(),this.groupedItems=t.createCollection(),this.groupedItemsDropdown=this._createGroupedItemsDropdown(),this.resizeObserver=null,this.cachedPadding=null,this.shouldUpdateGroupingOnNextResize=!1,t.itemsView.children.bindTo(this.ungroupedItems).using(n=>n),this.ungroupedItems.on("add",this._updateFocusCycleableItems.bind(this)),this.ungroupedItems.on("remove",this._updateFocusCycleableItems.bind(this)),t.children.on("add",this._updateFocusCycleableItems.bind(this)),t.children.on("remove",this._updateFocusCycleableItems.bind(this)),t.items.on("change",(n,o)=>{const r=o.index;for(const c of o.removed)r>=this.ungroupedItems.length?this.groupedItems.remove(c):this.ungroupedItems.remove(c);for(let c=r;c<r+o.added.length;c++){const u=o.added[c-r];c>this.ungroupedItems.length?this.groupedItems.add(u,c-this.ungroupedItems.length):this.ungroupedItems.add(u,c)}this._updateGrouping()}),t.extendTemplate({attributes:{class:["ck-toolbar_grouping"]}})}render(t){this.viewElement=t.element,this._enableGroupingOnResize(),this._enableGroupingOnMaxWidthChange(t)}destroy(){this.groupedItemsDropdown.destroy(),this.resizeObserver.destroy()}_updateGrouping(){if(!this.viewElement.ownerDocument.body.contains(this.viewElement))return;if(!this.viewElement.offsetParent)return void(this.shouldUpdateGroupingOnNextResize=!0);const t=this.groupedItems.length;let n;for(;this._areItemsOverflowing;)this._groupLastItem(),n=!0;if(!n&&this.groupedItems.length){for(;this.groupedItems.length&&!this._areItemsOverflowing;)this._ungroupFirstItem();this._areItemsOverflowing&&this._groupLastItem()}this.groupedItems.length!==t&&this.view.fire("groupedItemsUpdate")}get _areItemsOverflowing(){if(!this.ungroupedItems.length)return!1;const t=this.viewElement,n=this.viewLocale.uiLanguageDirection,o=new gt(t.lastChild),r=new gt(t);if(!this.cachedPadding){const c=Pt.window.getComputedStyle(t),u=n==="ltr"?"paddingRight":"paddingLeft";this.cachedPadding=Number.parseInt(c[u])}return n==="ltr"?o.right>r.right-this.cachedPadding:o.left<r.left+this.cachedPadding}_enableGroupingOnResize(){let t;this.resizeObserver=new It(this.viewElement,n=>{t&&t===n.contentRect.width&&!this.shouldUpdateGroupingOnNextResize||(this.shouldUpdateGroupingOnNextResize=!1,this._updateGrouping(),t=n.contentRect.width)}),this._updateGrouping()}_enableGroupingOnMaxWidthChange(t){t.on("change:maxWidth",()=>{this._updateGrouping()})}_groupLastItem(){this.groupedItems.length||(this.viewChildren.add(new Wg),this.viewChildren.add(this.groupedItemsDropdown),this.viewFocusTracker.add(this.groupedItemsDropdown.element)),this.groupedItems.add(this.ungroupedItems.remove(this.ungroupedItems.last),0)}_ungroupFirstItem(){this.ungroupedItems.add(this.groupedItems.remove(this.groupedItems.first)),this.groupedItems.length||(this.viewChildren.remove(this.groupedItemsDropdown),this.viewChildren.remove(this.viewChildren.last),this.viewFocusTracker.remove(this.groupedItemsDropdown.element))}_createGroupedItemsDropdown(){const t=this.viewLocale,n=t.t,o=ui(t);return o.class="ck-toolbar__grouped-dropdown",o.panelPosition=t.uiLanguageDirection==="ltr"?"sw":"se",Ug(o,[]),o.buttonView.set({label:n("Show more items"),tooltip:!0,tooltipPosition:t.uiLanguageDirection==="rtl"?"se":"sw",icon:Pg}),o.toolbarView.items.bindTo(this.groupedItems).using(r=>r),o}_updateFocusCycleableItems(){this.viewFocusables.clear(),this.ungroupedItems.map(t=>{this.viewFocusables.add(t)}),this.groupedItems.length&&this.viewFocusables.add(this.groupedItemsDropdown)}}d(35);class oC extends st{constructor(){super(),this.items=this.createCollection(),this.focusTracker=new Oe,this.keystrokes=new _n,this._focusCycler=new eo({focusables:this.items,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"arrowup",focusNext:"arrowdown"}}),this.setTemplate({tag:"ul",attributes:{class:["ck","ck-reset","ck-list"]},children:this.items})}render(){super.render();for(const t of this.items)this.focusTracker.add(t.element);this.items.on("add",(t,n)=>{this.focusTracker.add(n.element)}),this.items.on("remove",(t,n)=>{this.focusTracker.remove(n.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}}class sC extends st{constructor(t){super(t),this.children=this.createCollection(),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__item"]},children:this.children})}focus(){this.children.first.focus()}}class rC extends st{constructor(t){super(t),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__separator"]}})}}d(37),d(39);function ui(l,t=zg){const n=new t(l),o=new ZA(l),r=new no(l,n,o);return n.bind("isEnabled").to(r),n instanceof zg?n.bind("isOn").to(r,"isOpen"):n.arrowView.bind("isOn").to(r,"isOpen"),function(c){(function(u){u.on("render",()=>{bc({emitter:u,activator:()=>u.isOpen,callback:()=>{u.isOpen=!1},contextElements:[u.element]})})})(c),function(u){u.on("execute",g=>{g.source instanceof yc||(u.isOpen=!1)})}(c),function(u){u.keystrokes.set("arrowdown",(g,m)=>{u.isOpen&&(u.panelView.focus(),m())}),u.keystrokes.set("arrowup",(g,m)=>{u.isOpen&&(u.panelView.focusLast(),m())})}(c)}(r),r}function Ug(l,t){const n=l.locale,o=n.t,r=l.toolbarView=new xc(n);r.set("ariaLabel",o("Dropdown toolbar")),l.extendTemplate({attributes:{class:["ck-toolbar-dropdown"]}}),t.map(c=>r.items.add(c)),l.panelView.children.add(r),r.items.delegate("execute").to(l)}function Gg(l,t){const n=l.locale,o=l.listView=new oC(n);o.items.bindTo(t).using(({type:r,model:c})=>{if(r==="separator")return new rC(n);if(r==="button"||r==="switchbutton"){const u=new sC(n);let g;return g=r==="button"?new Mt(n):new yc(n),g.bind(...Object.keys(c)).to(c),g.delegate("execute").to(u),u.children.add(g),u}}),l.panelView.children.add(o),o.items.delegate("execute").to(l)}d(41);class aC extends st{constructor(t){super(t),this.body=new XA(t)}render(){super.render(),this.body.attachToDom()}destroy(){return this.body.detachFromDom(),super.destroy()}}d(43);class Kg extends st{constructor(t){super(t),this.set("text"),this.set("for"),this.id="ck-editor__label_"+k();const n=this.bindTemplate;this.setTemplate({tag:"label",attributes:{class:["ck","ck-label"],id:this.id,for:n.to("for")},children:[{text:n.to("text")}]})}}class lC extends aC{constructor(t){super(t),this.top=this.createCollection(),this.main=this.createCollection(),this._voiceLabelView=this._createVoiceLabel(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-editor","ck-rounded-corners"],role:"application",dir:t.uiLanguageDirection,lang:t.uiLanguage,"aria-labelledby":this._voiceLabelView.id},children:[this._voiceLabelView,{tag:"div",attributes:{class:["ck","ck-editor__top","ck-reset_all"],role:"presentation"},children:this.top},{tag:"div",attributes:{class:["ck","ck-editor__main"],role:"presentation"},children:this.main}]})}_createVoiceLabel(){const t=this.t,n=new Kg;return n.text=t("Rich Text Editor"),n.extendTemplate({attributes:{class:"ck-voice-label"}}),n}}class cC extends st{constructor(t,n,o){super(t),this.setTemplate({tag:"div",attributes:{class:["ck","ck-content","ck-editor__editable","ck-rounded-corners"],lang:t.contentLanguage,dir:t.contentLanguageDirection}}),this.name=null,this.set("isFocused",!1),this._editableElement=o,this._hasExternalElement=!!this._editableElement,this._editingView=n}render(){super.render(),this._hasExternalElement?this.template.apply(this.element=this._editableElement):this._editableElement=this.element,this.on("change:isFocused",()=>this._updateIsFocusedClasses()),this._updateIsFocusedClasses()}destroy(){this._hasExternalElement&&this.template.revert(this._editableElement),super.destroy()}_updateIsFocusedClasses(){const t=this._editingView;function n(o){t.change(r=>{const c=t.document.getRoot(o.name);r.addClass(o.isFocused?"ck-focused":"ck-blurred",c),r.removeClass(o.isFocused?"ck-blurred":"ck-focused",c)})}t.isRenderingInProgress?function o(r){t.once("change:isRenderingInProgress",(c,u,g)=>{g?o(r):n(r)})}(this):n(this)}}class dC extends cC{constructor(t,n,o){super(t,n,o),this.extendTemplate({attributes:{role:"textbox",class:"ck-editor__editable_inline"}})}render(){super.render();const t=this._editingView,n=this.t;t.change(o=>{const r=t.document.getRoot(this.name);o.setAttribute("aria-label",n("Rich Text Editor, %0",this.name),r)})}}d(45),d(47);class uC extends st{constructor(t){super(t),this.set("value"),this.set("id"),this.set("placeholder"),this.set("isReadOnly",!1),this.set("hasError",!1),this.set("ariaDescribedById"),this.focusTracker=new Oe,this.bind("isFocused").to(this.focusTracker),this.set("isEmpty",!0);const n=this.bindTemplate;this.setTemplate({tag:"input",attributes:{type:"text",class:["ck","ck-input","ck-input-text",n.if("isFocused","ck-input_focused"),n.if("isEmpty","ck-input-text_empty"),n.if("hasError","ck-error")],id:n.to("id"),placeholder:n.to("placeholder"),readonly:n.to("isReadOnly"),"aria-invalid":n.if("hasError",!0),"aria-describedby":n.to("ariaDescribedById")},on:{input:n.to((...o)=>{this.fire("input",...o),this._updateIsEmpty()}),change:n.to(this._updateIsEmpty.bind(this))}})}render(){super.render(),this.focusTracker.add(this.element),this._setDomElementValue(this.value),this._updateIsEmpty(),this.on("change:value",(t,n,o)=>{this._setDomElementValue(o),this._updateIsEmpty()})}destroy(){super.destroy(),this.focusTracker.destroy()}select(){this.element.select()}focus(){this.element.focus()}_updateIsEmpty(){this.isEmpty=!this.element.value}_setDomElementValue(t){this.element.value=t||t===0?t:""}}d(49);class Ec extends st{constructor(t,n){super(t);const o="ck-labeled-field-view-"+k(),r="ck-labeled-field-view-status-"+k();this.fieldView=n(this,o,r),this.set("label"),this.set("isEnabled",!0),this.set("isEmpty",!0),this.set("isFocused",!1),this.set("errorText",null),this.set("infoText",null),this.set("class"),this.set("placeholder"),this.labelView=this._createLabelView(o),this.statusView=this._createStatusView(r),this.bind("_statusText").to(this,"errorText",this,"infoText",(u,g)=>u||g);const c=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view",c.to("class"),c.if("isEnabled","ck-disabled",u=>!u),c.if("isEmpty","ck-labeled-field-view_empty"),c.if("isFocused","ck-labeled-field-view_focused"),c.if("placeholder","ck-labeled-field-view_placeholder"),c.if("errorText","ck-error")]},children:[{tag:"div",attributes:{class:["ck","ck-labeled-field-view__input-wrapper"]},children:[this.fieldView,this.labelView]},this.statusView]})}_createLabelView(t){const n=new Kg(this.locale);return n.for=t,n.bind("text").to(this,"label"),n}_createStatusView(t){const n=new st(this.locale),o=this.bindTemplate;return n.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view__status",o.if("errorText","ck-labeled-field-view__status_error"),o.if("_statusText","ck-hidden",r=>!r)],id:t,role:o.if("errorText","alert")},children:[{text:o.to("_statusText")}]}),n}focus(){this.fieldView.focus()}}function Tc(l,t,n){const o=new uC(l.locale);return o.set({id:t,ariaDescribedById:n}),o.bind("isReadOnly").to(l,"isEnabled",r=>!r),o.bind("hasError").to(l,"errorText",r=>!!r),o.on("input",()=>{l.errorText=null}),l.bind("isEmpty","isFocused","placeholder").to(o),o}class Sc extends Zo{static get pluginName(){return"Notification"}init(){this.on("show:warning",(t,n)=>{window.alert(n.message)},{priority:"lowest"})}showSuccess(t,n={}){this._showNotification({message:t,type:"success",namespace:n.namespace,title:n.title})}showInfo(t,n={}){this._showNotification({message:t,type:"info",namespace:n.namespace,title:n.title})}showWarning(t,n={}){this._showNotification({message:t,type:"warning",namespace:n.namespace,title:n.title})}_showNotification(t){const n="show:"+t.type+(t.namespace?":"+t.namespace:"");this.fire(n,{message:t.message,type:t.type,title:t.title||""})}}class Pc{constructor(t,n){n&&Ko(this,n),t&&this.set(t)}}tt(Pc,yt),d(51);const Yg=ic("px"),Jg=Pt.document.body;class be extends st{constructor(t){super(t);const n=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("position","arrow_nw"),this.set("isVisible",!1),this.set("withArrow",!0),this.set("class"),this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-panel",n.to("position",o=>"ck-balloon-panel_"+o),n.if("isVisible","ck-balloon-panel_visible"),n.if("withArrow","ck-balloon-panel_with-arrow"),n.to("class")],style:{top:n.to("top",Yg),left:n.to("left",Yg)}},children:this.content})}show(){this.isVisible=!0}hide(){this.isVisible=!1}attachTo(t){this.show();const n=be.defaultPositions,o=Object.assign({},{element:this.element,positions:[n.southArrowNorth,n.southArrowNorthMiddleWest,n.southArrowNorthMiddleEast,n.southArrowNorthWest,n.southArrowNorthEast,n.northArrowSouth,n.northArrowSouthMiddleWest,n.northArrowSouthMiddleEast,n.northArrowSouthWest,n.northArrowSouthEast,n.viewportStickyNorth],limiter:Jg,fitInViewport:!0},t),r=be._getOptimalPosition(o),c=parseInt(r.left),u=parseInt(r.top),{name:g,config:m={}}=r,{withArrow:p=!0}=m;Object.assign(this,{top:u,left:c,position:g,withArrow:p})}pin(t){this.unpin(),this._pinWhenIsVisibleCallback=()=>{this.isVisible?this._startPinning(t):this._stopPinning()},this._startPinning(t),this.listenTo(this,"change:isVisible",this._pinWhenIsVisibleCallback)}unpin(){this._pinWhenIsVisibleCallback&&(this._stopPinning(),this.stopListening(this,"change:isVisible",this._pinWhenIsVisibleCallback),this._pinWhenIsVisibleCallback=null,this.hide())}_startPinning(t){this.attachTo(t);const n=Ic(t.target),o=t.limiter?Ic(t.limiter):Jg;this.listenTo(Pt.document,"scroll",(r,c)=>{const u=c.target,g=n&&u.contains(n),m=o&&u.contains(o);!g&&!m&&n&&o||this.attachTo(t)},{useCapture:!0}),this.listenTo(Pt.window,"resize",()=>{this.attachTo(t)})}_stopPinning(){this.stopListening(Pt.document,"scroll"),this.stopListening(Pt.window,"resize")}}function Ic(l){return Dn(l)?l:Hr(l)?l.commonAncestorContainer:typeof l=="function"?Ic(l()):null}function hC({horizontalOffset:l=be.arrowHorizontalOffset,verticalOffset:t=be.arrowVerticalOffset,stickyVerticalOffset:n=be.stickyVerticalOffset,config:o}={}){return{northWestArrowSouthWest:(u,g)=>({top:r(u,g),left:u.left-l,name:"arrow_sw",...o&&{config:o}}),northWestArrowSouthMiddleWest:(u,g)=>({top:r(u,g),left:u.left-.25*g.width-l,name:"arrow_smw",...o&&{config:o}}),northWestArrowSouth:(u,g)=>({top:r(u,g),left:u.left-g.width/2,name:"arrow_s",...o&&{config:o}}),northWestArrowSouthMiddleEast:(u,g)=>({top:r(u,g),left:u.left-.75*g.width+l,name:"arrow_sme",...o&&{config:o}}),northWestArrowSouthEast:(u,g)=>({top:r(u,g),left:u.left-g.width+l,name:"arrow_se",...o&&{config:o}}),northArrowSouthWest:(u,g)=>({top:r(u,g),left:u.left+u.width/2-l,name:"arrow_sw",...o&&{config:o}}),northArrowSouthMiddleWest:(u,g)=>({top:r(u,g),left:u.left+u.width/2-.25*g.width-l,name:"arrow_smw",...o&&{config:o}}),northArrowSouth:(u,g)=>({top:r(u,g),left:u.left+u.width/2-g.width/2,name:"arrow_s",...o&&{config:o}}),northArrowSouthMiddleEast:(u,g)=>({top:r(u,g),left:u.left+u.width/2-.75*g.width+l,name:"arrow_sme",...o&&{config:o}}),northArrowSouthEast:(u,g)=>({top:r(u,g),left:u.left+u.width/2-g.width+l,name:"arrow_se",...o&&{config:o}}),northEastArrowSouthWest:(u,g)=>({top:r(u,g),left:u.right-l,name:"arrow_sw",...o&&{config:o}}),northEastArrowSouthMiddleWest:(u,g)=>({top:r(u,g),left:u.right-.25*g.width-l,name:"arrow_smw",...o&&{config:o}}),northEastArrowSouth:(u,g)=>({top:r(u,g),left:u.right-g.width/2,name:"arrow_s",...o&&{config:o}}),northEastArrowSouthMiddleEast:(u,g)=>({top:r(u,g),left:u.right-.75*g.width+l,name:"arrow_sme",...o&&{config:o}}),northEastArrowSouthEast:(u,g)=>({top:r(u,g),left:u.right-g.width+l,name:"arrow_se",...o&&{config:o}}),southWestArrowNorthWest:(u,g)=>({top:c(u),left:u.left-l,name:"arrow_nw",...o&&{config:o}}),southWestArrowNorthMiddleWest:(u,g)=>({top:c(u),left:u.left-.25*g.width-l,name:"arrow_nmw",...o&&{config:o}}),southWestArrowNorth:(u,g)=>({top:c(u),left:u.left-g.width/2,name:"arrow_n",...o&&{config:o}}),southWestArrowNorthMiddleEast:(u,g)=>({top:c(u),left:u.left-.75*g.width+l,name:"arrow_nme",...o&&{config:o}}),southWestArrowNorthEast:(u,g)=>({top:c(u),left:u.left-g.width+l,name:"arrow_ne",...o&&{config:o}}),southArrowNorthWest:(u,g)=>({top:c(u),left:u.left+u.width/2-l,name:"arrow_nw",...o&&{config:o}}),southArrowNorthMiddleWest:(u,g)=>({top:c(u),left:u.left+u.width/2-.25*g.width-l,name:"arrow_nmw",...o&&{config:o}}),southArrowNorth:(u,g)=>({top:c(u),left:u.left+u.width/2-g.width/2,name:"arrow_n",...o&&{config:o}}),southArrowNorthMiddleEast:(u,g)=>({top:c(u),left:u.left+u.width/2-.75*g.width+l,name:"arrow_nme",...o&&{config:o}}),southArrowNorthEast:(u,g)=>({top:c(u),left:u.left+u.width/2-g.width+l,name:"arrow_ne",...o&&{config:o}}),southEastArrowNorthWest:(u,g)=>({top:c(u),left:u.right-l,name:"arrow_nw",...o&&{config:o}}),southEastArrowNorthMiddleWest:(u,g)=>({top:c(u),left:u.right-.25*g.width-l,name:"arrow_nmw",...o&&{config:o}}),southEastArrowNorth:(u,g)=>({top:c(u),left:u.right-g.width/2,name:"arrow_n",...o&&{config:o}}),southEastArrowNorthMiddleEast:(u,g)=>({top:c(u),left:u.right-.75*g.width+l,name:"arrow_nme",...o&&{config:o}}),southEastArrowNorthEast:(u,g)=>({top:c(u),left:u.right-g.width+l,name:"arrow_ne",...o&&{config:o}}),viewportStickyNorth:(u,g,m)=>u.getIntersection(m)?{top:m.top+n,left:u.left+u.width/2-g.width/2,name:"arrowless",config:{withArrow:!1,...o}}:null};function r(u,g){return u.top-g.height-t}function c(u){return u.bottom+t}}be.arrowHorizontalOffset=25,be.arrowVerticalOffset=10,be.stickyVerticalOffset=20,be._getOptimalPosition=$g,be.defaultPositions=hC(),d(53),d(55);const Zr=ic("px");class ta extends z{static get pluginName(){return"ContextualBalloon"}constructor(t){super(t),this.positionLimiter=()=>{const n=this.editor.editing.view,o=n.document.selection.editableElement;return o?n.domConverter.mapViewToDom(o.root):null},this.set("visibleView",null),this.view=new be(t.locale),t.ui.view.body.add(this.view),t.ui.focusTracker.add(this.view.element),this._viewToStack=new Map,this._idToStack=new Map,this.set("_numberOfStacks",0),this.set("_singleViewMode",!1),this._rotatorView=this._createRotatorView(),this._fakePanelsView=this._createFakePanelsView()}destroy(){super.destroy(),this.view.destroy(),this._rotatorView.destroy(),this._fakePanelsView.destroy()}hasView(t){return Array.from(this._viewToStack.keys()).includes(t)}add(t){if(this.hasView(t.view))throw new y.a("contextualballoon-add-view-exist",[this,t]);const n=t.stackId||"main";if(!this._idToStack.has(n))return this._idToStack.set(n,new Map([[t.view,t]])),this._viewToStack.set(t.view,this._idToStack.get(n)),this._numberOfStacks=this._idToStack.size,void(this._visibleStack&&!t.singleViewMode||this.showStack(n));const o=this._idToStack.get(n);t.singleViewMode&&this.showStack(n),o.set(t.view,t),this._viewToStack.set(t.view,o),o===this._visibleStack&&this._showView(t)}remove(t){if(!this.hasView(t))throw new y.a("contextualballoon-remove-view-not-exist",[this,t]);const n=this._viewToStack.get(t);this._singleViewMode&&this.visibleView===t&&(this._singleViewMode=!1),this.visibleView===t&&(n.size===1?this._idToStack.size>1?this._showNextStack():(this.view.hide(),this.visibleView=null,this._rotatorView.hideView()):this._showView(Array.from(n.values())[n.size-2])),n.size===1?(this._idToStack.delete(this._getStackId(n)),this._numberOfStacks=this._idToStack.size):n.delete(t),this._viewToStack.delete(t)}updatePosition(t){t&&(this._visibleStack.get(this.visibleView).position=t),this.view.pin(this._getBalloonPosition()),this._fakePanelsView.updatePosition()}showStack(t){this.visibleStack=t;const n=this._idToStack.get(t);if(!n)throw new y.a("contextualballoon-showstack-stack-not-exist",this);this._visibleStack!==n&&this._showView(Array.from(n.values()).pop())}get _visibleStack(){return this._viewToStack.get(this.visibleView)}_getStackId(t){return Array.from(this._idToStack.entries()).find(n=>n[1]===t)[0]}_showNextStack(){const t=Array.from(this._idToStack.values());let n=t.indexOf(this._visibleStack)+1;t[n]||(n=0),this.showStack(this._getStackId(t[n]))}_showPrevStack(){const t=Array.from(this._idToStack.values());let n=t.indexOf(this._visibleStack)-1;t[n]||(n=t.length-1),this.showStack(this._getStackId(t[n]))}_createRotatorView(){const t=new fC(this.editor.locale),n=this.editor.locale.t;return this.view.content.add(t),t.bind("isNavigationVisible").to(this,"_numberOfStacks",this,"_singleViewMode",(o,r)=>!r&&o>1),t.on("change:isNavigationVisible",()=>this.updatePosition(),{priority:"low"}),t.bind("counter").to(this,"visibleView",this,"_numberOfStacks",(o,r)=>{if(r<2)return"";const c=Array.from(this._idToStack.values()).indexOf(this._visibleStack)+1;return n("%0 of %1",[c,r])}),t.buttonNextView.on("execute",()=>{t.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showNextStack()}),t.buttonPrevView.on("execute",()=>{t.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showPrevStack()}),t}_createFakePanelsView(){const t=new gC(this.editor.locale,this.view);return t.bind("numberOfPanels").to(this,"_numberOfStacks",this,"_singleViewMode",(n,o)=>!o&&n>=2?Math.min(n-1,2):0),t.listenTo(this.view,"change:top",()=>t.updatePosition()),t.listenTo(this.view,"change:left",()=>t.updatePosition()),this.editor.ui.view.body.add(t),t}_showView({view:t,balloonClassName:n="",withArrow:o=!0,singleViewMode:r=!1}){this.view.class=n,this.view.withArrow=o,this._rotatorView.showView(t),this.visibleView=t,this.view.pin(this._getBalloonPosition()),this._fakePanelsView.updatePosition(),r&&(this._singleViewMode=!0)}_getBalloonPosition(){let t=Array.from(this._visibleStack.values()).pop().position;return t&&(t.limiter||(t=Object.assign({},t,{limiter:this.positionLimiter})),t=Object.assign({},t,{viewportOffsetConfig:this.editor.ui.viewportOffset})),t}}class fC extends st{constructor(t){super(t);const n=t.t,o=this.bindTemplate;this.set("isNavigationVisible",!0),this.focusTracker=new Oe,this.buttonPrevView=this._createButtonView(n("Previous"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.463 5.187a.888.888 0 1 1 1.254 1.255L9.16 10l3.557 3.557a.888.888 0 1 1-1.254 1.255L7.26 10.61a.888.888 0 0 1 .16-1.382l4.043-4.042z"/></svg>'),this.buttonNextView=this._createButtonView(n("Next"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8.537 14.813a.888.888 0 1 1-1.254-1.255L10.84 10 7.283 6.442a.888.888 0 1 1 1.254-1.255L12.74 9.39a.888.888 0 0 1-.16 1.382l-4.043 4.042z"/></svg>'),this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-rotator"],"z-index":"-1"},children:[{tag:"div",attributes:{class:["ck-balloon-rotator__navigation",o.to("isNavigationVisible",r=>r?"":"ck-hidden")]},children:[this.buttonPrevView,{tag:"span",attributes:{class:["ck-balloon-rotator__counter"]},children:[{text:o.to("counter")}]},this.buttonNextView]},{tag:"div",attributes:{class:"ck-balloon-rotator__content"},children:this.content}]})}render(){super.render(),this.focusTracker.add(this.element)}destroy(){super.destroy(),this.focusTracker.destroy()}showView(t){this.hideView(),this.content.add(t)}hideView(){this.content.clear()}_createButtonView(t,n){const o=new Mt(this.locale);return o.set({label:t,icon:n,tooltip:!0}),o}}class gC extends st{constructor(t,n){super(t);const o=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("height",0),this.set("width",0),this.set("numberOfPanels",0),this.content=this.createCollection(),this._balloonPanelView=n,this.setTemplate({tag:"div",attributes:{class:["ck-fake-panel",o.to("numberOfPanels",r=>r?"":"ck-hidden")],style:{top:o.to("top",Zr),left:o.to("left",Zr),width:o.to("width",Zr),height:o.to("height",Zr)}},children:this.content}),this.on("change:numberOfPanels",(r,c,u,g)=>{u>g?this._addPanels(u-g):this._removePanels(g-u),this.updatePosition()})}_addPanels(t){for(;t--;){const n=new st;n.setTemplate({tag:"div"}),this.content.add(n),this.registerChild(n)}}_removePanels(t){for(;t--;){const n=this.content.last;this.content.remove(n),this.deregisterChild(n),n.destroy()}}updatePosition(){if(this.numberOfPanels){const{top:t,left:n}=this._balloonPanelView,{width:o,height:r}=new gt(this._balloonPanelView.element);Object.assign(this,{top:t,left:n,width:o,height:r})}}}d(57);const cs=ic("px");class mC extends st{constructor(t){super(t);const n=this.bindTemplate;this.set("isActive",!1),this.set("isSticky",!1),this.set("limiterElement",null),this.set("limiterBottomOffset",50),this.set("viewportTopOffset",0),this.set("_marginLeft",null),this.set("_isStickyToTheLimiter",!1),this.set("_hasViewportTopOffset",!1),this.content=this.createCollection(),this._contentPanelPlaceholder=new ye({tag:"div",attributes:{class:["ck","ck-sticky-panel__placeholder"],style:{display:n.to("isSticky",o=>o?"block":"none"),height:n.to("isSticky",o=>o?cs(this._panelRect.height):null)}}}).render(),this._contentPanel=new ye({tag:"div",attributes:{class:["ck","ck-sticky-panel__content",n.if("isSticky","ck-sticky-panel__content_sticky"),n.if("_isStickyToTheLimiter","ck-sticky-panel__content_sticky_bottom-limit")],style:{width:n.to("isSticky",o=>o?cs(this._contentPanelPlaceholder.getBoundingClientRect().width):null),top:n.to("_hasViewportTopOffset",o=>o?cs(this.viewportTopOffset):null),bottom:n.to("_isStickyToTheLimiter",o=>o?cs(this.limiterBottomOffset):null),marginLeft:n.to("_marginLeft")}},children:this.content}).render(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-sticky-panel"]},children:[this._contentPanelPlaceholder,this._contentPanel]})}render(){super.render(),this._checkIfShouldBeSticky(),this.listenTo(Pt.window,"scroll",()=>{this._checkIfShouldBeSticky()}),this.listenTo(this,"change:isActive",()=>{this._checkIfShouldBeSticky()})}_checkIfShouldBeSticky(){const t=this._panelRect=this._contentPanel.getBoundingClientRect();let n;this.limiterElement?(n=this._limiterRect=this.limiterElement.getBoundingClientRect(),this.isSticky=this.isActive&&n.top<this.viewportTopOffset&&this._panelRect.height+this.limiterBottomOffset<n.height):this.isSticky=!1,this.isSticky?(this._isStickyToTheLimiter=n.bottom<t.height+this.limiterBottomOffset+this.viewportTopOffset,this._hasViewportTopOffset=!this._isStickyToTheLimiter&&!!this.viewportTopOffset,this._marginLeft=this._isStickyToTheLimiter?null:cs(-Pt.window.scrollX)):(this._isStickyToTheLimiter=!1,this._hasViewportTopOffset=!1,this._marginLeft=null)}}d(59),d(61);const ea=new WeakMap;function Qg(l){const{view:t,element:n,text:o,isDirectHost:r=!0,keepOnFocus:c=!1}=l,u=t.document;ea.has(u)||(ea.set(u,new Map),u.registerPostFixer(g=>Xg(u,g))),ea.get(u).set(n,{text:o,isDirectHost:r,keepOnFocus:c,hostElement:r?n:null}),t.change(g=>Xg(u,g))}function pC(l,t){return!!t.hasClass("ck-placeholder")&&(l.removeClass("ck-placeholder",t),!0)}function Xg(l,t){const n=ea.get(l),o=[];let r=!1;for(const[c,u]of n)u.isDirectHost&&(o.push(c),Zg(t,c,u)&&(r=!0));for(const[c,u]of n){if(u.isDirectHost)continue;const g=bC(c);g&&(o.includes(g)||(u.hostElement=g,Zg(t,c,u)&&(r=!0)))}return r}function Zg(l,t,n){const{text:o,isDirectHost:r,hostElement:c}=n;let u=!1;return c.getAttribute("data-placeholder")!==o&&(l.setAttribute("data-placeholder",o,c),u=!0),(r||t.childCount==1)&&function(g,m){if(!g.isAttached()||Array.from(g.getChildren()).some(_=>!_.is("uiElement")))return!1;if(m)return!0;const p=g.document;if(!p.isFocused)return!0;const w=p.selection.anchor;return w&&w.parent!==g}(c,n.keepOnFocus)?function(g,m){return!m.hasClass("ck-placeholder")&&(g.addClass("ck-placeholder",m),!0)}(l,c)&&(u=!0):pC(l,c)&&(u=!0),u}function bC(l){if(l.childCount){const t=l.getChild(0);if(t.is("element")&&!t.is("uiElement"))return t}return null}const Mc=new Map;function ht(l,t,n){let o=Mc.get(l);o||(o=new Map,Mc.set(l,o)),o.set(t,n)}function wC(l){return[l]}function tm(l,t,n={}){const o=function(r,c){const u=Mc.get(r);return u&&u.has(c)?u.get(c):wC}(l.constructor,t.constructor);try{return o(l=l.clone(),t,n)}catch(r){throw r}}function _C(l,t,n){l=l.slice(),t=t.slice();const o=new kC(n.document,n.useRelations,n.forceWeakRemove);o.setOriginalOperations(l),o.setOriginalOperations(t);const r=o.originalOperations;if(l.length==0||t.length==0)return{operationsA:l,operationsB:t,originalOperations:r};const c=new WeakMap;for(const m of l)c.set(m,0);const u={nextBaseVersionA:l[l.length-1].baseVersion+1,nextBaseVersionB:t[t.length-1].baseVersion+1,originalOperationsACount:l.length,originalOperationsBCount:t.length};let g=0;for(;g<l.length;){const m=l[g],p=c.get(m);if(p==t.length){g++;continue}const w=t[p],_=tm(m,w,o.getContext(m,w,!0)),v=tm(w,m,o.getContext(w,m,!1));o.updateRelation(m,w),o.setOriginalOperations(_,m),o.setOriginalOperations(v,w);for(const A of _)c.set(A,p+v.length);l.splice(g,1,..._),t.splice(p,1,...v)}if(n.padWithNoOps){const m=l.length-u.originalOperationsACount,p=t.length-u.originalOperationsBCount;nm(l,p-m),nm(t,m-p)}return em(l,u.nextBaseVersionB),em(t,u.nextBaseVersionA),{operationsA:l,operationsB:t,originalOperations:r}}class kC{constructor(t,n,o=!1){this.originalOperations=new Map,this._history=t.history,this._useRelations=n,this._forceWeakRemove=!!o,this._relations=new Map}setOriginalOperations(t,n=null){const o=n?this.originalOperations.get(n):null;for(const r of t)this.originalOperations.set(r,o||r)}updateRelation(t,n){switch(t.constructor){case pt:switch(n.constructor){case Wt:t.targetPosition.isEqual(n.sourcePosition)||n.movedRange.containsPosition(t.targetPosition)?this._setRelation(t,n,"insertAtSource"):t.targetPosition.isEqual(n.deletionPosition)?this._setRelation(t,n,"insertBetween"):t.targetPosition.isAfter(n.sourcePosition)&&this._setRelation(t,n,"moveTargetAfter");break;case pt:t.targetPosition.isEqual(n.sourcePosition)||t.targetPosition.isBefore(n.sourcePosition)?this._setRelation(t,n,"insertBefore"):this._setRelation(t,n,"insertAfter")}break;case Ct:switch(n.constructor){case Wt:t.splitPosition.isBefore(n.sourcePosition)&&this._setRelation(t,n,"splitBefore");break;case pt:if(t.splitPosition.isEqual(n.sourcePosition)||t.splitPosition.isBefore(n.sourcePosition))this._setRelation(t,n,"splitBefore");else{const o=O._createFromPositionAndShift(n.sourcePosition,n.howMany);if(t.splitPosition.hasSameParentAs(n.sourcePosition)&&o.containsPosition(t.splitPosition)){const r=o.end.offset-t.splitPosition.offset,c=t.splitPosition.offset-o.start.offset;this._setRelation(t,n,{howMany:r,offset:c})}}}break;case Wt:switch(n.constructor){case Wt:t.targetPosition.isEqual(n.sourcePosition)||this._setRelation(t,n,"mergeTargetNotMoved"),t.sourcePosition.isEqual(n.targetPosition)&&this._setRelation(t,n,"mergeSourceNotMoved"),t.sourcePosition.isEqual(n.sourcePosition)&&this._setRelation(t,n,"mergeSameElement");break;case Ct:t.sourcePosition.isEqual(n.splitPosition)&&this._setRelation(t,n,"splitAtSource")}break;case me:{const o=t.newRange;if(!o)return;switch(n.constructor){case pt:{const r=O._createFromPositionAndShift(n.sourcePosition,n.howMany),c=r.containsPosition(o.start)||r.start.isEqual(o.start),u=r.containsPosition(o.end)||r.end.isEqual(o.end);!c&&!u||r.containsRange(o)||this._setRelation(t,n,{side:c?"left":"right",path:c?o.start.path.slice():o.end.path.slice()});break}case Wt:{const r=o.start.isEqual(n.targetPosition),c=o.start.isEqual(n.deletionPosition),u=o.end.isEqual(n.deletionPosition),g=o.end.isEqual(n.sourcePosition);(r||c||u||g)&&this._setRelation(t,n,{wasInLeftElement:r,wasStartBeforeMergedElement:c,wasEndBeforeMergedElement:u,wasInRightElement:g});break}}break}}}getContext(t,n,o){return{aIsStrong:o,aWasUndone:this._wasUndone(t),bWasUndone:this._wasUndone(n),abRelation:this._useRelations?this._getRelation(t,n):null,baRelation:this._useRelations?this._getRelation(n,t):null,forceWeakRemove:this._forceWeakRemove}}_wasUndone(t){const n=this.originalOperations.get(t);return n.wasUndone||this._history.isUndoneOperation(n)}_getRelation(t,n){const o=this.originalOperations.get(n),r=this._history.getUndoneOperation(o);if(!r)return null;const c=this.originalOperations.get(t),u=this._relations.get(c);return u&&u.get(r)||null}_setRelation(t,n,o){const r=this.originalOperations.get(t),c=this.originalOperations.get(n);let u=this._relations.get(r);u||(u=new Map,this._relations.set(r,u)),u.set(c,o)}}function em(l,t){for(const n of l)n.baseVersion=t++}function nm(l,t){for(let n=0;n<t;n++)l.push(new Jt(0))}function im(l,t,n){const o=l.nodes.getNode(0).getAttribute(t);if(o==n)return null;const r=new O(l.position,l.position.getShiftedBy(l.howMany));return new Bt(r,t,o,n,0)}function om(l,t){return l.targetPosition._getTransformedByDeletion(t.sourcePosition,t.howMany)===null}function io(l,t){const n=[];for(let o=0;o<l.length;o++){const r=l[o],c=new pt(r.start,r.end.offset-r.start.offset,t,0);n.push(c);for(let u=o+1;u<l.length;u++)l[u]=l[u]._getTransformedByMove(c.sourcePosition,c.targetPosition,c.howMany)[0];t=t._getTransformedByMove(c.sourcePosition,c.targetPosition,c.howMany)}return n}ht(Bt,Bt,(l,t,n)=>{if(l.key===t.key&&l.range.start.hasSameParentAs(t.range.start)){const o=l.range.getDifference(t.range).map(c=>new Bt(c,l.key,l.oldValue,l.newValue,0)),r=l.range.getIntersection(t.range);return r&&n.aIsStrong&&o.push(new Bt(r,t.key,t.newValue,l.newValue,0)),o.length==0?[new Jt(0)]:o}return[l]}),ht(Bt,Yt,(l,t)=>{if(l.range.start.hasSameParentAs(t.position)&&l.range.containsPosition(t.position)){const n=l.range._getTransformedByInsertion(t.position,t.howMany,!t.shouldReceiveAttributes).map(o=>new Bt(o,l.key,l.oldValue,l.newValue,l.baseVersion));if(t.shouldReceiveAttributes){const o=im(t,l.key,l.oldValue);o&&n.unshift(o)}return n}return l.range=l.range._getTransformedByInsertion(t.position,t.howMany,!1)[0],[l]}),ht(Bt,Wt,(l,t)=>{const n=[];l.range.start.hasSameParentAs(t.deletionPosition)&&(l.range.containsPosition(t.deletionPosition)||l.range.start.isEqual(t.deletionPosition))&&n.push(O._createFromPositionAndShift(t.graveyardPosition,1));const o=l.range._getTransformedByMergeOperation(t);return o.isCollapsed||n.push(o),n.map(r=>new Bt(r,l.key,l.oldValue,l.newValue,l.baseVersion))}),ht(Bt,pt,(l,t)=>function(n,o){const r=O._createFromPositionAndShift(o.sourcePosition,o.howMany);let c=null,u=[];r.containsRange(n,!0)?c=n:n.start.hasSameParentAs(r.start)?(u=n.getDifference(r),c=n.getIntersection(r)):u=[n];const g=[];for(let m of u){m=m._getTransformedByDeletion(o.sourcePosition,o.howMany);const p=o.getMovedRangeStart(),w=m.start.hasSameParentAs(p);m=m._getTransformedByInsertion(p,o.howMany,w),g.push(...m)}return c&&g.push(c._getTransformedByMove(o.sourcePosition,o.targetPosition,o.howMany,!1)[0]),g}(l.range,t).map(n=>new Bt(n,l.key,l.oldValue,l.newValue,l.baseVersion))),ht(Bt,Ct,(l,t)=>{if(l.range.end.isEqual(t.insertionPosition))return t.graveyardPosition||l.range.end.offset++,[l];if(l.range.start.hasSameParentAs(t.splitPosition)&&l.range.containsPosition(t.splitPosition)){const n=l.clone();return n.range=new O(t.moveTargetPosition.clone(),l.range.end._getCombined(t.splitPosition,t.moveTargetPosition)),l.range.end=t.splitPosition.clone(),l.range.end.stickiness="toPrevious",[l,n]}return l.range=l.range._getTransformedBySplitOperation(t),[l]}),ht(Yt,Bt,(l,t)=>{const n=[l];if(l.shouldReceiveAttributes&&l.position.hasSameParentAs(t.range.start)&&t.range.containsPosition(l.position)){const o=im(l,t.key,t.newValue);o&&n.push(o)}return n}),ht(Yt,Yt,(l,t,n)=>(l.position.isEqual(t.position)&&n.aIsStrong||(l.position=l.position._getTransformedByInsertOperation(t)),[l])),ht(Yt,pt,(l,t)=>(l.position=l.position._getTransformedByMoveOperation(t),[l])),ht(Yt,Ct,(l,t)=>(l.position=l.position._getTransformedBySplitOperation(t),[l])),ht(Yt,Wt,(l,t)=>(l.position=l.position._getTransformedByMergeOperation(t),[l])),ht(me,Yt,(l,t)=>(l.oldRange&&(l.oldRange=l.oldRange._getTransformedByInsertOperation(t)[0]),l.newRange&&(l.newRange=l.newRange._getTransformedByInsertOperation(t)[0]),[l])),ht(me,me,(l,t,n)=>{if(l.name==t.name){if(!n.aIsStrong)return[new Jt(0)];l.oldRange=t.newRange?t.newRange.clone():null}return[l]}),ht(me,Wt,(l,t)=>(l.oldRange&&(l.oldRange=l.oldRange._getTransformedByMergeOperation(t)),l.newRange&&(l.newRange=l.newRange._getTransformedByMergeOperation(t)),[l])),ht(me,pt,(l,t,n)=>{if(l.oldRange&&(l.oldRange=O._createFromRanges(l.oldRange._getTransformedByMoveOperation(t))),l.newRange){if(n.abRelation){const o=O._createFromRanges(l.newRange._getTransformedByMoveOperation(t));if(n.abRelation.side=="left"&&t.targetPosition.isEqual(l.newRange.start))return l.newRange.start.path=n.abRelation.path,l.newRange.end=o.end,[l];if(n.abRelation.side=="right"&&t.targetPosition.isEqual(l.newRange.end))return l.newRange.start=o.start,l.newRange.end.path=n.abRelation.path,[l]}l.newRange=O._createFromRanges(l.newRange._getTransformedByMoveOperation(t))}return[l]}),ht(me,Ct,(l,t,n)=>{if(l.oldRange&&(l.oldRange=l.oldRange._getTransformedBySplitOperation(t)),l.newRange){if(n.abRelation){const o=l.newRange._getTransformedBySplitOperation(t);return l.newRange.start.isEqual(t.splitPosition)&&n.abRelation.wasStartBeforeMergedElement?l.newRange.start=L._createAt(t.insertionPosition):l.newRange.start.isEqual(t.splitPosition)&&!n.abRelation.wasInLeftElement&&(l.newRange.start=L._createAt(t.moveTargetPosition)),l.newRange.end.isEqual(t.splitPosition)&&n.abRelation.wasInRightElement?l.newRange.end=L._createAt(t.moveTargetPosition):l.newRange.end.isEqual(t.splitPosition)&&n.abRelation.wasEndBeforeMergedElement?l.newRange.end=L._createAt(t.insertionPosition):l.newRange.end=o.end,[l]}l.newRange=l.newRange._getTransformedBySplitOperation(t)}return[l]}),ht(Wt,Yt,(l,t)=>(l.sourcePosition.hasSameParentAs(t.position)&&(l.howMany+=t.howMany),l.sourcePosition=l.sourcePosition._getTransformedByInsertOperation(t),l.targetPosition=l.targetPosition._getTransformedByInsertOperation(t),[l])),ht(Wt,Wt,(l,t,n)=>{if(l.sourcePosition.isEqual(t.sourcePosition)&&l.targetPosition.isEqual(t.targetPosition)){if(n.bWasUndone){const o=t.graveyardPosition.path.slice();return o.push(0),l.sourcePosition=new L(t.graveyardPosition.root,o),l.howMany=0,[l]}return[new Jt(0)]}if(l.sourcePosition.isEqual(t.sourcePosition)&&!l.targetPosition.isEqual(t.targetPosition)&&!n.bWasUndone&&n.abRelation!="splitAtSource"){const o=l.targetPosition.root.rootName=="$graveyard",r=t.targetPosition.root.rootName=="$graveyard";if(r&&!o||!(o&&!r)&&n.aIsStrong){const u=t.targetPosition._getTransformedByMergeOperation(t),g=l.targetPosition._getTransformedByMergeOperation(t);return[new pt(u,l.howMany,g,0)]}return[new Jt(0)]}return l.sourcePosition.hasSameParentAs(t.targetPosition)&&(l.howMany+=t.howMany),l.sourcePosition=l.sourcePosition._getTransformedByMergeOperation(t),l.targetPosition=l.targetPosition._getTransformedByMergeOperation(t),l.graveyardPosition.isEqual(t.graveyardPosition)&&n.aIsStrong||(l.graveyardPosition=l.graveyardPosition._getTransformedByMergeOperation(t)),[l]}),ht(Wt,pt,(l,t,n)=>{const o=O._createFromPositionAndShift(t.sourcePosition,t.howMany);return t.type=="remove"&&!n.bWasUndone&&!n.forceWeakRemove&&l.deletionPosition.hasSameParentAs(t.sourcePosition)&&o.containsPosition(l.sourcePosition)?[new Jt(0)]:(l.sourcePosition.hasSameParentAs(t.targetPosition)&&(l.howMany+=t.howMany),l.sourcePosition.hasSameParentAs(t.sourcePosition)&&(l.howMany-=t.howMany),l.sourcePosition=l.sourcePosition._getTransformedByMoveOperation(t),l.targetPosition=l.targetPosition._getTransformedByMoveOperation(t),l.graveyardPosition.isEqual(t.targetPosition)||(l.graveyardPosition=l.graveyardPosition._getTransformedByMoveOperation(t)),[l])}),ht(Wt,Ct,(l,t,n)=>{if(t.graveyardPosition&&(l.graveyardPosition=l.graveyardPosition._getTransformedByDeletion(t.graveyardPosition,1),l.deletionPosition.isEqual(t.graveyardPosition)&&(l.howMany=t.howMany)),l.targetPosition.isEqual(t.splitPosition)){const o=t.howMany!=0,r=t.graveyardPosition&&l.deletionPosition.isEqual(t.graveyardPosition);if(o||r||n.abRelation=="mergeTargetNotMoved")return l.sourcePosition=l.sourcePosition._getTransformedBySplitOperation(t),[l]}if(l.sourcePosition.isEqual(t.splitPosition)){if(n.abRelation=="mergeSourceNotMoved")return l.howMany=0,l.targetPosition=l.targetPosition._getTransformedBySplitOperation(t),[l];if(n.abRelation=="mergeSameElement"||l.sourcePosition.offset>0)return l.sourcePosition=t.moveTargetPosition.clone(),l.targetPosition=l.targetPosition._getTransformedBySplitOperation(t),[l]}return l.sourcePosition.hasSameParentAs(t.splitPosition)&&(l.howMany=t.splitPosition.offset),l.sourcePosition=l.sourcePosition._getTransformedBySplitOperation(t),l.targetPosition=l.targetPosition._getTransformedBySplitOperation(t),[l]}),ht(pt,Yt,(l,t)=>{const n=O._createFromPositionAndShift(l.sourcePosition,l.howMany)._getTransformedByInsertOperation(t,!1)[0];return l.sourcePosition=n.start,l.howMany=n.end.offset-n.start.offset,l.targetPosition.isEqual(t.position)||(l.targetPosition=l.targetPosition._getTransformedByInsertOperation(t)),[l]}),ht(pt,pt,(l,t,n)=>{const o=O._createFromPositionAndShift(l.sourcePosition,l.howMany),r=O._createFromPositionAndShift(t.sourcePosition,t.howMany);let c,u=n.aIsStrong,g=!n.aIsStrong;if(n.abRelation=="insertBefore"||n.baRelation=="insertAfter"?g=!0:n.abRelation!="insertAfter"&&n.baRelation!="insertBefore"||(g=!1),c=l.targetPosition.isEqual(t.targetPosition)&&g?l.targetPosition._getTransformedByDeletion(t.sourcePosition,t.howMany):l.targetPosition._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),om(l,t)&&om(t,l))return[t.getReversed()];if(o.containsPosition(t.targetPosition)&&o.containsRange(r,!0))return o.start=o.start._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),o.end=o.end._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),io([o],c);if(r.containsPosition(l.targetPosition)&&r.containsRange(o,!0))return o.start=o.start._getCombined(t.sourcePosition,t.getMovedRangeStart()),o.end=o.end._getCombined(t.sourcePosition,t.getMovedRangeStart()),io([o],c);const m=se(l.sourcePosition.getParentPath(),t.sourcePosition.getParentPath());if(m=="prefix"||m=="extension")return o.start=o.start._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),o.end=o.end._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),io([o],c);l.type!="remove"||t.type=="remove"||n.aWasUndone||n.forceWeakRemove?l.type=="remove"||t.type!="remove"||n.bWasUndone||n.forceWeakRemove||(u=!1):u=!0;const p=[],w=o.getDifference(r);for(const v of w){v.start=v.start._getTransformedByDeletion(t.sourcePosition,t.howMany),v.end=v.end._getTransformedByDeletion(t.sourcePosition,t.howMany);const A=se(v.start.getParentPath(),t.getMovedRangeStart().getParentPath())=="same",x=v._getTransformedByInsertion(t.getMovedRangeStart(),t.howMany,A);p.push(...x)}const _=o.getIntersection(r);return _!==null&&u&&(_.start=_.start._getCombined(t.sourcePosition,t.getMovedRangeStart()),_.end=_.end._getCombined(t.sourcePosition,t.getMovedRangeStart()),p.length===0?p.push(_):p.length==1?r.start.isBefore(o.start)||r.start.isEqual(o.start)?p.unshift(_):p.push(_):p.splice(1,0,_)),p.length===0?[new Jt(l.baseVersion)]:io(p,c)}),ht(pt,Ct,(l,t,n)=>{let o=l.targetPosition.clone();l.targetPosition.isEqual(t.insertionPosition)&&t.graveyardPosition&&n.abRelation!="moveTargetAfter"||(o=l.targetPosition._getTransformedBySplitOperation(t));const r=O._createFromPositionAndShift(l.sourcePosition,l.howMany);if(r.end.isEqual(t.insertionPosition))return t.graveyardPosition||l.howMany++,l.targetPosition=o,[l];if(r.start.hasSameParentAs(t.splitPosition)&&r.containsPosition(t.splitPosition)){let u=new O(t.splitPosition,r.end);return u=u._getTransformedBySplitOperation(t),io([new O(r.start,t.splitPosition),u],o)}l.targetPosition.isEqual(t.splitPosition)&&n.abRelation=="insertAtSource"&&(o=t.moveTargetPosition),l.targetPosition.isEqual(t.insertionPosition)&&n.abRelation=="insertBetween"&&(o=l.targetPosition);const c=[r._getTransformedBySplitOperation(t)];if(t.graveyardPosition){const u=r.start.isEqual(t.graveyardPosition)||r.containsPosition(t.graveyardPosition);l.howMany>1&&u&&!n.aWasUndone&&c.push(O._createFromPositionAndShift(t.insertionPosition,1))}return io(c,o)}),ht(pt,Wt,(l,t,n)=>{const o=O._createFromPositionAndShift(l.sourcePosition,l.howMany);if(t.deletionPosition.hasSameParentAs(l.sourcePosition)&&o.containsPosition(t.sourcePosition)){if(l.type!="remove"||n.forceWeakRemove){if(l.howMany==1)return n.bWasUndone?(l.sourcePosition=t.graveyardPosition.clone(),l.targetPosition=l.targetPosition._getTransformedByMergeOperation(t),[l]):[new Jt(0)]}else if(!n.aWasUndone){const c=[];let u=t.graveyardPosition.clone(),g=t.targetPosition._getTransformedByMergeOperation(t);l.howMany>1&&(c.push(new pt(l.sourcePosition,l.howMany-1,l.targetPosition,0)),u=u._getTransformedByMove(l.sourcePosition,l.targetPosition,l.howMany-1),g=g._getTransformedByMove(l.sourcePosition,l.targetPosition,l.howMany-1));const m=t.deletionPosition._getCombined(l.sourcePosition,l.targetPosition),p=new pt(u,1,m,0),w=p.getMovedRangeStart().path.slice();w.push(0);const _=new L(p.targetPosition.root,w);g=g._getTransformedByMove(u,m,1);const v=new pt(g,t.howMany,_,0);return c.push(p),c.push(v),c}}const r=O._createFromPositionAndShift(l.sourcePosition,l.howMany)._getTransformedByMergeOperation(t);return l.sourcePosition=r.start,l.howMany=r.end.offset-r.start.offset,l.targetPosition=l.targetPosition._getTransformedByMergeOperation(t),[l]}),ht(pe,Yt,(l,t)=>(l.position=l.position._getTransformedByInsertOperation(t),[l])),ht(pe,Wt,(l,t)=>l.position.isEqual(t.deletionPosition)?(l.position=t.graveyardPosition.clone(),l.position.stickiness="toNext",[l]):(l.position=l.position._getTransformedByMergeOperation(t),[l])),ht(pe,pt,(l,t)=>(l.position=l.position._getTransformedByMoveOperation(t),[l])),ht(pe,pe,(l,t,n)=>{if(l.position.isEqual(t.position)){if(!n.aIsStrong)return[new Jt(0)];l.oldName=t.newName}return[l]}),ht(pe,Ct,(l,t)=>{if(se(l.position.path,t.splitPosition.getParentPath())=="same"&&!t.graveyardPosition){const n=new pe(l.position.getShiftedBy(1),l.oldName,l.newName,0);return[l,n]}return l.position=l.position._getTransformedBySplitOperation(t),[l]}),ht(An,An,(l,t,n)=>{if(l.root===t.root&&l.key===t.key){if(!n.aIsStrong||l.newValue===t.newValue)return[new Jt(0)];l.oldValue=t.newValue}return[l]}),ht(Ct,Yt,(l,t)=>(l.splitPosition.hasSameParentAs(t.position)&&l.splitPosition.offset<t.position.offset&&(l.howMany+=t.howMany),l.splitPosition=l.splitPosition._getTransformedByInsertOperation(t),l.insertionPosition=l.insertionPosition._getTransformedByInsertOperation(t),[l])),ht(Ct,Wt,(l,t,n)=>{if(!l.graveyardPosition&&!n.bWasUndone&&l.splitPosition.hasSameParentAs(t.sourcePosition)){const o=t.graveyardPosition.path.slice();o.push(0);const r=new L(t.graveyardPosition.root,o),c=Ct.getInsertionPosition(new L(t.graveyardPosition.root,o)),u=new Ct(r,0,c,null,0);return l.splitPosition=l.splitPosition._getTransformedByMergeOperation(t),l.insertionPosition=Ct.getInsertionPosition(l.splitPosition),l.graveyardPosition=u.insertionPosition.clone(),l.graveyardPosition.stickiness="toNext",[u,l]}return l.splitPosition.hasSameParentAs(t.deletionPosition)&&!l.splitPosition.isAfter(t.deletionPosition)&&l.howMany--,l.splitPosition.hasSameParentAs(t.targetPosition)&&(l.howMany+=t.howMany),l.splitPosition=l.splitPosition._getTransformedByMergeOperation(t),l.insertionPosition=Ct.getInsertionPosition(l.splitPosition),l.graveyardPosition&&(l.graveyardPosition=l.graveyardPosition._getTransformedByMergeOperation(t)),[l]}),ht(Ct,pt,(l,t,n)=>{const o=O._createFromPositionAndShift(t.sourcePosition,t.howMany);if(l.graveyardPosition){const c=o.start.isEqual(l.graveyardPosition)||o.containsPosition(l.graveyardPosition);if(!n.bWasUndone&&c){const u=l.splitPosition._getTransformedByMoveOperation(t),g=l.graveyardPosition._getTransformedByMoveOperation(t),m=g.path.slice();m.push(0);const p=new L(g.root,m);return[new pt(u,l.howMany,p,0)]}l.graveyardPosition=l.graveyardPosition._getTransformedByMoveOperation(t)}const r=l.splitPosition.isEqual(t.targetPosition);if(r&&(n.baRelation=="insertAtSource"||n.abRelation=="splitBefore"))return l.howMany+=t.howMany,l.splitPosition=l.splitPosition._getTransformedByDeletion(t.sourcePosition,t.howMany),l.insertionPosition=Ct.getInsertionPosition(l.splitPosition),[l];if(r&&n.abRelation&&n.abRelation.howMany){const{howMany:c,offset:u}=n.abRelation;return l.howMany+=c,l.splitPosition=l.splitPosition.getShiftedBy(u),[l]}if(l.splitPosition.hasSameParentAs(t.sourcePosition)&&o.containsPosition(l.splitPosition)){const c=t.howMany-(l.splitPosition.offset-t.sourcePosition.offset);return l.howMany-=c,l.splitPosition.hasSameParentAs(t.targetPosition)&&l.splitPosition.offset<t.targetPosition.offset&&(l.howMany+=t.howMany),l.splitPosition=t.sourcePosition.clone(),l.insertionPosition=Ct.getInsertionPosition(l.splitPosition),[l]}return t.sourcePosition.isEqual(t.targetPosition)||(l.splitPosition.hasSameParentAs(t.sourcePosition)&&l.splitPosition.offset<=t.sourcePosition.offset&&(l.howMany-=t.howMany),l.splitPosition.hasSameParentAs(t.targetPosition)&&l.splitPosition.offset<t.targetPosition.offset&&(l.howMany+=t.howMany)),l.splitPosition.stickiness="toNone",l.splitPosition=l.splitPosition._getTransformedByMoveOperation(t),l.splitPosition.stickiness="toNext",l.graveyardPosition?l.insertionPosition=l.insertionPosition._getTransformedByMoveOperation(t):l.insertionPosition=Ct.getInsertionPosition(l.splitPosition),[l]}),ht(Ct,Ct,(l,t,n)=>{if(l.splitPosition.isEqual(t.splitPosition)){if(!l.graveyardPosition&&!t.graveyardPosition)return[new Jt(0)];if(l.graveyardPosition&&t.graveyardPosition&&l.graveyardPosition.isEqual(t.graveyardPosition))return[new Jt(0)];if(n.abRelation=="splitBefore")return l.howMany=0,l.graveyardPosition=l.graveyardPosition._getTransformedBySplitOperation(t),[l]}if(l.graveyardPosition&&t.graveyardPosition&&l.graveyardPosition.isEqual(t.graveyardPosition)){const o=l.splitPosition.root.rootName=="$graveyard",r=t.splitPosition.root.rootName=="$graveyard";if(r&&!o||!(o&&!r)&&n.aIsStrong){const u=[];return t.howMany&&u.push(new pt(t.moveTargetPosition,t.howMany,t.splitPosition,0)),l.howMany&&u.push(new pt(l.splitPosition,l.howMany,l.moveTargetPosition,0)),u}return[new Jt(0)]}if(l.graveyardPosition&&(l.graveyardPosition=l.graveyardPosition._getTransformedBySplitOperation(t)),l.splitPosition.isEqual(t.insertionPosition)&&n.abRelation=="splitBefore")return l.howMany++,[l];if(t.splitPosition.isEqual(l.insertionPosition)&&n.baRelation=="splitBefore"){const o=t.insertionPosition.path.slice();o.push(0);const r=new L(t.insertionPosition.root,o);return[l,new pt(l.insertionPosition,1,r,0)]}return l.splitPosition.hasSameParentAs(t.splitPosition)&&l.splitPosition.offset<t.splitPosition.offset&&(l.howMany-=t.howMany),l.splitPosition=l.splitPosition._getTransformedBySplitOperation(t),l.insertionPosition=Ct.getInsertionPosition(l.splitPosition),[l]});class vC extends Vn{constructor(t){super(t),this.domEventType="click"}onDomEvent(t){this.fire(t.type,t)}}class na extends Vn{constructor(t){super(t),this.domEventType=["mousedown","mouseup","mouseover","mouseout"]}onDomEvent(t){this.fire(t.type,t)}}class oo{constructor(t){this.document=t}createDocumentFragment(t){return new si(this.document,t)}createElement(t,n,o){return new Re(this.document,t,n,o)}createText(t){return new _t(this.document,t)}clone(t,n=!1){return t._clone(n)}appendChild(t,n){return n._appendChild(t)}insertChild(t,n,o){return o._insertChild(t,n)}removeChildren(t,n,o){return o._removeChildren(t,n)}remove(t){const n=t.parent;return n?this.removeChildren(n.getChildIndex(t),1,n):[]}replace(t,n){const o=t.parent;if(o){const r=o.getChildIndex(t);return this.removeChildren(r,1,o),this.insertChild(r,n,o),!0}return!1}unwrapElement(t){const n=t.parent;if(n){const o=n.getChildIndex(t);this.remove(t),this.insertChild(o,t.getChildren(),n)}}rename(t,n){const o=new Re(this.document,t,n.getAttributes(),n.getChildren());return this.replace(n,o)?o:null}setAttribute(t,n,o){o._setAttribute(t,n)}removeAttribute(t,n){n._removeAttribute(t)}addClass(t,n){n._addClass(t)}removeClass(t,n){n._removeClass(t)}setStyle(t,n,o){Pe(t)&&o===void 0&&(o=n),o._setStyle(t,n)}removeStyle(t,n){n._removeStyle(t)}setCustomProperty(t,n,o){o._setCustomProperty(t,n)}removeCustomProperty(t,n){return n._removeCustomProperty(t)}createPositionAt(t,n){return H._createAt(t,n)}createPositionAfter(t){return H._createAfter(t)}createPositionBefore(t){return H._createBefore(t)}createRange(t,n){return new et(t,n)}createRangeOn(t){return et._createOn(t)}createRangeIn(t){return et._createIn(t)}createSelection(t,n,o){return new We(t,n,o)}}class yC extends Tg{constructor(t,n){super(t),this.view=n,this._toolbarConfig=qg(t.config.get("toolbar")),this._elementReplacer=new Z1}get element(){return this.view.element}init(t){const n=this.editor,o=this.view,r=n.editing.view,c=o.editable,u=r.document.getRoot();c.name=u.rootName,o.render();const g=c.element;this.setEditableElement(c.name,g),this.focusTracker.add(g),o.editable.bind("isFocused").to(this.focusTracker),r.attachDomRoot(g),t&&this._elementReplacer.replace(t,this.element),this._initPlaceholder(),this._initToolbar(),this.fire("ready")}destroy(){const t=this.view,n=this.editor.editing.view;this._elementReplacer.restore(),n.detachDomRoot(t.editable.name),t.destroy(),super.destroy()}_initToolbar(){const t=this.editor,n=this.view,o=t.editing.view;n.stickyPanel.bind("isActive").to(this.focusTracker,"isFocused"),n.stickyPanel.limiterElement=n.element,n.stickyPanel.bind("viewportTopOffset").to(this,"viewportOffset",({top:r})=>r),n.toolbar.fillFromConfig(this._toolbarConfig,this.componentFactory),function({origin:r,originKeystrokeHandler:c,originFocusTracker:u,toolbar:g,beforeFocus:m,afterBlur:p}){u.add(g.element),c.set("Alt+F10",(w,_)=>{u.isFocused&&!g.focusTracker.isFocused&&(m&&m(),g.focus(),_())}),g.keystrokes.set("Esc",(w,_)=>{g.focusTracker.isFocused&&(r.focus(),p&&p(),_())})}({origin:o,originFocusTracker:this.focusTracker,originKeystrokeHandler:t.keystrokes,toolbar:n.toolbar})}_initPlaceholder(){const t=this.editor,n=t.editing.view,o=n.document.getRoot(),r=t.sourceElement,c=t.config.get("placeholder")||r&&r.tagName.toLowerCase()==="textarea"&&r.getAttribute("placeholder");c&&Qg({view:n,element:o,text:c,isDirectHost:!1,keepOnFocus:!0})}}d(63);class AC extends lC{constructor(t,n,o={}){super(t),this.stickyPanel=new mC(t),this.toolbar=new xc(t,{shouldGroupWhenFull:o.shouldToolbarGroupWhenFull}),this.editable=new dC(t,n)}render(){super.render(),this.stickyPanel.content.add(this.toolbar),this.top.add(this.stickyPanel),this.main.add(this.editable)}}class Rc extends Eg{constructor(t,n){super(n),Dn(t)&&(this.sourceElement=t),this.model.document.createRoot();const o=!this.config.get("toolbar.shouldNotGroupWhenFull"),r=new AC(this.locale,this.editing.view,{shouldToolbarGroupWhenFull:o});this.ui=new yC(this,r),function(c){if(!Qn(c.updateSourceElement))throw new y.a("attachtoform-missing-elementapi-interface",c);const u=c.sourceElement;if(u&&u.tagName.toLowerCase()==="textarea"&&u.form){let g;const m=u.form,p=()=>c.updateSourceElement();Qn(m.submit)&&(g=m.submit,m.submit=()=>{p(),g.apply(m)}),m.addEventListener("submit",p),c.on("destroy",()=>{m.removeEventListener("submit",p),g&&(m.submit=g)})}}(this)}destroy(){return this.sourceElement&&this.updateSourceElement(),this.ui.destroy(),super.destroy()}static create(t,n={}){return new Promise(o=>{const r=new this(t,n);o(r.initPlugins().then(()=>r.ui.init(Dn(t)?t:null)).then(()=>{if(!Dn(t)&&n.initialData)throw new y.a("editor-create-initial-data",null);const c=n.initialData!==void 0?n.initialData:function(u){return Dn(u)?(g=u,g instanceof HTMLTextAreaElement?g.value:g.innerHTML):u;var g}(t);return r.data.init(c)}).then(()=>r.fire("ready")).then(()=>r))})}}tt(Rc,qA),tt(Rc,UA);class CC{constructor(t){this.files=function(n){const o=Array.from(n.files||[]),r=Array.from(n.items||[]);return o.length?o:r.filter(c=>c.kind==="file").map(c=>c.getAsFile())}(t),this._native=t}get types(){return this._native.types}getData(t){return this._native.getData(t)}setData(t,n){this._native.setData(t,n)}set effectAllowed(t){this._native.effectAllowed=t}get effectAllowed(){return this._native.effectAllowed}set dropEffect(t){this._native.dropEffect=t}get dropEffect(){return this._native.dropEffect}get isCanceled(){return this._native.dropEffect=="none"||!!this._native.mozUserCancelled}}class Oc extends Vn{constructor(t){super(t);const n=this.document;function o(r){return(c,u)=>{u.preventDefault();const g=u.dropRange?[u.dropRange]:null,m=new f(n,r);n.fire(m,{dataTransfer:u.dataTransfer,method:c.name,targetRanges:g,target:u.target}),m.stop.called&&u.stopPropagation()}}this.domEventType=["paste","copy","cut","drop","dragover","dragstart","dragend","dragenter","dragleave"],this.listenTo(n,"paste",o("clipboardInput"),{priority:"low"}),this.listenTo(n,"drop",o("clipboardInput"),{priority:"low"}),this.listenTo(n,"dragover",o("dragging"),{priority:"low"})}onDomEvent(t){const n={dataTransfer:new CC(t.clipboardData?t.clipboardData:t.dataTransfer)};t.type!="drop"&&t.type!="dragover"||(n.dropRange=function(o,r){const c=r.target.ownerDocument,u=r.clientX,g=r.clientY;let m;return c.caretRangeFromPoint&&c.caretRangeFromPoint(u,g)?m=c.caretRangeFromPoint(u,g):r.rangeParent&&(m=c.createRange(),m.setStart(r.rangeParent,r.rangeOffset),m.collapse(!0)),m?o.domConverter.domRangeToView(m):null}(this.view,t)),this.fire(t.type,t,n)}}const sm=["figcaption","li"];class rn extends z{static get pluginName(){return"ClipboardPipeline"}init(){this.editor.editing.view.addObserver(Oc),this._setupPasteDrop(),this._setupCopyCut()}_setupPasteDrop(){const t=this.editor,n=t.model,o=t.editing.view,r=o.document;this.listenTo(r,"clipboardInput",c=>{t.isReadOnly&&c.stop()},{priority:"highest"}),this.listenTo(r,"clipboardInput",(c,u)=>{const g=u.dataTransfer;let m=u.content||"";var p;m||(g.getData("text/html")?m=function(_){return _.replace(/<span(?: class="Apple-converted-space"|)>(\s+)<\/span>/g,(v,A)=>A.length==1?" ":A).replace(/<!--[\s\S]*?-->/g,"")}(g.getData("text/html")):g.getData("text/plain")&&(((p=(p=g.getData("text/plain")).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r?\n\r?\n/g,"</p><p>").replace(/\r?\n/g,"<br>").replace(/^\s/,"&nbsp;").replace(/\s$/,"&nbsp;").replace(/\s\s/g," &nbsp;")).includes("</p><p>")||p.includes("<br>"))&&(p=`<p>${p}</p>`),m=p),m=this.editor.data.htmlProcessor.toView(m));const w=new f(this,"inputTransformation");this.fire(w,{content:m,dataTransfer:g,targetRanges:u.targetRanges,method:u.method}),w.stop.called&&c.stop(),o.scrollToTheSelection()},{priority:"low"}),this.listenTo(this,"inputTransformation",(c,u)=>{if(u.content.isEmpty)return;const g=this.editor.data.toModel(u.content,"$clipboardHolder");g.childCount!=0&&(c.stop(),n.change(()=>{this.fire("contentInsertion",{content:g,method:u.method,dataTransfer:u.dataTransfer,targetRanges:u.targetRanges})}))},{priority:"low"}),this.listenTo(this,"contentInsertion",(c,u)=>{u.resultRange=n.insertContent(u.content)},{priority:"low"})}_setupCopyCut(){const t=this.editor,n=t.model.document,o=t.editing.view.document;function r(c,u){const g=u.dataTransfer;u.preventDefault();const m=t.data.toView(t.model.getSelectedContent(n.selection));o.fire("clipboardOutput",{dataTransfer:g,content:m,method:c.name})}this.listenTo(o,"copy",r,{priority:"low"}),this.listenTo(o,"cut",(c,u)=>{t.isReadOnly?u.preventDefault():r(c,u)},{priority:"low"}),this.listenTo(o,"clipboardOutput",(c,u)=>{u.content.isEmpty||(u.dataTransfer.setData("text/html",this.editor.data.htmlProcessor.toData(u.content)),u.dataTransfer.setData("text/plain",function g(m){let p="";if(m.is("$text")||m.is("$textProxy"))p=m.data;else if(m.is("element","img")&&m.hasAttribute("alt"))p=m.getAttribute("alt");else if(m.is("element","br"))p=`
`;else{let w=null;for(const _ of m.getChildren()){const v=g(_);w&&(w.is("containerElement")||_.is("containerElement"))&&(sm.includes(w.name)||sm.includes(_.name)?p+=`
`:p+=`

`),p+=v,w=_}}return p}(u.content))),u.method=="cut"&&t.model.deleteContent(n.selection)},{priority:"low"})}}function*rm(l,t){for(const n of t)n&&l.getAttributeProperties(n[0]).copyOnEnter&&(yield n)}class xC extends lt{execute(){const t=this.editor.model,n=t.document;t.change(o=>{(function(r,c,u,g){const m=u.isCollapsed,p=u.getFirstRange(),w=p.start.parent,_=p.end.parent;if(g.isLimit(w)||g.isLimit(_))return void(m||w!=_||r.deleteContent(u));if(m){const v=rm(c.model.schema,u.getAttributes());am(c,p.start),c.setSelectionAttribute(v)}else{const v=!(p.start.isAtStart&&p.end.isAtEnd),A=w==_;r.deleteContent(u,{leaveUnmerged:v}),v&&(A?am(c,u.focus):c.setSelection(_,0))}})(this.editor.model,o,n.selection,t.schema),this.fire("afterExecute",{writer:o})})}}function am(l,t){l.split(t),l.setSelection(t.parent.nextSibling,0)}class lm extends wn{constructor(t){super(t);const n=this.document;n.on("keydown",(o,r)=>{if(this.isEnabled&&r.keyCode==rt.enter){const c=new Lr(n,"enter",n.selection.getFirstRange());n.fire(c,new ec(n,r.domEvent,{isSoft:r.shiftKey})),c.stop.called&&o.stop()}})}observe(){}}class ia extends z{static get pluginName(){return"Enter"}init(){const t=this.editor,n=t.editing.view,o=n.document;n.addObserver(lm),t.commands.add("enter",new xC(t)),this.listenTo(o,"enter",(r,c)=>{c.preventDefault(),c.isSoft||(t.execute("enter"),n.scrollToTheSelection())},{priority:"low"})}}class cm{constructor(t,n=20){this.model=t,this.size=0,this.limit=n,this.isLocked=!1,this._changeCallback=(o,r)=>{r.type!="transparent"&&r!==this._batch&&this._reset(!0)},this._selectionChangeCallback=()=>{this._reset()},this.model.document.on("change",this._changeCallback),this.model.document.selection.on("change:range",this._selectionChangeCallback),this.model.document.selection.on("change:attribute",this._selectionChangeCallback)}get batch(){return this._batch||(this._batch=this.model.createBatch()),this._batch}input(t){this.size+=t,this.size>=this.limit&&this._reset(!0)}lock(){this.isLocked=!0}unlock(){this.isLocked=!1}destroy(){this.model.document.off("change",this._changeCallback),this.model.document.selection.off("change:range",this._selectionChangeCallback),this.model.document.selection.off("change:attribute",this._selectionChangeCallback)}_reset(t){this.isLocked&&!t||(this._batch=null,this.size=0)}}class dm extends lt{constructor(t,n){super(t),this.direction=n,this._buffer=new cm(t.model,t.config.get("typing.undoStep"))}get buffer(){return this._buffer}execute(t={}){const n=this.editor.model,o=n.document;n.enqueueChange(this._buffer.batch,r=>{this._buffer.lock();const c=r.createSelection(t.selection||o.selection),u=t.sequence||1,g=c.isCollapsed;if(c.isCollapsed&&n.modifySelection(c,{direction:this.direction,unit:t.unit}),this._shouldEntireContentBeReplacedWithParagraph(u))return void this._replaceEntireContentWithParagraph(r);if(this._shouldReplaceFirstBlockWithParagraph(c,u))return void this.editor.execute("paragraph",{selection:c});if(c.isCollapsed)return;let m=0;c.getFirstRange().getMinimalFlatRanges().forEach(p=>{m+=jl(p.getWalker({singleCharacters:!0,ignoreElementEnd:!0,shallow:!0}))}),n.deleteContent(c,{doNotResetEntireContent:g,direction:this.direction}),this._buffer.input(m),r.setSelection(c),this._buffer.unlock()})}_shouldEntireContentBeReplacedWithParagraph(t){if(t>1)return!1;const n=this.editor.model,o=n.document.selection,r=n.schema.getLimitElement(o);if(!(o.isCollapsed&&o.containsEntireContent(r))||!n.schema.checkChild(r,"paragraph"))return!1;const c=r.getChild(0);return!c||c.name!=="paragraph"}_replaceEntireContentWithParagraph(t){const n=this.editor.model,o=n.document.selection,r=n.schema.getLimitElement(o),c=t.createElement("paragraph");t.remove(t.createRangeIn(r)),t.insert(c,r),t.setSelection(c,0)}_shouldReplaceFirstBlockWithParagraph(t,n){const o=this.editor.model;if(n>1||this.direction!="backward"||!t.isCollapsed)return!1;const r=t.getFirstPosition(),c=o.schema.getLimitElement(r),u=c.getChild(0);return r.parent==u&&!!t.containsEntireContent(u)&&!!o.schema.checkChild(c,"paragraph")&&u.name!="paragraph"}}function um(l){if(l.newChildren.length-l.oldChildren.length!=1)return;const t=function(o,r){const c=[];let u,g=0;return o.forEach(w=>{w=="equal"?(m(),g++):w=="insert"?(p("insert")?u.values.push(r[g]):(m(),u={type:"insert",index:g,values:[r[g]]}),g++):p("delete")?u.howMany++:(m(),u={type:"delete",index:g,howMany:1})}),m(),c;function m(){u&&(c.push(u),u=null)}function p(w){return u&&u.type==w}}(Ln(l.oldChildren,l.newChildren,EC),l.newChildren);if(t.length>1)return;const n=t[0];return n.values[0]&&n.values[0].is("$text")?n:void 0}function EC(l,t){return l&&l.is("$text")&&t&&t.is("$text")?l.data===t.data:l===t}function hm(l,t){const n=t.selection,o=l.shiftKey&&l.keyCode===rt.delete,r=!n.isCollapsed;return o&&r}class TC extends wn{constructor(t){super(t);const n=t.document;let o=0;function r(c,u,g){const m=new Lr(n,"delete",n.selection.getFirstRange());n.fire(m,new ec(n,u,g)),m.stop.called&&c.stop()}n.on("keyup",(c,u)=>{u.keyCode!=rt.delete&&u.keyCode!=rt.backspace||(o=0)}),n.on("keydown",(c,u)=>{if(bt.isWindows&&hm(u,n))return;const g={};if(u.keyCode==rt.delete)g.direction="forward",g.unit="character";else{if(u.keyCode!=rt.backspace)return;g.direction="backward",g.unit="codePoint"}const m=bt.isMac?u.altKey:u.ctrlKey;g.unit=m?"word":g.unit,g.sequence=++o,r(c,u.domEvent,g)}),bt.isAndroid&&n.on("beforeinput",(c,u)=>{if(u.domEvent.inputType!="deleteContentBackward")return;const g={unit:"codepoint",direction:"backward",sequence:1},m=u.domTarget.ownerDocument.defaultView.getSelection();m.anchorNode==m.focusNode&&m.anchorOffset+1!=m.focusOffset&&(g.selectionToRemove=t.domConverter.domSelectionToView(m)),r(c,u.domEvent,g)})}observe(){}}class Bn extends z{static get pluginName(){return"Delete"}init(){const t=this.editor,n=t.editing.view,o=n.document,r=t.model.document;n.addObserver(TC),this._undoOnBackspace=!1;const c=new dm(t,"forward");if(t.commands.add("deleteForward",c),t.commands.add("forwardDelete",c),t.commands.add("delete",new dm(t,"backward")),this.listenTo(o,"delete",(u,g)=>{const m={unit:g.unit,sequence:g.sequence};if(g.selectionToRemove){const p=t.model.createSelection(),w=[];for(const _ of g.selectionToRemove.getRanges())w.push(t.editing.mapper.toModelRange(_));p.setTo(w),m.selection=p}t.execute(g.direction=="forward"?"deleteForward":"delete",m),g.preventDefault(),n.scrollToTheSelection()},{priority:"low"}),bt.isAndroid){let u=null;this.listenTo(o,"delete",(g,m)=>{const p=m.domTarget.ownerDocument.defaultView.getSelection();u={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}},{priority:"lowest"}),this.listenTo(o,"keyup",(g,m)=>{if(u){const p=m.domTarget.ownerDocument.defaultView.getSelection();p.collapse(u.anchorNode,u.anchorOffset),p.extend(u.focusNode,u.focusOffset),u=null}})}this.editor.plugins.has("UndoEditing")&&(this.listenTo(o,"delete",(u,g)=>{this._undoOnBackspace&&g.direction=="backward"&&g.sequence==1&&g.unit=="codePoint"&&(this._undoOnBackspace=!1,t.execute("undo"),g.preventDefault(),u.stop())},{context:"$capture"}),this.listenTo(r,"change",()=>{this._undoOnBackspace=!1}))}requestUndoOnBackspace(){this.editor.plugins.has("UndoEditing")&&(this._undoOnBackspace=!0)}}class fm{constructor(){this._stack=[]}add(t,n){const o=this._stack,r=o[0];this._insertDescriptor(t);const c=o[0];r===c||Nc(r,c)||this.fire("change:top",{oldDescriptor:r,newDescriptor:c,writer:n})}remove(t,n){const o=this._stack,r=o[0];this._removeDescriptor(t);const c=o[0];r===c||Nc(r,c)||this.fire("change:top",{oldDescriptor:r,newDescriptor:c,writer:n})}_insertDescriptor(t){const n=this._stack,o=n.findIndex(c=>c.id===t.id);if(Nc(t,n[o]))return;o>-1&&n.splice(o,1);let r=0;for(;n[r]&&SC(n[r],t);)r++;n.splice(r,0,t)}_removeDescriptor(t){const n=this._stack,o=n.findIndex(r=>r.id===t);o>-1&&n.splice(o,1)}}function Nc(l,t){return l&&t&&l.priority==t.priority&&oa(l.classes)==oa(t.classes)}function SC(l,t){return l.priority>t.priority||!(l.priority<t.priority)&&oa(l.classes)>oa(t.classes)}function oa(l){return Array.isArray(l)?l.sort().join(","):l}tt(fm,D);function Nt(l){return!!l.is("element")&&!!l.getCustomProperty("widget")}function Dc(l,t,n={}){if(!l.is("containerElement"))throw new y.a("widget-to-widget-wrong-element-type",null,{element:l});return t.setAttribute("contenteditable","false",l),t.addClass("ck-widget",l),t.setCustomProperty("widget",!0,l),l.getFillerOffset=RC,n.label&&function(o,r,c){c.setCustomProperty("widgetLabel",r,o)}(l,n.label,t),n.hasSelectionHandle&&function(o,r){const c=r.createUIElement("div",{class:"ck ck-widget__selection-handle"},function(u){const g=this.toDomElement(u),m=new Xr;return m.set("content",'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 0v1H1v3H0V.5A.5.5 0 0 1 .5 0H4zm8 0h3.5a.5.5 0 0 1 .5.5V4h-1V1h-3V0zM4 16H.5a.5.5 0 0 1-.5-.5V12h1v3h3v1zm8 0v-1h3v-3h1v3.5a.5.5 0 0 1-.5.5H12z"/><path fill-opacity=".256" d="M1 1h14v14H1z"/><g class="ck-icon__selected-indicator"><path d="M7 0h2v1H7V0zM0 7h1v2H0V7zm15 0h1v2h-1V7zm-8 8h2v1H7v-1z"/><path fill-opacity=".254" d="M1 1h14v14H1z"/></g></svg>'),m.render(),g.appendChild(m.element),g});r.insert(r.createPositionAt(o,0),c),r.addClass(["ck-widget_with-selection-handle"],o)}(l,t),gm(l,t),l}function PC(l,t,n){if(t.classes&&n.addClass(Kt(t.classes),l),t.attributes)for(const o in t.attributes)n.setAttribute(o,t.attributes[o],l)}function IC(l,t,n){if(t.classes&&n.removeClass(Kt(t.classes),l),t.attributes)for(const o in t.attributes)n.removeAttribute(o,l)}function gm(l,t,n=PC,o=IC){const r=new fm;r.on("change:top",(c,u)=>{u.oldDescriptor&&o(l,u.oldDescriptor,u.writer),u.newDescriptor&&n(l,u.newDescriptor,u.writer)}),t.setCustomProperty("addHighlight",(c,u,g)=>r.add(u,g),l),t.setCustomProperty("removeHighlight",(c,u,g)=>r.remove(u,g),l)}function MC(l){const t=l.getCustomProperty("widgetLabel");return t?typeof t=="function"?t():t:""}function Lc(l,t){return t.addClass(["ck-editor__editable","ck-editor__nested-editable"],l),t.setAttribute("contenteditable",l.isReadOnly?"false":"true",l),l.on("change:isReadOnly",(n,o,r)=>{t.setAttribute("contenteditable",r?"false":"true",l)}),l.on("change:isFocused",(n,o,r)=>{r?t.addClass("ck-editor__nested-editable_focused",l):t.removeClass("ck-editor__nested-editable_focused",l)}),gm(l,t),l}function ds(l,t){const n=l.getSelectedElement();if(n){const r=fi(l);if(r)return t.createRange(t.createPositionAt(n,r));if(t.schema.isObject(n)&&!t.schema.isInline(n))return t.createRangeOn(n)}const o=l.getSelectedBlocks().next().value;if(o){if(o.isEmpty)return t.createRange(t.createPositionAt(o,0));const r=t.createPositionAfter(o);return l.focus.isTouching(r)?t.createRange(r):t.createRange(t.createPositionBefore(o))}return t.createRange(l.focus)}function RC(){return null}function hi(l,t,n){return l&&Nt(l)&&!n.isInline(t)}function fi(l){return l.getAttribute("widget-type-around")}const mm=[en("arrowUp"),en("arrowRight"),en("arrowDown"),en("arrowLeft"),9,16,17,18,19,20,27,33,34,35,36,45,91,93,144,145,173,174,175,176,177,178,179,255];for(let l=112;l<=135;l++)mm.push(l);function pm(l){return!(!l.ctrlKey&&!l.metaKey)||mm.includes(l.keyCode)}d(65);const bm=["before","after"],OC=new DOMParser().parseFromString('<svg viewBox="0 0 10 8" xmlns="http://www.w3.org/2000/svg"><path d="M9.055.263v3.972h-6.77M1 4.216l2-2.038m-2 2 2 2.038"/></svg>',"image/svg+xml").firstChild;class NC extends z{static get pluginName(){return"WidgetTypeAround"}static get requires(){return[ia,Bn]}constructor(t){super(t),this._currentFakeCaretModelElement=null}init(){const t=this.editor,n=t.editing.view;this.on("change:isEnabled",(o,r,c)=>{n.change(u=>{for(const g of n.document.roots)c?u.removeClass("ck-widget__type-around_disabled",g):u.addClass("ck-widget__type-around_disabled",g)}),c||t.model.change(u=>{u.removeSelectionAttribute("widget-type-around")})}),this._enableTypeAroundUIInjection(),this._enableInsertingParagraphsOnButtonClick(),this._enableInsertingParagraphsOnEnterKeypress(),this._enableInsertingParagraphsOnTypingKeystroke(),this._enableTypeAroundFakeCaretActivationUsingKeyboardArrows(),this._enableDeleteIntegration(),this._enableInsertContentIntegration(),this._enableDeleteContentIntegration()}destroy(){this._currentFakeCaretModelElement=null}_insertParagraph(t,n){const o=this.editor,r=o.editing.view;o.execute("insertParagraph",{position:o.model.createPositionAt(t,n)}),r.focus(),r.scrollToTheSelection()}_listenToIfEnabled(t,n,o,r){this.listenTo(t,n,(...c)=>{this.isEnabled&&o(...c)},r)}_insertParagraphAccordingToFakeCaretPosition(){const t=this.editor.model.document.selection,n=fi(t);if(!n)return!1;const o=t.getSelectedElement();return this._insertParagraph(o,n),!0}_enableTypeAroundUIInjection(){const t=this.editor,n=t.model.schema,o=t.locale.t,r={before:o("Insert paragraph before block"),after:o("Insert paragraph after block")};t.editing.downcastDispatcher.on("insert",(c,u,g)=>{const m=g.mapper.toViewElement(u.item);hi(m,u.item,n)&&function(p,w,_){const v=p.createUIElement("div",{class:"ck ck-reset_all ck-widget__type-around"},function(A){const x=this.toDomElement(A);return function(E,T){for(const S of bm){const I=new ye({tag:"div",attributes:{class:["ck","ck-widget__type-around__button","ck-widget__type-around__button_"+S],title:T[S]},children:[E.ownerDocument.importNode(OC,!0)]});E.appendChild(I.render())}}(x,w),function(E){const T=new ye({tag:"div",attributes:{class:["ck","ck-widget__type-around__fake-caret"]}});E.appendChild(T.render())}(x),x});p.insert(p.createPositionAt(_,"end"),v)}(g.writer,r,m)},{priority:"low"})}_enableTypeAroundFakeCaretActivationUsingKeyboardArrows(){const t=this.editor,n=t.model,o=n.document.selection,r=n.schema,c=t.editing.view;function u(g){return"ck-widget_type-around_show-fake-caret_"+g}this._listenToIfEnabled(c.document,"arrowKey",(g,m)=>{this._handleArrowKeyPress(g,m)},{context:[Nt,"$text"],priority:"high"}),this._listenToIfEnabled(o,"change:range",(g,m)=>{m.directChange&&t.model.change(p=>{p.removeSelectionAttribute("widget-type-around")})}),this._listenToIfEnabled(n.document,"change:data",()=>{const g=o.getSelectedElement();g&&hi(t.editing.mapper.toViewElement(g),g,r)||t.model.change(m=>{m.removeSelectionAttribute("widget-type-around")})}),this._listenToIfEnabled(t.editing.downcastDispatcher,"selection",(g,m,p)=>{const w=p.writer;if(this._currentFakeCaretModelElement){const x=p.mapper.toViewElement(this._currentFakeCaretModelElement);x&&(w.removeClass(bm.map(u),x),this._currentFakeCaretModelElement=null)}const _=m.selection.getSelectedElement();if(!_)return;const v=p.mapper.toViewElement(_);if(!hi(v,_,r))return;const A=fi(m.selection);A&&(w.addClass(u(A),v),this._currentFakeCaretModelElement=_)}),this._listenToIfEnabled(t.ui.focusTracker,"change:isFocused",(g,m,p)=>{p||t.model.change(w=>{w.removeSelectionAttribute("widget-type-around")})})}_handleArrowKeyPress(t,n){const o=this.editor,r=o.model,c=r.document.selection,u=r.schema,g=o.editing.view,m=function(_,v){const A=Gl(_,v);return A==="down"||A==="right"}(n.keyCode,o.locale.contentLanguageDirection),p=g.document.selection.getSelectedElement();let w;hi(p,o.editing.mapper.toModelElement(p),u)?w=this._handleArrowKeyPressOnSelectedWidget(m):c.isCollapsed?w=this._handleArrowKeyPressWhenSelectionNextToAWidget(m):n.shiftKey||(w=this._handleArrowKeyPressWhenNonCollapsedSelection(m)),w&&(n.preventDefault(),t.stop())}_handleArrowKeyPressOnSelectedWidget(t){const n=this.editor.model,o=fi(n.document.selection);return n.change(r=>o?o!==(t?"after":"before")?(r.removeSelectionAttribute("widget-type-around"),!0):!1:(r.setSelectionAttribute("widget-type-around",t?"after":"before"),!0))}_handleArrowKeyPressWhenSelectionNextToAWidget(t){const n=this.editor,o=n.model,r=o.schema,c=n.plugins.get("Widget"),u=c._getObjectElementNextToSelection(t);return!!hi(n.editing.mapper.toViewElement(u),u,r)&&(o.change(g=>{c._setSelectionOverElement(u),g.setSelectionAttribute("widget-type-around",t?"before":"after")}),!0)}_handleArrowKeyPressWhenNonCollapsedSelection(t){const n=this.editor,o=n.model,r=o.schema,c=n.editing.mapper,u=o.document.selection,g=t?u.getLastPosition().nodeBefore:u.getFirstPosition().nodeAfter;return!!hi(c.toViewElement(g),g,r)&&(o.change(m=>{m.setSelection(g,"on"),m.setSelectionAttribute("widget-type-around",t?"after":"before")}),!0)}_enableInsertingParagraphsOnButtonClick(){const t=this.editor,n=t.editing.view;this._listenToIfEnabled(n.document,"mousedown",(o,r)=>{const c=r.domTarget.closest(".ck-widget__type-around__button");if(!c)return;const u=function(p){return p.classList.contains("ck-widget__type-around__button_before")?"before":"after"}(c),g=function(p,w){const _=p.closest(".ck-widget");return w.mapDomToView(_)}(c,n.domConverter),m=t.editing.mapper.toModelElement(g);this._insertParagraph(m,u),r.preventDefault(),o.stop()})}_enableInsertingParagraphsOnEnterKeypress(){const t=this.editor,n=t.model.document.selection,o=t.editing.view;this._listenToIfEnabled(o.document,"enter",(r,c)=>{if(r.eventPhase!="atTarget")return;const u=n.getSelectedElement(),g=t.editing.mapper.toViewElement(u),m=t.model.schema;let p;this._insertParagraphAccordingToFakeCaretPosition()?p=!0:hi(g,u,m)&&(this._insertParagraph(u,c.isSoft?"before":"after"),p=!0),p&&(c.preventDefault(),r.stop())},{context:Nt})}_enableInsertingParagraphsOnTypingKeystroke(){const t=this.editor.editing.view,n=[rt.enter,rt.delete,rt.backspace];this._listenToIfEnabled(t.document,"keydown",(o,r)=>{n.includes(r.keyCode)||pm(r)||this._insertParagraphAccordingToFakeCaretPosition()},{priority:"high"})}_enableDeleteIntegration(){const t=this.editor,n=t.editing.view,o=t.model,r=o.schema;this._listenToIfEnabled(n.document,"delete",(c,u)=>{if(c.eventPhase!="atTarget")return;const g=fi(o.document.selection);if(!g)return;const m=u.direction,p=o.document.selection.getSelectedElement(),w=m=="forward";if(g==="before"===w)t.execute("delete",{selection:o.createSelection(p,"on")});else{const _=r.getNearestSelectionRange(o.createPositionAt(p,g),m);if(_)if(_.isCollapsed){const v=o.createSelection(_.start);if(o.modifySelection(v,{direction:m}),v.focus.isEqual(_.start)){const A=function(x,E){let T=E;for(const S of E.getAncestors({parentFirst:!0})){if(S.childCount>1||x.isLimit(S))break;T=S}return T}(r,_.start.parent);o.deleteContent(o.createSelection(A,"on"),{doNotAutoparagraph:!0})}else o.change(A=>{A.setSelection(_),t.execute(w?"deleteForward":"delete")})}else o.change(v=>{v.setSelection(_),t.execute(w?"deleteForward":"delete")})}u.preventDefault(),c.stop()},{context:Nt})}_enableInsertContentIntegration(){const t=this.editor,n=this.editor.model,o=n.document.selection;this._listenToIfEnabled(t.model,"insertContent",(r,[c,u])=>{if(u&&!u.is("documentSelection"))return;const g=fi(o);return g?(r.stop(),n.change(m=>{const p=o.getSelectedElement(),w=n.createPositionAt(p,g),_=m.createSelection(w),v=n.insertContent(c,_);return m.setSelection(_),v})):void 0},{priority:"high"})}_enableDeleteContentIntegration(){const t=this.editor,n=this.editor.model.document.selection;this._listenToIfEnabled(t.model,"deleteContent",(o,[r])=>{r&&!r.is("documentSelection")||fi(n)&&o.stop()},{priority:"high"})}}function DC(l){const t=l.model;return(n,o)=>{const r=o.keyCode==rt.arrowup,c=o.keyCode==rt.arrowdown,u=o.shiftKey,g=t.document.selection;if(!r&&!c)return;const m=c;if(u&&function(w,_){return!w.isCollapsed&&w.isBackward==_}(g,m))return;const p=function(w,_,v){const A=w.model;if(v){const x=_.isCollapsed?_.focus:_.getLastPosition(),E=wm(A,x,"forward");if(!E)return null;const T=A.createRange(x,E),S=_m(A.schema,T,"backward");return S?A.createRange(x,S):null}{const x=_.isCollapsed?_.focus:_.getFirstPosition(),E=wm(A,x,"backward");if(!E)return null;const T=A.createRange(E,x),S=_m(A.schema,T,"forward");return S?A.createRange(S,x):null}}(l,g,m);if(p){if(p.isCollapsed&&(g.isCollapsed||u))return;(p.isCollapsed||function(w,_,v){const A=w.model,x=w.view.domConverter;if(v){const N=A.createSelection(_.start);A.modifySelection(N),N.focus.isAtEnd||_.start.isEqual(N.focus)||(_=A.createRange(N.focus,_.end))}const E=w.mapper.toViewRange(_),T=x.viewRangeToDom(E),S=gt.getDomRangeRects(T);let I;for(const N of S)if(I!==void 0){if(Math.round(N.top)>=I)return!1;I=Math.max(I,Math.round(N.bottom))}else I=Math.round(N.bottom);return!0}(l,p,m))&&(t.change(w=>{const _=m?p.end:p.start;if(u){const v=t.createSelection(g.anchor);v.setFocus(_),w.setSelection(v)}else w.setSelection(_)}),n.stop(),o.preventDefault(),o.stopPropagation())}}}function wm(l,t,n){const o=l.schema,r=l.createRangeIn(t.root),c=n=="forward"?"elementStart":"elementEnd";for(const{previousPosition:u,item:g,type:m}of r.getWalker({startPosition:t,direction:n})){if(o.isLimit(g)&&!o.isInline(g))return u;if(m==c&&o.isBlock(g))return null}return null}function _m(l,t,n){const o=n=="backward"?t.end:t.start;if(l.checkChild(o,"$text"))return o;for(const{nextPosition:r}of t.getWalker({direction:n}))if(l.checkChild(r,"$text"))return r;return null}d(67);class us extends z{static get pluginName(){return"Widget"}static get requires(){return[NC,Bn]}init(){const t=this.editor,n=t.editing.view,o=n.document;this._previouslySelected=new Set,this.editor.editing.downcastDispatcher.on("selection",(r,c,u)=>{const g=u.writer,m=c.selection;if(m.isCollapsed)return;const p=m.getSelectedElement();if(!p)return;const w=t.editing.mapper.toViewElement(p);Nt(w)&&u.consumable.consume(m,"selection")&&g.setSelection(g.createRangeOn(w),{fake:!0,label:MC(w)})}),this.editor.editing.downcastDispatcher.on("selection",(r,c,u)=>{this._clearPreviouslySelectedWidgets(u.writer);const g=u.writer,m=g.document.selection;let p=null;for(const w of m.getRanges())for(const _ of w){const v=_.item;Nt(v)&&!LC(v,p)&&(g.addClass("ck-widget_selected",v),this._previouslySelected.add(v),p=v)}},{priority:"low"}),n.addObserver(na),this.listenTo(o,"mousedown",(...r)=>this._onMousedown(...r)),this.listenTo(o,"arrowKey",(...r)=>{this._handleSelectionChangeOnArrowKeyPress(...r)},{context:[Nt,"$text"]}),this.listenTo(o,"arrowKey",(...r)=>{this._preventDefaultOnArrowKeyPress(...r)},{context:"$root"}),this.listenTo(o,"arrowKey",DC(this.editor.editing),{context:"$text"}),this.listenTo(o,"delete",(r,c)=>{this._handleDelete(c.direction=="forward")&&(c.preventDefault(),r.stop())},{context:"$root"})}_onMousedown(t,n){const o=this.editor,r=o.editing.view,c=r.document;let u=n.target;if(function(m){for(;m;){if(m.is("editableElement")&&!m.is("rootElement"))return!0;if(Nt(m))return!1;m=m.parent}return!1}(u)){if((bt.isSafari||bt.isGecko)&&n.domEvent.detail>=3){const m=o.editing.mapper,p=u.is("attributeElement")?u.findAncestor(_=>!_.is("attributeElement")):u,w=m.toModelElement(p);n.preventDefault(),this.editor.model.change(_=>{_.setSelection(w,"in")})}return}if(!Nt(u)&&(u=u.findAncestor(Nt),!u))return;bt.isAndroid&&n.preventDefault(),c.isFocused||r.focus();const g=o.editing.mapper.toModelElement(u);this._setSelectionOverElement(g)}_handleSelectionChangeOnArrowKeyPress(t,n){const o=n.keyCode,r=this.editor.model,c=r.schema,u=r.document.selection,g=u.getSelectedElement(),m=Gl(o,this.editor.locale.contentLanguageDirection),p=m=="down"||m=="right",w=m=="up"||m=="down";if(g&&c.isObject(g)){const v=p?u.getLastPosition():u.getFirstPosition(),A=c.getNearestSelectionRange(v,p?"forward":"backward");return void(A&&(r.change(x=>{x.setSelection(A)}),n.preventDefault(),t.stop()))}if(!u.isCollapsed&&!n.shiftKey){const v=u.getFirstPosition(),A=u.getLastPosition(),x=v.nodeAfter,E=A.nodeBefore;return void((x&&c.isObject(x)||E&&c.isObject(E))&&(r.change(T=>{T.setSelection(p?A:v)}),n.preventDefault(),t.stop()))}if(!u.isCollapsed)return;const _=this._getObjectElementNextToSelection(p);if(_&&c.isObject(_)){if(c.isInline(_)&&w)return;this._setSelectionOverElement(_),n.preventDefault(),t.stop()}}_preventDefaultOnArrowKeyPress(t,n){const o=this.editor.model,r=o.schema,c=o.document.selection.getSelectedElement();c&&r.isObject(c)&&(n.preventDefault(),t.stop())}_handleDelete(t){if(this.editor.isReadOnly)return;const n=this.editor.model.document.selection;if(!n.isCollapsed)return;const o=this._getObjectElementNextToSelection(t);return o?(this.editor.model.change(r=>{let c=n.anchor.parent;for(;c.isEmpty;){const u=c;c=u.parent,r.remove(u)}this._setSelectionOverElement(o)}),!0):void 0}_setSelectionOverElement(t){this.editor.model.change(n=>{n.setSelection(n.createRangeOn(t))})}_getObjectElementNextToSelection(t){const n=this.editor.model,o=n.schema,r=n.document.selection,c=n.createSelection(r);if(n.modifySelection(c,{direction:t?"forward":"backward"}),c.isEqual(r))return null;const u=t?c.focus.nodeBefore:c.focus.nodeAfter;return u&&o.isObject(u)?u:null}_clearPreviouslySelectedWidgets(t){for(const n of this._previouslySelected)t.removeClass("ck-widget_selected",n);this._previouslySelected.clear()}}function LC(l,t){return!!t&&Array.from(l.getAncestors()).includes(t)}var km=function(l,t,n){var o=!0,r=!0;if(typeof l!="function")throw new TypeError("Expected a function");return G(n)&&(o="leading"in n?!!n.leading:o,r="trailing"in n?!!n.trailing:r),$r(l,t,{leading:o,maxWait:t,trailing:r})};d(69);class VC extends z{static get pluginName(){return"DragDrop"}static get requires(){return[rn,us]}init(){const t=this.editor,n=t.editing.view;this._draggedRange=null,this._draggingUid="",this._draggableElement=null,this._updateDropMarkerThrottled=km(o=>this._updateDropMarker(o),40),this._removeDropMarkerDelayed=Am(()=>this._removeDropMarker(),40),this._clearDraggableAttributesDelayed=Am(()=>this._clearDraggableAttributes(),40),n.addObserver(Oc),n.addObserver(na),this._setupDragging(),this._setupContentInsertionIntegration(),this._setupClipboardInputIntegration(),this._setupDropMarker(),this._setupDraggableAttributeHandling(),this.listenTo(t,"change:isReadOnly",(o,r,c)=>{c?this.forceDisabled("readOnlyMode"):this.clearForceDisabled("readOnlyMode")}),this.on("change:isEnabled",(o,r,c)=>{c||this._finalizeDragging(!1)}),bt.isAndroid&&this.forceDisabled("noAndroidSupport")}destroy(){return this._draggedRange&&(this._draggedRange.detach(),this._draggedRange=null),this._updateDropMarkerThrottled.cancel(),this._removeDropMarkerDelayed.cancel(),this._clearDraggableAttributesDelayed.cancel(),super.destroy()}_setupDragging(){const t=this.editor,n=t.model,o=n.document,r=t.editing.view,c=r.document;this.listenTo(c,"dragstart",(u,g)=>{const m=o.selection;if(g.target&&g.target.is("editableElement"))return void g.preventDefault();const p=g.target?Cm(g.target):null;if(p){const v=t.editing.mapper.toModelElement(p);this._draggedRange=on.fromRange(n.createRangeOn(v)),t.plugins.has("WidgetToolbarRepository")&&t.plugins.get("WidgetToolbarRepository").forceDisabled("dragDrop")}else if(!c.selection.isCollapsed){const v=c.selection.getSelectedElement();v&&Nt(v)||(this._draggedRange=on.fromRange(m.getFirstRange()))}if(!this._draggedRange)return void g.preventDefault();this._draggingUid=k(),g.dataTransfer.effectAllowed=this.isEnabled?"copyMove":"copy",g.dataTransfer.setData("application/ckeditor5-dragging-uid",this._draggingUid);const w=n.createSelection(this._draggedRange.toRange()),_=t.data.toView(n.getSelectedContent(w));c.fire("clipboardOutput",{dataTransfer:g.dataTransfer,content:_,method:u.name}),this.isEnabled||(this._draggedRange.detach(),this._draggedRange=null,this._draggingUid="")},{priority:"low"}),this.listenTo(c,"dragend",(u,g)=>{this._finalizeDragging(!g.dataTransfer.isCanceled&&g.dataTransfer.dropEffect=="move")},{priority:"low"}),this.listenTo(c,"dragenter",()=>{this.isEnabled&&r.focus()}),this.listenTo(c,"dragleave",()=>{this._removeDropMarkerDelayed()}),this.listenTo(c,"dragging",(u,g)=>{if(!this.isEnabled)return void(g.dataTransfer.dropEffect="none");this._removeDropMarkerDelayed.cancel();const m=vm(t,g.targetRanges,g.target);this._draggedRange||(g.dataTransfer.dropEffect="copy"),bt.isGecko||(g.dataTransfer.effectAllowed=="copy"?g.dataTransfer.dropEffect="copy":["all","copyMove"].includes(g.dataTransfer.effectAllowed)&&(g.dataTransfer.dropEffect="move")),m&&this._updateDropMarkerThrottled(m)},{priority:"low"})}_setupClipboardInputIntegration(){const t=this.editor,n=t.editing.view.document;this.listenTo(n,"clipboardInput",(o,r)=>{if(r.method!="drop")return;const c=vm(t,r.targetRanges,r.target);if(this._removeDropMarker(),!c)return this._finalizeDragging(!1),void o.stop();if(this._draggedRange&&this._draggingUid!=r.dataTransfer.getData("application/ckeditor5-dragging-uid")&&(this._draggedRange.detach(),this._draggedRange=null,this._draggingUid=""),ym(r.dataTransfer)=="move"&&this._draggedRange&&this._draggedRange.containsRange(c,!0))return this._finalizeDragging(!1),void o.stop();r.targetRanges=[t.editing.mapper.toViewRange(c)]},{priority:"high"})}_setupContentInsertionIntegration(){const t=this.editor.plugins.get(rn);t.on("contentInsertion",(n,o)=>{if(!this.isEnabled||o.method!=="drop")return;const r=o.targetRanges.map(c=>this.editor.editing.mapper.toModelRange(c));this.editor.model.change(c=>c.setSelection(r))},{priority:"high"}),t.on("contentInsertion",(n,o)=>{if(!this.isEnabled||o.method!=="drop")return;const r=ym(o.dataTransfer)=="move",c=!o.resultRange||!o.resultRange.isCollapsed;this._finalizeDragging(c&&r)},{priority:"lowest"})}_setupDraggableAttributeHandling(){const t=this.editor,n=t.editing.view,o=n.document;this.listenTo(o,"mousedown",(r,c)=>{if(bt.isAndroid||!c)return;this._clearDraggableAttributesDelayed.cancel();let u=Cm(c.target);if(bt.isBlink&&!t.isReadOnly&&!u&&!o.selection.isCollapsed){const g=o.selection.getSelectedElement();g&&Nt(g)||(u=o.selection.editableElement)}u&&(n.change(g=>{g.setAttribute("draggable","true",u)}),this._draggableElement=t.editing.mapper.toModelElement(u))}),this.listenTo(o,"mouseup",()=>{bt.isAndroid||this._clearDraggableAttributesDelayed()})}_clearDraggableAttributes(){const t=this.editor.editing;t.view.change(n=>{this._draggableElement&&this._draggableElement.root.rootName!="$graveyard"&&n.removeAttribute("draggable",t.mapper.toViewElement(this._draggableElement)),this._draggableElement=null})}_setupDropMarker(){const t=this.editor;t.conversion.for("editingDowncast").markerToHighlight({model:"drop-target",view:{classes:["ck-clipboard-drop-target-range"]}}),t.conversion.for("editingDowncast").markerToElement({model:"drop-target",view:(n,{writer:o})=>{if(t.model.schema.checkChild(n.markerRange.start,"$text"))return o.createUIElement("span",{class:"ck ck-clipboard-drop-target-position"},function(r){const c=this.toDomElement(r);return c.innerHTML="&NoBreak;<span></span>&NoBreak;",c})}})}_updateDropMarker(t){const n=this.editor,o=n.model.markers;n.model.change(r=>{o.has("drop-target")?o.get("drop-target").getRange().isEqual(t)||r.updateMarker("drop-target",{range:t}):r.addMarker("drop-target",{range:t,usingOperation:!1,affectsData:!1})})}_removeDropMarker(){const t=this.editor.model;this._removeDropMarkerDelayed.cancel(),this._updateDropMarkerThrottled.cancel(),t.markers.has("drop-target")&&t.change(n=>{n.removeMarker("drop-target")})}_finalizeDragging(t){const n=this.editor,o=n.model;this._removeDropMarker(),this._clearDraggableAttributes(),n.plugins.has("WidgetToolbarRepository")&&n.plugins.get("WidgetToolbarRepository").clearForceDisabled("dragDrop"),this._draggingUid="",this._draggedRange&&(t&&this.isEnabled&&o.deleteContent(o.createSelection(this._draggedRange),{doNotAutoparagraph:!0}),this._draggedRange.detach(),this._draggedRange=null)}}function vm(l,t,n){const o=l.model,r=l.editing.mapper;let c=null;const u=t?t[0].start:null;if(n.is("uiElement")&&(n=n.parent),c=function(p,w){const _=p.model,v=p.editing.mapper;if(Nt(w))return _.createRangeOn(v.toModelElement(w));if(!w.is("editableElement")){const A=w.findAncestor(x=>Nt(x)||x.is("editableElement"));if(Nt(A))return _.createRangeOn(v.toModelElement(A))}return null}(l,n),c)return c;const g=function(p,w){const _=p.editing.mapper,v=p.editing.view,A=_.toModelElement(w);if(A)return A;const x=v.createPositionBefore(w),E=_.findMappedViewAncestor(x);return _.toModelElement(E)}(l,n),m=u?r.toModelPosition(u):null;return m?(c=function(p,w,_){const v=p.model;if(!v.schema.checkChild(_,"$block"))return null;const A=v.createPositionAt(_,0),x=w.path.slice(0,A.path.length),E=v.createPositionFromPath(w.root,x).nodeAfter;return E&&v.schema.isObject(E)?v.createRangeOn(E):null}(l,m,g),c||(c=o.schema.getNearestSelectionRange(m,bt.isGecko?"forward":"backward"),c||function(p,w){const _=p.model;for(;w;){if(_.schema.isObject(w))return _.createRangeOn(w);w=w.parent}}(l,m.parent))):function(p,w){const _=p.model,v=_.schema,A=_.createPositionAt(w,0);return v.getNearestSelectionRange(A,"forward")}(l,g)}function ym(l){return bt.isGecko?l.dropEffect:["all","copyMove"].includes(l.effectAllowed)?"move":"copy"}function Am(l,t){let n;function o(...r){o.cancel(),n=setTimeout(()=>l(...r),t)}return o.cancel=()=>{clearTimeout(n)},o}function Cm(l){if(l.is("editableElement"))return null;if(l.hasClass("ck-widget__selection-handle"))return l.findAncestor(Nt);if(Nt(l))return l;const t=l.findAncestor(n=>Nt(n)||n.is("editableElement"));return Nt(t)?t:null}class BC extends z{static get pluginName(){return"PastePlainText"}static get requires(){return[rn]}init(){const t=this.editor,n=t.model,o=t.editing.view,r=o.document,c=n.document.selection;let u=!1;o.addObserver(Oc),this.listenTo(r,"keydown",(g,m)=>{u=m.shiftKey}),t.plugins.get(rn).on("contentInsertion",(g,m)=>{(u||function(p,w){if(p.childCount>1)return!1;const _=p.getChild(0);return w.isObject(_)?!1:[..._.getAttributeKeys()].length==0}(m.content,n.schema))&&n.change(p=>{const w=Array.from(c.getAttributes()).filter(([v])=>n.schema.getAttributeProperties(v).isFormatting);c.isCollapsed||n.deleteContent(c,{doNotAutoparagraph:!0}),w.push(...c.getAttributes());const _=p.createRangeIn(m.content);for(const v of _.getItems())v.is("$textProxy")&&p.setAttributes(w,v)})})}}class xm extends z{static get pluginName(){return"Clipboard"}static get requires(){return[rn,VC,BC]}}class FC extends lt{execute(){const t=this.editor.model,n=t.document;t.change(o=>{(function(r,c,u){const g=u.isCollapsed,m=u.getFirstRange(),p=m.start.parent,w=m.end.parent,_=p==w;if(g){const v=rm(r.schema,u.getAttributes());Em(r,c,m.end),c.removeSelectionAttribute(u.getAttributeKeys()),c.setSelectionAttribute(v)}else{const v=!(m.start.isAtStart&&m.end.isAtEnd);r.deleteContent(u,{leaveUnmerged:v}),_?Em(r,c,u.focus):v&&c.setSelection(w,0)}})(t,o,n.selection),this.fire("afterExecute",{writer:o})})}refresh(){const t=this.editor.model,n=t.document;this.isEnabled=function(o,r){if(r.rangeCount>1)return!1;const c=r.anchor;if(!c||!o.checkChild(c,"softBreak"))return!1;const u=r.getFirstRange(),g=u.start.parent,m=u.end.parent;return!((Vc(g,o)||Vc(m,o))&&g!==m)}(t.schema,n.selection)}}function Em(l,t,n){const o=t.createElement("softBreak");l.insertContent(o,n),t.setSelection(o,"after")}function Vc(l,t){return!l.is("rootElement")&&(t.isLimit(l)||Vc(l.parent,t))}class zC extends z{static get pluginName(){return"ShiftEnter"}init(){const t=this.editor,n=t.model.schema,o=t.conversion,r=t.editing.view,c=r.document;n.register("softBreak",{allowWhere:"$text",isInline:!0}),o.for("upcast").elementToElement({model:"softBreak",view:"br"}),o.for("downcast").elementToElement({model:"softBreak",view:(u,{writer:g})=>g.createEmptyElement("br")}),r.addObserver(lm),t.commands.add("shiftEnter",new FC(t)),this.listenTo(c,"enter",(u,g)=>{g.preventDefault(),g.isSoft&&(t.execute("shiftEnter"),r.scrollToTheSelection())},{priority:"low"})}}class jC extends lt{constructor(t){super(t),this.affectsData=!1}execute(){const t=this.editor.model,n=t.document.selection;let o=t.schema.getLimitElement(n);if(n.containsEntireContent(o)||!Tm(t.schema,o))do if(o=o.parent,!o)return;while(!Tm(t.schema,o));t.change(r=>{r.setSelection(o,"in")})}}function Tm(l,t){return l.isLimit(t)&&(l.checkChild(t,"$text")||l.checkChild(t,"paragraph"))}const $C=Ul("Ctrl+A");class HC extends z{static get pluginName(){return"SelectAllEditing"}init(){const t=this.editor,n=t.editing.view.document;t.commands.add("selectAll",new jC(t)),this.listenTo(n,"keydown",(o,r)=>{en(r)===$C&&(t.execute("selectAll"),r.preventDefault())})}}class WC extends z{static get pluginName(){return"SelectAllUI"}init(){const t=this.editor;t.ui.componentFactory.add("selectAll",n=>{const o=t.commands.get("selectAll"),r=new Mt(n),c=n.t;return r.set({label:c("Select all"),icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M.75 15.5a.75.75 0 0 1 .75.75V18l.008.09A.5.5 0 0 0 2 18.5h1.75a.75.75 0 1 1 0 1.5H1.5l-.144-.007a1.5 1.5 0 0 1-1.35-1.349L0 18.5v-2.25a.75.75 0 0 1 .75-.75zm18.5 0a.75.75 0 0 1 .75.75v2.25l-.007.144a1.5 1.5 0 0 1-1.349 1.35L18.5 20h-2.25a.75.75 0 1 1 0-1.5H18a.5.5 0 0 0 .492-.41L18.5 18v-1.75a.75.75 0 0 1 .75-.75zm-10.45 3c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2h1.6zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2h1.6zm.45-5.5a.75.75 0 1 1 0 1.5h-8.5a.75.75 0 1 1 0-1.5h8.5zM1.3 11c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2h1.1zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2h1.1zm-4.55-2a.75.75 0 1 1 0 1.5H4.75a.75.75 0 1 1 0-1.5h10.5zM1.3 7c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2h1.1zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2h1.1zm-4.55-2a.75.75 0 1 1 0 1.5h-2.5a.75.75 0 1 1 0-1.5h2.5zm-5 0a.75.75 0 1 1 0 1.5h-5.5a.75.75 0 0 1 0-1.5h5.5zm-6.5-5a.75.75 0 0 1 0 1.5H2a.5.5 0 0 0-.492.41L1.5 2v1.75a.75.75 0 0 1-1.5 0V1.5l.007-.144A1.5 1.5 0 0 1 1.356.006L1.5 0h2.25zM18.5 0l.144.007a1.5 1.5 0 0 1 1.35 1.349L20 1.5v2.25a.75.75 0 1 1-1.5 0V2l-.008-.09A.5.5 0 0 0 18 1.5h-1.75a.75.75 0 1 1 0-1.5h2.25zM8.8 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2h1.6zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2h1.6z"/></svg>',keystroke:"Ctrl+A",tooltip:!0}),r.bind("isOn","isEnabled").to(o,"value","isEnabled"),this.listenTo(r,"execute",()=>{t.execute("selectAll"),t.editing.view.focus()}),r})}}class qC extends z{static get requires(){return[HC,WC]}static get pluginName(){return"SelectAll"}}class UC extends lt{constructor(t,n){super(t),this._buffer=new cm(t.model,n),this._batches=new WeakSet}get buffer(){return this._buffer}destroy(){super.destroy(),this._buffer.destroy()}execute(t={}){const n=this.editor.model,o=n.document,r=t.text||"",c=r.length,u=t.range?n.createSelection(t.range):o.selection,g=t.resultRange;n.enqueueChange(this._buffer.batch,m=>{this._buffer.lock(),this._batches.add(this._buffer.batch),n.deleteContent(u),r&&n.insertContent(m.createText(r,o.selection.getAttributes()),u),g?m.setSelection(g):u.is("documentSelection")||m.setSelection(u),this._buffer.unlock(),this._buffer.input(c)})}}class GC{constructor(t){this.editor=t,this.editing=this.editor.editing}handle(t,n){if(function(o){if(o.length==0)return!1;for(const r of o)if(r.type==="children"&&!um(r))return!0;return!1}(t))this._handleContainerChildrenMutations(t,n);else for(const o of t)this._handleTextMutation(o,n),this._handleTextNodeInsertion(o)}_handleContainerChildrenMutations(t,n){const o=function(re){const ue=re.map(he=>he.node).reduce((he,Ve)=>he.getCommonAncestor(Ve,{includeSelf:!0}));if(ue)return ue.getAncestors({includeSelf:!0,parentFirst:!0}).find(he=>he.is("containerElement")||he.is("rootElement"))}(t);if(!o)return;const r=this.editor.editing.view.domConverter.mapViewToDom(o),c=new Fr(this.editor.editing.view.document),u=this.editor.data.toModel(c.domToView(r)).getChild(0),g=this.editor.editing.mapper.toModelElement(o);if(!g)return;const m=Array.from(u.getChildren()),p=Array.from(g.getChildren()),w=m[m.length-1],_=p[p.length-1],v=w&&w.is("element","softBreak"),A=_&&!_.is("element","softBreak");v&&A&&m.pop();const x=this.editor.model.schema;if(!Sm(m,x)||!Sm(p,x))return;const E=m.map(re=>re.is("$text")?re.data:"@").join("").replace(/\u00A0/g," "),T=p.map(re=>re.is("$text")?re.data:"@").join("").replace(/\u00A0/g," ");if(T===E)return;const S=Ln(T,E),{firstChangeAt:I,insertions:N,deletions:j}=Pm(S);let X=null;n&&(X=this.editing.mapper.toModelRange(n.getFirstRange()));const vt=E.substr(I,N),dt=this.editor.model.createRange(this.editor.model.createPositionAt(g,I),this.editor.model.createPositionAt(g,I+j));this.editor.execute("input",{text:vt,range:dt,resultRange:X})}_handleTextMutation(t,n){if(t.type!="text")return;const o=t.newText.replace(/\u00A0/g," "),r=t.oldText.replace(/\u00A0/g," ");if(r===o)return;const c=Ln(r,o),{firstChangeAt:u,insertions:g,deletions:m}=Pm(c);let p=null;n&&(p=this.editing.mapper.toModelRange(n.getFirstRange()));const w=this.editing.view.createPositionAt(t.node,u),_=this.editing.mapper.toModelPosition(w),v=this.editor.model.createRange(_,_.getShiftedBy(m)),A=o.substr(u,g);this.editor.execute("input",{text:A,range:v,resultRange:p})}_handleTextNodeInsertion(t){if(t.type!="children")return;const n=um(t),o=this.editing.view.createPositionAt(t.node,n.index),r=this.editing.mapper.toModelPosition(o),c=n.values[0].data;this.editor.execute("input",{text:c.replace(/\u00A0/g," "),range:this.editor.model.createRange(r)})}}function Sm(l,t){return l.every(n=>t.isInline(n))}function Pm(l){let t=null,n=null;for(let c=0;c<l.length;c++)l[c]!="equal"&&(t=t===null?c:t,n=c);let o=0,r=0;for(let c=t;c<=n;c++)l[c]!="insert"&&o++,l[c]!="delete"&&r++;return{insertions:r,deletions:o,firstChangeAt:t}}class Im extends z{static get pluginName(){return"Input"}init(){const t=this.editor,n=new UC(t,t.config.get("typing.undoStep")||20);t.commands.add("input",n),function(o){let r=null;const c=o.model,u=o.editing.view,g=o.commands.get("input");function m(w){if(bt.isWindows&&hm(w,u.document))return;const _=c.document,v=u.document.isComposing,A=r&&r.isEqual(_.selection);r=null,g.isEnabled&&(pm(w)||_.selection.isCollapsed||v&&w.keyCode===229||!v&&w.keyCode===229&&A||p())}function p(){const w=g.buffer;w.lock();const _=w.batch;g._batches.add(_),c.enqueueChange(_,()=>{c.deleteContent(c.document.selection)}),w.unlock()}bt.isAndroid?u.document.on("beforeinput",(w,_)=>m(_),{priority:"lowest"}):u.document.on("keydown",(w,_)=>m(_),{priority:"lowest"}),u.document.on("compositionstart",function(){const w=c.document,_=w.selection.rangeCount!==1||w.selection.getFirstRange().isFlat;w.selection.isCollapsed||_||p()},{priority:"lowest"}),u.document.on("compositionend",()=>{r=c.createSelection(c.document.selection)},{priority:"lowest"})}(t),function(o){o.editing.view.document.on("mutations",(r,c,u)=>{new GC(o).handle(c,u)})}(t)}isInput(t){return this.editor.commands.get("input")._batches.has(t)}}class KC extends z{static get requires(){return[Im,Bn]}static get pluginName(){return"Typing"}}function Mm(l,t){let n=l.start;return{text:Array.from(l.getItems()).reduce((o,r)=>r.is("$text")||r.is("$textProxy")?o+r.data:(n=t.createPositionAfter(r),""),""),range:t.createRange(n,l.end)}}class Bc{constructor(t,n){this.model=t,this.testCallback=n,this.hasMatch=!1,this.set("isEnabled",!0),this.on("change:isEnabled",()=>{this.isEnabled?this._startListening():(this.stopListening(t.document.selection),this.stopListening(t.document))}),this._startListening()}_startListening(){const t=this.model.document;this.listenTo(t.selection,"change:range",(n,{directChange:o})=>{o&&(t.selection.isCollapsed?this._evaluateTextBeforeSelection("selection"):this.hasMatch&&(this.fire("unmatched"),this.hasMatch=!1))}),this.listenTo(t,"change:data",(n,o)=>{o.type!="transparent"&&this._evaluateTextBeforeSelection("data",{batch:o})})}_evaluateTextBeforeSelection(t,n={}){const o=this.model,r=o.document.selection,c=o.createRange(o.createPositionAt(r.focus.parent,0),r.focus),{text:u,range:g}=Mm(c,o),m=this.testCallback(u);if(!m&&this.hasMatch&&this.fire("unmatched"),this.hasMatch=!!m,m){const p=Object.assign(n,{text:u,range:g});typeof m=="object"&&Object.assign(p,m),this.fire("matched:"+t,p)}}}tt(Bc,yt);class Rm extends z{static get pluginName(){return"TwoStepCaretMovement"}constructor(t){super(t),this.attributes=new Set,this._overrideUid=null}init(){const t=this.editor,n=t.model,o=t.editing.view,r=t.locale,c=n.document.selection;this.listenTo(o.document,"arrowKey",(u,g)=>{if(!c.isCollapsed||g.shiftKey||g.altKey||g.ctrlKey)return;const m=g.keyCode==rt.arrowright,p=g.keyCode==rt.arrowleft;if(!m&&!p)return;const w=r.contentLanguageDirection;let _=!1;_=w==="ltr"&&m||w==="rtl"&&p?this._handleForwardMovement(g):this._handleBackwardMovement(g),_===!0&&u.stop()},{context:"$text",priority:"highest"}),this._isNextGravityRestorationSkipped=!1,this.listenTo(c,"change:range",(u,g)=>{this._isNextGravityRestorationSkipped?this._isNextGravityRestorationSkipped=!1:this._isGravityOverridden&&(!g.directChange&&ra(c.getFirstPosition(),this.attributes)||this._restoreGravity())})}registerAttribute(t){this.attributes.add(t)}_handleForwardMovement(t){const n=this.attributes,o=this.editor.model.document.selection,r=o.getFirstPosition();return!this._isGravityOverridden&&(!r.isAtStart||!Fc(o,n))&&(ra(r,n)?(sa(t),this._overrideGravity(),!0):void 0)}_handleBackwardMovement(t){const n=this.attributes,o=this.editor.model,r=o.document.selection,c=r.getFirstPosition();return this._isGravityOverridden?(sa(t),this._restoreGravity(),zc(o,n,c),!0):c.isAtStart?!!Fc(r,n)&&(sa(t),zc(o,n,c),!0):function(u,g){return ra(u.getShiftedBy(-1),g)}(c,n)?c.isAtEnd&&!Fc(r,n)&&ra(c,n)?(sa(t),zc(o,n,c),!0):(this._isNextGravityRestorationSkipped=!0,this._overrideGravity(),!1):void 0}get _isGravityOverridden(){return!!this._overrideUid}_overrideGravity(){this._overrideUid=this.editor.model.change(t=>t.overrideSelectionGravity())}_restoreGravity(){this.editor.model.change(t=>{t.restoreSelectionGravity(this._overrideUid),this._overrideUid=null})}}function Fc(l,t){for(const n of t)if(l.hasAttribute(n))return!0;return!1}function zc(l,t,n){const o=n.nodeBefore;l.change(r=>{o?r.setSelectionAttribute(o.getAttributes()):r.removeSelectionAttribute(t)})}function sa(l){l.preventDefault()}function ra(l,t){const{nodeBefore:n,nodeAfter:o}=l;for(const r of t){const c=n?n.getAttribute(r):void 0;if((o?o.getAttribute(r):void 0)!==c)return!0}return!1}var Om=/[\\^$.*+?()[\]{}|]/g,YC=RegExp(Om.source),JC=function(l){return(l=Nl(l))&&YC.test(l)?l.replace(Om,"\\$&"):l};const QC={copyright:{from:"(c)",to:"©"},registeredTrademark:{from:"(r)",to:"®"},trademark:{from:"(tm)",to:"™"},oneHalf:{from:/(^|[^/a-z0-9])(1\/2)([^/a-z0-9])$/i,to:[null,"½",null]},oneThird:{from:/(^|[^/a-z0-9])(1\/3)([^/a-z0-9])$/i,to:[null,"⅓",null]},twoThirds:{from:/(^|[^/a-z0-9])(2\/3)([^/a-z0-9])$/i,to:[null,"⅔",null]},oneForth:{from:/(^|[^/a-z0-9])(1\/4)([^/a-z0-9])$/i,to:[null,"¼",null]},threeQuarters:{from:/(^|[^/a-z0-9])(3\/4)([^/a-z0-9])$/i,to:[null,"¾",null]},lessThanOrEqual:{from:"<=",to:"≤"},greaterThanOrEqual:{from:">=",to:"≥"},notEqual:{from:"!=",to:"≠"},arrowLeft:{from:"<-",to:"←"},arrowRight:{from:"->",to:"→"},horizontalEllipsis:{from:"...",to:"…"},enDash:{from:/(^| )(--)( )$/,to:[null,"–",null]},emDash:{from:/(^| )(---)( )$/,to:[null,"—",null]},quotesPrimary:{from:so('"'),to:[null,"“",null,"”"]},quotesSecondary:{from:so("'"),to:[null,"‘",null,"’"]},quotesPrimaryEnGb:{from:so("'"),to:[null,"‘",null,"’"]},quotesSecondaryEnGb:{from:so('"'),to:[null,"“",null,"”"]},quotesPrimaryPl:{from:so('"'),to:[null,"„",null,"”"]},quotesSecondaryPl:{from:so("'"),to:[null,"‚",null,"’"]}},Nm={symbols:["copyright","registeredTrademark","trademark"],mathematical:["oneHalf","oneThird","twoThirds","oneForth","threeQuarters","lessThanOrEqual","greaterThanOrEqual","notEqual","arrowLeft","arrowRight"],typography:["horizontalEllipsis","enDash","emDash"],quotes:["quotesPrimary","quotesSecondary"]},XC=["symbols","mathematical","typography","quotes"];function ZC(l){return typeof l=="string"?new RegExp(`(${JC(l)})$`):l}function tx(l){return typeof l=="string"?()=>[l]:l instanceof Array?()=>l:l}function ex(l){return(l.textNode?l.textNode:l.nodeAfter).getAttributes()}function so(l){return new RegExp(`(^|\\s)(${l})([^${l}]*)(${l})$`)}function ro(l,t,n,o){return o.createRange(Dm(l,t,n,!0,o),Dm(l,t,n,!1,o))}function Dm(l,t,n,o,r){let c=l.textNode||(o?l.nodeBefore:l.nodeAfter),u=null;for(;c&&c.getAttribute(t)==n;)u=c,c=o?c.previousSibling:c.nextSibling;return u?r.createPositionAt(u,o?"before":"after"):l}class Lm extends lt{constructor(t){super(t),this._stack=[],this._createdBatches=new WeakSet,this.refresh(),this.listenTo(t.data,"set",(n,o)=>{o[1]={...o[1]};const r=o[1];r.batchType||(r.batchType="transparent")},{priority:"high"}),this.listenTo(t.data,"set",(n,o)=>{o[1].batchType==="transparent"&&this.clearStack()})}refresh(){this.isEnabled=this._stack.length>0}addBatch(t){const n=this.editor.model.document.selection,o={ranges:n.hasOwnRange?Array.from(n.getRanges()):[],isBackward:n.isBackward};this._stack.push({batch:t,selection:o}),this.refresh()}clearStack(){this._stack=[],this.refresh()}_restoreSelection(t,n,o){const r=this.editor.model,c=r.document,u=[],g=t.map(p=>p.getTransformedByOperations(o)),m=g.flat();for(const p of g){const w=p.filter(_=>_.root!=c.graveyard).filter(_=>!ix(_,m));w.length&&(nx(w),u.push(w[0]))}u.length&&r.change(p=>{p.setSelection(u,{backward:n})})}_undo(t,n){const o=this.editor.model,r=o.document;this._createdBatches.add(n);const c=t.operations.slice().filter(u=>u.isDocumentOperation);c.reverse();for(const u of c){const g=u.baseVersion+1,m=Array.from(r.history.getOperations(g)),p=_C([u.getReversed()],m,{useRelations:!0,document:this.editor.model.document,padWithNoOps:!1,forceWeakRemove:!0}).operationsA;for(const w of p)n.addOperation(w),o.applyOperation(w),r.history.setOperationAsUndone(u,w)}}}function nx(l){l.sort((t,n)=>t.start.isBefore(n.start)?-1:1);for(let t=1;t<l.length;t++){const n=l[t-1].getJoined(l[t],!0);n&&(t--,l.splice(t,2,n))}}function ix(l,t){return t.some(n=>n!==l&&n.containsRange(l,!0))}class ox extends Lm{execute(t=null){const n=t?this._stack.findIndex(c=>c.batch==t):this._stack.length-1,o=this._stack.splice(n,1)[0],r=this.editor.model.createBatch("transparent");this.editor.model.enqueueChange(r,()=>{this._undo(o.batch,r);const c=this.editor.model.document.history.getOperations(o.batch.baseVersion);this._restoreSelection(o.selection.ranges,o.selection.isBackward,c),this.fire("revert",o.batch,r)}),this.refresh()}}class sx extends Lm{execute(){const t=this._stack.pop(),n=this.editor.model.createBatch("transparent");this.editor.model.enqueueChange(n,()=>{const o=t.batch.operations[t.batch.operations.length-1].baseVersion+1,r=this.editor.model.document.history.getOperations(o);this._restoreSelection(t.selection.ranges,t.selection.isBackward,r),this._undo(t.batch,n)}),this.refresh()}}class rx extends z{static get pluginName(){return"UndoEditing"}constructor(t){super(t),this._batchRegistry=new WeakSet}init(){const t=this.editor;this._undoCommand=new ox(t),this._redoCommand=new sx(t),t.commands.add("undo",this._undoCommand),t.commands.add("redo",this._redoCommand),this.listenTo(t.model,"applyOperation",(n,o)=>{const r=o[0];if(!r.isDocumentOperation)return;const c=r.batch,u=this._redoCommand._createdBatches.has(c),g=this._undoCommand._createdBatches.has(c);this._batchRegistry.has(c)||c.type=="transparent"&&!u&&!g||(u?this._undoCommand.addBatch(c):g||(this._undoCommand.addBatch(c),this._redoCommand.clearStack()),this._batchRegistry.add(c))},{priority:"highest"}),this.listenTo(this._undoCommand,"revert",(n,o,r)=>{this._redoCommand.addBatch(r)}),t.keystrokes.set("CTRL+Z","undo"),t.keystrokes.set("CTRL+Y","redo"),t.keystrokes.set("CTRL+SHIFT+Z","redo")}}var Vm='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m5.042 9.367 2.189 1.837a.75.75 0 0 1-.965 1.149l-3.788-3.18a.747.747 0 0 1-.21-.284.75.75 0 0 1 .17-.945L6.23 4.762a.75.75 0 1 1 .964 1.15L4.863 7.866h8.917A.75.75 0 0 1 14 7.9a4 4 0 1 1-1.477 7.718l.344-1.489a2.5 2.5 0 1 0 1.094-4.73l.008-.032H5.042z"/></svg>',Bm='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m14.958 9.367-2.189 1.837a.75.75 0 0 0 .965 1.149l3.788-3.18a.747.747 0 0 0 .21-.284.75.75 0 0 0-.17-.945L13.77 4.762a.75.75 0 1 0-.964 1.15l2.331 1.955H6.22A.75.75 0 0 0 6 7.9a4 4 0 1 0 1.477 7.718l-.344-1.489A2.5 2.5 0 1 1 6.039 9.4l-.008-.032h8.927z"/></svg>';class ax extends z{static get pluginName(){return"UndoUI"}init(){const t=this.editor,n=t.locale,o=t.t,r=n.uiLanguageDirection=="ltr"?Vm:Bm,c=n.uiLanguageDirection=="ltr"?Bm:Vm;this._addButton("undo",o("Undo"),"CTRL+Z",r),this._addButton("redo",o("Redo"),"CTRL+Y",c)}_addButton(t,n,o,r){const c=this.editor;c.ui.componentFactory.add(t,u=>{const g=c.commands.get(t),m=new Mt(u);return m.set({label:n,icon:r,keystroke:o,tooltip:!0}),m.bind("isEnabled").to(g,"isEnabled"),this.listenTo(m,"execute",()=>{c.execute(t),c.editing.view.focus()}),m})}}class Fm extends z{static get requires(){return[rx,ax]}static get pluginName(){return"Undo"}}class zm{constructor(){const t=new window.FileReader;this._reader=t,this._data=void 0,this.set("loaded",0),t.onprogress=n=>{this.loaded=n.loaded}}get error(){return this._reader.error}get data(){return this._data}read(t){const n=this._reader;return this.total=t.size,new Promise((o,r)=>{n.onload=()=>{const c=n.result;this._data=c,o(c)},n.onerror=()=>{r("error")},n.onabort=()=>{r("aborted")},this._reader.readAsDataURL(t)})}abort(){this._reader.abort()}}tt(zm,yt);class an extends z{static get pluginName(){return"FileRepository"}static get requires(){return[Sg]}init(){this.loaders=new Me,this.loaders.on("add",()=>this._updatePendingAction()),this.loaders.on("remove",()=>this._updatePendingAction()),this._loadersMap=new Map,this._pendingAction=null,this.set("uploaded",0),this.set("uploadTotal",null),this.bind("uploadedPercent").to(this,"uploaded",this,"uploadTotal",(t,n)=>n?t/n*100:0)}getLoader(t){return this._loadersMap.get(t)||null}createLoader(t){if(!this.createUploadAdapter)return Object(y.b)("filerepository-no-upload-adapter"),null;const n=new jc(Promise.resolve(t),this.createUploadAdapter);return this.loaders.add(n),this._loadersMap.set(t,n),t instanceof Promise&&n.file.then(o=>{this._loadersMap.set(o,n)}).catch(()=>{}),n.on("change:uploaded",()=>{let o=0;for(const r of this.loaders)o+=r.uploaded;this.uploaded=o}),n.on("change:uploadTotal",()=>{let o=0;for(const r of this.loaders)r.uploadTotal&&(o+=r.uploadTotal);this.uploadTotal=o}),n}destroyLoader(t){const n=t instanceof jc?t:this.getLoader(t);n._destroy(),this.loaders.remove(n),this._loadersMap.forEach((o,r)=>{o===n&&this._loadersMap.delete(r)})}_updatePendingAction(){const t=this.editor.plugins.get(Sg);if(this.loaders.length){if(!this._pendingAction){const n=this.editor.t,o=r=>`${n("Upload in progress")} ${parseInt(r)}%.`;this._pendingAction=t.add(o(this.uploadedPercent)),this._pendingAction.bind("message").to(this,"uploadedPercent",o)}}else t.remove(this._pendingAction),this._pendingAction=null}}tt(an,yt);class jc{constructor(t,n){this.id=k(),this._filePromiseWrapper=this._createFilePromiseWrapper(t),this._adapter=n(this),this._reader=new zm,this.set("status","idle"),this.set("uploaded",0),this.set("uploadTotal",null),this.bind("uploadedPercent").to(this,"uploaded",this,"uploadTotal",(o,r)=>r?o/r*100:0),this.set("uploadResponse",null)}get file(){return this._filePromiseWrapper?this._filePromiseWrapper.promise.then(t=>this._filePromiseWrapper?t:null):Promise.resolve(null)}get data(){return this._reader.data}read(){if(this.status!="idle")throw new y.a("filerepository-read-wrong-status",this);return this.status="reading",this.file.then(t=>this._reader.read(t)).then(t=>{if(this.status!=="reading")throw this.status;return this.status="idle",t}).catch(t=>{throw t==="aborted"?(this.status="aborted","aborted"):(this.status="error",this._reader.error?this._reader.error:t)})}upload(){if(this.status!="idle")throw new y.a("filerepository-upload-wrong-status",this);return this.status="uploading",this.file.then(()=>this._adapter.upload()).then(t=>(this.uploadResponse=t,this.status="idle",t)).catch(t=>{throw this.status==="aborted"?"aborted":(this.status="error",t)})}abort(){const t=this.status;this.status="aborted",this._filePromiseWrapper.isFulfilled?t=="reading"?this._reader.abort():t=="uploading"&&this._adapter.abort&&this._adapter.abort():(this._filePromiseWrapper.promise.catch(()=>{}),this._filePromiseWrapper.rejecter("aborted")),this._destroy()}_destroy(){this._filePromiseWrapper=void 0,this._reader=void 0,this._adapter=void 0,this.uploadResponse=void 0}_createFilePromiseWrapper(t){const n={};return n.promise=new Promise((o,r)=>{n.rejecter=r,n.isFulfilled=!1,t.then(c=>{n.isFulfilled=!0,o(c)}).catch(c=>{n.isFulfilled=!0,r(c)})}),n}}tt(jc,yt);class lx extends st{constructor(t){super(t),this.buttonView=new Mt(t),this._fileInputView=new cx(t),this._fileInputView.bind("acceptedType").to(this),this._fileInputView.bind("allowMultipleFiles").to(this),this._fileInputView.delegate("done").to(this),this.setTemplate({tag:"span",attributes:{class:"ck-file-dialog-button"},children:[this.buttonView,this._fileInputView]}),this.buttonView.on("execute",()=>{this._fileInputView.open()})}focus(){this.buttonView.focus()}}class cx extends st{constructor(t){super(t),this.set("acceptedType"),this.set("allowMultipleFiles",!1);const n=this.bindTemplate;this.setTemplate({tag:"input",attributes:{class:["ck-hidden"],type:"file",tabindex:"-1",accept:n.to("acceptedType"),multiple:n.to("allowMultipleFiles")},on:{change:n.to(()=>{this.element&&this.element.files&&this.element.files.length&&this.fire("done",this.element.files),this.element.value=""})}})}open(){this.element.click()}}function dx(){let l=function(o){o=o.toLowerCase();const r=document.cookie.split(";");for(const c of r){const u=c.split("=");if(decodeURIComponent(u[0].trim().toLowerCase())===o)return decodeURIComponent(u[1])}return null}("ckCsrfToken");var t,n;return l&&l.length==40||(l=function(o){let r="";const c=new Uint8Array(o);window.crypto.getRandomValues(c);for(let u=0;u<c.length;u++){const g="abcdefghijklmnopqrstuvwxyz0123456789".charAt(c[u]%36);r+=Math.random()>.5?g.toUpperCase():g}return r}(40),t="ckCsrfToken",n=l,document.cookie=encodeURIComponent(t)+"="+encodeURIComponent(n)+";path=/"),l}class ux{constructor(t,n,o){this.loader=t,this.url=n,this.t=o}upload(){return this.loader.file.then(t=>new Promise((n,o)=>{this._initRequest(),this._initListeners(n,o,t),this._sendRequest(t)}))}abort(){this.xhr&&this.xhr.abort()}_initRequest(){const t=this.xhr=new XMLHttpRequest;t.open("POST",this.url,!0),t.responseType="json"}_initListeners(t,n,o){const r=this.xhr,c=this.loader,u=(0,this.t)("Cannot upload file:")+` ${o.name}.`;r.addEventListener("error",()=>n(u)),r.addEventListener("abort",()=>n()),r.addEventListener("load",()=>{const g=r.response;if(!g||!g.uploaded)return n(g&&g.error&&g.error.message?g.error.message:u);t({default:g.url})}),r.upload&&r.upload.addEventListener("progress",g=>{g.lengthComputable&&(c.uploadTotal=g.total,c.uploaded=g.loaded)})}_sendRequest(t){const n=new FormData;n.append("upload",t),n.append("ckCsrfToken",dx()),this.xhr.send(n)}}function Fn(l,t,n,o){let r,c=null;typeof o=="function"?r=o:(c=l.commands.get(o),r=()=>{l.execute(o)}),l.model.document.on("change:data",(u,g)=>{if(c&&!c.isEnabled||!t.isEnabled)return;const m=de(l.model.document.selection.getRanges());if(!m.isCollapsed||g.type=="transparent")return;const p=Array.from(l.model.document.differ.getChanges()),w=p[0];if(p.length!=1||w.type!=="insert"||w.name!="$text"||w.length!=1)return;const _=w.position.parent;if(_.is("element","codeBlock")||_.is("element","listItem")&&typeof o!="function"&&!["numberedList","bulletedList","todoList"].includes(o)||c&&c.value===!0)return;const v=_.getChild(0),A=l.model.createRangeOn(v);if(!A.containsRange(m)&&!m.end.isEqual(A.end))return;const x=n.exec(v.data.substr(0,m.end.offset));x&&l.model.enqueueChange(E=>{const T=E.createPositionAt(_,0),S=E.createPositionAt(_,x[0].length),I=new on(T,S);if(r({match:x})!==!1){E.remove(I);const N=l.model.document.selection.getFirstRange(),j=E.createRangeIn(_);!_.isEmpty||j.isEqual(N)||j.containsRange(N,!0)||E.remove(_)}I.detach(),l.model.enqueueChange(()=>{l.plugins.get("Delete").requestUndoOnBackspace()})})})}function ao(l,t,n,o){let r,c;n instanceof RegExp?r=n:c=n,c=c||(u=>{let g;const m=[],p=[];for(;(g=r.exec(u))!==null&&!(g&&g.length<4);){let{index:w,1:_,2:v,3:A}=g;const x=_+v+A;w+=g[0].length-x.length;const E=[w,w+_.length],T=[w+_.length+v.length,w+_.length+v.length+A.length];m.push(E),m.push(T),p.push([w+_.length,w+_.length+v.length])}return{remove:m,format:p}}),l.model.document.on("change:data",(u,g)=>{if(g.type=="transparent"||!t.isEnabled)return;const m=l.model,p=m.document.selection;if(!p.isCollapsed)return;const w=Array.from(m.document.differ.getChanges()),_=w[0];if(w.length!=1||_.type!=="insert"||_.name!="$text"||_.length!=1)return;const v=p.focus,A=v.parent,{text:x,range:E}=function(N,j){let X=N.start;return{text:Array.from(N.getItems()).reduce((vt,dt)=>!dt.is("$text")&&!dt.is("$textProxy")||dt.getAttribute("code")?(X=j.createPositionAfter(dt),""):vt+dt.data,""),range:j.createRange(X,N.end)}}(m.createRange(m.createPositionAt(A,0),v),m),T=c(x),S=jm(E.start,T.format,m),I=jm(E.start,T.remove,m);S.length&&I.length&&m.enqueueChange(N=>{if(o(N,S)!==!1){for(const j of I.reverse())N.remove(j);m.enqueueChange(()=>{l.plugins.get("Delete").requestUndoOnBackspace()})}})})}function jm(l,t,n){return t.filter(o=>o[0]!==void 0&&o[1]!==void 0).map(o=>n.createRange(l.getShiftedBy(o[0]),l.getShiftedBy(o[1])))}function aa(l,t){return(n,o)=>{if(!l.commands.get(t).isEnabled)return!1;const r=l.model.schema.getValidRanges(o,t);for(const c of r)n.setAttribute(t,!0,c);n.removeSelectionAttribute(t)}}class $m extends lt{constructor(t,n){super(t),this.attributeKey=n}refresh(){const t=this.editor.model,n=t.document;this.value=this._getValueFromFirstAllowedNode(),this.isEnabled=t.schema.checkAttributeInSelection(n.selection,this.attributeKey)}execute(t={}){const n=this.editor.model,o=n.document.selection,r=t.forceValue===void 0?!this.value:t.forceValue;n.change(c=>{if(o.isCollapsed)r?c.setSelectionAttribute(this.attributeKey,!0):c.removeSelectionAttribute(this.attributeKey);else{const u=n.schema.getValidRanges(o.getRanges(),this.attributeKey);for(const g of u)r?c.setAttribute(this.attributeKey,r,g):c.removeAttribute(this.attributeKey,g)}})}_getValueFromFirstAllowedNode(){const t=this.editor.model,n=t.schema,o=t.document.selection;if(o.isCollapsed)return o.hasAttribute(this.attributeKey);for(const r of o.getRanges())for(const c of r.getItems())if(n.checkAttribute(c,this.attributeKey))return c.hasAttribute(this.attributeKey);return!1}}class hx extends z{static get pluginName(){return"BoldEditing"}init(){const t=this.editor;t.model.schema.extend("$text",{allowAttributes:"bold"}),t.model.schema.setAttributeProperties("bold",{isFormatting:!0,copyOnEnter:!0}),t.conversion.attributeToElement({model:"bold",view:"strong",upcastAlso:["b",n=>{const o=n.getStyle("font-weight");return o?o=="bold"||Number(o)>=600?{name:!0,styles:["font-weight"]}:void 0:null}]}),t.commands.add("bold",new $m(t,"bold")),t.keystrokes.set("CTRL+B","bold")}}class fx extends z{static get pluginName(){return"BoldUI"}init(){const t=this.editor,n=t.t;t.ui.componentFactory.add("bold",o=>{const r=t.commands.get("bold"),c=new Mt(o);return c.set({label:n("Bold"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.187 17H5.773c-.637 0-1.092-.138-1.364-.415-.273-.277-.409-.718-.409-1.323V4.738c0-.617.14-1.062.419-1.332.279-.27.73-.406 1.354-.406h4.68c.69 0 1.288.041 1.793.124.506.083.96.242 1.36.478.341.197.644.447.906.75a3.262 3.262 0 0 1 .808 2.162c0 1.401-.722 2.426-2.167 3.075C15.05 10.175 16 11.315 16 13.01a3.756 3.756 0 0 1-2.296 3.504 6.1 6.1 0 0 1-1.517.377c-.571.073-1.238.11-2 .11zm-.217-6.217H7v4.087h3.069c1.977 0 2.965-.69 2.965-2.072 0-.707-.256-1.22-.768-1.537-.512-.319-1.277-.478-2.296-.478zM7 5.13v3.619h2.606c.729 0 1.292-.067 1.69-.2a1.6 1.6 0 0 0 .91-.765c.165-.267.247-.566.247-.897 0-.707-.26-1.176-.778-1.409-.519-.232-1.31-.348-2.375-.348H7z"/></svg>',keystroke:"CTRL+B",tooltip:!0,isToggleable:!0}),c.bind("isOn","isEnabled").to(r,"value","isEnabled"),this.listenTo(c,"execute",()=>{t.execute("bold"),t.editing.view.focus()}),c})}}class gx extends z{static get pluginName(){return"ItalicEditing"}init(){const t=this.editor;t.model.schema.extend("$text",{allowAttributes:"italic"}),t.model.schema.setAttributeProperties("italic",{isFormatting:!0,copyOnEnter:!0}),t.conversion.attributeToElement({model:"italic",view:"i",upcastAlso:["em",{styles:{"font-style":"italic"}}]}),t.commands.add("italic",new $m(t,"italic")),t.keystrokes.set("CTRL+I","italic")}}class mx extends z{static get pluginName(){return"ItalicUI"}init(){const t=this.editor,n=t.t;t.ui.componentFactory.add("italic",o=>{const r=t.commands.get("italic"),c=new Mt(o);return c.set({label:n("Italic"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m9.586 14.633.021.004c-.036.335.095.655.393.962.082.083.173.15.274.201h1.474a.6.6 0 1 1 0 1.2H5.304a.6.6 0 0 1 0-1.2h1.15c.474-.07.809-.182 1.005-.334.157-.122.291-.32.404-.597l2.416-9.55a1.053 1.053 0 0 0-.281-.823 1.12 1.12 0 0 0-.442-.296H8.15a.6.6 0 0 1 0-1.2h6.443a.6.6 0 1 1 0 1.2h-1.195c-.376.056-.65.155-.823.296-.215.175-.423.439-.623.79l-2.366 9.347z"/></svg>',keystroke:"CTRL+I",tooltip:!0,isToggleable:!0}),c.bind("isOn","isEnabled").to(r,"value","isEnabled"),this.listenTo(c,"execute",()=>{t.execute("italic"),t.editing.view.focus()}),c})}}class px extends lt{refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(t={}){const n=this.editor.model,o=n.schema,r=n.document.selection,c=Array.from(r.getSelectedBlocks()),u=t.forceValue===void 0?!this.value:t.forceValue;n.change(g=>{if(u){const m=c.filter(p=>la(p)||Wm(o,p));this._applyQuote(g,m)}else this._removeQuote(g,c.filter(la))})}_getValue(){const t=de(this.editor.model.document.selection.getSelectedBlocks());return!(!t||!la(t))}_checkEnabled(){if(this.value)return!0;const t=this.editor.model.document.selection,n=this.editor.model.schema,o=de(t.getSelectedBlocks());return!!o&&Wm(n,o)}_removeQuote(t,n){Hm(t,n).reverse().forEach(o=>{if(o.start.isAtStart&&o.end.isAtEnd)return void t.unwrap(o.start.parent);if(o.start.isAtStart){const c=t.createPositionBefore(o.start.parent);return void t.move(o,c)}o.end.isAtEnd||t.split(o.end);const r=t.createPositionAfter(o.end.parent);t.move(o,r)})}_applyQuote(t,n){const o=[];Hm(t,n).reverse().forEach(r=>{let c=la(r.start);c||(c=t.createElement("blockQuote"),t.wrap(r,c)),o.push(c)}),o.reverse().reduce((r,c)=>r.nextSibling==c?(t.merge(t.createPositionAfter(r)),r):c)}}function la(l){return l.parent.name=="blockQuote"?l.parent:null}function Hm(l,t){let n,o=0;const r=[];for(;o<t.length;){const c=t[o],u=t[o+1];n||(n=l.createPositionBefore(c)),u&&c.nextSibling==u||(r.push(l.createRange(n,l.createPositionAfter(c))),n=null),o++}return r}function Wm(l,t){const n=l.checkChild(t.parent,"blockQuote"),o=l.checkChild(["$root","blockQuote"],t);return n&&o}class bx extends z{static get pluginName(){return"BlockQuoteEditing"}static get requires(){return[ia,Bn]}init(){const t=this.editor,n=t.model.schema;t.commands.add("blockQuote",new px(t)),n.register("blockQuote",{allowWhere:"$block",allowContentOf:"$root"}),t.conversion.elementToElement({model:"blockQuote",view:"blockquote"}),t.model.document.registerPostFixer(u=>{const g=t.model.document.differ.getChanges();for(const m of g)if(m.type=="insert"){const p=m.position.nodeAfter;if(!p)continue;if(p.is("element","blockQuote")&&p.isEmpty)return u.remove(p),!0;if(p.is("element","blockQuote")&&!n.checkChild(m.position,p))return u.unwrap(p),!0;if(p.is("element")){const w=u.createRangeIn(p);for(const _ of w.getItems())if(_.is("element","blockQuote")&&!n.checkChild(u.createPositionBefore(_),_))return u.unwrap(_),!0}}else if(m.type=="remove"){const p=m.position.parent;if(p.is("element","blockQuote")&&p.isEmpty)return u.remove(p),!0}return!1});const o=this.editor.editing.view.document,r=t.model.document.selection,c=t.commands.get("blockQuote");this.listenTo(o,"enter",(u,g)=>{!r.isCollapsed||!c.value||r.getLastPosition().parent.isEmpty&&(t.execute("blockQuote"),t.editing.view.scrollToTheSelection(),g.preventDefault(),u.stop())},{context:"blockquote"}),this.listenTo(o,"delete",(u,g)=>{if(g.direction!="backward"||!r.isCollapsed||!c.value)return;const m=r.getLastPosition().parent;m.isEmpty&&!m.previousSibling&&(t.execute("blockQuote"),t.editing.view.scrollToTheSelection(),g.preventDefault(),u.stop())},{context:"blockquote"})}}d(71);class wx extends z{static get pluginName(){return"BlockQuoteUI"}init(){const t=this.editor,n=t.t;t.ui.componentFactory.add("blockQuote",o=>{const r=t.commands.get("blockQuote"),c=new Mt(o);return c.set({label:n("Block quote"),icon:De.quote,tooltip:!0,isToggleable:!0}),c.bind("isOn","isEnabled").to(r,"value","isEnabled"),this.listenTo(c,"execute",()=>{t.execute("blockQuote"),t.editing.view.focus()}),c})}}class _x extends z{static get pluginName(){return"CKFinderUI"}init(){const t=this.editor,n=t.ui.componentFactory,o=t.t;n.add("ckfinder",r=>{const c=t.commands.get("ckfinder"),u=new Mt(r);return u.set({label:o("Insert image or file"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.627 16.5zm5.873-.196zm0-7.001V8h-13v8.5h4.341c.191.54.457 1.044.785 1.5H2a1.5 1.5 0 0 1-1.5-1.5v-13A1.5 1.5 0 0 1 2 2h4.5a1.5 1.5 0 0 1 1.06.44L9.122 4H16a1.5 1.5 0 0 1 1.5 1.5v1A1.5 1.5 0 0 1 19 8v2.531a6.027 6.027 0 0 0-1.5-1.228zM16 6.5v-1H8.5l-2-2H2v13h1V8a1.5 1.5 0 0 1 1.5-1.5H16z"/><path d="M14.5 19.5a5 5 0 1 1 0-10 5 5 0 0 1 0 10zM15 14v-2h-1v2h-2v1h2v2h1v-2h2v-1h-2z"/></svg>',tooltip:!0}),u.bind("isEnabled").to(c),u.on("execute",()=>{t.execute("ckfinder"),t.editing.view.focus()}),u})}}class kx extends lt{constructor(t){super(t),this.stopListening(this.editor.model.document,"change"),this.listenTo(this.editor.model.document,"change",()=>this.refresh(),{priority:"low"})}refresh(){const t=this.editor.commands.get("insertImage"),n=this.editor.commands.get("link");this.isEnabled=t.isEnabled||n.isEnabled}execute(){const t=this.editor,n=this.editor.config.get("ckfinder.openerMethod")||"modal";if(n!="popup"&&n!="modal")throw new y.a("ckfinder-unknown-openermethod",t);const o=this.editor.config.get("ckfinder.options")||{};o.chooseFiles=!0;const r=o.onInit;o.language||(o.language=t.locale.uiLanguage),o.onInit=c=>{r&&r(c),c.on("files:choose",u=>{const g=u.data.files.toArray(),m=g.filter(_=>!_.isImage()),p=g.filter(_=>_.isImage());for(const _ of m)t.execute("link",_.getUrl());const w=[];for(const _ of p){const v=_.getUrl();w.push(v||c.request("file:getProxyUrl",{file:_}))}w.length&&qm(t,w)}),c.on("file:choose:resizedImage",u=>{const g=u.data.resizedUrl;if(g)qm(t,[g]);else{const m=t.plugins.get("Notification"),p=t.locale.t;m.showWarning(p("Could not obtain resized image URL."),{title:p("Selecting resized image failed"),namespace:"ckfinder"})}})},window.CKFinder[n](o)}}function qm(l,t){if(l.commands.get("insertImage").isEnabled)l.execute("insertImage",{source:t});else{const n=l.plugins.get("Notification"),o=l.locale.t;n.showWarning(o("Could not insert image at the current position."),{title:o("Inserting image failed"),namespace:"ckfinder"})}}class vx extends z{static get pluginName(){return"CKFinderEditing"}static get requires(){return[Sc,"LinkEditing"]}init(){const t=this.editor;if(!t.plugins.has("ImageBlockEditing")&&!t.plugins.has("ImageInlineEditing"))throw new y.a("ckfinder-missing-image-plugin",t);t.commands.add("ckfinder",new kx(t))}}class yx extends z{static get pluginName(){return"CloudServicesUploadAdapter"}static get requires(){return["CloudServices",an]}init(){const t=this.editor,n=t.plugins.get("CloudServices"),o=n.token,r=n.uploadUrl;o&&(this._uploadGateway=t.plugins.get("CloudServicesCore").createUploadGateway(o,r),t.plugins.get(an).createUploadAdapter=c=>new Ax(this._uploadGateway,c))}}class Ax{constructor(t,n){this.uploadGateway=t,this.loader=n}upload(){return this.loader.file.then(t=>(this.fileUploader=this.uploadGateway.upload(t),this.fileUploader.on("progress",(n,o)=>{this.loader.uploadTotal=o.total,this.loader.uploaded=o.uploaded}),this.fileUploader.send()))}abort(){this.fileUploader.abort()}}class Cx extends lt{refresh(){const t=this.editor.model,n=de(t.document.selection.getSelectedBlocks());this.value=!!n&&n.is("element","paragraph"),this.isEnabled=!!n&&Um(n,t.schema)}execute(t={}){const n=this.editor.model,o=n.document;n.change(r=>{const c=(t.selection||o.selection).getSelectedBlocks();for(const u of c)!u.is("element","paragraph")&&Um(u,n.schema)&&r.rename(u,"paragraph")})}}function Um(l,t){return t.checkChild(l.parent,"paragraph")&&!t.isObject(l)}class xx extends lt{execute(t){const n=this.editor.model;let o=t.position;n.change(r=>{const c=r.createElement("paragraph");if(!n.schema.checkChild(o.parent,c)){const u=n.schema.findAllowedParent(o,c);if(!u)return;o=r.split(o,u).position}n.insertContent(c,o),r.setSelection(c,"in")})}}class hs extends z{static get pluginName(){return"Paragraph"}init(){const t=this.editor,n=t.model;t.commands.add("paragraph",new Cx(t)),t.commands.add("insertParagraph",new xx(t)),n.schema.register("paragraph",{inheritAllFrom:"$block"}),t.conversion.elementToElement({model:"paragraph",view:"p"}),t.conversion.for("upcast").elementToElement({model:(o,{writer:r})=>hs.paragraphLikeElements.has(o.name)?o.isEmpty?null:r.createElement("paragraph"):null,view:/.+/,converterPriority:"low"})}}hs.paragraphLikeElements=new Set(["blockquote","dd","div","dt","h1","h2","h3","h4","h5","h6","li","p","td","th"]);class Ex extends lt{constructor(t,n){super(t),this.modelElements=n}refresh(){const t=de(this.editor.model.document.selection.getSelectedBlocks());this.value=!!t&&this.modelElements.includes(t.name)&&t.name,this.isEnabled=!!t&&this.modelElements.some(n=>Gm(t,n,this.editor.model.schema))}execute(t){const n=this.editor.model,o=n.document,r=t.value;n.change(c=>{const u=Array.from(o.selection.getSelectedBlocks()).filter(g=>Gm(g,r,n.schema));for(const g of u)g.is("element",r)||c.rename(g,r)})}}function Gm(l,t,n){return n.checkChild(l.parent,t)&&!n.isObject(l)}class Tx extends z{static get pluginName(){return"HeadingEditing"}constructor(t){super(t),t.config.define("heading",{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h2",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h3",title:"Heading 2",class:"ck-heading_heading2"},{model:"heading3",view:"h4",title:"Heading 3",class:"ck-heading_heading3"}]})}static get requires(){return[hs]}init(){const t=this.editor,n=t.config.get("heading.options"),o=[];for(const r of n)r.model!=="paragraph"&&(t.model.schema.register(r.model,{inheritAllFrom:"$block"}),t.conversion.elementToElement(r),o.push(r.model));this._addDefaultH1Conversion(t),t.commands.add("heading",new Ex(t,o))}afterInit(){const t=this.editor,n=t.commands.get("enter"),o=t.config.get("heading.options");n&&this.listenTo(n,"afterExecute",(r,c)=>{const u=t.model.document.selection.getFirstPosition().parent;o.some(g=>u.is("element",g.model))&&!u.is("element","paragraph")&&u.childCount===0&&c.writer.rename(u,"paragraph")})}_addDefaultH1Conversion(t){t.conversion.for("upcast").elementToElement({model:"heading1",view:"h1",converterPriority:C.get("low")+1})}}d(13);class Sx extends z{static get pluginName(){return"HeadingUI"}init(){const t=this.editor,n=t.t,o=function(u){const g=u.t,m={Paragraph:g("Paragraph"),"Heading 1":g("Heading 1"),"Heading 2":g("Heading 2"),"Heading 3":g("Heading 3"),"Heading 4":g("Heading 4"),"Heading 5":g("Heading 5"),"Heading 6":g("Heading 6")};return u.config.get("heading.options").map(p=>{const w=m[p.title];return w&&w!=p.title&&(p.title=w),p})}(t),r=n("Choose heading"),c=n("Heading");t.ui.componentFactory.add("heading",u=>{const g={},m=new Me,p=t.commands.get("heading"),w=t.commands.get("paragraph"),_=[p];for(const A of o){const x={type:"button",model:new Pc({label:A.title,class:A.class,withText:!0})};A.model==="paragraph"?(x.model.bind("isOn").to(w,"value"),x.model.set("commandName","paragraph"),_.push(w)):(x.model.bind("isOn").to(p,"value",E=>E===A.model),x.model.set({commandName:"heading",commandValue:A.model})),m.add(x),g[A.model]=A.title}const v=ui(u);return Gg(v,m),v.buttonView.set({isOn:!1,withText:!0,tooltip:c}),v.extendTemplate({attributes:{class:["ck-heading-dropdown"]}}),v.bind("isEnabled").toMany(_,"isEnabled",(...A)=>A.some(x=>x)),v.buttonView.bind("label").to(p,"value",w,"value",(A,x)=>{const E=A||x&&"paragraph";return g[E]?g[E]:r}),this.listenTo(v,"execute",A=>{t.execute(A.source.commandName,A.source.commandValue?{value:A.source.commandValue}:void 0),t.editing.view.focus()}),v})}}class ca extends z{static get requires(){return[ta]}static get pluginName(){return"WidgetToolbarRepository"}init(){const t=this.editor;if(t.plugins.has("BalloonToolbar")){const n=t.plugins.get("BalloonToolbar");this.listenTo(n,"show",o=>{(function(r){const c=r.getSelectedElement();return!(!c||!Nt(c))})(t.editing.view.document.selection)&&o.stop()},{priority:"high"})}this._toolbarDefinitions=new Map,this._balloon=this.editor.plugins.get("ContextualBalloon"),this.on("change:isEnabled",()=>{this._updateToolbarsVisibility()}),this.listenTo(t.ui,"update",()=>{this._updateToolbarsVisibility()}),this.listenTo(t.ui.focusTracker,"change:isFocused",()=>{this._updateToolbarsVisibility()},{priority:"low"})}destroy(){super.destroy();for(const t of this._toolbarDefinitions.values())t.view.destroy()}register(t,{ariaLabel:n,items:o,getRelatedElement:r,balloonClassName:c="ck-toolbar-container"}){if(!o.length)return void Object(y.b)("widget-toolbar-no-items",{toolbarId:t});const u=this.editor,g=u.t,m=new xc(u.locale);if(m.ariaLabel=n||g("Widget toolbar"),this._toolbarDefinitions.has(t))throw new y.a("widget-toolbar-duplicated",this,{toolbarId:t});m.fillFromConfig(o,u.ui.componentFactory),this._toolbarDefinitions.set(t,{view:m,getRelatedElement:r,balloonClassName:c})}_updateToolbarsVisibility(){let t=0,n=null,o=null;for(const r of this._toolbarDefinitions.values()){const c=r.getRelatedElement(this.editor.editing.view.document.selection);if(this.isEnabled&&c)if(this.editor.ui.focusTracker.isFocused){const u=c.getAncestors().length;u>t&&(t=u,n=c,o=r)}else this._isToolbarVisible(r)&&this._hideToolbar(r);else this._isToolbarInBalloon(r)&&this._hideToolbar(r)}o&&this._showToolbar(o,n)}_hideToolbar(t){this._balloon.remove(t.view),this.stopListening(this._balloon,"change:visibleView")}_showToolbar(t,n){this._isToolbarVisible(t)?Km(this.editor,n):this._isToolbarInBalloon(t)||(this._balloon.add({view:t.view,position:Ym(this.editor,n),balloonClassName:t.balloonClassName}),this.listenTo(this._balloon,"change:visibleView",()=>{for(const o of this._toolbarDefinitions.values())if(this._isToolbarVisible(o)){const r=o.getRelatedElement(this.editor.editing.view.document.selection);Km(this.editor,r)}}))}_isToolbarVisible(t){return this._balloon.visibleView===t.view}_isToolbarInBalloon(t){return this._balloon.hasView(t.view)}}function Km(l,t){const n=l.plugins.get("ContextualBalloon"),o=Ym(l,t);n.updatePosition(o)}function Ym(l,t){const n=l.editing.view,o=be.defaultPositions;return{target:n.domConverter.mapViewToDom(t),positions:[o.northArrowSouth,o.northArrowSouthWest,o.northArrowSouthEast,o.southArrowNorth,o.southArrowNorthWest,o.southArrowNorthEast,o.viewportStickyNorth]}}class Jm{constructor(t){this.set("activeHandlePosition",null),this.set("proposedWidthPercents",null),this.set("proposedWidth",null),this.set("proposedHeight",null),this.set("proposedHandleHostWidth",null),this.set("proposedHandleHostHeight",null),this._options=t,this._referenceCoordinates=null}begin(t,n,o){const r=new gt(n);this.activeHandlePosition=function(u){const g=["top-left","top-right","bottom-right","bottom-left"];for(const m of g)if(u.classList.contains("ck-widget__resizer__handle-"+m))return m}(t),this._referenceCoordinates=function(u,g){const m=new gt(u),p=g.split("-"),w={x:p[1]=="right"?m.right:m.left,y:p[0]=="bottom"?m.bottom:m.top};return w.x+=u.ownerDocument.defaultView.scrollX,w.y+=u.ownerDocument.defaultView.scrollY,w}(n,function(u){const g=u.split("-"),m={top:"bottom",bottom:"top",left:"right",right:"left"};return`${m[g[0]]}-${m[g[1]]}`}(this.activeHandlePosition)),this.originalWidth=r.width,this.originalHeight=r.height,this.aspectRatio=r.width/r.height;const c=o.style.width;c&&c.match(/^\d+(\.\d*)?%$/)?this.originalWidthPercents=parseFloat(c):this.originalWidthPercents=function(u,g){const m=u.parentElement,p=parseFloat(m.ownerDocument.defaultView.getComputedStyle(m).width);return g.width/p*100}(o,r)}update(t){this.proposedWidth=t.width,this.proposedHeight=t.height,this.proposedWidthPercents=t.widthPercents,this.proposedHandleHostWidth=t.handleHostWidth,this.proposedHandleHostHeight=t.handleHostHeight}}tt(Jm,yt);class Px extends st{constructor(){super();const t=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-size-view",t.to("_viewPosition",n=>n?"ck-orientation-"+n:"")],style:{display:t.if("_isVisible","none",n=>!n)}},children:[{text:t.to("_label")}]})}_bindToState(t,n){this.bind("_isVisible").to(n,"proposedWidth",n,"proposedHeight",(o,r)=>o!==null&&r!==null),this.bind("_label").to(n,"proposedHandleHostWidth",n,"proposedHandleHostHeight",n,"proposedWidthPercents",(o,r,c)=>t.unit==="px"?`${o}×${r}`:c+"%"),this.bind("_viewPosition").to(n,"activeHandlePosition",n,"proposedHandleHostWidth",n,"proposedHandleHostHeight",(o,r,c)=>r<50||c<50?"above-center":o)}_dismiss(){this.unbind(),this._isVisible=!1}}class $c{constructor(t){this._options=t,this._viewResizerWrapper=null,this.set("isEnabled",!0),this.decorate("begin"),this.decorate("cancel"),this.decorate("commit"),this.decorate("updateSize"),this.on("commit",n=>{this.state.proposedWidth||this.state.proposedWidthPercents||(this._cleanup(),n.stop())},{priority:"high"}),this.on("change:isEnabled",()=>{this.isEnabled&&this.redraw()})}attach(){const t=this,n=this._options.viewElement;this._options.editor.editing.view.change(o=>{const r=o.createUIElement("div",{class:"ck ck-reset_all ck-widget__resizer"},function(c){const u=this.toDomElement(c);return t._appendHandles(u),t._appendSizeUI(u),t.on("change:isEnabled",(g,m,p)=>{u.style.display=p?"":"none"}),u.style.display=t.isEnabled?"":"none",u});o.insert(o.createPositionAt(n,"end"),r),o.addClass("ck-widget_with-resizer",n),this._viewResizerWrapper=r})}begin(t){this.state=new Jm(this._options),this._sizeView._bindToState(this._options,this.state),this._initialViewWidth=this._options.viewElement.getStyle("width"),this.state.begin(t,this._getHandleHost(),this._getResizeHost())}updateSize(t){const n=this._proposeNewSize(t);this._options.editor.editing.view.change(u=>{const g=this._options.unit||"%",m=(g==="%"?n.widthPercents:n.width)+g;u.setStyle("width",m,this._options.viewElement)});const o=this._getHandleHost(),r=new gt(o);n.handleHostWidth=Math.round(r.width),n.handleHostHeight=Math.round(r.height);const c=new gt(o);n.width=Math.round(c.width),n.height=Math.round(c.height),this.redraw(r),this.state.update(n)}commit(){const t=this._options.unit||"%",n=(t==="%"?this.state.proposedWidthPercents:this.state.proposedWidth)+t;this._options.editor.editing.view.change(()=>{this._cleanup(),this._options.onCommit(n)})}cancel(){this._cleanup()}destroy(){this.cancel()}redraw(t){const n=this._domResizerWrapper;if(!((o=n)&&o.ownerDocument&&o.ownerDocument.contains(o)))return;var o;const r=n.parentElement,c=this._getHandleHost(),u=this._viewResizerWrapper,g=[u.getStyle("width"),u.getStyle("height"),u.getStyle("left"),u.getStyle("top")];let m;if(r.isSameNode(c)){const p=t||new gt(c);m=[p.width+"px",p.height+"px",void 0,void 0]}else m=[c.offsetWidth+"px",c.offsetHeight+"px",c.offsetLeft+"px",c.offsetTop+"px"];se(g,m)!=="same"&&this._options.editor.editing.view.change(p=>{p.setStyle({width:m[0],height:m[1],left:m[2],top:m[3]},u)})}containsHandle(t){return this._domResizerWrapper.contains(t)}static isResizeHandle(t){return t.classList.contains("ck-widget__resizer__handle")}_cleanup(){this._sizeView._dismiss(),this._options.editor.editing.view.change(t=>{t.setStyle("width",this._initialViewWidth,this._options.viewElement)})}_proposeNewSize(t){const n=this.state,o={x:(r=t).pageX,y:r.pageY};var r;const c=!this._options.isCentered||this._options.isCentered(this),u={x:n._referenceCoordinates.x-(o.x+n.originalWidth),y:o.y-n.originalHeight-n._referenceCoordinates.y};c&&n.activeHandlePosition.endsWith("-right")&&(u.x=o.x-(n._referenceCoordinates.x+n.originalWidth)),c&&(u.x*=2);const g={width:Math.abs(n.originalWidth+u.x),height:Math.abs(n.originalHeight+u.y)};g.dominant=g.width/n.aspectRatio>g.height?"width":"height",g.max=g[g.dominant];const m={width:g.width,height:g.height};return g.dominant=="width"?m.height=m.width/n.aspectRatio:m.width=m.height*n.aspectRatio,{width:Math.round(m.width),height:Math.round(m.height),widthPercents:Math.min(Math.round(n.originalWidthPercents/n.originalWidth*m.width*100)/100,100)}}_getResizeHost(){const t=this._domResizerWrapper.parentElement;return this._options.getResizeHost(t)}_getHandleHost(){const t=this._domResizerWrapper.parentElement;return this._options.getHandleHost(t)}get _domResizerWrapper(){return this._options.editor.editing.view.domConverter.mapViewToDom(this._viewResizerWrapper)}_appendHandles(t){const n=["top-left","top-right","bottom-right","bottom-left"];for(const r of n)t.appendChild(new ye({tag:"div",attributes:{class:"ck-widget__resizer__handle "+(o=r,"ck-widget__resizer__handle-"+o)}}).render());var o}_appendSizeUI(t){this._sizeView=new Px,this._sizeView.render(),t.appendChild(this._sizeView.element)}}tt($c,yt),d(74),tt(class extends z{static get pluginName(){return"WidgetResize"}init(){const l=this.editor.editing,t=Pt.window.document;this.set("visibleResizer",null),this.set("_activeResizer",null),this._resizers=new Map,l.view.addObserver(na),this._observer=Object.create(Ji),this.listenTo(l.view.document,"mousedown",this._mouseDownListener.bind(this),{priority:"high"}),this._observer.listenTo(t,"mousemove",this._mouseMoveListener.bind(this)),this._observer.listenTo(t,"mouseup",this._mouseUpListener.bind(this));const n=()=>{this.visibleResizer&&this.visibleResizer.redraw()};this._redrawFocusedResizerThrottled=km(n,200),this.on("change:visibleResizer",n),this.editor.ui.on("update",this._redrawFocusedResizerThrottled),this.editor.model.document.on("change",()=>{for(const[r,c]of this._resizers)r.isAttached()||(this._resizers.delete(r),c.destroy())},{priority:"lowest"}),this._observer.listenTo(Pt.window,"resize",this._redrawFocusedResizerThrottled);const o=this.editor.editing.view.document.selection;o.on("change",()=>{const r=o.getSelectedElement();this.visibleResizer=this.getResizerByViewElement(r)||null})}destroy(){this._observer.stopListening();for(const l of this._resizers.values())l.destroy();this._redrawFocusedResizerThrottled.cancel()}attachTo(l){const t=new $c(l),n=this.editor.plugins;if(t.attach(),n.has("WidgetToolbarRepository")){const r=n.get("WidgetToolbarRepository");t.on("begin",()=>{r.forceDisabled("resize")},{priority:"lowest"}),t.on("cancel",()=>{r.clearForceDisabled("resize")},{priority:"highest"}),t.on("commit",()=>{r.clearForceDisabled("resize")},{priority:"highest"})}this._resizers.set(l.viewElement,t);const o=this.editor.editing.view.document.selection.getSelectedElement();return this.getResizerByViewElement(o)==t&&(this.visibleResizer=t),t}getResizerByViewElement(l){return this._resizers.get(l)}_getResizerByHandle(l){for(const t of this._resizers.values())if(t.containsHandle(l))return t}_mouseDownListener(l,t){const n=t.domTarget;$c.isResizeHandle(n)&&(this._activeResizer=this._getResizerByHandle(n),this._activeResizer&&(this._activeResizer.begin(n),l.stop(),t.preventDefault()))}_mouseMoveListener(l,t){this._activeResizer&&this._activeResizer.updateSize(t)}_mouseUpListener(){this._activeResizer&&(this._activeResizer.commit(),this._activeResizer=null)}},yt);class Ix extends lt{refresh(){const t=this.editor.plugins.get("ImageUtils").getClosestSelectedImageElement(this.editor.model.document.selection);this.isEnabled=!!t,this.isEnabled&&t.hasAttribute("alt")?this.value=t.getAttribute("alt"):this.value=!1}execute(t){const n=this.editor,o=n.plugins.get("ImageUtils"),r=n.model,c=o.getClosestSelectedImageElement(r.document.selection);r.change(u=>{u.setAttribute("alt",t.newValue,c)})}}function Hc(l,t){const n=l.createEmptyElement("img"),o=t==="imageBlock"?l.createContainerElement("figure",{class:"image"}):l.createContainerElement("span",{class:"image-inline"},{isAllowedInsideAttributeElement:!0});return l.insert(l.createPositionAt(o,0),n),o}function Qm(l,t){if(l.plugins.has("ImageInlineEditing")!==l.plugins.has("ImageBlockEditing"))return{name:"img"};const n=l.plugins.get("ImageUtils");return o=>n.isInlineImageView(o)?(o.findAncestor(n.isBlockImageView)?"imageBlock":"imageInline")!==t?null:{name:!0}:null}function Wc(l,t){const n=de(t.getSelectedBlocks());return!n||l.isObject(n)||n.isEmpty&&n.name!="listItem"?"imageBlock":"imageInline"}class ln extends z{static get pluginName(){return"ImageUtils"}isImage(t){return this.isInlineImage(t)||this.isBlockImage(t)}isInlineImageView(t){return!!t&&t.is("element","img")}isBlockImageView(t){return!!t&&t.is("element","figure")&&t.hasClass("image")}insertImage(t={},n=null,o=null){const r=this.editor,c=r.model,u=c.document.selection;o=Xm(r,n||u,o),t={...Object.fromEntries(u.getAttributes()),...t};for(const g in t)c.schema.checkAttribute(o,g)||delete t[g];return c.change(g=>{const m=g.createElement(o,t);return n||o=="imageInline"||(n=ds(u,c)),c.insertContent(m,n),m.parent?(g.setSelection(m,"on"),m):null})}getClosestSelectedImageWidget(t){const n=t.getSelectedElement();if(n&&this.isImageWidget(n))return n;let o=t.getFirstPosition().parent;for(;o;){if(o.is("element")&&this.isImageWidget(o))return o;o=o.parent}return null}getClosestSelectedImageElement(t){const n=t.getSelectedElement();return this.isImage(n)?n:t.getFirstPosition().findAncestor("imageBlock")}isImageAllowed(){const t=this.editor.model.document.selection;return function(n,o){if(Xm(n,o)=="imageBlock"){const r=function(c,u){const g=ds(c,u).start.parent;return g.isEmpty&&!g.is("element","$root")?g.parent:g}(o,n.model);if(n.model.schema.checkChild(r,"imageBlock"))return!0}else if(n.model.schema.checkChild(o.focus,"imageInline"))return!0;return!1}(this.editor,t)&&function(n){return[...n.focus.getAncestors()].every(o=>!o.is("element","imageBlock"))}(t)}toImageWidget(t,n,o){return n.setCustomProperty("image",!0,t),Dc(t,n,{label:()=>{const r=this.findViewImgElement(t).getAttribute("alt");return r?`${r} ${o}`:o}})}isImageWidget(t){return!!t.getCustomProperty("image")&&Nt(t)}isBlockImage(t){return!!t&&t.is("element","imageBlock")}isInlineImage(t){return!!t&&t.is("element","imageInline")}findViewImgElement(t){if(this.isInlineImageView(t))return t;const n=this.editor.editing.view;for(const{item:o}of n.createRangeIn(t))if(this.isInlineImageView(o))return o}}function Xm(l,t,n){const o=l.model.schema,r=l.config.get("image.insert.type");return l.plugins.has("ImageBlockEditing")?l.plugins.has("ImageInlineEditing")?n||(r==="inline"?"imageInline":r==="block"?"imageBlock":t.is("selection")?Wc(o,t):o.checkChild(t,"imageInline")?"imageInline":"imageBlock"):"imageBlock":"imageInline"}class Mx extends z{static get requires(){return[ln]}static get pluginName(){return"ImageTextAlternativeEditing"}init(){this.editor.commands.add("imageTextAlternative",new Ix(this.editor))}}d(76),d(7);class Rx extends st{constructor(t){super(t);const n=this.locale.t;this.focusTracker=new Oe,this.keystrokes=new _n,this.labeledInput=this._createLabeledInputView(),this.saveButtonView=this._createButton(n("Save"),De.check,"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton(n("Cancel"),De.cancel,"ck-button-cancel","cancel"),this._focusables=new di,this._focusCycler=new eo({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"form",attributes:{class:["ck","ck-text-alternative-form","ck-responsive-form"],tabindex:"-1"},children:[this.labeledInput,this.saveButtonView,this.cancelButtonView]}),wc(this)}render(){super.render(),this.keystrokes.listenTo(this.element),_c({view:this}),[this.labeledInput,this.saveButtonView,this.cancelButtonView].forEach(t=>{this._focusables.add(t),this.focusTracker.add(t.element)})}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}_createButton(t,n,o,r){const c=new Mt(this.locale);return c.set({label:t,icon:n,tooltip:!0}),c.extendTemplate({attributes:{class:o}}),r&&c.delegate("execute").to(this,r),c}_createLabeledInputView(){const t=this.locale.t,n=new Ec(this.locale,Tc);return n.label=t("Text alternative"),n}}function Zm(l){const t=l.editing.view,n=be.defaultPositions,o=l.plugins.get("ImageUtils");return{target:t.domConverter.viewToDom(o.getClosestSelectedImageWidget(t.document.selection)),positions:[n.northArrowSouth,n.northArrowSouthWest,n.northArrowSouthEast,n.southArrowNorth,n.southArrowNorthWest,n.southArrowNorthEast,n.viewportStickyNorth]}}class Ox extends z{static get requires(){return[ta]}static get pluginName(){return"ImageTextAlternativeUI"}init(){this._createButton(),this._createForm()}destroy(){super.destroy(),this._form.destroy()}_createButton(){const t=this.editor,n=t.t;t.ui.componentFactory.add("imageTextAlternative",o=>{const r=t.commands.get("imageTextAlternative"),c=new Mt(o);return c.set({label:n("Change image text alternative"),icon:De.lowVision,tooltip:!0}),c.bind("isEnabled").to(r,"isEnabled"),this.listenTo(c,"execute",()=>{this._showForm()}),c})}_createForm(){const t=this.editor,n=t.editing.view.document,o=t.plugins.get("ImageUtils");this._balloon=this.editor.plugins.get("ContextualBalloon"),this._form=new Rx(t.locale),this._form.render(),this.listenTo(this._form,"submit",()=>{t.execute("imageTextAlternative",{newValue:this._form.labeledInput.fieldView.element.value}),this._hideForm(!0)}),this.listenTo(this._form,"cancel",()=>{this._hideForm(!0)}),this._form.keystrokes.set("Esc",(r,c)=>{this._hideForm(!0),c()}),this.listenTo(t.ui,"update",()=>{o.getClosestSelectedImageWidget(n.selection)?this._isVisible&&function(r){const c=r.plugins.get("ContextualBalloon");if(r.plugins.get("ImageUtils").getClosestSelectedImageWidget(r.editing.view.document.selection)){const u=Zm(r);c.updatePosition(u)}}(t):this._hideForm(!0)}),bc({emitter:this._form,activator:()=>this._isVisible,contextElements:[this._balloon.view.element],callback:()=>this._hideForm()})}_showForm(){if(this._isVisible)return;const t=this.editor,n=t.commands.get("imageTextAlternative"),o=this._form.labeledInput;this._form.disableCssTransitions(),this._isInBalloon||this._balloon.add({view:this._form,position:Zm(t)}),o.fieldView.value=o.fieldView.element.value=n.value||"",this._form.labeledInput.fieldView.select(),this._form.enableCssTransitions()}_hideForm(t){this._isInBalloon&&(this._form.focusTracker.isFocused&&this._form.saveButtonView.focus(),this._balloon.remove(this._form),t&&this.editor.editing.view.focus())}get _isVisible(){return this._balloon.visibleView===this._form}get _isInBalloon(){return this._balloon.hasView(this._form)}}class tp extends z{static get requires(){return[Mx,Ox]}static get pluginName(){return"ImageTextAlternative"}}function ep(l,t){return o=>{o.on("attribute:srcset:"+t,n)};function n(o,r,c){if(!c.consumable.consume(r.item,o.name))return;const u=c.writer,g=c.mapper.toViewElement(r.item),m=l.findViewImgElement(g);if(r.attributeNewValue===null){const p=r.attributeOldValue;p.data&&(u.removeAttribute("srcset",m),u.removeAttribute("sizes",m),p.width&&u.removeAttribute("width",m))}else{const p=r.attributeNewValue;p.data&&(u.setAttribute("srcset",p.data,m),u.setAttribute("sizes","100vw",m),p.width&&u.setAttribute("width",p.width,m))}}}function da(l,t,n){return r=>{r.on(`attribute:${n}:${t}`,o)};function o(r,c,u){if(!u.consumable.consume(c.item,r.name))return;const g=u.writer,m=u.mapper.toViewElement(c.item),p=l.findViewImgElement(m);g.setAttribute(c.attributeKey,c.attributeNewValue||"",p)}}class Nx extends wn{observe(t){this.listenTo(t,"load",(n,o)=>{const r=o.target;this.checkShouldIgnoreEventFromTarget(r)||r.tagName=="IMG"&&this._fireEvents(o)},{useCapture:!0})}_fireEvents(t){this.isEnabled&&(this.document.fire("layoutChanged"),this.document.fire("imageLoaded",t))}}class Dx extends lt{constructor(t){super(t);const n=t.config.get("image.insert.type");t.plugins.has("ImageBlockEditing")||n==="block"&&Object(y.b)("image-block-plugin-required"),t.plugins.has("ImageInlineEditing")||n==="inline"&&Object(y.b)("image-inline-plugin-required")}refresh(){this.isEnabled=this.editor.plugins.get("ImageUtils").isImageAllowed()}execute(t){const n=Kt(t.source),o=this.editor.model.document.selection,r=this.editor.plugins.get("ImageUtils"),c=Object.fromEntries(o.getAttributes());n.forEach((u,g)=>{const m=o.getSelectedElement();if(typeof u=="string"&&(u={src:u}),g&&m&&r.isImage(m)){const p=this.editor.model.createPositionAfter(m);r.insertImage({...u,...c},p)}else r.insertImage({...u,...c})})}}class np extends z{static get requires(){return[ln]}static get pluginName(){return"ImageEditing"}init(){const t=this.editor,n=t.conversion;t.editing.view.addObserver(Nx),n.for("upcast").attributeToAttribute({view:{name:"img",key:"alt"},model:"alt"}).attributeToAttribute({view:{name:"img",key:"srcset"},model:{key:"srcset",value:r=>{const c={data:r.getAttribute("srcset")};return r.hasAttribute("width")&&(c.width=r.getAttribute("width")),c}}});const o=new Dx(t);t.commands.add("insertImage",o),t.commands.add("imageInsert",o)}}class ip extends lt{constructor(t,n){super(t),this._modelElementName=n}refresh(){const t=this.editor.plugins.get("ImageUtils"),n=t.getClosestSelectedImageElement(this.editor.model.document.selection);this._modelElementName==="imageBlock"?this.isEnabled=t.isInlineImage(n):this.isEnabled=t.isBlockImage(n)}execute(){const t=this.editor,n=this.editor.model,o=t.plugins.get("ImageUtils"),r=o.getClosestSelectedImageElement(n.document.selection),c=Object.fromEntries(r.getAttributes());return c.src||c.uploadId?n.change(u=>{const g=Array.from(n.markers).filter(w=>w.getRange().containsItem(r)),m=o.insertImage(c,n.createSelection(r,"on"),this._modelElementName);if(!m)return null;const p=u.createRangeOn(m);for(const w of g){const _=w.getRange(),v=_.root.rootName!="$graveyard"?_.getJoined(p,!0):p;u.updateMarker(w,{range:v})}return{oldElement:r,newElement:m}}):null}}class op extends z{static get requires(){return[np,ln,rn]}static get pluginName(){return"ImageBlockEditing"}init(){const t=this.editor;t.model.schema.register("imageBlock",{isObject:!0,isBlock:!0,allowWhere:"$block",allowAttributes:["alt","src","srcset"]}),this._setupConversion(),t.plugins.has("ImageInlineEditing")&&(t.commands.add("imageTypeBlock",new ip(this.editor,"imageBlock")),this._setupClipboardIntegration())}_setupConversion(){const t=this.editor,n=t.t,o=t.conversion,r=t.plugins.get("ImageUtils");o.for("dataDowncast").elementToElement({model:"imageBlock",view:(c,{writer:u})=>Hc(u,"imageBlock")}),o.for("editingDowncast").elementToElement({model:"imageBlock",view:(c,{writer:u})=>r.toImageWidget(Hc(u,"imageBlock"),u,n("image widget"))}),o.for("downcast").add(da(r,"imageBlock","src")).add(da(r,"imageBlock","alt")).add(ep(r,"imageBlock")),o.for("upcast").elementToElement({view:Qm(t,"imageBlock"),model:(c,{writer:u})=>u.createElement("imageBlock",c.hasAttribute("src")?{src:c.getAttribute("src")}:null)}).add(function(c){return g=>{g.on("element:figure",u)};function u(g,m,p){if(!p.consumable.test(m.viewItem,{name:!0,classes:"image"}))return;const w=c.findViewImgElement(m.viewItem);if(!w||!p.consumable.test(w,{name:!0}))return;p.consumable.consume(m.viewItem,{name:!0,classes:"image"});const _=de(p.convertItem(w,m.modelCursor).modelRange.getItems());_?(p.convertChildren(m.viewItem,_),p.updateConversionResult(_,m)):p.consumable.revert(m.viewItem,{name:!0,classes:"image"})}}(r))}_setupClipboardIntegration(){const t=this.editor,n=t.model,o=t.editing.view,r=t.plugins.get("ImageUtils");this.listenTo(t.plugins.get("ClipboardPipeline"),"inputTransformation",(c,u)=>{const g=Array.from(u.content.getChildren());let m;if(!g.every(r.isInlineImageView))return;m=u.targetRanges?t.editing.mapper.toModelRange(u.targetRanges[0]):n.document.selection.getFirstRange();const p=n.createSelection(m);if(Wc(n.schema,p)==="imageBlock"){const w=new oo(o.document),_=g.map(v=>w.createElement("figure",{class:"image"},v));u.content=w.createDocumentFragment(_)}})}}d(11);class Lx extends z{static get requires(){return[op,us,tp]}static get pluginName(){return"ImageBlock"}}class Vx extends z{static get requires(){return[np,ln,rn]}static get pluginName(){return"ImageInlineEditing"}init(){const t=this.editor,n=t.model.schema;n.register("imageInline",{isObject:!0,isInline:!0,allowWhere:"$text",allowAttributesOf:"$text",allowAttributes:["alt","src","srcset"]}),n.addChildCheck((o,r)=>{if(o.endsWith("caption")&&r.name==="imageInline")return!1}),this._setupConversion(),t.plugins.has("ImageBlockEditing")&&(t.commands.add("imageTypeInline",new ip(this.editor,"imageInline")),this._setupClipboardIntegration())}_setupConversion(){const t=this.editor,n=t.t,o=t.conversion,r=t.plugins.get("ImageUtils");o.for("dataDowncast").elementToElement({model:"imageInline",view:(c,{writer:u})=>u.createEmptyElement("img")}),o.for("editingDowncast").elementToElement({model:"imageInline",view:(c,{writer:u})=>r.toImageWidget(Hc(u,"imageInline"),u,n("image widget"))}),o.for("downcast").add(da(r,"imageInline","src")).add(da(r,"imageInline","alt")).add(ep(r,"imageInline")),o.for("upcast").elementToElement({view:Qm(t,"imageInline"),model:(c,{writer:u})=>u.createElement("imageInline",c.hasAttribute("src")?{src:c.getAttribute("src")}:null)})}_setupClipboardIntegration(){const t=this.editor,n=t.model,o=t.editing.view,r=t.plugins.get("ImageUtils");this.listenTo(t.plugins.get("ClipboardPipeline"),"inputTransformation",(c,u)=>{const g=Array.from(u.content.getChildren());let m;if(!g.every(r.isBlockImageView))return;m=u.targetRanges?t.editing.mapper.toModelRange(u.targetRanges[0]):n.document.selection.getFirstRange();const p=n.createSelection(m);if(Wc(n.schema,p)==="imageInline"){const w=new oo(o.document),_=g.map(v=>v.childCount===1?(Array.from(v.getAttributes()).forEach(A=>w.setAttribute(...A,r.findViewImgElement(v))),v.getChild(0)):v);u.content=w.createDocumentFragment(_)}})}}class Bx extends z{static get requires(){return[Vx,us,tp]}static get pluginName(){return"ImageInline"}}function qc(l){for(const t of l.getChildren())if(t&&t.is("element","caption"))return t;return null}function Uc(l,t){const n=t.getFirstPosition().findAncestor("caption");return n&&l.isBlockImage(n.parent)?n:null}class Fx extends lt{refresh(){const t=this.editor,n=t.plugins.get("ImageUtils");if(!t.plugins.has(op))return this.isEnabled=!1,void(this.value=!1);const o=t.model.document.selection,r=o.getSelectedElement();if(!r){const c=Uc(n,o);return this.isEnabled=!!c,void(this.value=!!c)}this.isEnabled=this.editor.plugins.get("ImageUtils").isImage(r),this.isEnabled?this.value=!!qc(r):this.value=!1}execute(t={}){const{focusCaptionOnShow:n}=t;this.editor.model.change(o=>{this.value?this._hideImageCaption(o):this._showImageCaption(o,n)})}_showImageCaption(t,n){const o=this.editor.model.document.selection,r=this.editor.plugins.get("ImageCaptionEditing");let c=o.getSelectedElement();const u=r._getSavedCaption(c);this.editor.plugins.get("ImageUtils").isInlineImage(c)&&(this.editor.execute("imageTypeBlock"),c=o.getSelectedElement());const g=u||t.createElement("caption");t.append(g,c),n&&t.setSelection(g,"in")}_hideImageCaption(t){const n=this.editor,o=n.model.document.selection,r=n.plugins.get("ImageCaptionEditing"),c=n.plugins.get("ImageUtils");let u,g=o.getSelectedElement();g?u=qc(g):(u=Uc(c,o),g=u.parent),r._saveCaption(g,u),t.setSelection(g,"on"),t.remove(u)}}class zx extends z{static get requires(){return[ln]}static get pluginName(){return"ImageCaptionEditing"}constructor(t){super(t),this._savedCaptionsMap=new WeakMap}init(){const t=this.editor,n=t.model.schema;n.isRegistered("caption")?n.extend("caption",{allowIn:"imageBlock"}):n.register("caption",{allowIn:"imageBlock",allowContentOf:"$block",isLimit:!0}),t.commands.add("toggleImageCaption",new Fx(this.editor)),this._setupConversion(),this._setupImageTypeCommandsIntegration()}_setupConversion(){const t=this.editor,n=t.editing.view,o=t.plugins.get("ImageUtils"),r=t.t;t.conversion.for("upcast").elementToElement({view:c=>function(u,g){return g.name=="figcaption"&&u.isBlockImageView(g.parent)?{name:!0}:null}(o,c),model:"caption"}),t.conversion.for("dataDowncast").elementToElement({model:"caption",view:(c,{writer:u})=>o.isBlockImage(c.parent)?u.createContainerElement("figcaption"):null}),t.conversion.for("editingDowncast").elementToElement({model:"caption",view:(c,{writer:u})=>{if(!o.isBlockImage(c.parent))return null;const g=u.createEditableElement("figcaption");return u.setCustomProperty("imageCaption",!0,g),Qg({view:n,element:g,text:r("Enter image caption"),keepOnFocus:!0}),Lc(g,u)}}),t.editing.mapper.on("modelToViewPosition",sp(n)),t.data.mapper.on("modelToViewPosition",sp(n))}_setupImageTypeCommandsIntegration(){const t=this.editor,n=t.plugins.get("ImageUtils"),o=t.commands.get("imageTypeInline"),r=t.commands.get("imageTypeBlock"),c=u=>{if(!u.return)return;const{oldElement:g,newElement:m}=u.return;if(!g)return;if(n.isBlockImage(g)){const w=qc(g);if(w)return void this._saveCaption(m,w)}const p=this._getSavedCaption(g);p&&this._saveCaption(m,p)};o&&this.listenTo(o,"execute",c,{priority:"low"}),r&&this.listenTo(r,"execute",c,{priority:"low"})}_getSavedCaption(t){const n=this._savedCaptionsMap.get(t);return n?mt.fromJSON(n):null}_saveCaption(t,n){this._savedCaptionsMap.set(t,n.toJSON())}}function sp(l){return(t,n)=>{const o=n.modelPosition,r=o.parent;if(!r.is("element","imageBlock"))return;const c=n.mapper.toViewElement(r);n.viewPosition=l.createPositionAt(c,o.offset+1)}}class jx extends z{static get requires(){return[ln]}static get pluginName(){return"ImageCaptionUI"}init(){const t=this.editor,n=t.editing.view,o=t.plugins.get("ImageUtils"),r=t.t;t.ui.componentFactory.add("toggleImageCaption",c=>{const u=t.commands.get("toggleImageCaption"),g=new Mt(c);return g.set({icon:De.caption,tooltip:!0,isToggleable:!0}),g.bind("isOn","isEnabled").to(u,"value","isEnabled"),g.bind("label").to(u,"value",m=>r(m?"Toggle caption off":"Toggle caption on")),this.listenTo(g,"execute",()=>{t.execute("toggleImageCaption",{focusCaptionOnShow:!0});const m=Uc(o,t.model.document.selection);if(m){const p=t.editing.mapper.toViewElement(m);n.scrollToTheSelection(),n.change(w=>{w.addClass("image__caption_highlighted",p)})}}),g})}}d(80);class $x extends lt{constructor(t,n){super(t),this._defaultStyles={imageBlock:!1,imageInline:!1},this._styles=new Map(n.map(o=>{if(o.isDefault)for(const r of o.modelElements)this._defaultStyles[r]=o.name;return[o.name,o]}))}refresh(){const t=this.editor.plugins.get("ImageUtils").getClosestSelectedImageElement(this.editor.model.document.selection);this.isEnabled=!!t,this.isEnabled?t.hasAttribute("imageStyle")?this.value=t.getAttribute("imageStyle"):this.value=this._defaultStyles[t.name]:this.value=!1}execute(t={}){const n=this.editor,o=n.model,r=n.plugins.get("ImageUtils");o.change(c=>{const u=t.value;let g=r.getClosestSelectedImageElement(o.document.selection);u&&this.shouldConvertImageType(u,g)&&(this.editor.execute(r.isBlockImage(g)?"imageTypeInline":"imageTypeBlock"),g=r.getClosestSelectedImageElement(o.document.selection)),!u||this._styles.get(u).isDefault?c.removeAttribute("imageStyle",g):c.setAttribute("imageStyle",u,g)})}shouldConvertImageType(t,n){return!this._styles.get(t).modelElements.includes(n.name)}}const{objectFullWidth:Hx,objectInline:rp,objectLeft:ap,objectRight:Gc,objectCenter:Kc,objectBlockLeft:lp,objectBlockRight:cp}=De,ua={inline:{name:"inline",title:"In line",icon:rp,modelElements:["imageInline"],isDefault:!0},alignLeft:{name:"alignLeft",title:"Left aligned image",icon:ap,modelElements:["imageBlock","imageInline"],className:"image-style-align-left"},alignBlockLeft:{name:"alignBlockLeft",title:"Left aligned image",icon:lp,modelElements:["imageBlock"],className:"image-style-block-align-left"},alignCenter:{name:"alignCenter",title:"Centered image",icon:Kc,modelElements:["imageBlock"],className:"image-style-align-center"},alignRight:{name:"alignRight",title:"Right aligned image",icon:Gc,modelElements:["imageBlock","imageInline"],className:"image-style-align-right"},alignBlockRight:{name:"alignBlockRight",title:"Right aligned image",icon:cp,modelElements:["imageBlock"],className:"image-style-block-align-right"},block:{name:"block",title:"Centered image",icon:Kc,modelElements:["imageBlock"],isDefault:!0},side:{name:"side",title:"Side image",icon:Gc,modelElements:["imageBlock"],className:"image-style-side"}},dp={full:Hx,left:lp,right:cp,center:Kc,inlineLeft:ap,inlineRight:Gc,inline:rp},up=[{name:"imageStyle:wrapText",title:"Wrap text",defaultItem:"imageStyle:alignLeft",items:["imageStyle:alignLeft","imageStyle:alignRight"]},{name:"imageStyle:breakText",title:"Break text",defaultItem:"imageStyle:block",items:["imageStyle:alignBlockLeft","imageStyle:block","imageStyle:alignBlockRight"]}];function hp(l){Object(y.b)("image-style-configuration-definition-invalid",l)}var Yc={normalizeStyles:function(l){return(l.configuredStyles.options||[]).map(t=>function(n){return n=typeof n=="string"?ua[n]?{...ua[n]}:{name:n}:function(o,r){const c={...r};for(const u in o)Object.prototype.hasOwnProperty.call(r,u)||(c[u]=o[u]);return c}(ua[n.name],n),typeof n.icon=="string"&&(n.icon=dp[n.icon]||n.icon),n}(t)).filter(t=>function(n,{isBlockPluginLoaded:o,isInlinePluginLoaded:r}){const{modelElements:c,name:u}=n;if(!(c&&c.length&&u))return hp({style:n}),!1;{const g=[o?"imageBlock":null,r?"imageInline":null];if(!c.some(m=>g.includes(m)))return Object(y.b)("image-style-missing-dependency",{style:n,missingPlugins:c.map(m=>m==="imageBlock"?"ImageBlockEditing":"ImageInlineEditing")}),!1}return!0}(t,l))},getDefaultStylesConfiguration:function(l,t){return l&&t?{options:["inline","alignLeft","alignRight","alignCenter","alignBlockLeft","alignBlockRight","block","side"]}:l?{options:["block","side"]}:t?{options:["inline","alignLeft","alignRight"]}:{}},getDefaultDropdownDefinitions:function(l){return l.has("ImageBlockEditing")&&l.has("ImageInlineEditing")?[...up]:[]},warnInvalidStyle:hp,DEFAULT_OPTIONS:ua,DEFAULT_ICONS:dp,DEFAULT_DROPDOWN_DEFINITIONS:up};function fp(l,t){for(const n of t)if(n.name===l)return n}class gp extends z{static get pluginName(){return"ImageStyleEditing"}static get requires(){return[ln]}init(){const{normalizeStyles:t,getDefaultStylesConfiguration:n}=Yc,o=this.editor,r=o.plugins.has("ImageBlockEditing"),c=o.plugins.has("ImageInlineEditing");o.config.define("image.styles",n(r,c)),this.normalizedStyles=t({configuredStyles:o.config.get("image.styles"),isBlockPluginLoaded:r,isInlinePluginLoaded:c}),this._setupConversion(r,c),this._setupPostFixer(),o.commands.add("imageStyle",new $x(o,this.normalizedStyles))}_setupConversion(t,n){const o=this.editor,r=o.model.schema,c=(u=this.normalizedStyles,(m,p,w)=>{if(!w.consumable.consume(p.item,m.name))return;const _=fp(p.attributeNewValue,u),v=fp(p.attributeOldValue,u),A=w.mapper.toViewElement(p.item),x=w.writer;v&&x.removeClass(v.className,A),_&&x.addClass(_.className,A)});var u;const g=function(m){const p={imageInline:m.filter(w=>!w.isDefault&&w.modelElements.includes("imageInline")),imageBlock:m.filter(w=>!w.isDefault&&w.modelElements.includes("imageBlock"))};return(w,_,v)=>{if(!_.modelRange)return;const A=_.viewItem,x=de(_.modelRange.getItems());if(x&&v.schema.checkAttribute(x,"imageStyle"))for(const E of p[x.name])v.consumable.consume(A,{classes:E.className})&&v.writer.setAttribute("imageStyle",E.name,x)}}(this.normalizedStyles);o.editing.downcastDispatcher.on("attribute:imageStyle",c),o.data.downcastDispatcher.on("attribute:imageStyle",c),t&&(r.extend("imageBlock",{allowAttributes:"imageStyle"}),o.data.upcastDispatcher.on("element:figure",g,{priority:"low"})),n&&(r.extend("imageInline",{allowAttributes:"imageStyle"}),o.data.upcastDispatcher.on("element:img",g,{priority:"low"}))}_setupPostFixer(){const t=this.editor,n=t.model.document,o=t.plugins.get(ln),r=new Map(this.normalizedStyles.map(c=>[c.name,c]));n.registerPostFixer(c=>{let u=!1;for(const g of n.differ.getChanges())if(g.type=="insert"||g.type=="attribute"&&g.attributeKey=="imageStyle"){let m=g.type=="insert"?g.position.nodeAfter:g.range.start.nodeAfter;if(m&&m.is("element","paragraph")&&m.childCount>0&&(m=m.getChild(0)),!o.isImage(m))continue;const p=m.getAttribute("imageStyle");if(!p)continue;const w=r.get(p);w&&w.modelElements.includes(m.name)||(c.removeAttribute("imageStyle",m),u=!0)}return u})}}d(82);class Wx extends z{static get requires(){return[gp]}static get pluginName(){return"ImageStyleUI"}get localizedDefaultStylesTitles(){const t=this.editor.t;return{"Wrap text":t("Wrap text"),"Break text":t("Break text"),"In line":t("In line"),"Full size image":t("Full size image"),"Side image":t("Side image"),"Left aligned image":t("Left aligned image"),"Centered image":t("Centered image"),"Right aligned image":t("Right aligned image")}}init(){const t=this.editor.plugins,n=this.editor.config.get("image.toolbar")||[],o=mp(t.get("ImageStyleEditing").normalizedStyles,this.localizedDefaultStylesTitles);for(const c of o)this._createButton(c);const r=mp([...n.filter(G),...Yc.getDefaultDropdownDefinitions(t)],this.localizedDefaultStylesTitles);for(const c of r)this._createDropdown(c,o)}_createDropdown(t,n){const o=this.editor.ui.componentFactory;o.add(t.name,r=>{let c;const{defaultItem:u,items:g,title:m}=t,p=g.filter(v=>n.find(({name:A})=>pp(A)===v)).map(v=>{const A=o.create(v);return v===u&&(c=A),A});g.length!==p.length&&Yc.warnInvalidStyle({dropdown:t});const w=ui(r,jg),_=w.buttonView;return Ug(w,p),_.set({label:bp(m,c.label),class:null,tooltip:!0}),_.bind("icon").toMany(p,"isOn",(...v)=>{const A=v.findIndex(ti);return A<0?c.icon:p[A].icon}),_.bind("label").toMany(p,"isOn",(...v)=>{const A=v.findIndex(ti);return bp(m,A<0?c.label:p[A].label)}),_.bind("isOn").toMany(p,"isOn",(...v)=>v.some(ti)),_.bind("class").toMany(p,"isOn",(...v)=>v.some(ti)?"ck-splitbutton_flatten":null),_.on("execute",()=>{p.some(({isOn:v})=>v)?w.isOpen=!w.isOpen:c.fire("execute")}),w.bind("isEnabled").toMany(p,"isEnabled",(...v)=>v.some(ti)),w})}_createButton(t){const n=t.name;this.editor.ui.componentFactory.add(pp(n),o=>{const r=this.editor.commands.get("imageStyle"),c=new Mt(o);return c.set({label:t.title,icon:t.icon,tooltip:!0,isToggleable:!0}),c.bind("isEnabled").to(r,"isEnabled"),c.bind("isOn").to(r,"value",u=>u===n),c.on("execute",this._executeCommand.bind(this,n)),c})}_executeCommand(t){this.editor.execute("imageStyle",{value:t}),this.editor.editing.view.focus()}}function mp(l,t){for(const n of l)t[n.title]&&(n.title=t[n.title]);return l}function pp(l){return"imageStyle:"+l}function bp(l,t){return(l?l+": ":"")+t}function wp(l){const t=l.map(n=>n.replace("+","\\+"));return new RegExp(`^image\\/(${t.join("|")})$`)}function qx(l){return new Promise((t,n)=>{const o=l.getAttribute("src");fetch(o).then(r=>r.blob()).then(r=>{const c=_p(r,o),u=c.replace("image/",""),g=new File([r],"image."+u,{type:c});t(g)}).catch(r=>r&&r.name==="TypeError"?function(c){return function(u){return new Promise((g,m)=>{const p=Pt.document.createElement("img");p.addEventListener("load",()=>{const w=Pt.document.createElement("canvas");w.width=p.width,w.height=p.height,w.getContext("2d").drawImage(p,0,0),w.toBlob(_=>_?g(_):m())}),p.addEventListener("error",()=>m()),p.src=u})}(c).then(u=>{const g=_p(u,c),m=g.replace("image/","");return new File([u],"image."+m,{type:g})})}(o).then(t).catch(n):n(r))})}function _p(l,t){return l.type?l.type:t.match(/data:(image\/\w+);base64/)?t.match(/data:(image\/\w+);base64/)[1].toLowerCase():"image/jpeg"}class Ux extends z{static get pluginName(){return"ImageUploadUI"}init(){const t=this.editor,n=t.t,o=r=>{const c=new lx(r),u=t.commands.get("uploadImage"),g=t.config.get("image.upload.types"),m=wp(g);return c.set({acceptedType:g.map(p=>"image/"+p).join(","),allowMultipleFiles:!0}),c.buttonView.set({label:n("Insert image"),icon:De.image,tooltip:!0}),c.buttonView.bind("isEnabled").to(u),c.on("done",(p,w)=>{const _=Array.from(w).filter(v=>m.test(v.type));_.length&&t.execute("uploadImage",{file:_})}),c};t.ui.componentFactory.add("uploadImage",o),t.ui.componentFactory.add("imageUpload",o)}}d(84),d(86),d(88);class Gx extends z{static get pluginName(){return"ImageUploadProgress"}constructor(t){super(t),this.placeholder="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="}init(){const t=this.editor;t.plugins.has("ImageBlockEditing")&&t.editing.downcastDispatcher.on("attribute:uploadStatus:imageBlock",(...n)=>this.uploadStatusChange(...n)),t.plugins.has("ImageInlineEditing")&&t.editing.downcastDispatcher.on("attribute:uploadStatus:imageInline",(...n)=>this.uploadStatusChange(...n))}uploadStatusChange(t,n,o){const r=this.editor,c=n.item,u=c.getAttribute("uploadId");if(!o.consumable.consume(n.item,t.name))return;const g=r.plugins.get("ImageUtils"),m=r.plugins.get(an),p=u?n.attributeNewValue:null,w=this.placeholder,_=r.editing.mapper.toViewElement(c),v=o.writer;if(p=="reading")return kp(_,v),void vp(g,w,_,v);if(p=="uploading"){const A=m.loaders.get(u);return kp(_,v),void(A?(yp(_,v),function(x,E,T,S){const I=function(N){const j=N.createUIElement("div",{class:"ck-progress-bar"});return N.setCustomProperty("progressBar",!0,j),j}(E);E.insert(E.createPositionAt(x,"end"),I),T.on("change:uploadedPercent",(N,j,X)=>{S.change(vt=>{vt.setStyle("width",X+"%",I)})})}(_,v,A,r.editing.view),function(x,E,T,S){if(S.data){const I=x.findViewImgElement(E);T.setAttribute("src",S.data,I)}}(g,_,v,A)):vp(g,w,_,v))}p=="complete"&&m.loaders.get(u)&&function(A,x,E){const T=x.createUIElement("div",{class:"ck-image-upload-complete-icon"});x.insert(x.createPositionAt(A,"end"),T),setTimeout(()=>{E.change(S=>S.remove(S.createRangeOn(T)))},3e3)}(_,v,r.editing.view),function(A,x){Cp(A,x,"progressBar")}(_,v),yp(_,v),function(A,x){x.removeClass("ck-appear",A)}(_,v)}}function kp(l,t){l.hasClass("ck-appear")||t.addClass("ck-appear",l)}function vp(l,t,n,o){n.hasClass("ck-image-upload-placeholder")||o.addClass("ck-image-upload-placeholder",n);const r=l.findViewImgElement(n);r.getAttribute("src")!==t&&o.setAttribute("src",t,r),Ap(n,"placeholder")||o.insert(o.createPositionAfter(r),function(c){const u=c.createUIElement("div",{class:"ck-upload-placeholder-loader"});return c.setCustomProperty("placeholder",!0,u),u}(o))}function yp(l,t){l.hasClass("ck-image-upload-placeholder")&&t.removeClass("ck-image-upload-placeholder",l),Cp(l,t,"placeholder")}function Ap(l,t){for(const n of l.getChildren())if(n.getCustomProperty(t))return n}function Cp(l,t,n){const o=Ap(l,n);o&&t.remove(t.createRangeOn(o))}class Kx extends lt{refresh(){const t=this.editor,n=t.plugins.get("ImageUtils"),o=t.model.document.selection.getSelectedElement();this.isEnabled=n.isImageAllowed()||n.isImage(o)}execute(t){const n=Kt(t.file),o=this.editor.model.document.selection,r=this.editor.plugins.get("ImageUtils"),c=Object.fromEntries(o.getAttributes());n.forEach((u,g)=>{const m=o.getSelectedElement();if(g&&m&&r.isImage(m)){const p=this.editor.model.createPositionAfter(m);this._uploadImage(u,c,p)}else this._uploadImage(u,c)})}_uploadImage(t,n,o){const r=this.editor,c=r.plugins.get(an).createLoader(t),u=r.plugins.get("ImageUtils");c&&u.insertImage({...n,uploadId:c.id},o)}}class Yx extends z{static get requires(){return[an,Sc,rn,ln]}static get pluginName(){return"ImageUploadEditing"}constructor(t){super(t),t.config.define("image",{upload:{types:["jpeg","png","gif","bmp","webp","tiff"]}}),this._uploadImageElements=new Map}init(){const t=this.editor,n=t.model.document,o=t.conversion,r=t.plugins.get(an),c=t.plugins.get("ImageUtils"),u=wp(t.config.get("image.upload.types")),g=new Kx(t);t.commands.add("uploadImage",g),t.commands.add("imageUpload",g),o.for("upcast").attributeToAttribute({view:{name:"img",key:"uploadId"},model:"uploadId"}),this.listenTo(t.editing.view.document,"clipboardInput",(m,p)=>{if(w=p.dataTransfer,Array.from(w.types).includes("text/html")&&w.getData("text/html")!=="")return;var w;const _=Array.from(p.dataTransfer.files).filter(v=>!!v&&u.test(v.type));_.length&&(m.stop(),t.model.change(v=>{p.targetRanges&&v.setSelection(p.targetRanges.map(A=>t.editing.mapper.toModelRange(A))),t.model.enqueueChange("default",()=>{t.execute("uploadImage",{file:_})})}))}),this.listenTo(t.plugins.get("ClipboardPipeline"),"inputTransformation",(m,p)=>{const w=Array.from(t.editing.view.createRangeIn(p.content)).filter(v=>function(A,x){return!(!A.isInlineImageView(x)||!x.getAttribute("src"))&&(x.getAttribute("src").match(/^data:image\/\w+;base64,/g)||x.getAttribute("src").match(/^blob:/g))}(c,v.item)&&!v.item.getAttribute("uploadProcessed")).map(v=>({promise:qx(v.item),imageElement:v.item}));if(!w.length)return;const _=new oo(t.editing.view.document);for(const v of w){_.setAttribute("uploadProcessed",!0,v.imageElement);const A=r.createLoader(v.promise);A&&(_.setAttribute("src","",v.imageElement),_.setAttribute("uploadId",A.id,v.imageElement))}}),t.editing.view.document.on("dragover",(m,p)=>{p.preventDefault()}),n.on("change",()=>{const m=n.differ.getChanges({includeChangesInGraveyard:!0}).reverse(),p=new Set;for(const w of m)if(w.type=="insert"&&w.name!="$text"){const _=w.position.nodeAfter,v=w.position.root.rootName=="$graveyard";for(const A of Jx(t,_)){const x=A.getAttribute("uploadId");if(!x)continue;const E=r.loaders.get(x);E&&(v?p.has(x)||E.abort():(p.add(x),this._uploadImageElements.set(x,A),E.status=="idle"&&this._readAndUpload(E)))}}}),this.on("uploadComplete",(m,{imageElement:p,data:w})=>{const _=w.urls?w.urls:w;this.editor.model.change(v=>{v.setAttribute("src",_.default,p),this._parseAndSetSrcsetAttributeOnImage(_,p,v)})},{priority:"low"})}afterInit(){const t=this.editor.model.schema;this.editor.plugins.has("ImageBlockEditing")&&t.extend("imageBlock",{allowAttributes:["uploadId","uploadStatus"]}),this.editor.plugins.has("ImageInlineEditing")&&t.extend("imageInline",{allowAttributes:["uploadId","uploadStatus"]})}_readAndUpload(t){const n=this.editor,o=n.model,r=n.locale.t,c=n.plugins.get(an),u=n.plugins.get(Sc),g=n.plugins.get("ImageUtils"),m=this._uploadImageElements;return o.enqueueChange("transparent",w=>{w.setAttribute("uploadStatus","reading",m.get(t.id))}),t.read().then(()=>{const w=t.upload(),_=m.get(t.id);if(bt.isSafari){const v=n.editing.mapper.toViewElement(_),A=g.findViewImgElement(v);n.editing.view.once("render",()=>{if(!A.parent)return;const x=n.editing.view.domConverter.mapViewToDom(A.parent);if(!x)return;const E=x.style.display;x.style.display="none",x._ckHack=x.offsetHeight,x.style.display=E})}return o.enqueueChange("transparent",v=>{v.setAttribute("uploadStatus","uploading",_)}),w}).then(w=>{o.enqueueChange("transparent",_=>{const v=m.get(t.id);_.setAttribute("uploadStatus","complete",v),this.fire("uploadComplete",{data:w,imageElement:v})}),p()}).catch(w=>{if(t.status!=="error"&&t.status!=="aborted")throw w;t.status=="error"&&w&&u.showWarning(w,{title:r("Upload failed"),namespace:"upload"}),o.enqueueChange("transparent",_=>{_.remove(m.get(t.id))}),p()});function p(){o.enqueueChange("transparent",w=>{const _=m.get(t.id);w.removeAttribute("uploadId",_),w.removeAttribute("uploadStatus",_),m.delete(t.id)}),c.destroyLoader(t)}}_parseAndSetSrcsetAttributeOnImage(t,n,o){let r=0;const c=Object.keys(t).filter(u=>{const g=parseInt(u,10);if(!isNaN(g))return r=Math.max(r,g),!0}).map(u=>`${t[u]} ${u}w`).join(", ");c!=""&&o.setAttribute("srcset",{data:c,width:r},n)}}function Jx(l,t){const n=l.plugins.get("ImageUtils");return Array.from(l.model.createRangeOn(t)).filter(o=>n.isImage(o.item)).map(o=>o.item)}class Qx extends z{static get pluginName(){return"IndentEditing"}init(){const t=this.editor;t.commands.add("indent",new mh(t)),t.commands.add("outdent",new mh(t))}}var xp='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zM1.632 6.95 5.02 9.358a.4.4 0 0 1-.013.661l-3.39 2.207A.4.4 0 0 1 1 11.892V7.275a.4.4 0 0 1 .632-.326z"/></svg>',Ep='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zm1.618-9.55L.98 9.358a.4.4 0 0 0 .013.661l3.39 2.207A.4.4 0 0 0 5 11.892V7.275a.4.4 0 0 0-.632-.326z"/></svg>';class Xx extends z{static get pluginName(){return"IndentUI"}init(){const t=this.editor,n=t.locale,o=t.t,r=n.uiLanguageDirection=="ltr"?xp:Ep,c=n.uiLanguageDirection=="ltr"?Ep:xp;this._defineButton("indent",o("Increase indent"),r),this._defineButton("outdent",o("Decrease indent"),c)}_defineButton(t,n,o){const r=this.editor;r.ui.componentFactory.add(t,c=>{const u=r.commands.get(t),g=new Mt(c);return g.set({label:n,icon:o,tooltip:!0}),g.bind("isOn","isEnabled").to(u,"value","isEnabled"),this.listenTo(g,"execute",()=>{r.execute(t),r.editing.view.focus()}),g})}}class Zx{constructor(){this._definitions=new Set}get length(){return this._definitions.size}add(t){Array.isArray(t)?t.forEach(n=>this._definitions.add(n)):this._definitions.add(t)}getDispatcher(){return t=>{t.on("attribute:linkHref",(n,o,r)=>{if(!r.consumable.test(o.item,"attribute:linkHref"))return;const c=r.writer,u=c.document.selection;for(const g of this._definitions){const m=c.createAttributeElement("a",g.attributes,{priority:5});g.classes&&c.addClass(g.classes,m);for(const p in g.styles)c.setStyle(p,g.styles[p],m);c.setCustomProperty("link",!0,m),g.callback(o.attributeNewValue)?o.item.is("selection")?c.wrap(u.getFirstRange(),m):c.wrap(r.mapper.toViewRange(o.range),m):c.unwrap(r.mapper.toViewRange(o.range),m)}},{priority:"high"})}}getDispatcherForLinkedImage(){return t=>{t.on("attribute:linkHref:imageBlock",(n,o,{writer:r,mapper:c})=>{const u=c.toViewElement(o.item),g=Array.from(u.getChildren()).find(m=>m.name==="a");for(const m of this._definitions){const p=bn(m.attributes);if(m.callback(o.attributeNewValue)){for(const[w,_]of p)w==="class"?r.addClass(_,g):r.setAttribute(w,_,g);m.classes&&r.addClass(m.classes,g);for(const w in m.styles)r.setStyle(w,m.styles[w],g)}else{for(const[w,_]of p)w==="class"?r.removeClass(_,g):r.removeAttribute(w,g);m.classes&&r.removeClass(m.classes,g);for(const w in m.styles)r.removeStyle(w,g)}}})}}}var tE=function(l,t,n){var o=l.length;return n=n===void 0?o:n,!t&&n>=o?l:$h(l,t,n)},eE=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]"),Tp=function(l){return eE.test(l)},nE=function(l){return l.split("")},iE="[\\ud800-\\udfff]",Jc="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Qc="\\ud83c[\\udffb-\\udfff]",Sp="[^\\ud800-\\udfff]",Pp="(?:\\ud83c[\\udde6-\\uddff]){2}",Ip="[\\ud800-\\udbff][\\udc00-\\udfff]",Mp="(?:"+Jc+"|"+Qc+")?",oE="[\\ufe0e\\ufe0f]?"+Mp+("(?:\\u200d(?:"+[Sp,Pp,Ip].join("|")+")[\\ufe0e\\ufe0f]?"+Mp+")*"),sE="(?:"+[Sp+Jc+"?",Jc,Pp,Ip,iE].join("|")+")",rE=RegExp(Qc+"(?="+Qc+")|"+sE+oE,"g"),aE=function(l){return l.match(rE)||[]},lE=function(l){return Tp(l)?aE(l):nE(l)},cE=function(l){return function(t){t=Nl(t);var n=Tp(t)?lE(t):void 0,o=n?n[0]:t.charAt(0),r=n?tE(n,1).join(""):t.slice(1);return o[l]()+r}}("toUpperCase");const dE=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,uE=/^(?:(?:https?|ftps?|mailto):|[^a-z]|[a-z+.-]+(?:[^a-z+.:-]|$))/i,hE=/^[\S]+@((?![-_])(?:[-\w\u00a1-\uffff]{0,63}[^-_]\.))+(?:[a-z\u00a1-\uffff]{2,})$/i,fE=/^((\w+:(\/{2,})?)|(\W))/i;function Rp(l,{writer:t}){const n=t.createAttributeElement("a",{href:l},{priority:5});return t.setCustomProperty("link",!0,n),n}function Op(l){return function(t){return t.replace(dE,"").match(uE)}(l=String(l))?l:"#"}function Xc(l,t){return!!l&&t.checkAttribute(l.name,"linkHref")}function Np(l,t){const n=(o=l,hE.test(o)?"mailto:":t);var o;const r=!!n&&!fE.test(l);return l&&r?n+l:l}function Dp(l){window.open(l,"_blank","noopener")}class gE extends lt{constructor(t){super(t),this.manualDecorators=new Me,this.automaticDecorators=new Zx}restoreManualDecoratorStates(){for(const t of this.manualDecorators)t.value=this._getDecoratorStateFromModel(t.id)}refresh(){const t=this.editor.model,n=t.document.selection,o=n.getSelectedElement()||de(n.getSelectedBlocks());Xc(o,t.schema)?(this.value=o.getAttribute("linkHref"),this.isEnabled=t.schema.checkAttribute(o,"linkHref")):(this.value=n.getAttribute("linkHref"),this.isEnabled=t.schema.checkAttributeInSelection(n,"linkHref"));for(const r of this.manualDecorators)r.value=this._getDecoratorStateFromModel(r.id)}execute(t,n={}){const o=this.editor.model,r=o.document.selection,c=[],u=[];for(const g in n)n[g]?c.push(g):u.push(g);o.change(g=>{if(r.isCollapsed){const m=r.getFirstPosition();if(r.hasAttribute("linkHref")){const p=ro(m,"linkHref",r.getAttribute("linkHref"),o);g.setAttribute("linkHref",t,p),c.forEach(w=>{g.setAttribute(w,!0,p)}),u.forEach(w=>{g.removeAttribute(w,p)}),g.setSelection(g.createPositionAfter(p.end.nodeBefore))}else if(t!==""){const p=bn(r.getAttributes());p.set("linkHref",t),c.forEach(_=>{p.set(_,!0)});const{end:w}=o.insertContent(g.createText(t,p),m);g.setSelection(w)}["linkHref",...c,...u].forEach(p=>{g.removeSelectionAttribute(p)})}else{const m=o.schema.getValidRanges(r.getRanges(),"linkHref"),p=[];for(const _ of r.getSelectedBlocks())o.schema.checkAttribute(_,"linkHref")&&p.push(g.createRangeOn(_));const w=p.slice();for(const _ of m)this._isRangeToUpdate(_,p)&&w.push(_);for(const _ of w)g.setAttribute("linkHref",t,_),c.forEach(v=>{g.setAttribute(v,!0,_)}),u.forEach(v=>{g.removeAttribute(v,_)})}})}_getDecoratorStateFromModel(t){const n=this.editor.model,o=n.document.selection,r=o.getSelectedElement();return Xc(r,n.schema)?r.getAttribute(t):o.getAttribute(t)}_isRangeToUpdate(t,n){for(const o of n)if(o.containsRange(t))return!1;return!0}}class mE extends lt{refresh(){const t=this.editor.model,n=t.document.selection,o=n.getSelectedElement();Xc(o,t.schema)?this.isEnabled=t.schema.checkAttribute(o,"linkHref"):this.isEnabled=t.schema.checkAttributeInSelection(n,"linkHref")}execute(){const t=this.editor,n=this.editor.model,o=n.document.selection,r=t.commands.get("link");n.change(c=>{const u=o.isCollapsed?[ro(o.getFirstPosition(),"linkHref",o.getAttribute("linkHref"),n)]:n.schema.getValidRanges(o.getRanges(),"linkHref");for(const g of u)if(c.removeAttribute("linkHref",g),r)for(const m of r.manualDecorators)c.removeAttribute(m.id,g)})}}class Lp{constructor({id:t,label:n,attributes:o,classes:r,styles:c,defaultValue:u}){this.id=t,this.set("value"),this.defaultValue=u,this.label=n,this.attributes=o,this.classes=r,this.styles=c}_createPattern(){return{attributes:this.attributes,classes:this.classes,styles:this.styles}}}tt(Lp,yt),d(90);const pE=/^(https?:)?\/\//;class bE extends z{static get pluginName(){return"LinkEditing"}static get requires(){return[Rm,Im,rn]}constructor(t){super(t),t.config.define("link",{addTargetToExternalLinks:!1})}init(){const t=this.editor;t.model.schema.extend("$text",{allowAttributes:"linkHref"}),t.conversion.for("dataDowncast").attributeToElement({model:"linkHref",view:Rp}),t.conversion.for("editingDowncast").attributeToElement({model:"linkHref",view:(o,r)=>Rp(Op(o),r)}),t.conversion.for("upcast").elementToAttribute({view:{name:"a",attributes:{href:!0}},model:{key:"linkHref",value:o=>o.getAttribute("href")}}),t.commands.add("link",new gE(t)),t.commands.add("unlink",new mE(t));const n=function(o,r){const c={"Open in a new tab":o("Open in a new tab"),Downloadable:o("Downloadable")};return r.forEach(u=>(u.label&&c[u.label]&&(u.label=c[u.label]),u)),r}(t.t,function(o){const r=[];if(o)for(const[c,u]of Object.entries(o)){const g=Object.assign({},u,{id:"link"+cE(c)});r.push(g)}return r}(t.config.get("link.decorators")));this._enableAutomaticDecorators(n.filter(o=>o.mode==="automatic")),this._enableManualDecorators(n.filter(o=>o.mode==="manual")),t.plugins.get(Rm).registerAttribute("linkHref"),function(o,r,c,u){const g=o.editing.view,m=new Set;g.document.registerPostFixer(p=>{const w=o.model.document.selection;let _=!1;if(w.hasAttribute(r)){const v=ro(w.getFirstPosition(),r,w.getAttribute(r),o.model),A=o.editing.mapper.toViewRange(v);for(const x of A.getItems())x.is("element",c)&&!x.hasClass(u)&&(p.addClass(u,x),m.add(x),_=!0)}return _}),o.conversion.for("editingDowncast").add(p=>{function w(){g.change(_=>{for(const v of m.values())_.removeClass(u,v),m.delete(v)})}p.on("insert",w,{priority:"highest"}),p.on("remove",w,{priority:"highest"}),p.on("attribute",w,{priority:"highest"}),p.on("selection",w,{priority:"highest"})})}(t,"linkHref","a","ck-link_selected"),this._enableLinkOpen(),this._enableInsertContentSelectionAttributesFixer(),this._enableClickingAfterLink(),this._enableTypingOverLink(),this._handleDeleteContentAfterLink()}_enableAutomaticDecorators(t){const n=this.editor,o=n.commands.get("link").automaticDecorators;n.config.get("link.addTargetToExternalLinks")&&o.add({id:"linkIsExternal",mode:"automatic",callback:r=>pE.test(r),attributes:{target:"_blank",rel:"noopener noreferrer"}}),o.add(t),o.length&&n.conversion.for("downcast").add(o.getDispatcher())}_enableManualDecorators(t){if(!t.length)return;const n=this.editor,o=n.commands.get("link").manualDecorators;t.forEach(r=>{n.model.schema.extend("$text",{allowAttributes:r.id}),r=new Lp(r),o.add(r),n.conversion.for("downcast").attributeToElement({model:r.id,view:(c,{writer:u})=>{if(c){const g=u.createAttributeElement("a",r.attributes,{priority:5});r.classes&&u.addClass(r.classes,g);for(const m in r.styles)u.setStyle(m,r.styles[m],g);return u.setCustomProperty("link",!0,g),g}}}),n.conversion.for("upcast").elementToAttribute({view:{name:"a",...r._createPattern()},model:{key:r.id}})})}_enableLinkOpen(){const t=this.editor,n=t.editing.view.document,o=t.model.document;this.listenTo(n,"click",(r,c)=>{if(!(bt.isMac?c.domEvent.metaKey:c.domEvent.ctrlKey))return;let u=c.domTarget;if(u.tagName.toLowerCase()!="a"&&(u=u.closest("a")),!u)return;const g=u.getAttribute("href");g&&(r.stop(),c.preventDefault(),Dp(g))},{context:"$capture"}),this.listenTo(n,"enter",(r,c)=>{const u=o.selection,g=u.getSelectedElement(),m=g?g.getAttribute("linkHref"):u.getAttribute("linkHref");m&&c.domEvent.altKey&&(r.stop(),Dp(m))},{context:"a"})}_enableInsertContentSelectionAttributesFixer(){const t=this.editor.model,n=t.document.selection;this.listenTo(t,"insertContent",()=>{const o=n.anchor.nodeBefore,r=n.anchor.nodeAfter;n.hasAttribute("linkHref")&&o&&o.hasAttribute("linkHref")&&(r&&r.hasAttribute("linkHref")||t.change(c=>{Zc(c,td(t.schema))}))},{priority:"low"})}_enableClickingAfterLink(){const t=this.editor,n=t.model;t.editing.view.addObserver(na);let o=!1;this.listenTo(t.editing.view.document,"mousedown",()=>{o=!0}),this.listenTo(t.editing.view.document,"selectionChange",()=>{if(!o)return;o=!1;const r=n.document.selection;if(!r.isCollapsed||!r.hasAttribute("linkHref"))return;const c=r.getFirstPosition(),u=ro(c,"linkHref",r.getAttribute("linkHref"),n);(c.isTouching(u.start)||c.isTouching(u.end))&&n.change(g=>{Zc(g,td(n.schema))})})}_enableTypingOverLink(){const t=this.editor,n=t.editing.view;let o,r;this.listenTo(n.document,"delete",()=>{r=!0},{priority:"high"}),this.listenTo(t.model,"deleteContent",()=>{const c=t.model.document.selection;c.isCollapsed||(r?r=!1:Vp(t)&&function(u){const g=u.document.selection,m=g.getFirstPosition(),p=g.getLastPosition(),w=m.nodeAfter;if(!w||!w.is("$text")||!w.hasAttribute("linkHref"))return!1;const _=p.textNode||p.nodeBefore;return w===_?!0:ro(m,"linkHref",w.getAttribute("linkHref"),u).containsRange(u.createRange(m,p),!0)}(t.model)&&(o=c.getAttributes()))},{priority:"high"}),this.listenTo(t.model,"insertContent",(c,[u])=>{r=!1,Vp(t)&&o&&(t.model.change(g=>{for(const[m,p]of o)g.setAttribute(m,p,u)}),o=null)},{priority:"high"})}_handleDeleteContentAfterLink(){const t=this.editor,n=t.model,o=n.document.selection,r=t.editing.view;let c=!1,u=!1;this.listenTo(r.document,"delete",(g,m)=>{u=m.domEvent.keyCode===rt.backspace},{priority:"high"}),this.listenTo(n,"deleteContent",()=>{c=!1;const g=o.getFirstPosition(),m=o.getAttribute("linkHref");if(!m)return;const p=ro(g,"linkHref",m,n);c=p.containsPosition(g)||p.end.isEqual(g)},{priority:"high"}),this.listenTo(n,"deleteContent",()=>{u&&(u=!1,c||t.model.enqueueChange(g=>{Zc(g,td(n.schema))}))},{priority:"low"})}}function Zc(l,t){l.removeSelectionAttribute("linkHref");for(const n of t)l.removeSelectionAttribute(n)}function Vp(l){return l.plugins.get("Input").isInput(l.model.change(t=>t.batch))}function td(l){return l.getDefinition("$text").allowAttributes.filter(t=>t.startsWith("link"))}d(92);class wE extends st{constructor(t,n){super(t);const o=t.t;this.focusTracker=new Oe,this.keystrokes=new _n,this.urlInputView=this._createUrlInput(),this.saveButtonView=this._createButton(o("Save"),De.check,"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton(o("Cancel"),De.cancel,"ck-button-cancel","cancel"),this._manualDecoratorSwitches=this._createManualDecoratorSwitches(n),this.children=this._createFormChildren(n.manualDecorators),this._focusables=new di,this._focusCycler=new eo({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}});const r=["ck","ck-link-form","ck-responsive-form"];n.manualDecorators.length&&r.push("ck-link-form_layout-vertical","ck-vertical-form"),this.setTemplate({tag:"form",attributes:{class:r,tabindex:"-1"},children:this.children}),wc(this)}getDecoratorSwitchesState(){return Array.from(this._manualDecoratorSwitches).reduce((t,n)=>(t[n.name]=n.isOn,t),{})}render(){super.render(),_c({view:this}),[this.urlInputView,...this._manualDecoratorSwitches,this.saveButtonView,this.cancelButtonView].forEach(t=>{this._focusables.add(t),this.focusTracker.add(t.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createUrlInput(){const t=this.locale.t,n=new Ec(this.locale,Tc);return n.label=t("Link URL"),n}_createButton(t,n,o,r){const c=new Mt(this.locale);return c.set({label:t,icon:n,tooltip:!0}),c.extendTemplate({attributes:{class:o}}),r&&c.delegate("execute").to(this,r),c}_createManualDecoratorSwitches(t){const n=this.createCollection();for(const o of t.manualDecorators){const r=new yc(this.locale);r.set({name:o.id,label:o.label,withText:!0}),r.bind("isOn").toMany([o,t],"value",(c,u)=>u===void 0&&c===void 0?o.defaultValue:c),r.on("execute",()=>{o.set("value",!r.isOn)}),n.add(r)}return n}_createFormChildren(t){const n=this.createCollection();if(n.add(this.urlInputView),t.length){const o=new st;o.setTemplate({tag:"ul",children:this._manualDecoratorSwitches.map(r=>({tag:"li",children:[r],attributes:{class:["ck","ck-list__item"]}})),attributes:{class:["ck","ck-reset","ck-list"]}}),n.add(o)}return n.add(this.saveButtonView),n.add(this.cancelButtonView),n}}d(94);class _E extends st{constructor(t){super(t);const n=t.t;this.focusTracker=new Oe,this.keystrokes=new _n,this.previewButtonView=this._createPreviewButton(),this.unlinkButtonView=this._createButton(n("Unlink"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.077 15 .991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.748.748 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.741.741 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294l.006.004zm5.494-5.335a.748.748 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.748.748 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955zm-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184zm4.919 10.562-1.414 1.414a.75.75 0 1 1-1.06-1.06l1.414-1.415-1.415-1.414a.75.75 0 0 1 1.061-1.06l1.414 1.414 1.414-1.415a.75.75 0 0 1 1.061 1.061l-1.414 1.414 1.414 1.415a.75.75 0 0 1-1.06 1.06l-1.415-1.414z"/></svg>',"unlink"),this.editButtonView=this._createButton(n("Edit link"),De.pencil,"edit"),this.set("href"),this._focusables=new di,this._focusCycler=new eo({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-link-actions","ck-responsive-form"],tabindex:"-1"},children:[this.previewButtonView,this.editButtonView,this.unlinkButtonView]})}render(){super.render(),[this.previewButtonView,this.editButtonView,this.unlinkButtonView].forEach(t=>{this._focusables.add(t),this.focusTracker.add(t.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createButton(t,n,o){const r=new Mt(this.locale);return r.set({label:t,icon:n,tooltip:!0}),r.delegate("execute").to(this,o),r}_createPreviewButton(){const t=new Mt(this.locale),n=this.bindTemplate,o=this.t;return t.set({withText:!0,tooltip:o("Open link in new tab")}),t.extendTemplate({attributes:{class:["ck","ck-link-actions__preview"],href:n.to("href",r=>r&&Op(r)),target:"_blank",rel:"noopener noreferrer"}}),t.bind("label").to(this,"href",r=>r||o("This link has no URL")),t.bind("isEnabled").to(this,"href",r=>!!r),t.template.tag="a",t.template.eventListeners={},t}}class kE extends z{static get requires(){return[ta]}static get pluginName(){return"LinkUI"}init(){const t=this.editor;t.editing.view.addObserver(vC),this.actionsView=this._createActionsView(),this.formView=this._createFormView(),this._balloon=t.plugins.get(ta),this._createToolbarLinkButton(),this._enableUserBalloonInteractions(),t.conversion.for("editingDowncast").markerToHighlight({model:"link-ui",view:{classes:["ck-fake-link-selection"]}}),t.conversion.for("editingDowncast").markerToElement({model:"link-ui",view:{name:"span",classes:["ck-fake-link-selection","ck-fake-link-selection_collapsed"]}})}destroy(){super.destroy(),this.formView.destroy()}_createActionsView(){const t=this.editor,n=new _E(t.locale),o=t.commands.get("link"),r=t.commands.get("unlink");return n.bind("href").to(o,"value"),n.editButtonView.bind("isEnabled").to(o),n.unlinkButtonView.bind("isEnabled").to(r),this.listenTo(n,"edit",()=>{this._addFormView()}),this.listenTo(n,"unlink",()=>{t.execute("unlink"),this._hideUI()}),n.keystrokes.set("Esc",(c,u)=>{this._hideUI(),u()}),n.keystrokes.set("Ctrl+K",(c,u)=>{this._addFormView(),u()}),n}_createFormView(){const t=this.editor,n=t.commands.get("link"),o=t.config.get("link.defaultProtocol"),r=new wE(t.locale,n);return r.urlInputView.fieldView.bind("value").to(n,"value"),r.urlInputView.bind("isReadOnly").to(n,"isEnabled",c=>!c),r.saveButtonView.bind("isEnabled").to(n),this.listenTo(r,"submit",()=>{const{value:c}=r.urlInputView.fieldView.element,u=Np(c,o);t.execute("link",u,r.getDecoratorSwitchesState()),this._closeFormView()}),this.listenTo(r,"cancel",()=>{this._closeFormView()}),r.keystrokes.set("Esc",(c,u)=>{this._closeFormView(),u()}),r}_createToolbarLinkButton(){const t=this.editor,n=t.commands.get("link"),o=t.t;t.keystrokes.set("Ctrl+K",(r,c)=>{c(),n.isEnabled&&this._showUI(!0)}),t.ui.componentFactory.add("link",r=>{const c=new Mt(r);return c.isEnabled=!0,c.label=o("Link"),c.icon='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.077 15 .991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.748.748 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.741.741 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294l.006.004zm5.494-5.335a.748.748 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.748.748 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955zm-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184z"/></svg>',c.keystroke="Ctrl+K",c.tooltip=!0,c.isToggleable=!0,c.bind("isEnabled").to(n,"isEnabled"),c.bind("isOn").to(n,"value",u=>!!u),this.listenTo(c,"execute",()=>this._showUI(!0)),c})}_enableUserBalloonInteractions(){const t=this.editor.editing.view.document;this.listenTo(t,"click",()=>{this._getSelectedLinkElement()&&this._showUI()}),this.editor.keystrokes.set("Tab",(n,o)=>{this._areActionsVisible&&!this.actionsView.focusTracker.isFocused&&(this.actionsView.focus(),o())},{priority:"high"}),this.editor.keystrokes.set("Esc",(n,o)=>{this._isUIVisible&&(this._hideUI(),o())}),bc({emitter:this.formView,activator:()=>this._isUIInPanel,contextElements:[this._balloon.view.element],callback:()=>this._hideUI()})}_addActionsView(){this._areActionsInPanel||this._balloon.add({view:this.actionsView,position:this._getBalloonPositionData()})}_addFormView(){if(this._isFormInPanel)return;const t=this.editor.commands.get("link");this.formView.disableCssTransitions(),this._balloon.add({view:this.formView,position:this._getBalloonPositionData()}),this._balloon.visibleView===this.formView&&this.formView.urlInputView.fieldView.select(),this.formView.enableCssTransitions(),this.formView.urlInputView.fieldView.element.value=t.value||""}_closeFormView(){const t=this.editor.commands.get("link");t.restoreManualDecoratorStates(),t.value!==void 0?this._removeFormView():this._hideUI()}_removeFormView(){this._isFormInPanel&&(this.formView.saveButtonView.focus(),this._balloon.remove(this.formView),this.editor.editing.view.focus(),this._hideFakeVisualSelection())}_showUI(t=!1){this._getSelectedLinkElement()?(this._areActionsVisible?this._addFormView():this._addActionsView(),t&&this._balloon.showStack("main")):(this._showFakeVisualSelection(),this._addActionsView(),t&&this._balloon.showStack("main"),this._addFormView()),this._startUpdatingUI()}_hideUI(){if(!this._isUIInPanel)return;const t=this.editor;this.stopListening(t.ui,"update"),this.stopListening(this._balloon,"change:visibleView"),t.editing.view.focus(),this._removeFormView(),this._balloon.remove(this.actionsView),this._hideFakeVisualSelection()}_startUpdatingUI(){const t=this.editor,n=t.editing.view.document;let o=this._getSelectedLinkElement(),r=u();const c=()=>{const g=this._getSelectedLinkElement(),m=u();o&&!g||!o&&m!==r?this._hideUI():this._isUIVisible&&this._balloon.updatePosition(this._getBalloonPositionData()),o=g,r=m};function u(){return n.selection.focus.getAncestors().reverse().find(g=>g.is("element"))}this.listenTo(t.ui,"update",c),this.listenTo(this._balloon,"change:visibleView",c)}get _isFormInPanel(){return this._balloon.hasView(this.formView)}get _areActionsInPanel(){return this._balloon.hasView(this.actionsView)}get _areActionsVisible(){return this._balloon.visibleView===this.actionsView}get _isUIInPanel(){return this._isFormInPanel||this._areActionsInPanel}get _isUIVisible(){return this._balloon.visibleView==this.formView||this._areActionsVisible}_getBalloonPositionData(){const t=this.editor.editing.view,n=this.editor.model,o=t.document;let r=null;if(n.markers.has("link-ui")){const c=Array.from(this.editor.editing.mapper.markerNameToElements("link-ui")),u=t.createRange(t.createPositionBefore(c[0]),t.createPositionAfter(c[c.length-1]));r=t.domConverter.viewRangeToDom(u)}else r=()=>{const c=this._getSelectedLinkElement();return c?t.domConverter.mapViewToDom(c):t.domConverter.viewRangeToDom(o.selection.getFirstRange())};return{target:r}}_getSelectedLinkElement(){const t=this.editor.editing.view,n=t.document.selection,o=n.getSelectedElement();if(n.isCollapsed||o&&Nt(o))return ed(n.getFirstPosition());{const r=n.getFirstRange().getTrimmed(),c=ed(r.start),u=ed(r.end);return c&&c==u&&t.createRangeIn(c).getTrimmed().isEqual(r)?c:null}}_showFakeVisualSelection(){const t=this.editor.model;t.change(n=>{const o=t.document.selection.getFirstRange();if(t.markers.has("link-ui"))n.updateMarker("link-ui",{range:o});else if(o.start.isAtEnd){const r=o.start.getLastMatchingPosition(({item:c})=>!t.schema.isContent(c),{boundaries:o});n.addMarker("link-ui",{usingOperation:!1,affectsData:!1,range:n.createRange(r,o.end)})}else n.addMarker("link-ui",{usingOperation:!1,affectsData:!1,range:o})})}_hideFakeVisualSelection(){const t=this.editor.model;t.markers.has("link-ui")&&t.change(n=>{n.removeMarker("link-ui")})}}function ed(l){return l.getAncestors().find(t=>{return(n=t).is("attributeElement")&&!!n.getCustomProperty("link");var n})}const vE=new RegExp("(^|\\s)(((?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(((?!www\\.)|(www\\.))(?![-_])(?:[-_a-z0-9\\u00a1-\\uffff]{1,63}\\.)+(?:[a-z\\u00a1-\\uffff]{2,63})))(?::\\d{2,5})?(?:[/?#]\\S*)?)|((www.|(\\S+@))((?![-_])(?:[-_a-z0-9\\u00a1-\\uffff]{1,63}\\.))+(?:[a-z\\u00a1-\\uffff]{2,63})))$","i");class yE extends z{static get requires(){return[Bn]}static get pluginName(){return"AutoLink"}init(){const t=this.editor.model.document.selection;t.on("change:range",()=>{this.isEnabled=!t.anchor.parent.is("element","codeBlock")}),this._enableTypingHandling()}afterInit(){this._enableEnterHandling(),this._enableShiftEnterHandling()}_enableTypingHandling(){const t=this.editor,n=new Bc(t.model,r=>{if(!function(u){return u.length>4&&u[u.length-1]===" "&&u[u.length-2]!==" "}(r))return;const c=Bp(r.substr(0,r.length-1));return c?{url:c}:void 0}),o=t.plugins.get("Input");n.on("matched:data",(r,c)=>{const{batch:u,range:g,url:m}=c;if(!o.isInput(u))return;const p=g.end.getShiftedBy(-1),w=p.getShiftedBy(-m.length),_=t.model.createRange(w,p);this._applyAutoLink(m,_)}),n.bind("isEnabled").to(this)}_enableEnterHandling(){const t=this.editor,n=t.model,o=t.commands.get("enter");o&&o.on("execute",()=>{const r=n.document.selection.getFirstPosition();if(!r.parent.previousSibling)return;const c=n.createRangeIn(r.parent.previousSibling);this._checkAndApplyAutoLinkOnRange(c)})}_enableShiftEnterHandling(){const t=this.editor,n=t.model,o=t.commands.get("shiftEnter");o&&o.on("execute",()=>{const r=n.document.selection.getFirstPosition(),c=n.createRange(n.createPositionAt(r.parent,0),r.getShiftedBy(-1));this._checkAndApplyAutoLinkOnRange(c)})}_checkAndApplyAutoLinkOnRange(t){const n=this.editor.model,{text:o,range:r}=Mm(t,n),c=Bp(o);if(c){const u=n.createRange(r.end.getShiftedBy(-c.length),r.end);this._applyAutoLink(c,u)}}_applyAutoLink(t,n){const o=this.editor.model,r=this.editor.plugins.get("Delete");this.isEnabled&&function(c,u){return u.schema.checkAttributeInSelection(u.createSelection(c),"linkHref")}(n,o)&&o.enqueueChange(c=>{const u=this.editor.config.get("link.defaultProtocol"),g=Np(t,u);c.setAttribute("linkHref",g,n),o.enqueueChange(()=>{r.requestUndoOnBackspace()})})}}function Bp(l){const t=vE.exec(l);return t?t[2]:null}class Fp extends lt{constructor(t,n){super(t),this.type=n}refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(t={}){const n=this.editor.model,o=n.document,r=Array.from(o.selection.getSelectedBlocks()).filter(u=>jp(u,n.schema)),c=t.forceValue!==void 0?!t.forceValue:this.value;n.change(u=>{if(c){let g=r[r.length-1].nextSibling,m=Number.POSITIVE_INFINITY,p=[];for(;g&&g.name=="listItem"&&g.getAttribute("listIndent")!==0;){const w=g.getAttribute("listIndent");w<m&&(m=w);const _=w-m;p.push({element:g,listIndent:_}),g=g.nextSibling}p=p.reverse();for(const w of p)u.setAttribute("listIndent",w.listIndent,w.element)}if(!c){let g=Number.POSITIVE_INFINITY;for(const m of r)m.is("element","listItem")&&m.getAttribute("listIndent")<g&&(g=m.getAttribute("listIndent"));g=g===0?1:g,zp(r,!0,g),zp(r,!1,g)}for(const g of r.reverse())c&&g.name=="listItem"?u.rename(g,"paragraph"):c||g.name=="listItem"?c||g.name!="listItem"||g.getAttribute("listType")==this.type||u.setAttribute("listType",this.type,g):(u.setAttributes({listType:this.type,listIndent:0},g),u.rename(g,"listItem"));this.fire("_executeCleanup",r)})}_getValue(){const t=de(this.editor.model.document.selection.getSelectedBlocks());return!!t&&t.is("element","listItem")&&t.getAttribute("listType")==this.type}_checkEnabled(){if(this.value)return!0;const t=this.editor.model.document.selection,n=this.editor.model.schema,o=de(t.getSelectedBlocks());return!!o&&jp(o,n)}}function zp(l,t,n){const o=t?l[0]:l[l.length-1];if(o.is("element","listItem")){let r=o[t?"previousSibling":"nextSibling"],c=o.getAttribute("listIndent");for(;r&&r.is("element","listItem")&&r.getAttribute("listIndent")>=n;)c>r.getAttribute("listIndent")&&(c=r.getAttribute("listIndent")),r.getAttribute("listIndent")==c&&l[t?"unshift":"push"](r),r=r[t?"previousSibling":"nextSibling"]}}function jp(l,t){return t.checkChild(l.parent,"listItem")&&!t.isObject(l)}class $p extends lt{constructor(t,n){super(t),this._indentBy=n=="forward"?1:-1}refresh(){this.isEnabled=this._checkEnabled()}execute(){const t=this.editor.model,n=t.document;let o=Array.from(n.selection.getSelectedBlocks());t.change(r=>{const c=o[o.length-1];let u=c.nextSibling;for(;u&&u.name=="listItem"&&u.getAttribute("listIndent")>c.getAttribute("listIndent");)o.push(u),u=u.nextSibling;this._indentBy<0&&(o=o.reverse());for(const g of o){const m=g.getAttribute("listIndent")+this._indentBy;m<0?r.rename(g,"paragraph"):r.setAttribute("listIndent",m,g)}this.fire("_executeCleanup",o)})}_checkEnabled(){const t=de(this.editor.model.document.selection.getSelectedBlocks());if(!t||!t.is("element","listItem"))return!1;if(this._indentBy>0){const n=t.getAttribute("listIndent"),o=t.getAttribute("listType");let r=t.previousSibling;for(;r&&r.is("element","listItem")&&r.getAttribute("listIndent")>=n;){if(r.getAttribute("listIndent")==n)return r.getAttribute("listType")==o;r=r.previousSibling}return!1}return!0}}function AE(l,t){const n=t.mapper,o=t.writer,r=l.getAttribute("listType")=="numbered"?"ol":"ul",c=function(g){const m=g.createContainerElement("li");return m.getFillerOffset=CE,m}(o),u=o.createContainerElement(r,null);return o.insert(o.createPositionAt(u,0),c),n.bindElements(l,c),c}function Hp(l,t,n,o){const r=t.parent,c=n.mapper,u=n.writer;let g=c.toViewPosition(o.createPositionBefore(l));const m=qp(l.previousSibling,{sameIndent:!0,smallerIndent:!0,listIndent:l.getAttribute("listIndent")}),p=l.previousSibling;if(m&&m.getAttribute("listIndent")==l.getAttribute("listIndent")){const w=c.toViewElement(m);g=u.breakContainer(u.createPositionAfter(w))}else if(p&&p.name=="listItem"){g=c.toViewPosition(o.createPositionAt(p,"end"));const w=c.findMappedViewAncestor(g),_=function(v){for(const A of v.getChildren())if(A.name=="ul"||A.name=="ol")return A;return null}(w);g=_?u.createPositionBefore(_):u.createPositionAt(w,"end")}else g=c.toViewPosition(o.createPositionBefore(l));if(g=Wp(g),u.insert(g,r),p&&p.name=="listItem"){const w=c.toViewElement(p),_=u.createRange(u.createPositionAt(w,0),g).getWalker({ignoreElementEnd:!0});for(const v of _)if(v.item.is("element","li")){const A=u.breakContainer(u.createPositionBefore(v.item)),x=v.item.parent,E=u.createPositionAt(t,"end");Le(u,E.nodeBefore,E.nodeAfter),u.move(u.createRangeOn(x),E),_.position=A}}else{const w=r.nextSibling;if(w&&(w.is("element","ul")||w.is("element","ol"))){let _=null;for(const v of w.getChildren()){const A=c.toModelElement(v);if(!(A&&A.getAttribute("listIndent")>l.getAttribute("listIndent")))break;_=v}_&&(u.breakContainer(u.createPositionAfter(_)),u.move(u.createRangeOn(_.parent),u.createPositionAt(t,"end")))}}Le(u,r,r.nextSibling),Le(u,r.previousSibling,r)}function Le(l,t,n){return!t||!n||t.name!="ul"&&t.name!="ol"||t.name!=n.name||t.getAttribute("class")!==n.getAttribute("class")?null:l.mergeContainers(l.createPositionAfter(t))}function Wp(l){return l.getLastMatchingPosition(t=>t.item.is("uiElement"))}function qp(l,t){const n=!!t.sameIndent,o=!!t.smallerIndent,r=t.listIndent;let c=l;for(;c&&c.name=="listItem";){const u=c.getAttribute("listIndent");if(n&&r==u||o&&r>u)return c;c=t.direction==="forward"?c.nextSibling:c.previousSibling}return null}function Up(l,t,n,o){l.ui.componentFactory.add(t,r=>{const c=l.commands.get(t),u=new Mt(r);return u.set({label:n,icon:o,tooltip:!0,isToggleable:!0}),u.bind("isOn","isEnabled").to(c,"value","isEnabled"),u.on("execute",()=>{l.execute(t),l.editing.view.focus()}),u})}function CE(){const l=!this.isEmpty&&(this.getChild(0).name=="ul"||this.getChild(0).name=="ol");return this.isEmpty||l?0:qh.call(this)}function Gp(l){return(t,n,o)=>{const r=o.consumable;if(!r.test(n.item,"insert")||!r.test(n.item,"attribute:listType")||!r.test(n.item,"attribute:listIndent"))return;r.consume(n.item,"insert"),r.consume(n.item,"attribute:listType"),r.consume(n.item,"attribute:listIndent");const c=n.item;Hp(c,AE(c,o),o,l)}}function xE(l,t,n){if(!n.consumable.consume(t.item,"attribute:listType"))return;const o=n.mapper.toViewElement(t.item),r=n.writer;r.breakContainer(r.createPositionBefore(o)),r.breakContainer(r.createPositionAfter(o));const c=o.parent,u=t.attributeNewValue=="numbered"?"ol":"ul";r.rename(u,c)}function EE(l,t,n){const o=n.mapper.toViewElement(t.item).parent,r=n.writer;Le(r,o,o.nextSibling),Le(r,o.previousSibling,o);for(const c of t.item.getChildren())n.consumable.consume(c,"insert")}function Kp(l,t,n){if(t.item.name!="listItem"){let o=n.mapper.toViewPosition(t.range.start);const r=n.writer,c=[];for(;(o.parent.name=="ul"||o.parent.name=="ol")&&(o=r.breakContainer(o),o.parent.name=="li");){const u=o,g=r.createPositionAt(o.parent,"end");if(!u.isEqual(g)){const m=r.remove(r.createRange(u,g));c.push(m)}o=r.createPositionAfter(o.parent)}if(c.length>0){for(let u=0;u<c.length;u++){const g=o.nodeBefore;if(o=r.insert(o,c[u]).end,u>0){const m=Le(r,g,g.nextSibling);m&&m.parent==g&&o.offset--}}Le(r,o.nodeBefore,o.nodeAfter)}}}function TE(l,t,n){const o=n.mapper.toViewPosition(t.position),r=o.nodeBefore,c=o.nodeAfter;Le(n.writer,r,c)}function SE(l,t,n){if(n.consumable.consume(t.viewItem,{name:!0})){const o=n.writer,r=o.createElement("listItem"),c=function(m){let p=0,w=m.parent;for(;w;){if(w.is("element","li"))p++;else{const _=w.previousSibling;_&&_.is("element","li")&&p++}w=w.parent}return p}(t.viewItem);o.setAttribute("listIndent",c,r);const u=t.viewItem.parent&&t.viewItem.parent.name=="ol"?"numbered":"bulleted";if(o.setAttribute("listType",u,r),!n.safeInsert(r,t.modelCursor))return;const g=function(m,p,w){const{writer:_,schema:v}=w;let A=_.createPositionAfter(m);for(const x of p)if(x.name=="ul"||x.name=="ol")A=w.convertItem(x,A).modelCursor;else{const E=w.convertItem(x,_.createPositionAt(m,"end")),T=E.modelRange.start.nodeAfter;T&&T.is("element")&&!v.checkChild(m,T.name)&&(m=E.modelCursor.parent.is("element","listItem")?E.modelCursor.parent:ME(E.modelCursor),A=_.createPositionAfter(m))}return A}(r,t.viewItem.getChildren(),n);t.modelRange=o.createRange(t.modelCursor,g),n.updateConversionResult(r,t)}}function Yp(l,t,n){if(n.consumable.test(t.viewItem,{name:!0})){const o=Array.from(t.viewItem.getChildren());for(const r of o)!(r.is("element","li")||lo(r))&&r._remove()}}function PE(l,t,n){if(n.consumable.test(t.viewItem,{name:!0})){if(t.viewItem.childCount===0)return;const o=[...t.viewItem.getChildren()];let r=!1;for(const c of o)r&&!lo(c)&&c._remove(),lo(c)&&(r=!0)}}function Jp(l){return(t,n)=>{if(n.isPhantom)return;const o=n.modelPosition.nodeBefore;if(o&&o.is("element","listItem")){const r=n.mapper.toViewElement(o),c=r.getAncestors().find(lo),u=l.createPositionAt(r,0).getWalker();for(const g of u){if(g.type=="elementStart"&&g.item.is("element","li")){n.viewPosition=g.previousPosition;break}if(g.type=="elementEnd"&&g.item==c){n.viewPosition=g.nextPosition;break}}}}}function IE(l,[t,n]){let o,r=t.is("documentFragment")?t.getChild(0):t;if(o=n?this.createSelection(n):this.document.selection,r&&r.is("element","listItem")){const c=o.getFirstPosition();let u=null;if(c.parent.is("element","listItem")?u=c.parent:c.nodeBefore&&c.nodeBefore.is("element","listItem")&&(u=c.nodeBefore),u){const g=u.getAttribute("listIndent");if(g>0)for(;r&&r.is("element","listItem");)r._setAttribute("listIndent",r.getAttribute("listIndent")+g),r=r.nextSibling}}}function ME(l){const t=new kn({startPosition:l});let n;do n=t.next();while(!n.value.item.is("element","listItem"));return n.value.item}function Qp(l,t,n,o,r,c){const u=qp(t.nodeBefore,{sameIndent:!0,smallerIndent:!0,listIndent:l,foo:"b"}),g=r.mapper,m=r.writer,p=u?u.getAttribute("listIndent"):null;let w;if(u)if(p==l){const _=g.toViewElement(u).parent;w=m.createPositionAfter(_)}else{const _=c.createPositionAt(u,"end");w=g.toViewPosition(_)}else w=n;w=Wp(w);for(const _ of[...o.getChildren()])lo(_)&&(w=m.move(m.createRangeOn(_),w).end,Le(m,_,_.nextSibling),Le(m,_.previousSibling,_))}function lo(l){return l.is("element","ol")||l.is("element","ul")}class RE extends z{static get pluginName(){return"ListEditing"}static get requires(){return[ia,Bn]}init(){const t=this.editor;t.model.schema.register("listItem",{inheritAllFrom:"$block",allowAttributes:["listType","listIndent"]});const n=t.data,o=t.editing;var r;t.model.document.registerPostFixer(g=>function(m,p){const w=m.document.differ.getChanges(),_=new Map;let v=!1;for(const T of w)if(T.type=="insert"&&T.name=="listItem")A(T.position);else if(T.type=="insert"&&T.name!="listItem"){if(T.name!="$text"){const S=T.position.nodeAfter;S.hasAttribute("listIndent")&&(p.removeAttribute("listIndent",S),v=!0),S.hasAttribute("listType")&&(p.removeAttribute("listType",S),v=!0),S.hasAttribute("listStyle")&&(p.removeAttribute("listStyle",S),v=!0);for(const I of Array.from(m.createRangeIn(S)).filter(N=>N.item.is("element","listItem")))A(I.previousPosition)}A(T.position.getShiftedBy(T.length))}else T.type=="remove"&&T.name=="listItem"?A(T.position):(T.type=="attribute"&&T.attributeKey=="listIndent"||T.type=="attribute"&&T.attributeKey=="listType")&&A(T.range.start);for(const T of _.values())x(T),E(T);return v;function A(T){const S=T.nodeBefore;if(S&&S.is("element","listItem")){let I=S;if(_.has(I))return;for(let N=I.previousSibling;N&&N.is("element","listItem");N=I.previousSibling)if(I=N,_.has(I))return;_.set(S,I)}else{const I=T.nodeAfter;I&&I.is("element","listItem")&&_.set(I,I)}}function x(T){let S=0,I=null;for(;T&&T.is("element","listItem");){const N=T.getAttribute("listIndent");if(N>S){let j;I===null?(I=N-S,j=S):(I>N&&(I=N),j=N-I),p.setAttribute("listIndent",j,T),v=!0}else I=null,S=T.getAttribute("listIndent")+1;T=T.nextSibling}}function E(T){let S=[],I=null;for(;T&&T.is("element","listItem");){const N=T.getAttribute("listIndent");if(I&&I.getAttribute("listIndent")>N&&(S=S.slice(0,N+1)),N!=0)if(S[N]){const j=S[N];T.getAttribute("listType")!=j&&(p.setAttribute("listType",j,T),v=!0)}else S[N]=T.getAttribute("listType");I=T,T=T.nextSibling}}}(t.model,g)),o.mapper.registerViewToModelLength("li",nd),n.mapper.registerViewToModelLength("li",nd),o.mapper.on("modelToViewPosition",Jp(o.view)),o.mapper.on("viewToModelPosition",(r=t.model,(g,m)=>{const p=m.viewPosition,w=p.parent,_=m.mapper;if(w.name=="ul"||w.name=="ol"){if(p.isAtEnd){const v=_.toModelElement(p.nodeBefore),A=_.getModelLength(p.nodeBefore);m.modelPosition=r.createPositionBefore(v).getShiftedBy(A)}else{const v=_.toModelElement(p.nodeAfter);m.modelPosition=r.createPositionBefore(v)}g.stop()}else if(w.name=="li"&&p.nodeBefore&&(p.nodeBefore.name=="ul"||p.nodeBefore.name=="ol")){const v=_.toModelElement(w);let A=1,x=p.nodeBefore;for(;x&&lo(x);)A+=_.getModelLength(x),x=x.previousSibling;m.modelPosition=r.createPositionBefore(v).getShiftedBy(A),g.stop()}})),n.mapper.on("modelToViewPosition",Jp(o.view)),t.conversion.for("editingDowncast").add(g=>{g.on("insert",Kp,{priority:"high"}),g.on("insert:listItem",Gp(t.model)),g.on("attribute:listType:listItem",xE,{priority:"high"}),g.on("attribute:listType:listItem",EE,{priority:"low"}),g.on("attribute:listIndent:listItem",function(m){return(p,w,_)=>{if(!_.consumable.consume(w.item,"attribute:listIndent"))return;const v=_.mapper.toViewElement(w.item),A=_.writer;A.breakContainer(A.createPositionBefore(v)),A.breakContainer(A.createPositionAfter(v));const x=v.parent,E=x.previousSibling,T=A.createRangeOn(x);A.remove(T),E&&E.nextSibling&&Le(A,E,E.nextSibling),Qp(w.attributeOldValue+1,w.range.start,T.start,v,_,m),Hp(w.item,v,_,m);for(const S of w.item.getChildren())_.consumable.consume(S,"insert")}}(t.model)),g.on("remove:listItem",function(m){return(p,w,_)=>{const v=_.mapper.toViewPosition(w.position).getLastMatchingPosition(I=>!I.item.is("element","li")).nodeAfter,A=_.writer;A.breakContainer(A.createPositionBefore(v)),A.breakContainer(A.createPositionAfter(v));const x=v.parent,E=x.previousSibling,T=A.createRangeOn(x),S=A.remove(T);E&&E.nextSibling&&Le(A,E,E.nextSibling),Qp(_.mapper.toModelElement(v).getAttribute("listIndent")+1,w.position,T.start,v,_,m);for(const I of A.createRangeIn(S).getItems())_.mapper.unbindViewElement(I);p.stop()}}(t.model)),g.on("remove",TE,{priority:"low"})}),t.conversion.for("dataDowncast").add(g=>{g.on("insert",Kp,{priority:"high"}),g.on("insert:listItem",Gp(t.model))}),t.conversion.for("upcast").add(g=>{g.on("element:ul",Yp,{priority:"high"}),g.on("element:ol",Yp,{priority:"high"}),g.on("element:li",PE,{priority:"high"}),g.on("element:li",SE)}),t.model.on("insertContent",IE,{priority:"high"}),t.commands.add("numberedList",new Fp(t,"numbered")),t.commands.add("bulletedList",new Fp(t,"bulleted")),t.commands.add("indentList",new $p(t,"forward")),t.commands.add("outdentList",new $p(t,"backward"));const c=o.view.document;this.listenTo(c,"enter",(g,m)=>{const p=this.editor.model.document,w=p.selection.getLastPosition().parent;p.selection.isCollapsed&&w.name=="listItem"&&w.isEmpty&&(this.editor.execute("outdentList"),m.preventDefault(),g.stop())},{context:"li"}),this.listenTo(c,"delete",(g,m)=>{if(m.direction!=="backward")return;const p=this.editor.model.document.selection;if(!p.isCollapsed)return;const w=p.getFirstPosition();if(!w.isAtStart)return;const _=w.parent;_.name==="listItem"&&(_.previousSibling&&_.previousSibling.name==="listItem"||(this.editor.execute("outdentList"),m.preventDefault(),g.stop()))},{context:"li"});const u=g=>(m,p)=>{this.editor.commands.get(g).isEnabled&&(this.editor.execute(g),p())};t.keystrokes.set("Tab",u("indentList")),t.keystrokes.set("Shift+Tab",u("outdentList"))}afterInit(){const t=this.editor.commands,n=t.get("indent"),o=t.get("outdent");n&&n.registerChildCommand(t.get("indentList")),o&&o.registerChildCommand(t.get("outdentList"))}}function nd(l){let t=1;for(const n of l.getChildren())if(n.name=="ul"||n.name=="ol")for(const o of n.getChildren())t+=nd(o);return t}class OE extends z{static get pluginName(){return"ListUI"}init(){const t=this.editor.t;Up(this.editor,"numberedList",t("Numbered List"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM3.5 3v5H2V3.7H1v-1h2.5V3zM.343 17.857l2.59-3.257H2.92a.6.6 0 1 0-1.04 0H.302a2 2 0 1 1 3.995 0h-.001c-.048.405-.16.734-.333.988-.175.254-.59.692-1.244 1.312H4.3v1h-4l.043-.043zM7 14.75a.75.75 0 0 1 .75-.75h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75z"/></svg>'),Up(this.editor,"bulletedList",t("Bulleted List"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0C1 4.784 1.777 4 2.75 4c.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75C1.784 7.5 1 6.723 1 5.75zm6 9c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0c0-.966.777-1.75 1.75-1.75.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75-.966 0-1.75-.777-1.75-1.75z"/></svg>')}}function Xp(l,t){return o=>{o.on("attribute:url:media",n)};function n(o,r,c){if(!c.consumable.consume(r.item,o.name))return;const u=r.attributeNewValue,g=c.writer,m=c.mapper.toViewElement(r.item),p=[...m.getChildren()].find(_=>_.getCustomProperty("media-content"));g.remove(p);const w=l.getMediaViewElement(g,u,t);g.insert(g.createPositionAt(m,0),w)}}function Zp(l,t,n,o){const r=l.createContainerElement("figure",{class:"media"});return l.insert(l.createPositionAt(r,0),t.getMediaViewElement(l,n,o)),r}function tb(l){const t=l.getSelectedElement();return t&&t.is("element","media")?t:null}function eb(l,t,n){l.change(o=>{const r=o.createElement("media",{url:t});l.insertContent(r,n),o.setSelection(r,"on")})}class NE extends lt{refresh(){const t=this.editor.model,n=t.document.selection,o=tb(n);this.value=o?o.getAttribute("url"):null,this.isEnabled=function(r){const c=r.getSelectedElement();return!!c&&c.name==="media"}(n)||function(r,c){let u=ds(r,c).start.parent;return u.isEmpty&&!c.schema.isLimit(u)&&(u=u.parent),c.schema.checkChild(u,"media")}(n,t)}execute(t){const n=this.editor.model,o=n.document.selection,r=tb(o);r?n.change(c=>{c.setAttribute("url",t,r)}):eb(n,t,ds(o,n))}}class DE{constructor(t,n){const o=n.providers,r=n.extraProviders||[],c=new Set(n.removeProviders),u=o.concat(r).filter(g=>{const m=g.name;return m?!c.has(m):(Object(y.b)("media-embed-no-provider-name",{provider:g}),!1)});this.locale=t,this.providerDefinitions=u}hasMedia(t){return!!this._getMedia(t)}getMediaViewElement(t,n,o){return this._getMedia(n).getViewElement(t,o)}_getMedia(t){if(!t)return new nb(this.locale);t=t.trim();for(const n of this.providerDefinitions){const o=n.html,r=Kt(n.url);for(const c of r){const u=this._getUrlMatches(t,c);if(u)return new nb(this.locale,t,u,o)}}return null}_getUrlMatches(t,n){let o=t.match(n);if(o)return o;let r=t.replace(/^https?:\/\//,"");return o=r.match(n),o||(r=r.replace(/^www\./,""),o=r.match(n),o||null)}}class nb{constructor(t,n,o,r){this.url=this._getValidUrl(n),this._t=t.t,this._match=o,this._previewRenderer=r}getViewElement(t,n){const o={};let r;if(n.renderForEditingView||n.renderMediaPreview&&this.url&&this._previewRenderer){this.url&&(o["data-oembed-url"]=this.url),n.renderForEditingView&&(o.class="ck-media__wrapper");const c=this._getPreviewHtml(n);r=t.createRawElement("div",o,(u,g)=>{g.setContentOf(u,c)})}else this.url&&(o.url=this.url),r=t.createEmptyElement(n.elementName,o);return t.setCustomProperty("media-content",!0,r),r}_getPreviewHtml(t){return this._previewRenderer?this._previewRenderer(this._match):this.url&&t.renderForEditingView?this._getPlaceholderHtml():""}_getPlaceholderHtml(){const t=new Bg,n=new Xr;return t.text=this._t("Open media in new tab"),n.content='<svg viewBox="0 0 64 42" xmlns="http://www.w3.org/2000/svg"><path d="M47.426 17V3.713L63.102 0v19.389h-.001l.001.272c0 1.595-2.032 3.43-4.538 4.098-2.506.668-4.538-.083-4.538-1.678 0-1.594 2.032-3.43 4.538-4.098.914-.244 2.032-.565 2.888-.603V4.516L49.076 7.447v9.556A1.014 1.014 0 0 0 49 17h-1.574zM29.5 17h-8.343a7.073 7.073 0 1 0-4.657 4.06v3.781H3.3a2.803 2.803 0 0 1-2.8-2.804V8.63a2.803 2.803 0 0 1 2.8-2.805h4.082L8.58 2.768A1.994 1.994 0 0 1 10.435 1.5h8.985c.773 0 1.477.448 1.805 1.149l1.488 3.177H26.7c1.546 0 2.8 1.256 2.8 2.805V17zm-11.637 0H17.5a1 1 0 0 0-1 1v.05A4.244 4.244 0 1 1 17.863 17zm29.684 2c.97 0 .953-.048.953.889v20.743c0 .953.016.905-.953.905H19.453c-.97 0-.953.048-.953-.905V19.89c0-.937-.016-.889.97-.889h28.077zm-4.701 19.338V22.183H24.154v16.155h18.692zM20.6 21.375v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616V37.53H20.6zm24.233-16.155v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615V37.53h-1.615zM29.485 25.283a.4.4 0 0 1 .593-.35l9.05 4.977a.4.4 0 0 1 0 .701l-9.05 4.978a.4.4 0 0 1-.593-.35v-9.956z"/></svg>',n.viewBox="0 0 64 42",new ye({tag:"div",attributes:{class:"ck ck-reset_all ck-media__placeholder"},children:[{tag:"div",attributes:{class:"ck-media__placeholder__icon"},children:[n]},{tag:"a",attributes:{class:"ck-media__placeholder__url",target:"_blank",rel:"noopener noreferrer",href:this.url},children:[{tag:"span",attributes:{class:"ck-media__placeholder__url__text"},children:[this.url]},t]}]}).render().outerHTML}_getValidUrl(t){return t?t.match(/^https?/)?t:"https://"+t:null}}d(96);class ha extends z{static get pluginName(){return"MediaEmbedEditing"}constructor(t){super(t),t.config.define("mediaEmbed",{elementName:"oembed",providers:[{name:"dailymotion",url:/^dailymotion\.com\/video\/(\w+)/,html:n=>`<div style="position: relative; padding-bottom: 100%; height: 0; "><iframe src="https://www.dailymotion.com/embed/video/${n[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" width="480" height="270" allowfullscreen allow="autoplay"></iframe></div>`},{name:"spotify",url:[/^open\.spotify\.com\/(artist\/\w+)/,/^open\.spotify\.com\/(album\/\w+)/,/^open\.spotify\.com\/(track\/\w+)/],html:n=>`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 126%;"><iframe src="https://open.spotify.com/embed/${n[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe></div>`},{name:"youtube",url:[/^(?:m\.)?youtube\.com\/watch\?v=([\w-]+)/,/^(?:m\.)?youtube\.com\/v\/([\w-]+)/,/^youtube\.com\/embed\/([\w-]+)/,/^youtu\.be\/([\w-]+)/],html:n=>`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 56.2493%;"><iframe src="https://www.youtube.com/embed/${n[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div>`},{name:"vimeo",url:[/^vimeo\.com\/(\d+)/,/^vimeo\.com\/[^/]+\/[^/]+\/video\/(\d+)/,/^vimeo\.com\/album\/[^/]+\/video\/(\d+)/,/^vimeo\.com\/channels\/[^/]+\/(\d+)/,/^vimeo\.com\/groups\/[^/]+\/videos\/(\d+)/,/^vimeo\.com\/ondemand\/[^/]+\/(\d+)/,/^player\.vimeo\.com\/video\/(\d+)/],html:n=>`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 56.2493%;"><iframe src="https://player.vimeo.com/video/${n[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>`},{name:"instagram",url:/^instagram\.com\/p\/(\w+)/},{name:"twitter",url:/^twitter\.com/},{name:"googleMaps",url:[/^google\.com\/maps/,/^goo\.gl\/maps/,/^maps\.google\.com/,/^maps\.app\.goo\.gl/]},{name:"flickr",url:/^flickr\.com/},{name:"facebook",url:/^facebook\.com/}]}),this.registry=new DE(t.locale,t.config.get("mediaEmbed"))}init(){const t=this.editor,n=t.model.schema,o=t.t,r=t.conversion,c=t.config.get("mediaEmbed.previewsInData"),u=t.config.get("mediaEmbed.elementName"),g=this.registry;t.commands.add("mediaEmbed",new NE(t)),n.register("media",{isObject:!0,isBlock:!0,allowWhere:"$block",allowAttributes:["url"]}),r.for("dataDowncast").elementToElement({model:"media",view:(m,{writer:p})=>{const w=m.getAttribute("url");return Zp(p,g,w,{elementName:u,renderMediaPreview:w&&c})}}),r.for("dataDowncast").add(Xp(g,{elementName:u,renderMediaPreview:c})),r.for("editingDowncast").elementToElement({model:"media",view:(m,{writer:p})=>{const w=m.getAttribute("url");return function(_,v,A){return v.setCustomProperty("media",!0,_),Dc(_,v,{label:A})}(Zp(p,g,w,{elementName:u,renderForEditingView:!0}),p,o("media widget"))}}),r.for("editingDowncast").add(Xp(g,{elementName:u,renderForEditingView:!0})),r.for("upcast").elementToElement({view:m=>["oembed",u].includes(m.name)&&m.getAttribute("url")?{name:!0}:null,model:(m,{writer:p})=>{const w=m.getAttribute("url");if(g.hasMedia(w))return p.createElement("media",{url:w})}}).elementToElement({view:{name:"div",attributes:{"data-oembed-url":!0}},model:(m,{writer:p})=>{const w=m.getAttribute("data-oembed-url");if(g.hasMedia(w))return p.createElement("media",{url:w})}}).add(m=>{m.on("element:figure",function(p,w,_){if(!_.consumable.consume(w.viewItem,{name:!0,classes:"media"}))return;const{modelRange:v,modelCursor:A}=_.convertChildren(w.viewItem,w.modelCursor);w.modelRange=v,w.modelCursor=A,de(v.getItems())||_.consumable.revert(w.viewItem,{name:!0,classes:"media"})})})}}const LE=/^(?:http(s)?:\/\/)?[\w-]+\.[\w-.~:/?#[\]@!$&'()*+,;=%]+$/;class VE extends z{static get requires(){return[xm,Bn,Fm]}static get pluginName(){return"AutoMediaEmbed"}constructor(t){super(t),this._timeoutId=null,this._positionToInsert=null}init(){const t=this.editor,n=t.model.document;this.listenTo(t.plugins.get("ClipboardPipeline"),"inputTransformation",()=>{const o=n.selection.getFirstRange(),r=te.fromPosition(o.start);r.stickiness="toPrevious";const c=te.fromPosition(o.end);c.stickiness="toNext",n.once("change:data",()=>{this._embedMediaBetweenPositions(r,c),r.detach(),c.detach()},{priority:"high"})}),t.commands.get("undo").on("execute",()=>{this._timeoutId&&(Pt.window.clearTimeout(this._timeoutId),this._positionToInsert.detach(),this._timeoutId=null,this._positionToInsert=null)},{priority:"high"})}_embedMediaBetweenPositions(t,n){const o=this.editor,r=o.plugins.get(ha).registry,c=new on(t,n),u=c.getWalker({ignoreElementEnd:!0});let g="";for(const m of u)m.item.is("$textProxy")&&(g+=m.item.data);if(g=g.trim(),!g.match(LE)||!r.hasMedia(g))return void c.detach();o.commands.get("mediaEmbed").isEnabled?(this._positionToInsert=te.fromPosition(t),this._timeoutId=Pt.window.setTimeout(()=>{o.model.change(m=>{let p;this._timeoutId=null,m.remove(c),c.detach(),this._positionToInsert.root.rootName!=="$graveyard"&&(p=this._positionToInsert),eb(o.model,g,p),this._positionToInsert.detach(),this._positionToInsert=null}),o.plugins.get("Delete").requestUndoOnBackspace()},100)):c.detach()}}d(98);class BE extends st{constructor(t,n){super(n);const o=n.t;this.focusTracker=new Oe,this.keystrokes=new _n,this.set("mediaURLInputValue",""),this.urlInputView=this._createUrlInput(),this.saveButtonView=this._createButton(o("Save"),De.check,"ck-button-save"),this.saveButtonView.type="submit",this.saveButtonView.bind("isEnabled").to(this,"mediaURLInputValue",r=>!!r),this.cancelButtonView=this._createButton(o("Cancel"),De.cancel,"ck-button-cancel","cancel"),this._focusables=new di,this._focusCycler=new eo({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this._validators=t,this.setTemplate({tag:"form",attributes:{class:["ck","ck-media-form","ck-responsive-form"],tabindex:"-1"},children:[this.urlInputView,this.saveButtonView,this.cancelButtonView]}),wc(this)}render(){super.render(),_c({view:this}),[this.urlInputView,this.saveButtonView,this.cancelButtonView].forEach(n=>{this._focusables.add(n),this.focusTracker.add(n.element)}),this.keystrokes.listenTo(this.element);const t=n=>n.stopPropagation();this.keystrokes.set("arrowright",t),this.keystrokes.set("arrowleft",t),this.keystrokes.set("arrowup",t),this.keystrokes.set("arrowdown",t),this.listenTo(this.urlInputView.element,"selectstart",(n,o)=>{o.stopPropagation()},{priority:"high"})}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}get url(){return this.urlInputView.fieldView.element.value.trim()}set url(t){this.urlInputView.fieldView.element.value=t.trim()}isValid(){this.resetFormStatus();for(const t of this._validators){const n=t(this);if(n)return this.urlInputView.errorText=n,!1}return!0}resetFormStatus(){this.urlInputView.errorText=null,this.urlInputView.infoText=this._urlInputViewInfoDefault}_createUrlInput(){const t=this.locale.t,n=new Ec(this.locale,Tc),o=n.fieldView;return this._urlInputViewInfoDefault=t("Paste the media URL in the input."),this._urlInputViewInfoTip=t("Tip: Paste the URL into the content to embed faster."),n.label=t("Media URL"),n.infoText=this._urlInputViewInfoDefault,o.on("input",()=>{n.infoText=o.element.value?this._urlInputViewInfoTip:this._urlInputViewInfoDefault,this.mediaURLInputValue=o.element.value.trim()}),n}_createButton(t,n,o,r){const c=new Mt(this.locale);return c.set({label:t,icon:n,tooltip:!0}),c.extendTemplate({attributes:{class:o}}),r&&c.delegate("execute").to(this,r),c}}class FE extends z{static get requires(){return[ha]}static get pluginName(){return"MediaEmbedUI"}init(){const t=this.editor,n=t.commands.get("mediaEmbed"),o=t.plugins.get(ha).registry;t.ui.componentFactory.add("mediaEmbed",r=>{const c=ui(r),u=new BE(function(g,m){return[p=>{if(!p.url.length)return g("The URL must not be empty.")},p=>{if(!m.hasMedia(p.url))return g("This media URL is not supported.")}]}(t.t,o),t.locale);return this._setUpDropdown(c,u,n,t),this._setUpForm(c,u,n),c})}_setUpDropdown(t,n,o){const r=this.editor,c=r.t,u=t.buttonView;function g(){r.editing.view.focus(),t.isOpen=!1}t.bind("isEnabled").to(o),t.panelView.children.add(n),u.set({label:c("Insert media"),icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M18.68 3.03c.6 0 .59-.03.59.55v12.84c0 .59.01.56-.59.56H1.29c-.6 0-.59.03-.59-.56V3.58c0-.58-.01-.55.6-.55h17.38zM15.77 15V5H4.2v10h11.57zM2 4v1h1V4H2zm0 2v1h1V6H2zm0 2v1h1V8H2zm0 2v1h1v-1H2zm0 2v1h1v-1H2zm0 2v1h1v-1H2zM17 4v1h1V4h-1zm0 2v1h1V6h-1zm0 2v1h1V8h-1zm0 2v1h1v-1h-1zm0 2v1h1v-1h-1zm0 2v1h1v-1h-1zM7.5 7.177a.4.4 0 0 1 .593-.351l5.133 2.824a.4.4 0 0 1 0 .7l-5.133 2.824a.4.4 0 0 1-.593-.35V7.176v.001z"/></svg>',tooltip:!0}),u.on("open",()=>{n.disableCssTransitions(),n.url=o.value||"",n.urlInputView.fieldView.select(),n.focus(),n.enableCssTransitions()},{priority:"low"}),t.on("submit",()=>{n.isValid()&&(r.execute("mediaEmbed",n.url),g())}),t.on("change:isOpen",()=>n.resetFormStatus()),t.on("cancel",()=>g())}_setUpForm(t,n,o){n.delegate("submit","cancel").to(t),n.urlInputView.bind("value").to(o,"value"),n.urlInputView.bind("isReadOnly").to(o,"isEnabled",r=>!r)}}d(100);function zE(l,t){if(!l.childCount)return;const n=new oo(l.document),o=function(u,g){const m=g.createRangeIn(u),p=new tn({name:/^p|h\d+$/,styles:{"mso-list":/.*/}}),w=[];for(const _ of m)if(_.type==="elementStart"&&p.match(_.item)){const v=$E(_.item);w.push({element:_.item,id:v.id,order:v.order,indent:v.indent})}return w}(l,n);if(!o.length)return;let r=null,c=1;o.forEach((u,g)=>{const m=function(x,E){if(!x)return!0;if(x.id!==E.id)return E.indent-x.indent!=1;const T=E.element.previousSibling;if(!T)return!0;return S=T,!(S.is("element","ol")||S.is("element","ul"));var S}(o[g-1],u),p=m?null:o[g-1],w=(v=u,(_=p)?v.indent-_.indent:v.indent-1);var _,v;if(m&&(r=null,c=1),!r||w!==0){const x=function(E,T){const S=new RegExp(`@list l${E.id}:level${E.indent}\\s*({[^}]*)`,"gi"),I=/mso-level-number-format:([^;]{0,100});/gi,N=S.exec(T);let j="decimal",X="ol";if(N&&N[1]){const vt=I.exec(N[1]);if(vt&&vt[1]&&(j=vt[1].trim(),X=j!=="bullet"&&j!=="image"?"ol":"ul"),j==="bullet"){const dt=function(re){const ue=function(Ve){if(Ve.getChild(0).is("$text"))return null;for(const Ge of Ve.getChildren()){if(!Ge.is("element","span"))continue;const cn=Ge.getChild(0);return cn.is("$text")?cn:cn.getChild(0)}}(re);if(!ue)return null;const he=ue._data;return he==="o"?"circle":he==="·"?"disc":he==="§"?"square":null}(E.element);dt&&(j=dt)}}return{type:X,style:jE(j)}}(u,t);if(r){if(u.indent>c){const E=r.getChild(r.childCount-1),T=E.getChild(E.childCount-1);r=ib(x,T,n),c+=1}else if(u.indent<c){const E=c-u.indent;r=function(T,S){const I=T.getAncestors({parentFirst:!0});let N=null,j=0;for(const X of I)if(X.name!=="ul"&&X.name!=="ol"||j++,j===S){N=X;break}return N}(r,E),c=parseInt(u.indent)}}else r=ib(x,u.element,n);u.indent<=c&&(r.is("element",x.type)||(r=n.rename(x.type,r)))}const A=function(x,E){return function(T,S){const I=new tn({name:"span",styles:{"mso-list":"Ignore"}}),N=S.createRangeIn(T);for(const j of N)j.type==="elementStart"&&I.match(j.item)&&S.remove(j.item)}(x,E),E.rename("li",x)}(u.element,n);n.appendChild(A,r)})}function jE(l){switch(l){case"arabic-leading-zero":return"decimal-leading-zero";case"alpha-upper":return"upper-alpha";case"alpha-lower":return"lower-alpha";case"roman-upper":return"upper-roman";case"roman-lower":return"lower-roman";case"circle":case"disc":case"square":return l;default:return null}}function ib(l,t,n){const o=t.parent,r=n.createElement(l.type),c=o.getChildIndex(t)+1;return n.insertChild(c,r,o),l.style&&n.setStyle("list-style-type",l.style,r),r}function $E(l){const t={},n=l.getStyle("mso-list");if(n){const o=n.match(/(^|\s{1,100})l(\d+)/i),r=n.match(/\s{0,100}lfo(\d+)/i),c=n.match(/\s{0,100}level(\d+)/i);o&&r&&c&&(t.id=o[2],t.order=r[1],t.indent=c[1])}return t}const HE=/id=("|')docs-internal-guid-[-0-9a-f]+("|')/i;class WE{constructor(t){this.document=t}isActive(t){return HE.test(t)}execute(t){const n=new oo(this.document),{body:o}=t._parsedData;(function(r,c){for(const u of r.getChildren())if(u.is("element","b")&&u.getStyle("font-weight")==="normal"){const g=r.getChildIndex(u);c.remove(u),c.insertChild(g,u.getChildren(),r)}})(o,n),function(r,c){for(const u of c.createRangeIn(r)){const g=u.item;if(g.is("element","li")){const m=g.getChild(0);m&&m.is("element","p")&&c.unwrapElement(m)}}}(o,n),t.content=o}}function qE(l,t){if(!l.childCount)return;const n=new oo;(function(r,c,u){const g=u.createRangeIn(c),m=new tn({name:"img"}),p=[];for(const w of g)if(m.match(w.item)){const _=w.item,v=_.getAttribute("v:shapes")?_.getAttribute("v:shapes").split(" "):[];v.length&&v.every(A=>r.indexOf(A)>-1)?p.push(_):_.getAttribute("src")||p.push(_)}for(const w of p)u.remove(w)})(function(r,c){const u=c.createRangeIn(r),g=new tn({name:/v:(.+)/}),m=[];for(const p of u){if(p.type!="elementStart")continue;const w=p.item,_=w.previousSibling&&w.previousSibling.name||null;g.match(w)&&w.getAttribute("o:gfxdata")&&_!=="v:shapetype"&&m.push(p.item.getAttribute("id"))}return m}(l,n),l,n),function(r,c){const u=c.createRangeIn(r),g=new tn({name:/v:(.+)/}),m=[];for(const p of u)p.type=="elementStart"&&g.match(p.item)&&m.push(p.item);for(const p of m)c.remove(p)}(l,n);const o=function(r,c){const u=c.createRangeIn(r),g=new tn({name:"img"}),m=[];for(const p of u)g.match(p.item)&&p.item.getAttribute("src").startsWith("file://")&&m.push(p.item);return m}(l,n);o.length&&function(r,c,u){if(r.length===c.length)for(let m=0;m<r.length;m++){const p=`data:${c[m].type};base64,${g=c[m].hex,btoa(g.match(/\w{2}/g).map(w=>String.fromCharCode(parseInt(w,16))).join(""))}`;u.setAttribute("src",p,r[m])}var g}(o,function(r){if(!r)return[];const c=/{\\pict[\s\S]+?\\bliptag-?\d+(\\blipupi-?\d+)?({\\\*\\blipuid\s?[\da-fA-F]+)?[\s}]*?/,u=new RegExp("(?:("+c.source+"))([\\da-fA-F\\s]+)\\}","g"),g=r.match(u),m=[];if(g)for(const p of g){let w=!1;p.includes("\\pngblip")?w="image/png":p.includes("\\jpegblip")&&(w="image/jpeg"),w&&m.push({hex:p.replace(c,"").replace(/[^\da-fA-F]/g,""),type:w})}return m}(t),n)}const UE=/<meta\s*name="?generator"?\s*content="?microsoft\s*word\s*\d+"?\/?>/i,GE=/xmlns:o="urn:schemas-microsoft-com/i;class KE{constructor(t){this.document=t}isActive(t){return UE.test(t)||GE.test(t)}execute(t){const{body:n,stylesString:o}=t._parsedData;zE(n,o),qE(n,t.dataTransfer.getData("text/rtf")),t.content=n}}function ob(l){return l.replace(/<span(?: class="Apple-converted-space"|)>(\s+)<\/span>/g,(t,n)=>n.length===1?" ":Array(n.length+1).join("  ").substr(0,n.length))}function YE(l,t){const n=new DOMParser,o=function(m){return ob(ob(m)).replace(/(<span\s+style=['"]mso-spacerun:yes['"]>[^\S\r\n]*?)[\r\n]+([^\S\r\n]*<\/span>)/g,"$1$2").replace(/<span\s+style=['"]mso-spacerun:yes['"]><\/span>/g,"").replace(/ <\//g," </").replace(/ <o:p><\/o:p>/g," <o:p></o:p>").replace(/<o:p>(&nbsp;|\u00A0)<\/o:p>/g,"").replace(/>([^\S\r\n]*[\r\n]\s*)</g,"><")}(function(m){const p=m.indexOf("</body>");if(p<0)return m;const w=m.indexOf("</html>",p+7);return m.substring(0,p+7)+(w>=0?m.substring(w):"")}(l=l.replace(/<!--\[if gte vml 1]>/g,""))),r=n.parseFromString(o,"text/html");(function(m){m.querySelectorAll("span[style*=spacerun]").forEach(p=>{const w=p.innerText.length||0;p.innerHTML=Array(w+1).join("  ").substr(0,w)})})(r);const c=r.body.innerHTML,u=function(m,p){const w=new es(p),_=new Fr(w,{renderingMode:"data"}),v=m.createDocumentFragment(),A=m.body.childNodes;for(;A.length>0;)v.appendChild(A[0]);return _.domToView(v,{skipComments:!0})}(r,t),g=function(m){const p=[],w=[],_=Array.from(m.getElementsByTagName("style"));for(const v of _)v.sheet&&v.sheet.cssRules&&v.sheet.cssRules.length&&(p.push(v.sheet),w.push(v.innerHTML));return{styles:p,stylesString:w.join(" ")}}(r);return{body:u,bodyString:c,styles:g.styles,stylesString:g.stylesString}}function Vt(l,t,n,o,r=1){t>r?o.setAttribute(l,t,n):o.removeAttribute(l,n)}function gi(l,t,n={}){const o=l.createElement("tableCell",n);return l.insertElement("paragraph",o),l.insert(o,t),o}function id(l,t){const n=t.parent.parent,o=parseInt(n.getAttribute("headingColumns")||0),{column:r}=l.getCellLocation(t);return!!o&&r<o}function JE(){return l=>{l.on("element:table",(t,n,o)=>{const r=n.viewItem;if(!o.consumable.test(r,{name:!0}))return;const{rows:c,headingRows:u,headingColumns:g}=function(w){const _={headingRows:0,headingColumns:0},v=[],A=[];let x;for(const E of Array.from(w.getChildren()))if(E.name==="tbody"||E.name==="thead"||E.name==="tfoot"){E.name!=="thead"||x||(x=E);const T=Array.from(E.getChildren()).filter(S=>S.is("element","tr"));for(const S of T)if(S.parent.name==="thead"&&S.parent===x)_.headingRows++,v.push(S);else{A.push(S);const I=QE(S);I>_.headingColumns&&(_.headingColumns=I)}}return _.rows=[...v,...A],_}(r),m={};g&&(m.headingColumns=g),u&&(m.headingRows=u);const p=o.writer.createElement("table",m);if(o.safeInsert(p,n.modelCursor)){if(o.consumable.consume(r,{name:!0}),c.forEach(w=>o.convertItem(w,o.writer.createPositionAt(p,"end"))),o.convertChildren(r,o.writer.createPositionAt(p,"end")),p.isEmpty){const w=o.writer.createElement("tableRow");o.writer.insert(w,o.writer.createPositionAt(p,"end")),gi(o.writer,o.writer.createPositionAt(w,"end"))}o.updateConversionResult(p,n)}})}}function sb(l){return t=>{t.on("element:"+l,(n,o,r)=>{if(o.modelRange&&o.viewItem.isEmpty){const c=o.modelRange.start.nodeAfter,u=r.writer.createPositionAt(c,0);r.writer.insertElement("paragraph",u)}},{priority:"low"})}}function QE(l){let t=0,n=0;const o=Array.from(l.getChildren()).filter(r=>r.name==="th"||r.name==="td");for(;n<o.length&&o[n].name==="th";){const r=o[n];t+=parseInt(r.getAttribute("colspan")||1),n++}return t}class ft{constructor(t,n={}){this._table=t,this._startRow=n.row!==void 0?n.row:n.startRow||0,this._endRow=n.row!==void 0?n.row:n.endRow,this._startColumn=n.column!==void 0?n.column:n.startColumn||0,this._endColumn=n.column!==void 0?n.column:n.endColumn,this._includeAllSlots=!!n.includeAllSlots,this._skipRows=new Set,this._row=0,this._rowIndex=0,this._column=0,this._cellIndex=0,this._spannedCells=new Map,this._nextCellAtColumn=-1}[Symbol.iterator](){return this}next(){const t=this._table.getChild(this._rowIndex);if(!t||this._isOverEndRow())return{done:!0};if(!t.is("element","tableRow"))return this._rowIndex++,this.next();if(this._isOverEndColumn())return this._advanceToNextRow();let n=null;const o=this._getSpanned();if(o)this._includeAllSlots&&!this._shouldSkipSlot()&&(n=this._formatOutValue(o.cell,o.row,o.column));else{const r=t.getChild(this._cellIndex);if(!r)return this._advanceToNextRow();const c=parseInt(r.getAttribute("colspan")||1),u=parseInt(r.getAttribute("rowspan")||1);(c>1||u>1)&&this._recordSpans(r,u,c),this._shouldSkipSlot()||(n=this._formatOutValue(r)),this._nextCellAtColumn=this._column+c}return this._column++,this._column==this._nextCellAtColumn&&this._cellIndex++,n||this.next()}skipRow(t){this._skipRows.add(t)}_advanceToNextRow(){return this._row++,this._rowIndex++,this._column=0,this._cellIndex=0,this._nextCellAtColumn=-1,this.next()}_isOverEndRow(){return this._endRow!==void 0&&this._row>this._endRow}_isOverEndColumn(){return this._endColumn!==void 0&&this._column>this._endColumn}_formatOutValue(t,n=this._row,o=this._column){return{done:!1,value:new XE(this,t,n,o)}}_shouldSkipSlot(){const t=this._skipRows.has(this._row),n=this._row<this._startRow,o=this._column<this._startColumn,r=this._endColumn!==void 0&&this._column>this._endColumn;return t||n||o||r}_getSpanned(){const t=this._spannedCells.get(this._row);return t&&t.get(this._column)||null}_recordSpans(t,n,o){const r={cell:t,row:this._row,column:this._column};for(let c=this._row;c<this._row+n;c++)for(let u=this._column;u<this._column+o;u++)c==this._row&&u==this._column||this._markSpannedCell(c,u,r)}_markSpannedCell(t,n,o){this._spannedCells.has(t)||this._spannedCells.set(t,new Map),this._spannedCells.get(t).set(n,o)}}class XE{constructor(t,n,o,r){this.cell=n,this.row=t._row,this.column=t._column,this.cellAnchorRow=o,this.cellAnchorColumn=r,this._cellIndex=t._cellIndex,this._rowIndex=t._rowIndex,this._table=t._table}get isAnchor(){return this.row===this.cellAnchorRow&&this.column===this.cellAnchorColumn}get cellWidth(){return parseInt(this.cell.getAttribute("colspan")||1)}get cellHeight(){return parseInt(this.cell.getAttribute("rowspan")||1)}get rowIndex(){return this._rowIndex}getPositionBefore(){return this._table.root.document.model.createPositionAt(this._table.getChild(this.row),this._cellIndex)}}function rb(l={}){return t=>t.on("insert:table",(n,o,r)=>{const c=o.item;if(!r.consumable.consume(c,"insert"))return;r.consumable.consume(c,"attribute:headingRows:table"),r.consumable.consume(c,"attribute:headingColumns:table");const u=l&&l.asWidget,g=r.writer.createContainerElement("figure",{class:"table"}),m=r.writer.createContainerElement("table");let p;var w,_;r.writer.insert(r.writer.createPositionAt(g,0),m),u&&(w=g,(_=r.writer).setCustomProperty("table",!0,w),p=Dc(w,_,{hasSelectionHandle:!0}));const v=new ft(c),A={headingRows:c.getAttribute("headingRows")||0,headingColumns:c.getAttribute("headingColumns")||0},x=new Map;for(const T of v){const{row:S,cell:I}=T,N=c.getChild(S),j=x.get(S)||sd(m,N,S,A,r);x.set(S,j),r.consumable.consume(I,"insert"),od(T,A,r.writer.createPositionAt(j,"end"),r,l)}for(const T of c.getChildren()){const S=T.index;T.is("element","tableRow")&&!x.has(S)&&x.set(S,sd(m,T,S,A,r))}const E=r.mapper.toViewPosition(o.range.start);r.mapper.bindElements(c,u?p:g),r.writer.insert(E,u?p:g)})}function ZE(l,t){const{writer:n}=t;if(l.parent.is("element","tableCell"))return ab(l)?n.createContainerElement("span",{class:"ck-table-bogus-paragraph"}):n.createContainerElement("p")}function ab(l){return l.parent.childCount===1&&!ub(l)}function tT(l,t,n){const{cell:o}=l,r=lb(l,t),c=n.mapper.toViewElement(o);c&&c.name!==r&&function(u,g,m){const p=m.writer,w=m.mapper.toViewElement(u),_=Lc(p.createEditableElement(g,w.getAttributes()),p);p.insert(p.createPositionAfter(w),_),p.move(p.createRangeIn(w),p.createPositionAt(_,0)),p.remove(p.createRangeOn(w)),m.mapper.unbindViewElement(w),m.mapper.bindElements(u,_)}(o,r,n)}function od(l,t,n,o,r){const c=r&&r.asWidget,u=lb(l,t),g=c?Lc(o.writer.createEditableElement(u),o.writer):o.writer.createContainerElement(u),m=l.cell,p=m.getChild(0),w=m.childCount===1&&p.name==="paragraph";if(o.writer.insert(n,g),o.mapper.bindElements(m,g),!c&&w&&!ub(p)){const _=m.getChild(0);o.consumable.consume(_,"insert"),o.mapper.bindElements(_,g)}}function sd(l,t,n,o,r){r.consumable.consume(t,"insert");const c=t.isEmpty?r.writer.createEmptyElement("tr"):r.writer.createContainerElement("tr");r.mapper.bindElements(t,c);const u=o.headingRows,g=function(w,_,v){return cb(w,_)||function(x,E,T){const S=T.writer.createContainerElement(x),I=T.writer.createPositionAt(E,x=="tbody"?"end":0);return T.writer.insert(I,S),S}(w,_,v)}(function(w,_){return w<_.headingRows?"thead":"tbody"}(n,o),l,r),m=u>0&&n>=u?n-u:n,p=r.writer.createPositionAt(g,m);return r.writer.insert(p,c),c}function lb(l,t){const{row:n,column:o}=l,{headingColumns:r,headingRows:c}=t;return c&&c>n||r&&r>o?"th":"td"}function cb(l,t){for(const n of t.getChildren())if(n.name==l)return n}function db(l,t,n){const o=cb(l,t);o&&o.childCount===0&&n.writer.remove(n.writer.createRangeOn(o))}function ub(l){return!![...l.getAttributeKeys()].length}class eT extends lt{refresh(){const t=this.editor.model,n=t.document.selection,o=t.schema;this.isEnabled=function(r,c){const u=r.getFirstPosition().parent,g=u===u.root?u:u.parent;return c.checkChild(g,"table")}(n,o)}execute(t={}){const n=this.editor.model,o=n.document.selection,r=this.editor.plugins.get("TableUtils"),c=this.editor.config.get("table"),u=ds(o,n),g=c.defaultHeadings.rows,m=c.defaultHeadings.columns;t.headingRows===void 0&&g&&(t.headingRows=g),t.headingColumns===void 0&&m&&(t.headingColumns=m),n.change(p=>{const w=r.createTable(p,t);n.insertContent(w,u),p.setSelection(p.createPositionAt(w.getNodeByPath([0,0,0]),0))})}}function co(l){const t=[];for(const n of hb(l.getRanges())){const o=n.getContainedElement();o&&o.is("element","tableCell")&&t.push(o)}return t}function fs(l){const t=[];for(const n of l.getRanges()){const o=n.start.findAncestor("tableCell");o&&t.push(o)}return t}function Ut(l){const t=co(l);return t.length?t:fs(l)}function zn(l){return fb(l.map(t=>t.parent.index))}function uo(l){const t=l[0].findAncestor("table");return fb([...new ft(t)].filter(n=>l.includes(n.cell)).map(n=>n.column))}function rd(l,t){if(l.length<2||!function(c){const u=c[0].findAncestor("table"),g=zn(c),m=parseInt(u.getAttribute("headingRows")||0);if(!gb(g,m))return!1;const p=parseInt(u.getAttribute("headingColumns")||0);return gb(uo(c),p)}(l))return!1;const n=new Set,o=new Set;let r=0;for(const c of l){const{row:u,column:g}=t.getCellLocation(c),m=parseInt(c.getAttribute("rowspan")||1),p=parseInt(c.getAttribute("colspan")||1);n.add(u),o.add(g),m>1&&n.add(u+m-1),p>1&&o.add(g+p-1),r+=m*p}return function(c,u){const g=Array.from(c.values()),m=Array.from(u.values()),p=Math.max(...g),w=Math.min(...g),_=Math.max(...m),v=Math.min(...m);return(p-w+1)*(_-v+1)}(n,o)==r}function hb(l){return Array.from(l).sort(nT)}function fb(l){const t=l.sort((n,o)=>n-o);return{first:t[0],last:t[t.length-1]}}function nT(l,t){const n=l.start,o=t.start;return n.isBefore(o)?-1:1}function gb({first:l,last:t},n){return l<n==t<n}class mb extends lt{constructor(t,n={}){super(t),this.order=n.order||"below"}refresh(){const t=!!Ut(this.editor.model.document.selection).length;this.isEnabled=t}execute(){const t=this.editor,n=t.model.document.selection,o=t.plugins.get("TableUtils"),r=this.order==="above",c=Ut(n),u=zn(c),g=r?u.first:u.last,m=c[0].findAncestor("table");o.insertRows(m,{at:r?g:g+1,copyStructureFromAbove:!r})}}class pb extends lt{constructor(t,n={}){super(t),this.order=n.order||"right"}refresh(){const t=!!Ut(this.editor.model.document.selection).length;this.isEnabled=t}execute(){const t=this.editor,n=t.model.document.selection,o=t.plugins.get("TableUtils"),r=this.order==="left",c=Ut(n),u=uo(c),g=r?u.first:u.last,m=c[0].findAncestor("table");o.insertColumns(m,{columns:1,at:r?g:g+1})}}class bb extends lt{constructor(t,n={}){super(t),this.direction=n.direction||"horizontally"}refresh(){const t=Ut(this.editor.model.document.selection);this.isEnabled=t.length===1}execute(){const t=Ut(this.editor.model.document.selection)[0],n=this.direction==="horizontally",o=this.editor.plugins.get("TableUtils");n?o.splitCellHorizontally(t,2):o.splitCellVertically(t,2)}}function wb(l,t,n){const{startRow:o,startColumn:r,endRow:c,endColumn:u}=t,g=n.createElement("table"),m=c-o+1;for(let w=0;w<m;w++)n.insertElement("tableRow",g,"end");const p=[...new ft(l,{startRow:o,endRow:c,startColumn:r,endColumn:u,includeAllSlots:!0})];for(const{row:w,column:_,cell:v,isAnchor:A,cellAnchorRow:x,cellAnchorColumn:E}of p){const T=w-o,S=g.getChild(T);if(A){const I=n.cloneElement(v);n.append(I,S),Ab(I,w,_,c,u,n)}else(x<o||E<r)&&gi(n,n.createPositionAt(S,"end"))}return function(w,_,v,A,x){const E=parseInt(_.getAttribute("headingRows")||0);E>0&&Vt("headingRows",E-v,w,x,0);const T=parseInt(_.getAttribute("headingColumns")||0);T>0&&Vt("headingColumns",T-A,w,x,0)}(g,l,o,r,n),g}function _b(l,t,n=0){const o=[],r=new ft(l,{startRow:n,endRow:t-1});for(const c of r){const{row:u,cellHeight:g}=c,m=u+g-1;u<t&&t<=m&&o.push(c)}return o}function kb(l,t,n){const o=l.parent,r=o.parent,c=o.index,u=t-c,g={},m=parseInt(l.getAttribute("rowspan"))-u;m>1&&(g.rowspan=m);const p=parseInt(l.getAttribute("colspan")||1);p>1&&(g.colspan=p);const w=c+u,_=[...new ft(r,{startRow:c,endRow:w,includeAllSlots:!0})];let v,A=null;for(const x of _){const{row:E,column:T,cell:S}=x;S===l&&v===void 0&&(v=T),v!==void 0&&v===T&&E===w&&(A=gi(n,x.getPositionBefore(),g))}return Vt("rowspan",u,l,n),A}function vb(l,t){const n=[],o=new ft(l);for(const r of o){const{column:c,cellWidth:u}=r,g=c+u-1;c<t&&t<=g&&n.push(r)}return n}function yb(l,t,n,o){const r=n-t,c={},u=parseInt(l.getAttribute("colspan"))-r;u>1&&(c.colspan=u);const g=parseInt(l.getAttribute("rowspan")||1);g>1&&(c.rowspan=g);const m=gi(o,o.createPositionAfter(l),c);return Vt("colspan",r,l,o),m}function Ab(l,t,n,o,r,c){const u=parseInt(l.getAttribute("colspan")||1),g=parseInt(l.getAttribute("rowspan")||1);n+u-1>r&&Vt("colspan",r-n+1,l,c,1),t+g-1>o&&Vt("rowspan",o-t+1,l,c,1)}function ad(l,t){const n=t.getColumns(l),o=new Array(n).fill(0);for(const{column:c}of new ft(l))o[c]++;const r=o.reduce((c,u,g)=>u?c:[...c,g],[]);if(r.length>0){const c=r[r.length-1];return t.removeColumns(l,{at:c}),!0}return!1}function ld(l,t){const n=[],o=t.getRows(l);for(let r=0;r<o;r++)l.getChild(r).isEmpty&&n.push(r);if(n.length>0){const r=n[n.length-1];return t.removeRows(l,{at:r}),!0}return!1}function cd(l,t){ad(l,t)||ld(l,t)}function Cb(l,t){const n=Array.from(new ft(l,{startColumn:t.firstColumn,endColumn:t.lastColumn,row:t.lastRow}));if(n.every(({cellHeight:r})=>r===1))return t.lastRow;const o=n[0].cellHeight-1;return t.lastRow+o}function xb(l,t){const n=Array.from(new ft(l,{startRow:t.firstRow,endRow:t.lastRow,column:t.lastColumn}));if(n.every(({cellWidth:r})=>r===1))return t.lastColumn;const o=n[0].cellWidth-1;return t.lastColumn+o}class fa extends lt{constructor(t,n){super(t),this.direction=n.direction,this.isHorizontal=this.direction=="right"||this.direction=="left"}refresh(){const t=this._getMergeableCell();this.value=t,this.isEnabled=!!t}execute(){const t=this.editor.model,n=fs(t.document.selection)[0],o=this.value,r=this.direction;t.change(c=>{const u=r=="right"||r=="down",g=u?n:o,m=u?o:n,p=m.parent;(function(x,E,T){Eb(x)||(Eb(E)&&T.remove(T.createRangeIn(E)),T.move(T.createRangeIn(x),T.createPositionAt(E,"end"))),T.remove(x)})(m,g,c);const w=this.isHorizontal?"colspan":"rowspan",_=parseInt(n.getAttribute(w)||1),v=parseInt(o.getAttribute(w)||1);c.setAttribute(w,_+v,g),c.setSelection(c.createRangeIn(g));const A=this.editor.plugins.get("TableUtils");cd(p.findAncestor("table"),A)})}_getMergeableCell(){const t=fs(this.editor.model.document.selection)[0];if(!t)return;const n=this.editor.plugins.get("TableUtils"),o=this.isHorizontal?function(u,g,m){const p=u.parent.parent,w=g=="right"?u.nextSibling:u.previousSibling,_=(p.getAttribute("headingColumns")||0)>0;if(!w)return;const v=g=="right"?u:w,A=g=="right"?w:u,{column:x}=m.getCellLocation(v),{column:E}=m.getCellLocation(A),T=parseInt(v.getAttribute("colspan")||1),S=id(m,v),I=id(m,A);if(!(_&&S!=I))return x+T===E?w:void 0}(t,this.direction,n):function(u,g,m){const p=u.parent,w=p.parent,_=w.getChildIndex(p);if(g=="down"&&_===m.getRows(w)-1||g=="up"&&_===0)return;const v=parseInt(u.getAttribute("rowspan")||1),A=w.getAttribute("headingRows")||0,x=g=="down"&&_+v===A,E=g=="up"&&_===A;if(A&&(x||E))return;const T=parseInt(u.getAttribute("rowspan")||1),S=g=="down"?_+T:_,I=[...new ft(w,{endRow:S})],N=I.find(X=>X.cell===u).column,j=I.find(({row:X,cellHeight:vt,column:dt})=>dt===N&&(g=="down"?X===S:S===X+vt));return j&&j.cell}(t,this.direction,n);if(!o)return;const r=this.isHorizontal?"rowspan":"colspan",c=parseInt(t.getAttribute(r)||1);return parseInt(o.getAttribute(r)||1)===c?o:void 0}}function Eb(l){return l.childCount==1&&l.getChild(0).is("element","paragraph")&&l.getChild(0).isEmpty}class iT extends lt{refresh(){const t=Ut(this.editor.model.document.selection),n=t[0];if(n){const o=n.findAncestor("table"),r=this.editor.plugins.get("TableUtils").getRows(o)-1,c=zn(t),u=c.first===0&&c.last===r;this.isEnabled=!u}else this.isEnabled=!1}execute(){const t=this.editor.model,n=this.editor.plugins.get("TableUtils"),o=Ut(t.document.selection),r=zn(o),c=o[0],u=c.findAncestor("table"),g=n.getCellLocation(c).column;t.change(m=>{const p=r.last-r.first+1;n.removeRows(u,{at:r.first,rows:p});const w=function(_,v,A,x){const E=_.getChild(Math.min(v,x-1));let T=E.getChild(0),S=0;for(const I of E.getChildren()){if(S>A)return T;T=I,S+=parseInt(I.getAttribute("colspan")||1)}return T}(u,r.first,g,n.getRows(u));m.setSelection(m.createPositionAt(w,0))})}}class oT extends lt{refresh(){const t=Ut(this.editor.model.document.selection),n=t[0];if(n){const o=n.findAncestor("table"),r=this.editor.plugins.get("TableUtils").getColumns(o),{first:c,last:u}=uo(t);this.isEnabled=u-c<r-1}else this.isEnabled=!1}execute(){const[t,n]=function(g){const m=Ut(g),p=m[0],w=m.pop(),_=[p,w];return p.isBefore(w)?_:_.reverse()}(this.editor.model.document.selection),o=t.parent.parent,r=[...new ft(o)],c={first:r.find(g=>g.cell===t).column,last:r.find(g=>g.cell===n).column},u=function(g,m,p,w){return parseInt(p.getAttribute("colspan")||1)>1?p:m.previousSibling||p.nextSibling?p.nextSibling||m.previousSibling:w.first?g.reverse().find(({column:_})=>_<w.first).cell:g.reverse().find(({column:_})=>_>w.last).cell}(r,t,n,c);this.editor.model.change(g=>{const m=c.last-c.first+1;this.editor.plugins.get("TableUtils").removeColumns(o,{at:c.first,columns:m}),g.setSelection(g.createPositionAt(u,0))})}}class sT extends lt{refresh(){const t=Ut(this.editor.model.document.selection),n=t.length>0;this.isEnabled=n,this.value=n&&t.every(o=>this._isInHeading(o,o.parent.parent))}execute(t={}){if(t.forceValue===this.value)return;const n=this.editor.model,o=Ut(n.document.selection),r=o[0].findAncestor("table"),{first:c,last:u}=zn(o),g=this.value?c:u+1,m=r.getAttribute("headingRows")||0;n.change(p=>{if(g){const w=_b(r,g,g>m?m:0);for(const{cell:_}of w)kb(_,g,p)}Vt("headingRows",g,r,p,0)})}_isInHeading(t,n){const o=parseInt(n.getAttribute("headingRows")||0);return!!o&&t.parent.index<o}}class rT extends lt{refresh(){const t=Ut(this.editor.model.document.selection),n=this.editor.plugins.get("TableUtils"),o=t.length>0;this.isEnabled=o,this.value=o&&t.every(r=>id(n,r))}execute(t={}){if(t.forceValue===this.value)return;const n=this.editor.model,o=Ut(n.document.selection),r=o[0].findAncestor("table"),{first:c,last:u}=uo(o),g=this.value?c:u+1;n.change(m=>{if(g){const p=vb(r,g);for(const{cell:w,column:_}of p)yb(w,_,g,m)}Vt("headingColumns",g,r,m,0)})}}class ho extends z{static get pluginName(){return"TableUtils"}init(){this.decorate("insertColumns"),this.decorate("insertRows")}getCellLocation(t){const n=t.parent,o=n.parent,r=o.getChildIndex(n),c=new ft(o,{row:r});for(const{cell:u,row:g,column:m}of c)if(u===t)return{row:g,column:m}}createTable(t,n){const o=t.createElement("table"),r=parseInt(n.rows)||2,c=parseInt(n.columns)||2;return dd(t,o,0,r,c),n.headingRows&&Vt("headingRows",Math.min(n.headingRows,r),o,t,0),n.headingColumns&&Vt("headingColumns",Math.min(n.headingColumns,c),o,t,0),o}insertRows(t,n={}){const o=this.editor.model,r=n.at||0,c=n.rows||1,u=n.copyStructureFromAbove!==void 0,g=n.copyStructureFromAbove?r-1:r,m=this.getRows(t),p=this.getColumns(t);if(r>m)throw new y.a("tableutils-insertrows-insert-out-of-range",this,{options:n});o.change(w=>{const _=t.getAttribute("headingRows")||0;if(_>r&&Vt("headingRows",_+c,t,w,0),!u&&(r===0||r===m))return void dd(w,t,r,c,p);const v=u?Math.max(r,g):r,A=new ft(t,{endRow:v}),x=new Array(p).fill(1);for(const{row:E,column:T,cellHeight:S,cellWidth:I,cell:N}of A){const j=E+S-1,X=E<=g&&g<=j;E<r&&r<=j?(w.setAttribute("rowspan",S+c,N),x[T]=-I):u&&X&&(x[T]=I)}for(let E=0;E<c;E++){const T=w.createElement("tableRow");w.insert(T,t,r);for(let S=0;S<x.length;S++){const I=x[S],N=w.createPositionAt(T,"end");I>0&&gi(w,N,I>1?{colspan:I}:null),S+=Math.abs(I)-1}}})}insertColumns(t,n={}){const o=this.editor.model,r=n.at||0,c=n.columns||1;o.change(u=>{const g=t.getAttribute("headingColumns");r<g&&u.setAttribute("headingColumns",g+c,t);const m=this.getColumns(t);if(r===0||m===r){for(const w of t.getChildren())w.is("element","tableRow")&&fo(c,u,u.createPositionAt(w,r?"end":0));return}const p=new ft(t,{column:r,includeAllSlots:!0});for(const w of p){const{row:_,cell:v,cellAnchorColumn:A,cellAnchorRow:x,cellWidth:E,cellHeight:T}=w;if(A<r){u.setAttribute("colspan",E+c,v);const S=x+T-1;for(let I=_;I<=S;I++)p.skipRow(I)}else fo(c,u,w.getPositionBefore())}})}removeRows(t,n){const o=this.editor.model,r=n.rows||1,c=this.getRows(t),u=n.at,g=u+r-1;if(g>c-1)throw new y.a("tableutils-removerows-row-index-out-of-range",this,{table:t,options:n});o.change(m=>{const{cellsToMove:p,cellsToTrim:w}=function(_,v,A){const x=new Map,E=[];for(const{row:T,column:S,cellHeight:I,cell:N}of new ft(_,{endRow:A})){const j=T+I-1;if(T>=v&&T<=A&&j>A){const X=I-(A-T+1);x.set(S,{cell:N,rowspan:X})}if(T<v&&j>=v){let X;X=j>=A?A-v+1:j-v+1,E.push({cell:N,rowspan:I-X})}}return{cellsToMove:x,cellsToTrim:E}}(t,u,g);p.size&&function(_,v,A,x){const E=[...new ft(_,{includeAllSlots:!0,row:v})],T=_.getChild(v);let S;for(const{column:I,cell:N,isAnchor:j}of E)if(A.has(I)){const{cell:X,rowspan:vt}=A.get(I),dt=S?x.createPositionAfter(S):x.createPositionAt(T,0);x.move(x.createRangeOn(X),dt),Vt("rowspan",vt,X,x),S=X}else j&&(S=N)}(t,g+1,p,m);for(let _=g;_>=u;_--)m.remove(t.getChild(_));for(const{rowspan:_,cell:v}of w)Vt("rowspan",_,v,m);(function(_,v,A,x){const E=_.getAttribute("headingRows")||0;v<E&&Vt("headingRows",A<E?E-(A-v+1):v,_,x,0)})(t,u,g,m),ad(t,this)||ld(t,this)})}removeColumns(t,n){const o=this.editor.model,r=n.at,c=n.columns||1,u=n.at+c-1;o.change(g=>{(function(m,p,w){const _=m.getAttribute("headingColumns")||0;if(_&&p.first<_){const v=Math.min(_-1,p.last)-p.first+1;w.setAttribute("headingColumns",_-v,m)}})(t,{first:r,last:u},g);for(let m=u;m>=r;m--)for(const{cell:p,column:w,cellWidth:_}of[...new ft(t)])w<=m&&_>1&&w+_>m?Vt("colspan",_-1,p,g):w===m&&g.remove(p);ld(t,this)||ad(t,this)})}splitCellVertically(t,n=2){const o=this.editor.model,r=t.parent.parent,c=parseInt(t.getAttribute("rowspan")||1),u=parseInt(t.getAttribute("colspan")||1);o.change(g=>{if(u>1){const{newCellsSpan:m,updatedSpan:p}=Tb(u,n);Vt("colspan",p,t,g);const w={};m>1&&(w.colspan=m),c>1&&(w.rowspan=c),fo(u>n?n-1:u-1,g,g.createPositionAfter(t),w)}if(u<n){const m=n-u,p=[...new ft(r)],{column:w}=p.find(({cell:x})=>x===t),_=p.filter(({cell:x,cellWidth:E,column:T})=>x!==t&&T===w||T<w&&T+E>w);for(const{cell:x,cellWidth:E}of _)g.setAttribute("colspan",E+m,x);const v={};c>1&&(v.rowspan=c),fo(m,g,g.createPositionAfter(t),v);const A=r.getAttribute("headingColumns")||0;A>w&&Vt("headingColumns",A+m,r,g)}})}splitCellHorizontally(t,n=2){const o=this.editor.model,r=t.parent,c=r.parent,u=c.getChildIndex(r),g=parseInt(t.getAttribute("rowspan")||1),m=parseInt(t.getAttribute("colspan")||1);o.change(p=>{if(g>1){const w=[...new ft(c,{startRow:u,endRow:u+g-1,includeAllSlots:!0})],{newCellsSpan:_,updatedSpan:v}=Tb(g,n);Vt("rowspan",v,t,p);const{column:A}=w.find(({cell:E})=>E===t),x={};_>1&&(x.rowspan=_),m>1&&(x.colspan=m);for(const E of w){const{column:T,row:S}=E,I=T===A,N=(S+u+v)%_==0;S>=u+v&&I&&N&&fo(1,p,E.getPositionBefore(),x)}}if(g<n){const w=n-g,_=[...new ft(c,{startRow:0,endRow:u})];for(const{cell:x,cellHeight:E,row:T}of _)if(x!==t&&T+E>u){const S=E+w;p.setAttribute("rowspan",S,x)}const v={};m>1&&(v.colspan=m),dd(p,c,u+1,w,1,v);const A=c.getAttribute("headingRows")||0;A>u&&Vt("headingRows",A+w,c,p)}})}getColumns(t){return[...t.getChild(0).getChildren()].reduce((n,o)=>n+parseInt(o.getAttribute("colspan")||1),0)}getRows(t){return Array.from(t.getChildren()).reduce((n,o)=>o.is("element","tableRow")?n+1:n,0)}}function dd(l,t,n,o,r,c={}){for(let u=0;u<o;u++){const g=l.createElement("tableRow");l.insert(g,t,n),fo(r,l,l.createPositionAt(g,"end"),c)}}function fo(l,t,n,o={}){for(let r=0;r<l;r++)gi(t,n,o)}function Tb(l,t){if(l<t)return{newCellsSpan:1,updatedSpan:1};const n=Math.floor(l/t);return{newCellsSpan:n,updatedSpan:l-n*t+n}}class aT extends lt{refresh(){const t=co(this.editor.model.document.selection);this.isEnabled=rd(t,this.editor.plugins.get(ho))}execute(){const t=this.editor.model,n=this.editor.plugins.get(ho);t.change(o=>{const r=co(t.document.selection),c=r.shift(),{mergeWidth:u,mergeHeight:g}=function(m,p,w){let _=0,v=0;for(const E of p){const{row:T,column:S}=w.getCellLocation(E);_=Pb(E,S,_,"colspan"),v=Pb(E,T,v,"rowspan")}const{row:A,column:x}=w.getCellLocation(m);return{mergeWidth:_-x,mergeHeight:v-A}}(c,r,n);Vt("colspan",u,c,o),Vt("rowspan",g,c,o);for(const m of r)lT(m,c,o);cd(c.findAncestor("table"),n),o.setSelection(c,"in")})}}function lT(l,t,n){Sb(l)||(Sb(t)&&n.remove(n.createRangeIn(t)),n.move(n.createRangeIn(l),n.createPositionAt(t,"end"))),n.remove(l)}function Sb(l){return l.childCount==1&&l.getChild(0).is("element","paragraph")&&l.getChild(0).isEmpty}function Pb(l,t,n,o){const r=parseInt(l.getAttribute(o)||1);return Math.max(n,t+r)}class cT extends lt{constructor(t){super(t),this.affectsData=!1}refresh(){const t=Ut(this.editor.model.document.selection);this.isEnabled=t.length>0}execute(){const t=this.editor.model,n=Ut(t.document.selection),o=zn(n),r=n[0].findAncestor("table"),c=[];for(let u=o.first;u<=o.last;u++)for(const g of r.getChild(u).getChildren())c.push(t.createRangeOn(g));t.change(u=>{u.setSelection(c)})}}class dT extends lt{constructor(t){super(t),this.affectsData=!1}refresh(){const t=Ut(this.editor.model.document.selection);this.isEnabled=t.length>0}execute(){const t=this.editor.model,n=Ut(t.document.selection),o=n[0],r=n.pop(),c=o.findAncestor("table"),u=this.editor.plugins.get("TableUtils"),g=u.getCellLocation(o),m=u.getCellLocation(r),p=Math.min(g.column,m.column),w=Math.max(g.column,m.column),_=[];for(const v of new ft(c,{startColumn:p,endColumn:w}))_.push(t.createRangeOn(v.cell));t.change(v=>{v.setSelection(_)})}}function uT(l){l.document.registerPostFixer(t=>function(n,o){const r=o.document.differ.getChanges();let c=!1;const u=new Set;for(const g of r){let m;g.name=="table"&&g.type=="insert"&&(m=g.position.nodeAfter),g.name!="tableRow"&&g.name!="tableCell"||(m=g.position.findAncestor("table")),gT(g)&&(m=g.range.start.findAncestor("table")),m&&!u.has(m)&&(c=hT(m,n)||c,c=fT(m,n)||c,u.add(m))}return c}(t,l))}function hT(l,t){let n=!1;const o=function(r){const c=parseInt(r.getAttribute("headingRows")||0),u=Array.from(r.getChildren()).reduce((m,p)=>p.is("element","tableRow")?m+1:m,0),g=[];for(const{row:m,cell:p,cellHeight:w}of new ft(r)){if(w<2)continue;const _=m<c?c:u;if(m+w>_){const v=_-m;g.push({cell:p,rowspan:v})}}return g}(l);if(o.length){n=!0;for(const r of o)Vt("rowspan",r.rowspan,r.cell,t,1)}return n}function fT(l,t){let n=!1;const o=function(g){const m=new Array(g.childCount).fill(0);for(const{rowIndex:p}of new ft(g,{includeAllSlots:!0}))m[p]++;return m}(l),r=[];for(const[g,m]of o.entries())!m&&l.getChild(g).is("element","tableRow")&&r.push(g);if(r.length){n=!0;for(const g of r.reverse())t.remove(l.getChild(g)),o.splice(g,1)}const c=o.filter((g,m)=>l.getChild(m).is("element","tableRow")),u=c[0];if(!c.every(g=>g===u)){const g=c.reduce((m,p)=>p>m?p:m,0);for(const[m,p]of c.entries()){const w=g-p;if(w){for(let _=0;_<w;_++)gi(t,t.createPositionAt(l.getChild(m),"end"));n=!0}}}return n}function gT(l){const t=l.type==="attribute",n=l.attributeKey;return t&&(n==="headingRows"||n==="colspan"||n==="rowspan")}function mT(l){l.document.registerPostFixer(t=>function(n,o){const r=o.document.differ.getChanges();let c=!1;for(const u of r)u.type=="insert"&&u.name=="table"&&(c=pT(u.position.nodeAfter,n)||c),u.type=="insert"&&u.name=="tableRow"&&(c=Ib(u.position.nodeAfter,n)||c),u.type=="insert"&&u.name=="tableCell"&&(c=ud(u.position.nodeAfter,n)||c),bT(u)&&(c=ud(u.position.parent,n)||c);return c}(t,l))}function pT(l,t){let n=!1;for(const o of l.getChildren())o.is("element","tableRow")&&(n=Ib(o,t)||n);return n}function Ib(l,t){let n=!1;for(const o of l.getChildren())n=ud(o,t)||n;return n}function ud(l,t){if(l.childCount==0)return t.insertElement("paragraph",l),!0;const n=Array.from(l.getChildren()).filter(o=>o.is("$text"));for(const o of n)t.wrap(t.createRangeOn(o),"paragraph");return!!n.length}function bT(l){return!(!l.position||!l.position.parent.is("element","tableCell"))&&(l.type=="insert"&&l.name=="$text"||l.type=="remove")}function wT(l,t){l.document.registerPostFixer(()=>function(n,o){const r=new Set;for(const c of n.getChanges()){const u=c.type=="attribute"?c.range.start.parent:c.position.parent;u.is("element","tableCell")&&r.add(u)}for(const c of r.values())for(const u of[...c.getChildren()].filter(g=>_T(g,o)))n.refreshItem(u);return!1}(l.document.differ,t))}function _T(l,t){if(!l.is("element","paragraph"))return!1;const n=t.toViewElement(l);return!!n&&ab(l)!==n.is("element","span")}function kT(l){l.document.registerPostFixer(()=>function(t){const n=t.document.differ,o=new Set;for(const r of n.getChanges())if(r.type==="attribute"){const c=r.range.start.nodeAfter;c&&c.is("element","table")&&r.attributeKey==="headingRows"&&o.add(c)}else if(r.type==="insert"||r.type==="remove"){if(r.name==="tableRow"){const c=r.position.findAncestor("table"),u=c.getAttribute("headingRows")||0;r.position.offset<u&&o.add(c)}else if(r.name==="tableCell"){const c=r.position.findAncestor("table"),u=c.getAttribute("headingColumns")||0;r.position.offset<u&&o.add(c)}}if(o.size){for(const r of o.values())n.refreshItem(r);return!0}return!1}(l))}d(102);class vT extends z{static get pluginName(){return"TableEditing"}init(){const t=this.editor,n=t.model,o=n.schema,r=t.conversion;o.register("table",{allowWhere:"$block",allowAttributes:["headingRows","headingColumns"],isObject:!0,isBlock:!0}),o.register("tableRow",{allowIn:"table",isLimit:!0}),o.register("tableCell",{allowIn:"tableRow",allowChildren:"$block",allowAttributes:["colspan","rowspan"],isLimit:!0,isSelectable:!0}),r.for("upcast").add(c=>{c.on("element:figure",(u,g,m)=>{if(!m.consumable.test(g.viewItem,{name:!0,classes:"table"}))return;const p=function(_){for(const v of _.getChildren())if(v.is("element","table"))return v}(g.viewItem);if(!p||!m.consumable.test(p,{name:!0}))return;m.consumable.consume(g.viewItem,{name:!0,classes:"table"});const w=de(m.convertItem(p,g.modelCursor).modelRange.getItems());w?(m.convertChildren(g.viewItem,m.writer.createPositionAt(w,"end")),m.updateConversionResult(w,g)):m.consumable.revert(g.viewItem,{name:!0,classes:"table"})})}),r.for("upcast").add(JE()),r.for("editingDowncast").add(rb({asWidget:!0})),r.for("dataDowncast").add(rb()),r.for("upcast").elementToElement({model:"tableRow",view:"tr"}),r.for("upcast").add(c=>{c.on("element:tr",(u,g)=>{g.viewItem.isEmpty&&g.modelCursor.index==0&&u.stop()},{priority:"high"})}),r.for("editingDowncast").add(c=>c.on("insert:tableRow",(u,g,m)=>{const p=g.item;if(!m.consumable.consume(p,"insert"))return;const w=p.parent,_=function(T){for(const S of T.getChildren())if(S.name==="table")return S}(m.mapper.toViewElement(w)),v=w.getChildIndex(p),A=new ft(w,{row:v}),x={headingRows:w.getAttribute("headingRows")||0,headingColumns:w.getAttribute("headingColumns")||0},E=new Map;for(const T of A){const S=E.get(v)||sd(_,p,v,x,m);E.set(v,S),m.consumable.consume(T.cell,"insert"),od(T,x,m.writer.createPositionAt(S,"end"),m,{asWidget:!0})}})),r.for("editingDowncast").add(c=>c.on("remove:tableRow",(u,g,m)=>{u.stop();const p=m.writer,w=m.mapper,_=w.toViewPosition(g.position).getLastMatchingPosition(E=>!E.item.is("element","tr")).nodeAfter,v=_.parent.parent,A=p.createRangeOn(_),x=p.remove(A);for(const E of p.createRangeIn(x).getItems())w.unbindViewElement(E);db("thead",v,m),db("tbody",v,m)},{priority:"higher"})),r.for("upcast").elementToElement({model:"tableCell",view:"td"}),r.for("upcast").elementToElement({model:"tableCell",view:"th"}),r.for("upcast").add(sb("td")),r.for("upcast").add(sb("th")),r.for("editingDowncast").add(c=>c.on("insert:tableCell",(u,g,m)=>{const p=g.item;if(!m.consumable.consume(p,"insert"))return;const w=p.parent,_=w.parent,v=_.getChildIndex(w),A=new ft(_,{row:v}),x={headingRows:_.getAttribute("headingRows")||0,headingColumns:_.getAttribute("headingColumns")||0};for(const E of A)if(E.cell===p){const T=m.mapper.toViewElement(w);return void od(E,x,m.writer.createPositionAt(T,w.getChildIndex(p)),m,{asWidget:!0})}})),r.for("editingDowncast").elementToElement({model:"paragraph",view:ZE,converterPriority:"high"}),r.for("downcast").attributeToAttribute({model:"colspan",view:"colspan"}),r.for("upcast").attributeToAttribute({model:{key:"colspan",value:Mb("colspan")},view:"colspan"}),r.for("downcast").attributeToAttribute({model:"rowspan",view:"rowspan"}),r.for("upcast").attributeToAttribute({model:{key:"rowspan",value:Mb("rowspan")},view:"rowspan"}),r.for("editingDowncast").add(c=>c.on("attribute:headingColumns:table",(u,g,m)=>{const p=g.item;if(!m.consumable.consume(g.item,u.name))return;const w={headingRows:p.getAttribute("headingRows")||0,headingColumns:p.getAttribute("headingColumns")||0},_=g.attributeOldValue,v=g.attributeNewValue,A=(_>v?_:v)-1;for(const x of new ft(p,{endColumn:A}))tT(x,w,m)})),t.data.mapper.on("modelToViewPosition",(c,u)=>{const g=u.modelPosition.parent,m=u.modelPosition.nodeBefore;if(!g.is("element","tableCell")||!m||!m.is("element","paragraph"))return;const p=u.mapper.toViewElement(m),w=u.mapper.toViewElement(g);p===w&&(u.viewPosition=u.mapper.findPositionIn(w,m.maxOffset))}),t.config.define("table.defaultHeadings.rows",0),t.config.define("table.defaultHeadings.columns",0),t.commands.add("insertTable",new eT(t)),t.commands.add("insertTableRowAbove",new mb(t,{order:"above"})),t.commands.add("insertTableRowBelow",new mb(t,{order:"below"})),t.commands.add("insertTableColumnLeft",new pb(t,{order:"left"})),t.commands.add("insertTableColumnRight",new pb(t,{order:"right"})),t.commands.add("removeTableRow",new iT(t)),t.commands.add("removeTableColumn",new oT(t)),t.commands.add("splitTableCellVertically",new bb(t,{direction:"vertically"})),t.commands.add("splitTableCellHorizontally",new bb(t,{direction:"horizontally"})),t.commands.add("mergeTableCells",new aT(t)),t.commands.add("mergeTableCellRight",new fa(t,{direction:"right"})),t.commands.add("mergeTableCellLeft",new fa(t,{direction:"left"})),t.commands.add("mergeTableCellDown",new fa(t,{direction:"down"})),t.commands.add("mergeTableCellUp",new fa(t,{direction:"up"})),t.commands.add("setTableColumnHeader",new rT(t)),t.commands.add("setTableRowHeader",new sT(t)),t.commands.add("selectTableRow",new cT(t)),t.commands.add("selectTableColumn",new dT(t)),kT(n),uT(n),wT(n,t.editing.mapper),mT(n)}static get requires(){return[ho]}}function Mb(l){return t=>{const n=parseInt(t.getAttribute(l));return Number.isNaN(n)||n<=0?null:n}}d(104);class yT extends st{constructor(t){super(t);const n=this.bindTemplate;this.items=this._createGridCollection(),this.set("rows",0),this.set("columns",0),this.bind("label").to(this,"columns",this,"rows",(o,r)=>`${r} × ${o}`),this.setTemplate({tag:"div",attributes:{class:["ck"]},children:[{tag:"div",attributes:{class:["ck-insert-table-dropdown__grid"]},on:{"mouseover@.ck-insert-table-dropdown-grid-box":n.to("boxover")},children:this.items},{tag:"div",attributes:{class:["ck-insert-table-dropdown__label"]},children:[{text:n.to("label")}]}],on:{mousedown:n.to(o=>{o.preventDefault()}),click:n.to(()=>{this.fire("execute")})}}),this.on("boxover",(o,r)=>{const{row:c,column:u}=r.target.dataset;this.set({rows:parseInt(c),columns:parseInt(u)})}),this.on("change:columns",()=>{this._highlightGridBoxes()}),this.on("change:rows",()=>{this._highlightGridBoxes()})}focus(){}focusLast(){}_highlightGridBoxes(){const t=this.rows,n=this.columns;this.items.map((o,r)=>{const c=Math.floor(r/10)<t&&r%10<n;o.set("isOn",c)})}_createGridCollection(){const t=[];for(let n=0;n<100;n++){const o=Math.floor(n/10),r=n%10;t.push(new AT(this.locale,o+1,r+1))}return this.createCollection(t)}}class AT extends st{constructor(t,n,o){super(t);const r=this.bindTemplate;this.set("isOn",!1),this.setTemplate({tag:"div",attributes:{class:["ck-insert-table-dropdown-grid-box",r.if("isOn","ck-on")],"data-row":n,"data-column":o}})}}class CT extends z{static get pluginName(){return"TableUI"}init(){const t=this.editor,n=this.editor.t,o=t.locale.contentLanguageDirection==="ltr";t.ui.componentFactory.add("insertTable",r=>{const c=t.commands.get("insertTable"),u=ui(r);let g;return u.bind("isEnabled").to(c),u.buttonView.set({icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 6v3h4V6H3zm0 4v3h4v-3H3zm0 4v3h4v-3H3zm5 3h4v-3H8v3zm5 0h4v-3h-4v3zm4-4v-3h-4v3h4zm0-4V6h-4v3h4zm1.5 8a1.5 1.5 0 0 1-1.5 1.5H3A1.5 1.5 0 0 1 1.5 17V4c.222-.863 1.068-1.5 2-1.5h13c.932 0 1.778.637 2 1.5v13zM12 13v-3H8v3h4zm0-4V6H8v3h4z"/></svg>',label:n("Insert table"),tooltip:!0}),u.on("change:isOpen",()=>{g||(g=new yT(r),u.panelView.children.add(g),g.delegate("execute").to(u),u.buttonView.on("open",()=>{g.rows=0,g.columns=0}),u.on("execute",()=>{t.execute("insertTable",{rows:g.rows,columns:g.columns}),t.editing.view.focus()}))}),u}),t.ui.componentFactory.add("tableColumn",r=>{const c=[{type:"switchbutton",model:{commandName:"setTableColumnHeader",label:n("Header column"),bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:o?"insertTableColumnLeft":"insertTableColumnRight",label:n("Insert column left")}},{type:"button",model:{commandName:o?"insertTableColumnRight":"insertTableColumnLeft",label:n("Insert column right")}},{type:"button",model:{commandName:"removeTableColumn",label:n("Delete column")}},{type:"button",model:{commandName:"selectTableColumn",label:n("Select column")}}];return this._prepareDropdown(n("Column"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M18 7v1H2V7h16zm0 5v1H2v-1h16z" opacity=".6"/><path d="M14 1v18a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V1a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1zm-2 1H8v4h4V2zm0 6H8v4h4V8zm0 6H8v4h4v-4z"/></svg>',c,r)}),t.ui.componentFactory.add("tableRow",r=>{const c=[{type:"switchbutton",model:{commandName:"setTableRowHeader",label:n("Header row"),bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:"insertTableRowAbove",label:n("Insert row above")}},{type:"button",model:{commandName:"insertTableRowBelow",label:n("Insert row below")}},{type:"button",model:{commandName:"removeTableRow",label:n("Delete row")}},{type:"button",model:{commandName:"selectTableRow",label:n("Select row")}}];return this._prepareDropdown(n("Row"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M7 2h1v16H7V2zm5 0h1v16h-1V2z" opacity=".6"/><path d="M1 6h18a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1zm1 2v4h4V8H2zm6 0v4h4V8H8zm6 0v4h4V8h-4z"/></svg>',c,r)}),t.ui.componentFactory.add("mergeTableCells",r=>{const c=[{type:"button",model:{commandName:"mergeTableCellUp",label:n("Merge cell up")}},{type:"button",model:{commandName:o?"mergeTableCellRight":"mergeTableCellLeft",label:n("Merge cell right")}},{type:"button",model:{commandName:"mergeTableCellDown",label:n("Merge cell down")}},{type:"button",model:{commandName:o?"mergeTableCellLeft":"mergeTableCellRight",label:n("Merge cell left")}},{type:"separator"},{type:"button",model:{commandName:"splitTableCellVertically",label:n("Split cell vertically")}},{type:"button",model:{commandName:"splitTableCellHorizontally",label:n("Split cell horizontally")}}];return this._prepareMergeSplitButtonDropdown(n("Merge cells"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M7 2h1v16H7V2zm5 0h1v7h-1V2zm6 5v1H2V7h16zM8 12v1H2v-1h6z" opacity=".6"/><path d="M7 7h12a1 1 0 0 1 1 1v11a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1zm1 2v9h10V9H8z"/></svg>',c,r)})}_prepareDropdown(t,n,o,r){const c=this.editor,u=ui(r),g=this._fillDropdownWithListOptions(u,o);return u.buttonView.set({label:t,icon:n,tooltip:!0}),u.bind("isEnabled").toMany(g,"isEnabled",(...m)=>m.some(p=>p)),this.listenTo(u,"execute",m=>{c.execute(m.source.commandName),c.editing.view.focus()}),u}_prepareMergeSplitButtonDropdown(t,n,o,r){const c=this.editor,u=ui(r,jg),g=c.commands.get("mergeTableCells"),m=this._fillDropdownWithListOptions(u,o);return u.buttonView.set({label:t,icon:n,tooltip:!0,isEnabled:!0}),u.bind("isEnabled").toMany([g,...m],"isEnabled",(...p)=>p.some(w=>w)),this.listenTo(u.buttonView,"execute",()=>{c.execute("mergeTableCells"),c.editing.view.focus()}),this.listenTo(u,"execute",p=>{c.execute(p.source.commandName),c.editing.view.focus()}),u}_fillDropdownWithListOptions(t,n){const o=this.editor,r=[],c=new Me;for(const u of n)xT(u,o,r,c);return Gg(t,c,o.ui.componentFactory),r}}function xT(l,t,n,o){const r=l.model=new Pc(l.model),{commandName:c,bindIsOn:u}=l.model;if(l.type==="button"||l.type==="switchbutton"){const g=t.commands.get(c);n.push(g),r.set({commandName:c}),r.bind("isEnabled").to(g),u&&r.bind("isOn").to(g,"value")}r.set({withText:!0}),o.add(l)}d(106);class mi extends z{static get pluginName(){return"TableSelection"}static get requires(){return[ho]}init(){const t=this.editor.model;this.listenTo(t,"deleteContent",(n,o)=>this._handleDeleteContent(n,o),{priority:"high"}),this._defineSelectionConverter(),this._enablePluginDisabling()}getSelectedTableCells(){const t=co(this.editor.model.document.selection);return t.length==0?null:t}getSelectionAsFragment(){const t=this.getSelectedTableCells();return t?this.editor.model.change(n=>{const o=n.createDocumentFragment(),r=this.editor.plugins.get("TableUtils"),{first:c,last:u}=uo(t),{first:g,last:m}=zn(t),p=t[0].findAncestor("table");let w=m,_=u;if(rd(t,r)){const A={firstColumn:c,lastColumn:u,firstRow:g,lastRow:m};w=Cb(p,A),_=xb(p,A)}const v=wb(p,{startRow:g,startColumn:c,endRow:w,endColumn:_},n);return n.insert(v,o,0),o}):null}setCellSelection(t,n){const o=this._getCellsToSelect(t,n);this.editor.model.change(r=>{r.setSelection(o.cells.map(c=>r.createRangeOn(c)),{backward:o.backward})})}getFocusCell(){const t=[...this.editor.model.document.selection.getRanges()].pop().getContainedElement();return t&&t.is("element","tableCell")?t:null}getAnchorCell(){const t=de(this.editor.model.document.selection.getRanges()).getContainedElement();return t&&t.is("element","tableCell")?t:null}_defineSelectionConverter(){const t=this.editor,n=new Set;t.conversion.for("editingDowncast").add(o=>o.on("selection",(r,c,u)=>{const g=u.writer;(function(w){for(const _ of n)w.removeClass("ck-editor__editable_selected",_);n.clear()})(g);const m=this.getSelectedTableCells();if(!m)return;for(const w of m){const _=u.mapper.toViewElement(w);g.addClass("ck-editor__editable_selected",_),n.add(_)}const p=u.mapper.toViewElement(m[m.length-1]);g.setSelection(p,0)},{priority:"lowest"}))}_enablePluginDisabling(){const t=this.editor;this.on("change:isEnabled",()=>{if(!this.isEnabled){const n=this.getSelectedTableCells();if(!n)return;t.model.change(o=>{const r=o.createPositionAt(n[0],0),c=t.model.schema.getNearestSelectionRange(r);o.setSelection(c)})}})}_handleDeleteContent(t,n){const[o,r]=n,c=this.editor.model,u=!r||r.direction=="backward",g=co(o);g.length&&(t.stop(),c.change(m=>{const p=g[u?g.length-1:0];c.change(_=>{for(const v of g)c.deleteContent(_.createSelection(v,"in"))});const w=c.schema.getNearestSelectionRange(m.createPositionAt(p,0));o.is("documentSelection")?m.setSelection(w):o.setTo(w)}))}_getCellsToSelect(t,n){const o=this.editor.plugins.get("TableUtils"),r=o.getCellLocation(t),c=o.getCellLocation(n),u=Math.min(r.row,c.row),g=Math.max(r.row,c.row),m=Math.min(r.column,c.column),p=Math.max(r.column,c.column),w=new Array(g-u+1).fill(null).map(()=>[]),_={startRow:u,endRow:g,startColumn:m,endColumn:p};for(const{row:x,cell:E}of new ft(t.findAncestor("table"),_))w[x-u].push(E);const v=c.row<r.row,A=c.column<r.column;return v&&w.reverse(),A&&w.forEach(x=>x.reverse()),{cells:w.flat(),backward:v||A}}}class ET extends z{static get pluginName(){return"TableClipboard"}static get requires(){return[mi,ho]}init(){const t=this.editor,n=t.editing.view.document;this.listenTo(n,"copy",(o,r)=>this._onCopyCut(o,r)),this.listenTo(n,"cut",(o,r)=>this._onCopyCut(o,r)),this.listenTo(t.model,"insertContent",(o,r)=>this._onInsertContent(o,...r),{priority:"high"}),this.decorate("_replaceTableSlotCell")}_onCopyCut(t,n){const o=this.editor.plugins.get(mi);if(!o.getSelectedTableCells()||t.name=="cut"&&this.editor.isReadOnly)return;n.preventDefault(),t.stop();const r=this.editor.data,c=this.editor.editing.view.document,u=r.toView(o.getSelectionAsFragment());c.fire("clipboardOutput",{dataTransfer:n.dataTransfer,content:u,method:t.name})}_onInsertContent(t,n,o){if(o&&!o.is("documentSelection"))return;const r=this.editor.model,c=this.editor.plugins.get(ho);let u=function(m,p){if(!m.is("documentFragment")&&!m.is("element"))return null;if(m.is("element","table"))return m;if(m.childCount==1&&m.getChild(0).is("element","table"))return m.getChild(0);const w=p.createRangeIn(m);for(const _ of w.getItems())if(_.is("element","table")){const v=p.createRange(w.start,p.createPositionBefore(_));if(p.hasContent(v,{ignoreWhitespaces:!0}))return null;const A=p.createRange(p.createPositionAfter(_),w.end);return p.hasContent(A,{ignoreWhitespaces:!0})?null:_}return null}(n,r);if(!u)return;const g=Ut(r.document.selection);g.length?(t.stop(),r.change(m=>{const p={width:c.getColumns(u),height:c.getRows(u)},w=function(T,S,I,N){const j=T[0].findAncestor("table"),X=uo(T),vt=zn(T),dt={firstColumn:X.first,lastColumn:X.last,firstRow:vt.first,lastRow:vt.last},re=T.length===1;return re&&(dt.lastRow+=S.height-1,dt.lastColumn+=S.width-1,function(ue,he,Ve,Ge){const cn=Ge.getColumns(ue),go=Ge.getRows(ue);Ve>cn&&Ge.insertColumns(ue,{at:cn,columns:Ve-cn}),he>go&&Ge.insertRows(ue,{at:go,rows:he-go})}(j,dt.lastRow+1,dt.lastColumn+1,N)),re||!rd(T,N)?function(ue,he,Ve){const{firstRow:Ge,lastRow:cn,firstColumn:go,lastColumn:Lb}=he,Vb={first:Ge,last:cn},Bb={first:go,last:Lb};fd(ue,go,Vb,Ve),fd(ue,Lb+1,Vb,Ve),hd(ue,Ge,Bb,Ve),hd(ue,cn+1,Bb,Ve,Ge)}(j,dt,I):(dt.lastRow=Cb(j,dt),dt.lastColumn=xb(j,dt)),dt}(g,p,m,c),_=w.lastRow-w.firstRow+1,v=w.lastColumn-w.firstColumn+1,A={startRow:0,startColumn:0,endRow:Math.min(_,p.height)-1,endColumn:Math.min(v,p.width)-1};u=wb(u,A,m);const x=g[0].findAncestor("table"),E=this._replaceSelectedCellsWithPasted(u,p,x,w,m);if(this.editor.plugins.get("TableSelection").isEnabled){const T=hb(E.map(S=>m.createRangeOn(S)));m.setSelection(T)}else m.setSelection(E[0],0)})):cd(u,c)}_replaceSelectedCellsWithPasted(t,n,o,r,c){const{width:u,height:g}=n,m=function(T,S,I){const N=new Array(I).fill(null).map(()=>new Array(S).fill(null));for(const{column:j,row:X,cell:vt}of new ft(T))N[X][j]=vt;return N}(t,u,g),p=[...new ft(o,{startRow:r.firstRow,endRow:r.lastRow,startColumn:r.firstColumn,endColumn:r.lastColumn,includeAllSlots:!0})],w=[];let _;for(const T of p){const{row:S,column:I}=T;I===r.firstColumn&&(_=T.getPositionBefore());const N=S-r.firstRow,j=I-r.firstColumn,X=m[N%g][j%u],vt=X?c.cloneElement(X):null,dt=this._replaceTableSlotCell(T,vt,_,c);dt&&(Ab(dt,S,I,r.lastRow,r.lastColumn,c),w.push(dt),_=c.createPositionAfter(dt))}const v=parseInt(o.getAttribute("headingRows")||0),A=parseInt(o.getAttribute("headingColumns")||0),x=r.firstRow<v&&v<=r.lastRow,E=r.firstColumn<A&&A<=r.lastColumn;if(x){const T=hd(o,v,{first:r.firstColumn,last:r.lastColumn},c,r.firstRow);w.push(...T)}if(E){const T=fd(o,A,{first:r.firstRow,last:r.lastRow},c);w.push(...T)}return w}_replaceTableSlotCell(t,n,o,r){const{cell:c,isAnchor:u}=t;return u&&r.remove(c),n?(r.insert(n,o),n):null}}function hd(l,t,n,o,r=0){if(!(t<1))return _b(l,t,r).filter(({column:c,cellWidth:u})=>Rb(c,u,n)).map(({cell:c})=>kb(c,t,o))}function fd(l,t,n,o){if(!(t<1))return vb(l,t).filter(({row:r,cellHeight:c})=>Rb(r,c,n)).map(({cell:r,column:c})=>yb(r,c,t,o))}function Rb(l,t,n){const o=l+t-1,{first:r,last:c}=n;return l>=r&&l<=c||l<r&&o>=r}class TT extends z{static get pluginName(){return"TableKeyboard"}static get requires(){return[mi]}init(){const t=this.editor.editing.view.document;this.editor.keystrokes.set("Tab",(...n)=>this._handleTabOnSelectedTable(...n),{priority:"low"}),this.editor.keystrokes.set("Tab",this._getTabHandler(!0),{priority:"low"}),this.editor.keystrokes.set("Shift+Tab",this._getTabHandler(!1),{priority:"low"}),this.listenTo(t,"arrowKey",(...n)=>this._onArrowKey(...n),{context:"table"})}_handleTabOnSelectedTable(t,n){const o=this.editor,r=o.model.document.selection.getSelectedElement();r&&r.is("element","table")&&(n(),o.model.change(c=>{c.setSelection(c.createRangeIn(r.getChild(0).getChild(0)))}))}_getTabHandler(t){const n=this.editor;return(o,r)=>{let c=fs(n.model.document.selection)[0];if(c||(c=this.editor.plugins.get("TableSelection").getFocusCell()),!c)return;r();const u=c.parent,g=u.parent,m=g.getChildIndex(u),p=u.getChildIndex(c),w=p===0;if(!t&&w&&m===0)return void n.model.change(E=>{E.setSelection(E.createRangeOn(g))});const _=this.editor.plugins.get("TableUtils"),v=p===u.childCount-1,A=m===_.getRows(g)-1;if(t&&A&&v&&(n.execute("insertTableRowBelow"),m===_.getRows(g)-1))return void n.model.change(E=>{E.setSelection(E.createRangeOn(g))});let x;if(t&&v)x=g.getChild(m+1).getChild(0);else if(!t&&w){const E=g.getChild(m-1);x=E.getChild(E.childCount-1)}else x=u.getChild(p+(t?1:-1));n.model.change(E=>{E.setSelection(E.createRangeIn(x))})}}_onArrowKey(t,n){const o=this.editor,r=Gl(n.keyCode,o.locale.contentLanguageDirection);this._handleArrowKeys(r,n.shiftKey)&&(n.preventDefault(),n.stopPropagation(),t.stop())}_handleArrowKeys(t,n){const o=this.editor.model,r=o.document.selection,c=["right","down"].includes(t),u=co(r);if(u.length){let m;return m=n?this.editor.plugins.get("TableSelection").getFocusCell():c?u[u.length-1]:u[0],this._navigateFromCellInDirection(m,t,n),!0}const g=r.focus.findAncestor("tableCell");if(!g)return!1;if(!r.isCollapsed)if(n){if(r.isBackward==c&&!r.containsEntireContent(g))return!1}else{const m=r.getSelectedElement();if(!m||!o.schema.isObject(m))return!1}return!!this._isSelectionAtCellEdge(r,g,c)&&(this._navigateFromCellInDirection(g,t,n),!0)}_isSelectionAtCellEdge(t,n,o){const r=this.editor.model,c=this.editor.model.schema,u=o?t.getLastPosition():t.getFirstPosition();if(!c.getLimitElement(u).is("element","tableCell"))return r.createPositionAt(n,o?"end":0).isTouching(u);const g=r.createSelection(u);return r.modifySelection(g,{direction:o?"forward":"backward"}),u.isEqual(g.focus)}_navigateFromCellInDirection(t,n,o=!1){const r=this.editor.model,c=t.findAncestor("table"),u=[...new ft(c,{includeAllSlots:!0})],{row:g,column:m}=u[u.length-1],p=u.find(({cell:E})=>E==t);let{row:w,column:_}=p;switch(n){case"left":_--;break;case"up":w--;break;case"right":_+=p.cellWidth;break;case"down":w+=p.cellHeight}if(w<0||w>g||_<0&&w<=0||_>m&&w>=g)return void r.change(E=>{E.setSelection(E.createRangeOn(c))});_<0?(_=o?0:m,w--):_>m&&(_=o?m:0,w++);const v=u.find(E=>E.row==w&&E.column==_).cell,A=["right","down"].includes(n),x=this.editor.plugins.get("TableSelection");if(o&&x.isEnabled){const E=x.getAnchorCell()||t;x.setCellSelection(E,v)}else{const E=r.createPositionAt(v,A?0:"end");r.change(T=>{T.setSelection(E)})}}}class ST extends Vn{constructor(t){super(t),this.domEventType=["mousemove","mouseleave"]}onDomEvent(t){this.fire(t.type,t)}}class PT extends z{static get pluginName(){return"TableMouse"}static get requires(){return[mi]}init(){this.editor.editing.view.addObserver(ST),this._enableShiftClickSelection(),this._enableMouseDragSelection()}_enableShiftClickSelection(){const t=this.editor;let n=!1;const o=t.plugins.get(mi);this.listenTo(t.editing.view.document,"mousedown",(r,c)=>{if(!this.isEnabled||!o.isEnabled||!c.domEvent.shiftKey)return;const u=o.getAnchorCell()||fs(t.model.document.selection)[0];if(!u)return;const g=this._getModelTableCellFromDomEvent(c);g&&Ob(u,g)&&(n=!0,o.setCellSelection(u,g),c.preventDefault())}),this.listenTo(t.editing.view.document,"mouseup",()=>{n=!1}),this.listenTo(t.editing.view.document,"selectionChange",r=>{n&&r.stop()},{priority:"highest"})}_enableMouseDragSelection(){const t=this.editor;let n,o,r=!1,c=!1;const u=t.plugins.get(mi);this.listenTo(t.editing.view.document,"mousedown",(g,m)=>{this.isEnabled&&u.isEnabled&&(m.domEvent.shiftKey||m.domEvent.ctrlKey||m.domEvent.altKey||(n=this._getModelTableCellFromDomEvent(m)))}),this.listenTo(t.editing.view.document,"mousemove",(g,m)=>{if(!m.domEvent.buttons||!n)return;const p=this._getModelTableCellFromDomEvent(m);p&&Ob(n,p)&&(o=p,r||o==n||(r=!0)),r&&(c=!0,u.setCellSelection(n,o),m.preventDefault())}),this.listenTo(t.editing.view.document,"mouseup",()=>{r=!1,c=!1,n=null,o=null}),this.listenTo(t.editing.view.document,"selectionChange",g=>{c&&g.stop()},{priority:"highest"})}_getModelTableCellFromDomEvent(t){const n=t.target,o=this.editor.editing.view.createPositionAt(n,0);return this.editor.editing.mapper.toModelPosition(o).parent.findAncestor("tableCell",{includeSelf:!0})}}function Ob(l,t){return l.parent.parent==t.parent.parent}d(108);function IT(l){const t=l.getSelectedElement();return t&&Nb(t)?t:null}function MT(l){let t=l.getFirstPosition().parent;for(;t;){if(t.is("element")&&Nb(t))return t;t=t.parent}return null}function Nb(l){return!!l.getCustomProperty("table")&&Nt(l)}const gd={autoRefresh:!0};class ga{constructor(t,n=gd){if(!t)throw new y.a("token-missing-token-url",this);n.initValue&&this._validateTokenValue(n.initValue),this.set("value",n.initValue),this._refresh=typeof t=="function"?t:()=>{return o=t,new Promise((r,c)=>{const u=new XMLHttpRequest;u.open("GET",o),u.addEventListener("load",()=>{const g=u.status,m=u.response;return g<200||g>299?c(new y.a("token-cannot-download-new-token",null)):r(m)}),u.addEventListener("error",()=>c(new Error("Network Error"))),u.addEventListener("abort",()=>c(new Error("Abort"))),u.send()});var o},this._options=Object.assign({},gd,n)}init(){return new Promise((t,n)=>{this.value?(this._options.autoRefresh&&this._registerRefreshTokenTimeout(),t(this)):this.refreshToken().then(t).catch(n)})}refreshToken(){return this._refresh().then(t=>{this._validateTokenValue(t),this.set("value",t),this._options.autoRefresh&&this._registerRefreshTokenTimeout()}).then(()=>this)}destroy(){clearTimeout(this._tokenRefreshTimeout)}_validateTokenValue(t){const n=typeof t=="string",o=!/^".*"$/.test(t),r=n&&t.split(".").length===3;if(!o||!r)throw new y.a("token-not-in-jwt-format",this)}_registerRefreshTokenTimeout(){const t=this._getTokenRefreshTimeoutTime();clearTimeout(this._tokenRefreshTimeout),this._tokenRefreshTimeout=setTimeout(()=>{this.refreshToken()},t)}_getTokenRefreshTimeoutTime(){try{const[,t]=this.value.split("."),{exp:n}=JSON.parse(atob(t));return n?Math.floor((1e3*n-Date.now())/2):36e5}catch{return 36e5}}static create(t,n=gd){return new ga(t,n).init()}}tt(ga,yt);var RT=ga;const md=/^data:(\S*?);base64,/;class Db{constructor(t,n,o){if(!t)throw new y.a("fileuploader-missing-file",null);if(!n)throw new y.a("fileuploader-missing-token",null);if(!o)throw new y.a("fileuploader-missing-api-address",null);this.file=function(r){if(typeof r!="string")return!1;const c=r.match(md);return!(!c||!c.length)}(t)?function(r,c=512){try{const u=r.match(md)[1],g=atob(r.replace(md,"")),m=[];for(let p=0;p<g.length;p+=c){const w=g.slice(p,p+c),_=new Array(w.length);for(let v=0;v<w.length;v++)_[v]=w.charCodeAt(v);m.push(new Uint8Array(_))}return new Blob(m,{type:u})}catch{throw new y.a("fileuploader-decoding-image-data-error",null)}}(t):t,this._token=n,this._apiAddress=o}onProgress(t){return this.on("progress",(n,o)=>t(o)),this}onError(t){return this.once("error",(n,o)=>t(o)),this}abort(){this.xhr.abort()}send(){return this._prepareRequest(),this._attachXHRListeners(),this._sendRequest()}_prepareRequest(){const t=new XMLHttpRequest;t.open("POST",this._apiAddress),t.setRequestHeader("Authorization",this._token.value),t.responseType="json",this.xhr=t}_attachXHRListeners(){const t=this,n=this.xhr;function o(r){return()=>t.fire("error",r)}n.addEventListener("error",o("Network Error")),n.addEventListener("abort",o("Abort")),n.upload&&n.upload.addEventListener("progress",r=>{r.lengthComputable&&this.fire("progress",{total:r.total,uploaded:r.loaded})}),n.addEventListener("load",()=>{const r=n.status,c=n.response;if(r<200||r>299)return this.fire("error",c.message||c.error)})}_sendRequest(){const t=new FormData,n=this.xhr;return t.append("file",this.file),new Promise((o,r)=>{n.addEventListener("load",()=>{const c=n.status,u=n.response;return c<200||c>299?u.message?r(new y.a("fileuploader-uploading-data-failed",this,{message:u.message})):r(u.error):o(u)}),n.addEventListener("error",()=>r(new Error("Network Error"))),n.addEventListener("abort",()=>r(new Error("Abort"))),n.send(t)})}}tt(Db,D);class OT{constructor(t,n){if(!t)throw new y.a("uploadgateway-missing-token",null);if(!n)throw new y.a("uploadgateway-missing-api-address",null);this._token=t,this._apiAddress=n}upload(t){return new Db(t,this._token,this._apiAddress)}}class NT extends Zo{static get pluginName(){return"CloudServicesCore"}createToken(t,n){return new RT(t,n)}createUploadGateway(t,n){return new OT(t,n)}}class pd extends Rc{}pd.builtinPlugins=[class extends z{static get requires(){return[xm,ia,qC,zC,KC,Fm]}static get pluginName(){return"Essentials"}},class extends z{static get requires(){return[an]}static get pluginName(){return"CKFinderUploadAdapter"}init(){const l=this.editor.config.get("ckfinder.uploadUrl");l&&(this.editor.plugins.get(an).createUploadAdapter=t=>new ux(t,l,this.editor.t))}},class extends z{static get requires(){return[Bn]}static get pluginName(){return"Autoformat"}afterInit(){this._addListAutoformats(),this._addBasicStylesAutoformats(),this._addHeadingAutoformats(),this._addBlockQuoteAutoformats(),this._addCodeBlockAutoformats(),this._addHorizontalLineAutoformats()}_addListAutoformats(){const l=this.editor.commands;l.get("bulletedList")&&Fn(this.editor,this,/^[*-]\s$/,"bulletedList"),l.get("numberedList")&&Fn(this.editor,this,/^1[.|)]\s$/,"numberedList"),l.get("todoList")&&Fn(this.editor,this,/^\[\s?\]\s$/,"todoList"),l.get("checkTodoList")&&Fn(this.editor,this,/^\[\s?x\s?\]\s$/,()=>{this.editor.execute("todoList"),this.editor.execute("checkTodoList")})}_addBasicStylesAutoformats(){const l=this.editor.commands;if(l.get("bold")){const t=aa(this.editor,"bold");ao(this.editor,this,/(?:^|\s)(\*\*)([^*]+)(\*\*)$/g,t),ao(this.editor,this,/(?:^|\s)(__)([^_]+)(__)$/g,t)}if(l.get("italic")){const t=aa(this.editor,"italic");ao(this.editor,this,/(?:^|\s)(\*)([^*_]+)(\*)$/g,t),ao(this.editor,this,/(?:^|\s)(_)([^_]+)(_)$/g,t)}if(l.get("code")){const t=aa(this.editor,"code");ao(this.editor,this,/(`)([^`]+)(`)$/g,t)}if(l.get("strikethrough")){const t=aa(this.editor,"strikethrough");ao(this.editor,this,/(~~)([^~]+)(~~)$/g,t)}}_addHeadingAutoformats(){const l=this.editor.commands.get("heading");l&&l.modelElements.filter(t=>t.match(/^heading[1-6]$/)).forEach(t=>{const n=t[7],o=new RegExp(`^(#{${n}})\\s$`);Fn(this.editor,this,o,()=>{if(!l.isEnabled||l.value===t)return!1;this.editor.execute("heading",{value:t})})})}_addBlockQuoteAutoformats(){this.editor.commands.get("blockQuote")&&Fn(this.editor,this,/^>\s$/,"blockQuote")}_addCodeBlockAutoformats(){const l=this.editor,t=l.model.document.selection;l.commands.get("codeBlock")&&Fn(l,this,/^```$/,()=>{if(t.getFirstPosition().parent.is("element","listItem"))return!1;this.editor.execute("codeBlock",{usePreviousLanguageChoice:!0})})}_addHorizontalLineAutoformats(){this.editor.commands.get("horizontalLine")&&Fn(this.editor,this,/^---$/,"horizontalLine")}},class extends z{static get requires(){return[hx,fx]}static get pluginName(){return"Bold"}},class extends z{static get requires(){return[gx,mx]}static get pluginName(){return"Italic"}},class extends z{static get requires(){return[bx,wx]}static get pluginName(){return"BlockQuote"}},class extends z{static get pluginName(){return"CKFinder"}static get requires(){return["Link","CKFinderUploadAdapter",vx,_x]}},class extends Zo{static get pluginName(){return"CloudServices"}static get requires(){return[NT]}init(){const l=this.context.config.get("cloudServices")||{};for(const t in l)this[t]=l[t];if(this._tokens=new Map,this.tokenUrl)return this.token=this.context.plugins.get("CloudServicesCore").createToken(this.tokenUrl),this._tokens.set(this.tokenUrl,this.token),this.token.init();this.token=null}registerTokenUrl(l){if(this._tokens.has(l))return Promise.resolve(this.getTokenFor(l));const t=this.context.plugins.get("CloudServicesCore").createToken(l);return this._tokens.set(l,t),t.init()}getTokenFor(l){const t=this._tokens.get(l);if(!t)throw new y.a("cloudservices-token-not-registered",this);return t}destroy(){super.destroy();for(const l of this._tokens.values())l.destroy()}},class extends z{static get requires(){return[yx,"ImageUpload"]}init(){const l=this.editor;l.plugins.has("ImageBlockEditing")||l.plugins.has("ImageInlineEditing")||Object(y.b)("easy-image-image-feature-missing",l)}static get pluginName(){return"EasyImage"}},class extends z{static get requires(){return[Tx,Sx]}static get pluginName(){return"Heading"}},class extends z{static get requires(){return[Lx,Bx]}static get pluginName(){return"Image"}},class extends z{static get requires(){return[zx,jx]}static get pluginName(){return"ImageCaption"}},class extends z{static get requires(){return[gp,Wx]}static get pluginName(){return"ImageStyle"}},class extends z{static get requires(){return[ca,ln]}static get pluginName(){return"ImageToolbar"}afterInit(){const l=this.editor,t=l.t,n=l.plugins.get(ca),o=l.plugins.get("ImageUtils");var r;n.register("image",{ariaLabel:t("Image toolbar"),items:(r=l.config.get("image.toolbar")||[],r.map(c=>G(c)?c.name:c)),getRelatedElement:c=>o.getClosestSelectedImageWidget(c)})}},class extends z{static get pluginName(){return"ImageUpload"}static get requires(){return[Yx,Ux,Gx]}},class extends z{static get pluginName(){return"Indent"}static get requires(){return[Qx,Xx]}},class extends z{static get requires(){return[bE,kE,yE]}static get pluginName(){return"Link"}},class extends z{static get requires(){return[RE,OE]}static get pluginName(){return"List"}},class extends z{static get requires(){return[ha,FE,VE,us]}static get pluginName(){return"MediaEmbed"}},hs,class extends z{static get pluginName(){return"PasteFromOffice"}static get requires(){return[rn]}init(){const l=this.editor,t=l.editing.view.document,n=[];n.push(new KE(t)),n.push(new WE(t)),l.plugins.get("ClipboardPipeline").on("inputTransformation",(o,r)=>{if(r._isTransformedWithPasteFromOffice)return;const c=r.dataTransfer.getData("text/html"),u=n.find(g=>g.isActive(c));u&&(r._parsedData=YE(c,t.stylesProcessor),u.execute(r),r._isTransformedWithPasteFromOffice=!0)},{priority:"high"})}},class extends z{static get requires(){return[vT,CT,mi,PT,TT,ET,us]}static get pluginName(){return"Table"}},class extends z{static get requires(){return[ca]}static get pluginName(){return"TableToolbar"}afterInit(){const l=this.editor,t=l.t,n=l.plugins.get(ca),o=l.config.get("table.contentToolbar"),r=l.config.get("table.tableToolbar");o&&n.register("tableContent",{ariaLabel:t("Table toolbar"),items:o,getRelatedElement:MT}),r&&n.register("table",{ariaLabel:t("Table toolbar"),items:r,getRelatedElement:IT})}},class extends z{static get requires(){return["Delete","Input"]}static get pluginName(){return"TextTransformation"}constructor(l){super(l),l.config.define("typing",{transformations:{include:XC}})}init(){const l=this.editor.model.document.selection;l.on("change:range",()=>{this.isEnabled=!l.anchor.parent.is("element","codeBlock")}),this._enableTransformationWatchers()}_enableTransformationWatchers(){const l=this.editor,t=l.model,n=l.plugins.get("Input"),o=l.plugins.get("Delete"),r=function(u){const g=u.extra||[],m=u.remove||[],p=w=>!m.includes(w);return function(w){const _=new Set;for(const v of w)if(Nm[v])for(const A of Nm[v])_.add(A);else _.add(v);return Array.from(_)}(u.include.concat(g).filter(p)).filter(p).map(w=>QC[w]||w).map(w=>({from:ZC(w.from),to:tx(w.to)}))}(l.config.get("typing.transformations")),c=new Bc(l.model,u=>{for(const g of r)if(g.from.test(u))return{normalizedTransformation:g}});c.on("matched:data",(u,g)=>{if(!n.isInput(g.batch))return;const{from:m,to:p}=g.normalizedTransformation,w=m.exec(g.text),_=p(w.slice(1)),v=g.range;let A=w.index;t.enqueueChange(x=>{for(let E=1;E<w.length;E++){const T=w[E],S=_[E-1];if(S==null){A+=T.length;continue}const I=v.start.getShiftedBy(A),N=t.createRange(I,I.getShiftedBy(T.length)),j=ex(I);t.insertContent(x.createText(S,j),N),A+=S.length}t.enqueueChange(()=>{o.requestUndoOnBackspace()})})}),c.bind("isEnabled").to(this)}}],pd.defaultConfig={toolbar:{items:["heading","|","bold","italic","link","bulletedList","numberedList","|","outdent","indent","|","uploadImage","blockQuote","insertTable","mediaEmbed","undo","redo"]},image:{toolbar:["imageStyle:inline","imageStyle:block","imageStyle:side","|","toggleImageCaption","imageTextAlternative"]},table:{contentToolbar:["tableColumn","tableRow","mergeTableCells"]},language:"en"}}]).default})})(Bd,Bd.exports);var BT=Bd.exports;const Fb=VT(BT);/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function FT(){try{return navigator.userAgent.toLowerCase()}catch{return""}}const pi=FT(),Ye={isMac:D_(pi),isWindows:zT(pi),isGecko:jT(pi),isSafari:$T(pi),isiOS:HT(pi),isAndroid:WT(pi),isBlink:qT(pi),features:{isRegExpUnicodePropertySupported:UT()}};function D_(s){return s.indexOf("macintosh")>-1}function zT(s){return s.indexOf("windows")>-1}function jT(s){return!!s.match(/gecko\/\d+/)}function $T(s){return s.indexOf(" applewebkit/")>-1&&s.indexOf("chrome")===-1}function HT(s){return!!s.match(/iphone|ipad/i)||D_(s)&&navigator.maxTouchPoints>0}function WT(s){return s.indexOf("android")>-1}function qT(s){return s.indexOf("chrome/")>-1&&s.indexOf("edge/")<0}function UT(){let s=!1;try{s="ć".search(new RegExp("[\\p{L}]","u"))===0}catch{}return s}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function zb(){return function s(){s.called=!0}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ro{constructor(e,i){this.source=e,this.name=i,this.path=[],this.stop=zb(),this.off=zb()}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const ae=new Array(256).fill("").map((s,e)=>("0"+e.toString(16)).slice(-2));function Yn(){const s=Math.random()*4294967296>>>0,e=Math.random()*4294967296>>>0,i=Math.random()*4294967296>>>0,a=Math.random()*4294967296>>>0;return"e"+ae[s>>0&255]+ae[s>>8&255]+ae[s>>16&255]+ae[s>>24&255]+ae[e>>0&255]+ae[e>>8&255]+ae[e>>16&255]+ae[e>>24&255]+ae[i>>0&255]+ae[i>>8&255]+ae[i>>16&255]+ae[i>>24&255]+ae[a>>0&255]+ae[a>>8&255]+ae[a>>16&255]+ae[a>>24&255]}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Un={get(s="normal"){return typeof s!="number"?this[s]||this.normal:s},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function GT(s,e){const i=Un.get(e.priority);for(let a=0;a<s.length;a++)if(Un.get(s[a].priority)<i){s.splice(a,0,e);return}s.push(e)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const KT="https://ckeditor.com/docs/ckeditor5/latest/support/error-codes.html";class M extends Error{constructor(e,i,a){super(YT(e,a)),this.name="CKEditorError",this.context=i,this.data=a}is(e){return e==="CKEditorError"}static rethrowUnexpectedError(e,i){if(e.is&&e.is("CKEditorError"))throw e;const a=new M(e.message,i);throw a.stack=e.stack,a}}function In(s,e){console.warn(...JT(s,e))}function L_(s){return`
Read more: ${KT}#error-${s}`}function YT(s,e){const i=new WeakSet,d=e?` ${JSON.stringify(e,(f,b)=>{if(typeof b=="object"&&b!==null){if(i.has(b))return`[object ${b.constructor.name}]`;i.add(b)}return b})}`:"",h=L_(s);return s+d+h}function JT(s,e){const i=L_(s);return e?[s,e,i]:[s,i]}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const QT="41.0.0";/* istanbul ignore next -- @preserve */if(globalThis.CKEDITOR_VERSION)throw new M("ckeditor-duplicated-modules",null);globalThis.CKEDITOR_VERSION=QT;/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Ao=Symbol("listeningTo"),Fd=Symbol("emitterId"),Cn=Symbol("delegations"),V_=wt(Object);function wt(s){if(!s)return V_;class e extends s{on(a,d,h){this.listenTo(this,a,d,h)}once(a,d,h){let f=!1;const b=(k,...C)=>{f||(f=!0,k.off(),d.call(this,k,...C))};this.listenTo(this,a,b,h)}off(a,d){this.stopListening(this,a,d)}listenTo(a,d,h,f={}){let b,k;this[Ao]||(this[Ao]={});const C=this[Ao];wd(a)||B_(a);const y=wd(a);(b=C[y])||(b=C[y]={emitter:a,callbacks:{}}),(k=b.callbacks[d])||(k=b.callbacks[d]=[]),k.push(h),eS(this,a,d,h,f)}stopListening(a,d,h){const f=this[Ao];let b=a&&wd(a);const k=f&&b?f[b]:void 0,C=k&&d?k.callbacks[d]:void 0;if(!(!f||a&&!k||d&&!C))if(h)_d(this,a,d,h),C.indexOf(h)!==-1&&(C.length===1?delete k.callbacks[d]:_d(this,a,d,h));else if(C){for(;h=C.pop();)_d(this,a,d,h);delete k.callbacks[d]}else if(k){for(d in k.callbacks)this.stopListening(a,d);delete f[b]}else{for(b in f)this.stopListening(f[b].emitter);delete this[Ao]}}fire(a,...d){try{const h=a instanceof Ro?a:new Ro(this,a),f=h.name;let b=z_(this,f);if(h.path.push(this),b){const C=[h,...d];b=Array.from(b);for(let y=0;y<b.length&&(b[y].callback.apply(this,C),h.off.called&&(delete h.off.called,this._removeEventListener(f,b[y].callback)),!h.stop.called);y++);}const k=this[Cn];if(k){const C=k.get(f),y=k.get("*");C&&jb(C,h,d),y&&jb(y,h,d)}return h.return}catch(h){/* istanbul ignore next -- @preserve */M.rethrowUnexpectedError(h,this)}}delegate(...a){return{to:(d,h)=>{this[Cn]||(this[Cn]=new Map),a.forEach(f=>{const b=this[Cn].get(f);b?b.set(d,h):this[Cn].set(f,new Map([[d,h]]))})}}}stopDelegating(a,d){if(this[Cn])if(!a)this[Cn].clear();else if(!d)this[Cn].delete(a);else{const h=this[Cn].get(a);h&&h.delete(d)}}_addEventListener(a,d,h){tS(this,a);const f=zd(this,a),b=Un.get(h.priority),k={callback:d,priority:b};for(const C of f)GT(C,k)}_removeEventListener(a,d){const h=zd(this,a);for(const f of h)for(let b=0;b<f.length;b++)f[b].callback==d&&(f.splice(b,1),b--)}}return e}["on","once","off","listenTo","stopListening","fire","delegate","stopDelegating","_addEventListener","_removeEventListener"].forEach(s=>{wt[s]=V_.prototype[s]});function XT(s,e){const i=s[Ao];return i&&i[e]?i[e].emitter:null}function B_(s,e){s[Fd]||(s[Fd]=e||Yn())}function wd(s){return s[Fd]}function F_(s){return s._events||Object.defineProperty(s,"_events",{value:{}}),s._events}function ZT(){return{callbacks:[],childEvents:[]}}function tS(s,e){const i=F_(s);if(i[e])return;let a=e,d=null;const h=[];for(;a!==""&&!i[a];)i[a]=ZT(),h.push(i[a]),d&&i[a].childEvents.push(d),d=a,a=a.substr(0,a.lastIndexOf(":"));if(a!==""){for(const f of h)f.callbacks=i[a].callbacks.slice();i[a].childEvents.push(d)}}function zd(s,e){const i=F_(s)[e];if(!i)return[];let a=[i.callbacks];for(let d=0;d<i.childEvents.length;d++){const h=zd(s,i.childEvents[d]);a=a.concat(h)}return a}function z_(s,e){let i;return!s._events||!(i=s._events[e])||!i.callbacks.length?e.indexOf(":")>-1?z_(s,e.substr(0,e.lastIndexOf(":"))):null:i.callbacks}function jb(s,e,i){for(let[a,d]of s){d?typeof d=="function"&&(d=d(e.name)):d=e.name;const h=new Ro(e.source,d);h.path=[...e.path],a.fire(h,...i)}}function eS(s,e,i,a,d){e._addEventListener?e._addEventListener(i,a,d):s._addEventListener.call(e,i,a,d)}function _d(s,e,i,a){e._removeEventListener?e._removeEventListener(i,a):s._removeEventListener.call(e,i,a)}var nS=typeof global=="object"&&global&&global.Object===Object&&global;const j_=nS;var iS=typeof self=="object"&&self&&self.Object===Object&&self,oS=j_||iS||Function("return this")();const Xe=oS;var sS=Xe.Symbol;const gn=sS;var $_=Object.prototype,rS=$_.hasOwnProperty,aS=$_.toString,gs=gn?gn.toStringTag:void 0;function lS(s){var e=rS.call(s,gs),i=s[gs];try{s[gs]=void 0;var a=!0}catch{}var d=aS.call(s);return a&&(e?s[gs]=i:delete s[gs]),d}var cS=Object.prototype,dS=cS.toString;function uS(s){return dS.call(s)}var hS="[object Null]",fS="[object Undefined]",$b=gn?gn.toStringTag:void 0;function Mi(s){return s==null?s===void 0?fS:hS:$b&&$b in Object(s)?lS(s):uS(s)}function Je(s){return s!=null&&typeof s=="object"}var gS="[object Symbol]";function Ya(s){return typeof s=="symbol"||Je(s)&&Mi(s)==gS}function H_(s,e){for(var i=-1,a=s==null?0:s.length,d=Array(a);++i<a;)d[i]=e(s[i],i,s);return d}var mS=Array.isArray;const _e=mS;var pS=1/0,Hb=gn?gn.prototype:void 0,Wb=Hb?Hb.toString:void 0;function W_(s){if(typeof s=="string")return s;if(_e(s))return H_(s,W_)+"";if(Ya(s))return Wb?Wb.call(s):"";var e=s+"";return e=="0"&&1/s==-pS?"-0":e}var bS=/\s/;function wS(s){for(var e=s.length;e--&&bS.test(s.charAt(e)););return e}var _S=/^\s+/;function kS(s){return s&&s.slice(0,wS(s)+1).replace(_S,"")}function ge(s){var e=typeof s;return s!=null&&(e=="object"||e=="function")}var qb=0/0,vS=/^[-+]0x[0-9a-f]+$/i,yS=/^0b[01]+$/i,AS=/^0o[0-7]+$/i,CS=parseInt;function Ub(s){if(typeof s=="number")return s;if(Ya(s))return qb;if(ge(s)){var e=typeof s.valueOf=="function"?s.valueOf():s;s=ge(e)?e+"":e}if(typeof s!="string")return s===0?s:+s;s=kS(s);var i=yS.test(s);return i||AS.test(s)?CS(s.slice(2),i?2:8):vS.test(s)?qb:+s}function q_(s){return s}var xS="[object AsyncFunction]",ES="[object Function]",TS="[object GeneratorFunction]",SS="[object Proxy]";function Js(s){if(!ge(s))return!1;var e=Mi(s);return e==ES||e==TS||e==xS||e==SS}var PS=Xe["__core-js_shared__"];const kd=PS;var Gb=function(){var s=/[^.]+$/.exec(kd&&kd.keys&&kd.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""}();function IS(s){return!!Gb&&Gb in s}var MS=Function.prototype,RS=MS.toString;function Ri(s){if(s!=null){try{return RS.call(s)}catch{}try{return s+""}catch{}}return""}var OS=/[\\^$.*+?()[\]{}|]/g,NS=/^\[object .+?Constructor\]$/,DS=Function.prototype,LS=Object.prototype,VS=DS.toString,BS=LS.hasOwnProperty,FS=RegExp("^"+VS.call(BS).replace(OS,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function zS(s){if(!ge(s)||IS(s))return!1;var e=Js(s)?FS:NS;return e.test(Ri(s))}function jS(s,e){return s==null?void 0:s[e]}function Oi(s,e){var i=jS(s,e);return zS(i)?i:void 0}var $S=Oi(Xe,"WeakMap");const jd=$S;var Kb=Object.create,HS=function(){function s(){}return function(e){if(!ge(e))return{};if(Kb)return Kb(e);s.prototype=e;var i=new s;return s.prototype=void 0,i}}();const WS=HS;function qS(s,e,i){switch(i.length){case 0:return s.call(e);case 1:return s.call(e,i[0]);case 2:return s.call(e,i[0],i[1]);case 3:return s.call(e,i[0],i[1],i[2])}return s.apply(e,i)}function pu(s,e){var i=-1,a=s.length;for(e||(e=Array(a));++i<a;)e[i]=s[i];return e}var US=800,GS=16,KS=Date.now;function YS(s){var e=0,i=0;return function(){var a=KS(),d=GS-(a-i);if(i=a,d>0){if(++e>=US)return arguments[0]}else e=0;return s.apply(void 0,arguments)}}function JS(s){return function(){return s}}var QS=function(){try{var s=Oi(Object,"defineProperty");return s({},"",{}),s}catch{}}();const Na=QS;var XS=Na?function(s,e){return Na(s,"toString",{configurable:!0,enumerable:!1,value:JS(e),writable:!0})}:q_;const ZS=XS;var tP=YS(ZS);const eP=tP;function nP(s,e){for(var i=-1,a=s==null?0:s.length;++i<a&&e(s[i],i,s)!==!1;);return s}function iP(s,e,i,a){for(var d=s.length,h=i+(a?1:-1);a?h--:++h<d;)if(e(s[h],h,s))return h;return-1}function oP(s){return s!==s}function sP(s,e,i){for(var a=i-1,d=s.length;++a<d;)if(s[a]===e)return a;return-1}function rP(s,e,i){return e===e?sP(s,e,i):iP(s,oP,i)}var aP=9007199254740991,lP=/^(?:0|[1-9]\d*)$/;function U_(s,e){var i=typeof s;return e=e??aP,!!e&&(i=="number"||i!="symbol"&&lP.test(s))&&s>-1&&s%1==0&&s<e}function bu(s,e,i){e=="__proto__"&&Na?Na(s,e,{configurable:!0,enumerable:!0,value:i,writable:!0}):s[e]=i}function gr(s,e){return s===e||s!==s&&e!==e}var cP=Object.prototype,dP=cP.hasOwnProperty;function G_(s,e,i){var a=s[e];(!(dP.call(s,e)&&gr(a,i))||i===void 0&&!(e in s))&&bu(s,e,i)}function Fo(s,e,i,a){var d=!i;i||(i={});for(var h=-1,f=e.length;++h<f;){var b=e[h],k=a?a(i[b],s[b],b,i,s):void 0;k===void 0&&(k=s[b]),d?bu(i,b,k):G_(i,b,k)}return i}var Yb=Math.max;function uP(s,e,i){return e=Yb(e===void 0?s.length-1:e,0),function(){for(var a=arguments,d=-1,h=Yb(a.length-e,0),f=Array(h);++d<h;)f[d]=a[e+d];d=-1;for(var b=Array(e+1);++d<e;)b[d]=a[d];return b[e]=i(f),qS(s,this,b)}}function K_(s,e){return eP(uP(s,e,q_),s+"")}var hP=9007199254740991;function Y_(s){return typeof s=="number"&&s>-1&&s%1==0&&s<=hP}function Ja(s){return s!=null&&Y_(s.length)&&!Js(s)}function fP(s,e,i){if(!ge(i))return!1;var a=typeof e;return(a=="number"?Ja(i)&&U_(e,i.length):a=="string"&&e in i)?gr(i[e],s):!1}function J_(s){return K_(function(e,i){var a=-1,d=i.length,h=d>1?i[d-1]:void 0,f=d>2?i[2]:void 0;for(h=s.length>3&&typeof h=="function"?(d--,h):void 0,f&&fP(i[0],i[1],f)&&(h=d<3?void 0:h,d=1),e=Object(e);++a<d;){var b=i[a];b&&s(e,b,a,h)}return e})}var gP=Object.prototype;function wu(s){var e=s&&s.constructor,i=typeof e=="function"&&e.prototype||gP;return s===i}function mP(s,e){for(var i=-1,a=Array(s);++i<s;)a[i]=e(i);return a}var pP="[object Arguments]";function Jb(s){return Je(s)&&Mi(s)==pP}var Q_=Object.prototype,bP=Q_.hasOwnProperty,wP=Q_.propertyIsEnumerable,_P=Jb(function(){return arguments}())?Jb:function(s){return Je(s)&&bP.call(s,"callee")&&!wP.call(s,"callee")};const $d=_P;function kP(){return!1}var X_=typeof Ce=="object"&&Ce&&!Ce.nodeType&&Ce,Qb=X_&&typeof xe=="object"&&xe&&!xe.nodeType&&xe,vP=Qb&&Qb.exports===X_,Xb=vP?Xe.Buffer:void 0,yP=Xb?Xb.isBuffer:void 0,AP=yP||kP;const Qs=AP;var CP="[object Arguments]",xP="[object Array]",EP="[object Boolean]",TP="[object Date]",SP="[object Error]",PP="[object Function]",IP="[object Map]",MP="[object Number]",RP="[object Object]",OP="[object RegExp]",NP="[object Set]",DP="[object String]",LP="[object WeakMap]",VP="[object ArrayBuffer]",BP="[object DataView]",FP="[object Float32Array]",zP="[object Float64Array]",jP="[object Int8Array]",$P="[object Int16Array]",HP="[object Int32Array]",WP="[object Uint8Array]",qP="[object Uint8ClampedArray]",UP="[object Uint16Array]",GP="[object Uint32Array]",St={};St[FP]=St[zP]=St[jP]=St[$P]=St[HP]=St[WP]=St[qP]=St[UP]=St[GP]=!0;St[CP]=St[xP]=St[VP]=St[EP]=St[BP]=St[TP]=St[SP]=St[PP]=St[IP]=St[MP]=St[RP]=St[OP]=St[NP]=St[DP]=St[LP]=!1;function KP(s){return Je(s)&&Y_(s.length)&&!!St[Mi(s)]}function Qa(s){return function(e){return s(e)}}var Z_=typeof Ce=="object"&&Ce&&!Ce.nodeType&&Ce,Us=Z_&&typeof xe=="object"&&xe&&!xe.nodeType&&xe,YP=Us&&Us.exports===Z_,vd=YP&&j_.process,JP=function(){try{var s=Us&&Us.require&&Us.require("util").types;return s||vd&&vd.binding&&vd.binding("util")}catch{}}();const Oo=JP;var Zb=Oo&&Oo.isTypedArray,QP=Zb?Qa(Zb):KP;const _u=QP;var XP=Object.prototype,ZP=XP.hasOwnProperty;function tk(s,e){var i=_e(s),a=!i&&$d(s),d=!i&&!a&&Qs(s),h=!i&&!a&&!d&&_u(s),f=i||a||d||h,b=f?mP(s.length,String):[],k=b.length;for(var C in s)(e||ZP.call(s,C))&&!(f&&(C=="length"||d&&(C=="offset"||C=="parent")||h&&(C=="buffer"||C=="byteLength"||C=="byteOffset")||U_(C,k)))&&b.push(C);return b}function ek(s,e){return function(i){return s(e(i))}}var tI=ek(Object.keys,Object);const eI=tI;var nI=Object.prototype,iI=nI.hasOwnProperty;function oI(s){if(!wu(s))return eI(s);var e=[];for(var i in Object(s))iI.call(s,i)&&i!="constructor"&&e.push(i);return e}function ku(s){return Ja(s)?tk(s):oI(s)}function sI(s){var e=[];if(s!=null)for(var i in Object(s))e.push(i);return e}var rI=Object.prototype,aI=rI.hasOwnProperty;function lI(s){if(!ge(s))return sI(s);var e=wu(s),i=[];for(var a in s)a=="constructor"&&(e||!aI.call(s,a))||i.push(a);return i}function zo(s){return Ja(s)?tk(s,!0):lI(s)}var cI=J_(function(s,e){Fo(e,zo(e),s)});const dI=cI;var uI=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,hI=/^\w*$/;function fI(s,e){if(_e(s))return!1;var i=typeof s;return i=="number"||i=="symbol"||i=="boolean"||s==null||Ya(s)?!0:hI.test(s)||!uI.test(s)||e!=null&&s in Object(e)}var gI=Oi(Object,"create");const Xs=gI;function mI(){this.__data__=Xs?Xs(null):{},this.size=0}function pI(s){var e=this.has(s)&&delete this.__data__[s];return this.size-=e?1:0,e}var bI="__lodash_hash_undefined__",wI=Object.prototype,_I=wI.hasOwnProperty;function kI(s){var e=this.__data__;if(Xs){var i=e[s];return i===bI?void 0:i}return _I.call(e,s)?e[s]:void 0}var vI=Object.prototype,yI=vI.hasOwnProperty;function AI(s){var e=this.__data__;return Xs?e[s]!==void 0:yI.call(e,s)}var CI="__lodash_hash_undefined__";function xI(s,e){var i=this.__data__;return this.size+=this.has(s)?0:1,i[s]=Xs&&e===void 0?CI:e,this}function Si(s){var e=-1,i=s==null?0:s.length;for(this.clear();++e<i;){var a=s[e];this.set(a[0],a[1])}}Si.prototype.clear=mI;Si.prototype.delete=pI;Si.prototype.get=kI;Si.prototype.has=AI;Si.prototype.set=xI;function EI(){this.__data__=[],this.size=0}function Xa(s,e){for(var i=s.length;i--;)if(gr(s[i][0],e))return i;return-1}var TI=Array.prototype,SI=TI.splice;function PI(s){var e=this.__data__,i=Xa(e,s);if(i<0)return!1;var a=e.length-1;return i==a?e.pop():SI.call(e,i,1),--this.size,!0}function II(s){var e=this.__data__,i=Xa(e,s);return i<0?void 0:e[i][1]}function MI(s){return Xa(this.__data__,s)>-1}function RI(s,e){var i=this.__data__,a=Xa(i,s);return a<0?(++this.size,i.push([s,e])):i[a][1]=e,this}function Rn(s){var e=-1,i=s==null?0:s.length;for(this.clear();++e<i;){var a=s[e];this.set(a[0],a[1])}}Rn.prototype.clear=EI;Rn.prototype.delete=PI;Rn.prototype.get=II;Rn.prototype.has=MI;Rn.prototype.set=RI;var OI=Oi(Xe,"Map");const Zs=OI;function NI(){this.size=0,this.__data__={hash:new Si,map:new(Zs||Rn),string:new Si}}function DI(s){var e=typeof s;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?s!=="__proto__":s===null}function Za(s,e){var i=s.__data__;return DI(e)?i[typeof e=="string"?"string":"hash"]:i.map}function LI(s){var e=Za(this,s).delete(s);return this.size-=e?1:0,e}function VI(s){return Za(this,s).get(s)}function BI(s){return Za(this,s).has(s)}function FI(s,e){var i=Za(this,s),a=i.size;return i.set(s,e),this.size+=i.size==a?0:1,this}function On(s){var e=-1,i=s==null?0:s.length;for(this.clear();++e<i;){var a=s[e];this.set(a[0],a[1])}}On.prototype.clear=NI;On.prototype.delete=LI;On.prototype.get=VI;On.prototype.has=BI;On.prototype.set=FI;var zI="Expected a function";function vu(s,e){if(typeof s!="function"||e!=null&&typeof e!="function")throw new TypeError(zI);var i=function(){var a=arguments,d=e?e.apply(this,a):a[0],h=i.cache;if(h.has(d))return h.get(d);var f=s.apply(this,a);return i.cache=h.set(d,f)||h,f};return i.cache=new(vu.Cache||On),i}vu.Cache=On;var jI=500;function $I(s){var e=vu(s,function(a){return i.size===jI&&i.clear(),a}),i=e.cache;return e}var HI=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,WI=/\\(\\)?/g,qI=$I(function(s){var e=[];return s.charCodeAt(0)===46&&e.push(""),s.replace(HI,function(i,a,d,h){e.push(d?h.replace(WI,"$1"):a||i)}),e});const UI=qI;function mr(s){return s==null?"":W_(s)}function nk(s,e){return _e(s)?s:fI(s,e)?[s]:UI(mr(s))}var GI=1/0;function ik(s){if(typeof s=="string"||Ya(s))return s;var e=s+"";return e=="0"&&1/s==-GI?"-0":e}function ok(s,e){e=nk(e,s);for(var i=0,a=e.length;s!=null&&i<a;)s=s[ik(e[i++])];return i&&i==a?s:void 0}function KI(s,e,i){var a=s==null?void 0:ok(s,e);return a===void 0?i:a}function sk(s,e){for(var i=-1,a=e.length,d=s.length;++i<a;)s[d+i]=e[i];return s}var YI=ek(Object.getPrototypeOf,Object);const yu=YI;var JI="[object Object]",QI=Function.prototype,XI=Object.prototype,rk=QI.toString,ZI=XI.hasOwnProperty,tM=rk.call(Object);function Mn(s){if(!Je(s)||Mi(s)!=JI)return!1;var e=yu(s);if(e===null)return!0;var i=ZI.call(e,"constructor")&&e.constructor;return typeof i=="function"&&i instanceof i&&rk.call(i)==tM}function ak(s,e,i){var a=-1,d=s.length;e<0&&(e=-e>d?0:d+e),i=i>d?d:i,i<0&&(i+=d),d=e>i?0:i-e>>>0,e>>>=0;for(var h=Array(d);++a<d;)h[a]=s[a+e];return h}function eM(s,e,i){var a=s.length;return i=i===void 0?a:i,!e&&i>=a?s:ak(s,e,i)}var nM="\\ud800-\\udfff",iM="\\u0300-\\u036f",oM="\\ufe20-\\ufe2f",sM="\\u20d0-\\u20ff",rM=iM+oM+sM,aM="\\ufe0e\\ufe0f",lM="\\u200d",cM=RegExp("["+lM+nM+rM+aM+"]");function lk(s){return cM.test(s)}function dM(s){return s.split("")}var ck="\\ud800-\\udfff",uM="\\u0300-\\u036f",hM="\\ufe20-\\ufe2f",fM="\\u20d0-\\u20ff",gM=uM+hM+fM,mM="\\ufe0e\\ufe0f",pM="["+ck+"]",Hd="["+gM+"]",Wd="\\ud83c[\\udffb-\\udfff]",bM="(?:"+Hd+"|"+Wd+")",dk="[^"+ck+"]",uk="(?:\\ud83c[\\udde6-\\uddff]){2}",hk="[\\ud800-\\udbff][\\udc00-\\udfff]",wM="\\u200d",fk=bM+"?",gk="["+mM+"]?",_M="(?:"+wM+"(?:"+[dk,uk,hk].join("|")+")"+gk+fk+")*",kM=gk+fk+_M,vM="(?:"+[dk+Hd+"?",Hd,uk,hk,pM].join("|")+")",yM=RegExp(Wd+"(?="+Wd+")|"+vM+kM,"g");function AM(s){return s.match(yM)||[]}function CM(s){return lk(s)?AM(s):dM(s)}function xM(s){return function(e){e=mr(e);var i=lk(e)?CM(e):void 0,a=i?i[0]:e.charAt(0),d=i?eM(i,1).join(""):e.slice(1);return a[s]()+d}}var EM=xM("toUpperCase");const TM=EM;function SM(s,e,i,a){var d=-1,h=s==null?0:s.length;for(a&&h&&(i=s[++d]);++d<h;)i=e(i,s[d],d,s);return i}function PM(s){return function(e){return s==null?void 0:s[e]}}var IM={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},MM=PM(IM);const RM=MM;var OM=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,NM="\\u0300-\\u036f",DM="\\ufe20-\\ufe2f",LM="\\u20d0-\\u20ff",VM=NM+DM+LM,BM="["+VM+"]",FM=RegExp(BM,"g");function zM(s){return s=mr(s),s&&s.replace(OM,RM).replace(FM,"")}var jM=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function $M(s){return s.match(jM)||[]}var HM=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function WM(s){return HM.test(s)}var mk="\\ud800-\\udfff",qM="\\u0300-\\u036f",UM="\\ufe20-\\ufe2f",GM="\\u20d0-\\u20ff",KM=qM+UM+GM,pk="\\u2700-\\u27bf",bk="a-z\\xdf-\\xf6\\xf8-\\xff",YM="\\xac\\xb1\\xd7\\xf7",JM="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",QM="\\u2000-\\u206f",XM=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",wk="A-Z\\xc0-\\xd6\\xd8-\\xde",ZM="\\ufe0e\\ufe0f",_k=YM+JM+QM+XM,kk="['’]",tw="["+_k+"]",t2="["+KM+"]",vk="\\d+",e2="["+pk+"]",yk="["+bk+"]",Ak="[^"+mk+_k+vk+pk+bk+wk+"]",n2="\\ud83c[\\udffb-\\udfff]",i2="(?:"+t2+"|"+n2+")",o2="[^"+mk+"]",Ck="(?:\\ud83c[\\udde6-\\uddff]){2}",xk="[\\ud800-\\udbff][\\udc00-\\udfff]",Co="["+wk+"]",s2="\\u200d",ew="(?:"+yk+"|"+Ak+")",r2="(?:"+Co+"|"+Ak+")",nw="(?:"+kk+"(?:d|ll|m|re|s|t|ve))?",iw="(?:"+kk+"(?:D|LL|M|RE|S|T|VE))?",Ek=i2+"?",Tk="["+ZM+"]?",a2="(?:"+s2+"(?:"+[o2,Ck,xk].join("|")+")"+Tk+Ek+")*",l2="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",c2="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",d2=Tk+Ek+a2,u2="(?:"+[e2,Ck,xk].join("|")+")"+d2,h2=RegExp([Co+"?"+yk+"+"+nw+"(?="+[tw,Co,"$"].join("|")+")",r2+"+"+iw+"(?="+[tw,Co+ew,"$"].join("|")+")",Co+"?"+ew+"+"+nw,Co+"+"+iw,c2,l2,vk,u2].join("|"),"g");function f2(s){return s.match(h2)||[]}function g2(s,e,i){return s=mr(s),e=i?void 0:e,e===void 0?WM(s)?f2(s):$M(s):s.match(e)||[]}var m2="['’]",p2=RegExp(m2,"g");function b2(s){return function(e){return SM(g2(zM(e).replace(p2,"")),s,"")}}function w2(){this.__data__=new Rn,this.size=0}function _2(s){var e=this.__data__,i=e.delete(s);return this.size=e.size,i}function k2(s){return this.__data__.get(s)}function v2(s){return this.__data__.has(s)}var y2=200;function A2(s,e){var i=this.__data__;if(i instanceof Rn){var a=i.__data__;if(!Zs||a.length<y2-1)return a.push([s,e]),this.size=++i.size,this;i=this.__data__=new On(a)}return i.set(s,e),this.size=i.size,this}function hn(s){var e=this.__data__=new Rn(s);this.size=e.size}hn.prototype.clear=w2;hn.prototype.delete=_2;hn.prototype.get=k2;hn.prototype.has=v2;hn.prototype.set=A2;function C2(s,e){return s&&Fo(e,ku(e),s)}function x2(s,e){return s&&Fo(e,zo(e),s)}var Sk=typeof Ce=="object"&&Ce&&!Ce.nodeType&&Ce,ow=Sk&&typeof xe=="object"&&xe&&!xe.nodeType&&xe,E2=ow&&ow.exports===Sk,sw=E2?Xe.Buffer:void 0,rw=sw?sw.allocUnsafe:void 0;function Pk(s,e){if(e)return s.slice();var i=s.length,a=rw?rw(i):new s.constructor(i);return s.copy(a),a}function T2(s,e){for(var i=-1,a=s==null?0:s.length,d=0,h=[];++i<a;){var f=s[i];e(f,i,s)&&(h[d++]=f)}return h}function Ik(){return[]}var S2=Object.prototype,P2=S2.propertyIsEnumerable,aw=Object.getOwnPropertySymbols,I2=aw?function(s){return s==null?[]:(s=Object(s),T2(aw(s),function(e){return P2.call(s,e)}))}:Ik;const Au=I2;function M2(s,e){return Fo(s,Au(s),e)}var R2=Object.getOwnPropertySymbols,O2=R2?function(s){for(var e=[];s;)sk(e,Au(s)),s=yu(s);return e}:Ik;const Mk=O2;function N2(s,e){return Fo(s,Mk(s),e)}function Rk(s,e,i){var a=e(s);return _e(s)?a:sk(a,i(s))}function qd(s){return Rk(s,ku,Au)}function D2(s){return Rk(s,zo,Mk)}var L2=Oi(Xe,"DataView");const Ud=L2;var V2=Oi(Xe,"Promise");const Gd=V2;var B2=Oi(Xe,"Set");const Kd=B2;var lw="[object Map]",F2="[object Object]",cw="[object Promise]",dw="[object Set]",uw="[object WeakMap]",hw="[object DataView]",z2=Ri(Ud),j2=Ri(Zs),$2=Ri(Gd),H2=Ri(Kd),W2=Ri(jd),vi=Mi;(Ud&&vi(new Ud(new ArrayBuffer(1)))!=hw||Zs&&vi(new Zs)!=lw||Gd&&vi(Gd.resolve())!=cw||Kd&&vi(new Kd)!=dw||jd&&vi(new jd)!=uw)&&(vi=function(s){var e=Mi(s),i=e==F2?s.constructor:void 0,a=i?Ri(i):"";if(a)switch(a){case z2:return hw;case j2:return lw;case $2:return cw;case H2:return dw;case W2:return uw}return e});const tr=vi;var q2=Object.prototype,U2=q2.hasOwnProperty;function G2(s){var e=s.length,i=new s.constructor(e);return e&&typeof s[0]=="string"&&U2.call(s,"index")&&(i.index=s.index,i.input=s.input),i}var K2=Xe.Uint8Array;const Da=K2;function Cu(s){var e=new s.constructor(s.byteLength);return new Da(e).set(new Da(s)),e}function Y2(s,e){var i=e?Cu(s.buffer):s.buffer;return new s.constructor(i,s.byteOffset,s.byteLength)}var J2=/\w*$/;function Q2(s){var e=new s.constructor(s.source,J2.exec(s));return e.lastIndex=s.lastIndex,e}var fw=gn?gn.prototype:void 0,gw=fw?fw.valueOf:void 0;function X2(s){return gw?Object(gw.call(s)):{}}function Ok(s,e){var i=e?Cu(s.buffer):s.buffer;return new s.constructor(i,s.byteOffset,s.length)}var Z2="[object Boolean]",tR="[object Date]",eR="[object Map]",nR="[object Number]",iR="[object RegExp]",oR="[object Set]",sR="[object String]",rR="[object Symbol]",aR="[object ArrayBuffer]",lR="[object DataView]",cR="[object Float32Array]",dR="[object Float64Array]",uR="[object Int8Array]",hR="[object Int16Array]",fR="[object Int32Array]",gR="[object Uint8Array]",mR="[object Uint8ClampedArray]",pR="[object Uint16Array]",bR="[object Uint32Array]";function wR(s,e,i){var a=s.constructor;switch(e){case aR:return Cu(s);case Z2:case tR:return new a(+s);case lR:return Y2(s,i);case cR:case dR:case uR:case hR:case fR:case gR:case mR:case pR:case bR:return Ok(s,i);case eR:return new a;case nR:case sR:return new a(s);case iR:return Q2(s);case oR:return new a;case rR:return X2(s)}}function Nk(s){return typeof s.constructor=="function"&&!wu(s)?WS(yu(s)):{}}var _R="[object Map]";function kR(s){return Je(s)&&tr(s)==_R}var mw=Oo&&Oo.isMap,vR=mw?Qa(mw):kR;const yR=vR;var AR="[object Set]";function CR(s){return Je(s)&&tr(s)==AR}var pw=Oo&&Oo.isSet,xR=pw?Qa(pw):CR;const ER=xR;var TR=1,SR=2,PR=4,Dk="[object Arguments]",IR="[object Array]",MR="[object Boolean]",RR="[object Date]",OR="[object Error]",Lk="[object Function]",NR="[object GeneratorFunction]",DR="[object Map]",LR="[object Number]",Vk="[object Object]",VR="[object RegExp]",BR="[object Set]",FR="[object String]",zR="[object Symbol]",jR="[object WeakMap]",$R="[object ArrayBuffer]",HR="[object DataView]",WR="[object Float32Array]",qR="[object Float64Array]",UR="[object Int8Array]",GR="[object Int16Array]",KR="[object Int32Array]",YR="[object Uint8Array]",JR="[object Uint8ClampedArray]",QR="[object Uint16Array]",XR="[object Uint32Array]",xt={};xt[Dk]=xt[IR]=xt[$R]=xt[HR]=xt[MR]=xt[RR]=xt[WR]=xt[qR]=xt[UR]=xt[GR]=xt[KR]=xt[DR]=xt[LR]=xt[Vk]=xt[VR]=xt[BR]=xt[FR]=xt[zR]=xt[YR]=xt[JR]=xt[QR]=xt[XR]=!0;xt[OR]=xt[Lk]=xt[jR]=!1;function Po(s,e,i,a,d,h){var f,b=e&TR,k=e&SR,C=e&PR;if(i&&(f=d?i(s,a,d,h):i(s)),f!==void 0)return f;if(!ge(s))return s;var y=_e(s);if(y){if(f=G2(s),!b)return pu(s,f)}else{var P=tr(s),R=P==Lk||P==NR;if(Qs(s))return Pk(s,b);if(P==Vk||P==Dk||R&&!d){if(f=k||R?{}:Nk(s),!b)return k?N2(s,x2(f,s)):M2(s,C2(f,s))}else{if(!xt[P])return d?s:{};f=wR(s,P,b)}}h||(h=new hn);var D=h.get(s);if(D)return D;h.set(s,f),ER(s)?s.forEach(function(nt){f.add(Po(nt,e,i,nt,s,h))}):yR(s)&&s.forEach(function(nt,ot){f.set(ot,Po(nt,e,i,ot,s,h))});var $=C?k?D2:qd:k?zo:ku,Z=y?void 0:$(s);return nP(Z||s,function(nt,ot){Z&&(ot=nt,nt=s[ot]),G_(f,ot,Po(nt,e,i,ot,s,h))}),f}var ZR=4;function Bk(s){return Po(s,ZR)}var tO=1,eO=4;function nO(s){return Po(s,tO|eO)}var iO=1,oO=4;function sO(s,e){return e=typeof e=="function"?e:void 0,Po(s,iO|oO,e)}var rO="__lodash_hash_undefined__";function aO(s){return this.__data__.set(s,rO),this}function lO(s){return this.__data__.has(s)}function La(s){var e=-1,i=s==null?0:s.length;for(this.__data__=new On;++e<i;)this.add(s[e])}La.prototype.add=La.prototype.push=aO;La.prototype.has=lO;function cO(s,e){for(var i=-1,a=s==null?0:s.length;++i<a;)if(e(s[i],i,s))return!0;return!1}function dO(s,e){return s.has(e)}var uO=1,hO=2;function Fk(s,e,i,a,d,h){var f=i&uO,b=s.length,k=e.length;if(b!=k&&!(f&&k>b))return!1;var C=h.get(s),y=h.get(e);if(C&&y)return C==e&&y==s;var P=-1,R=!0,D=i&hO?new La:void 0;for(h.set(s,e),h.set(e,s);++P<b;){var $=s[P],Z=e[P];if(a)var nt=f?a(Z,$,P,e,s,h):a($,Z,P,s,e,h);if(nt!==void 0){if(nt)continue;R=!1;break}if(D){if(!cO(e,function(ot,Lt){if(!dO(D,Lt)&&($===ot||d($,ot,i,a,h)))return D.push(Lt)})){R=!1;break}}else if(!($===Z||d($,Z,i,a,h))){R=!1;break}}return h.delete(s),h.delete(e),R}function fO(s){var e=-1,i=Array(s.size);return s.forEach(function(a,d){i[++e]=[d,a]}),i}function gO(s){var e=-1,i=Array(s.size);return s.forEach(function(a){i[++e]=a}),i}var mO=1,pO=2,bO="[object Boolean]",wO="[object Date]",_O="[object Error]",kO="[object Map]",vO="[object Number]",yO="[object RegExp]",AO="[object Set]",CO="[object String]",xO="[object Symbol]",EO="[object ArrayBuffer]",TO="[object DataView]",bw=gn?gn.prototype:void 0,yd=bw?bw.valueOf:void 0;function SO(s,e,i,a,d,h,f){switch(i){case TO:if(s.byteLength!=e.byteLength||s.byteOffset!=e.byteOffset)return!1;s=s.buffer,e=e.buffer;case EO:return!(s.byteLength!=e.byteLength||!h(new Da(s),new Da(e)));case bO:case wO:case vO:return gr(+s,+e);case _O:return s.name==e.name&&s.message==e.message;case yO:case CO:return s==e+"";case kO:var b=fO;case AO:var k=a&mO;if(b||(b=gO),s.size!=e.size&&!k)return!1;var C=f.get(s);if(C)return C==e;a|=pO,f.set(s,e);var y=Fk(b(s),b(e),a,d,h,f);return f.delete(s),y;case xO:if(yd)return yd.call(s)==yd.call(e)}return!1}var PO=1,IO=Object.prototype,MO=IO.hasOwnProperty;function RO(s,e,i,a,d,h){var f=i&PO,b=qd(s),k=b.length,C=qd(e),y=C.length;if(k!=y&&!f)return!1;for(var P=k;P--;){var R=b[P];if(!(f?R in e:MO.call(e,R)))return!1}var D=h.get(s),$=h.get(e);if(D&&$)return D==e&&$==s;var Z=!0;h.set(s,e),h.set(e,s);for(var nt=f;++P<k;){R=b[P];var ot=s[R],Lt=e[R];if(a)var J=f?a(Lt,ot,R,e,s,h):a(ot,Lt,R,s,e,h);if(!(J===void 0?ot===Lt||d(ot,Lt,i,a,h):J)){Z=!1;break}nt||(nt=R=="constructor")}if(Z&&!nt){var G=s.constructor,Q=e.constructor;G!=Q&&"constructor"in s&&"constructor"in e&&!(typeof G=="function"&&G instanceof G&&typeof Q=="function"&&Q instanceof Q)&&(Z=!1)}return h.delete(s),h.delete(e),Z}var OO=1,ww="[object Arguments]",_w="[object Array]",ma="[object Object]",NO=Object.prototype,kw=NO.hasOwnProperty;function DO(s,e,i,a,d,h){var f=_e(s),b=_e(e),k=f?_w:tr(s),C=b?_w:tr(e);k=k==ww?ma:k,C=C==ww?ma:C;var y=k==ma,P=C==ma,R=k==C;if(R&&Qs(s)){if(!Qs(e))return!1;f=!0,y=!1}if(R&&!y)return h||(h=new hn),f||_u(s)?Fk(s,e,i,a,d,h):SO(s,e,k,i,a,d,h);if(!(i&OO)){var D=y&&kw.call(s,"__wrapped__"),$=P&&kw.call(e,"__wrapped__");if(D||$){var Z=D?s.value():s,nt=$?e.value():e;return h||(h=new hn),d(Z,nt,i,a,h)}}return R?(h||(h=new hn),RO(s,e,i,a,d,h)):!1}function zk(s,e,i,a,d){return s===e?!0:s==null||e==null||!Je(s)&&!Je(e)?s!==s&&e!==e:DO(s,e,i,a,zk,d)}function LO(s){return function(e,i,a){for(var d=-1,h=Object(e),f=a(e),b=f.length;b--;){var k=f[s?b:++d];if(i(h[k],k,h)===!1)break}return e}}var VO=LO();const BO=VO;var FO=function(){return Xe.Date.now()};const Ad=FO;var zO="Expected a function",jO=Math.max,$O=Math.min;function HO(s,e,i){var a,d,h,f,b,k,C=0,y=!1,P=!1,R=!0;if(typeof s!="function")throw new TypeError(zO);e=Ub(e)||0,ge(i)&&(y=!!i.leading,P="maxWait"in i,h=P?jO(Ub(i.maxWait)||0,e):h,R="trailing"in i?!!i.trailing:R);function D(B){var K=a,W=d;return a=d=void 0,C=B,f=s.apply(W,K),f}function $(B){return C=B,b=setTimeout(ot,e),y?D(B):f}function Z(B){var K=B-k,W=B-C,it=e-K;return P?$O(it,h-W):it}function nt(B){var K=B-k,W=B-C;return k===void 0||K>=e||K<0||P&&W>=h}function ot(){var B=Ad();if(nt(B))return Lt(B);b=setTimeout(ot,Z(B))}function Lt(B){return b=void 0,R&&a?D(B):(a=d=void 0,f)}function J(){b!==void 0&&clearTimeout(b),C=0,a=k=d=b=void 0}function G(){return b===void 0?f:Lt(Ad())}function Q(){var B=Ad(),K=nt(B);if(a=arguments,d=this,k=B,K){if(b===void 0)return $(k);if(P)return clearTimeout(b),b=setTimeout(ot,e),D(k)}return b===void 0&&(b=setTimeout(ot,e)),f}return Q.cancel=J,Q.flush=G,Q}function Yd(s,e,i){(i!==void 0&&!gr(s[e],i)||i===void 0&&!(e in s))&&bu(s,e,i)}function WO(s){return Je(s)&&Ja(s)}function Jd(s,e){if(!(e==="constructor"&&typeof s[e]=="function")&&e!="__proto__")return s[e]}function qO(s){return Fo(s,zo(s))}function UO(s,e,i,a,d,h,f){var b=Jd(s,i),k=Jd(e,i),C=f.get(k);if(C){Yd(s,i,C);return}var y=h?h(b,k,i+"",s,e,f):void 0,P=y===void 0;if(P){var R=_e(k),D=!R&&Qs(k),$=!R&&!D&&_u(k);y=k,R||D||$?_e(b)?y=b:WO(b)?y=pu(b):D?(P=!1,y=Pk(k,!0)):$?(P=!1,y=Ok(k,!0)):y=[]:Mn(k)||$d(k)?(y=b,$d(b)?y=qO(b):(!ge(b)||Js(b))&&(y=Nk(k))):P=!1}P&&(f.set(k,y),d(y,k,a,h,f),f.delete(k)),Yd(s,i,y)}function jk(s,e,i,a,d){s!==e&&BO(e,function(h,f){if(d||(d=new hn),ge(h))UO(s,e,f,i,jk,a,d);else{var b=a?a(Jd(s,f),h,f+"",s,e,d):void 0;b===void 0&&(b=h),Yd(s,f,b)}},zo)}var GO=J_(function(s,e,i,a){jk(s,e,i,a)});const KO=GO;function YO(s){var e=s==null?0:s.length;return e?s[e-1]:void 0}var $k=/[\\^$.*+?()[\]{}|]/g,JO=RegExp($k.source);function QO(s){return s=mr(s),s&&JO.test(s)?s.replace($k,"\\$&"):s}function XO(s,e){return e.length<2?s:ok(s,ak(e,0,-1))}function xu(s){return Je(s)&&s.nodeType===1&&!Mn(s)}function Va(s,e){return zk(s,e)}function ZO(s,e){return e=nk(e,s),s=XO(s,e),s==null||delete s[ik(YO(e))]}function t5(s,e,i,a){for(var d=i-1,h=s.length;++d<h;)if(a(s[d],e))return d;return-1}var e5=Array.prototype,vw=e5.splice;function n5(s,e,i,a){var d=a?t5:rP,h=-1,f=e.length,b=s;for(s===e&&(e=pu(e)),i&&(b=H_(s,Qa(i)));++h<f;)for(var k=0,C=e[h],y=i?i(C):C;(k=d(b,y,k,a))>-1;)b!==s&&vw.call(b,k,1),vw.call(s,k,1);return s}function i5(s,e){return s&&s.length&&e&&e.length?n5(s,e):s}var o5=K_(i5);const s5=o5;var r5=b2(function(s,e,i){return s+(i?" ":"")+TM(e)});const a5=r5;function l5(s,e){return s==null?!0:ZO(s,e)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Ba=Symbol("observableProperties"),tl=Symbol("boundObservables"),Fa=Symbol("boundProperties"),mo=Symbol("decoratedMethods"),yw=Symbol("decoratedOriginal"),Hk=Ae(wt());function Ae(s){if(!s)return Hk;class e extends s{set(a,d){if(ge(a)){Object.keys(a).forEach(f=>{this.set(f,a[f])},this);return}Cd(this);const h=this[Ba];if(a in this&&!h.has(a))throw new M("observable-set-cannot-override",this);Object.defineProperty(this,a,{enumerable:!0,configurable:!0,get(){return h.get(a)},set(f){const b=h.get(a);let k=this.fire(`set:${a}`,a,f,b);k===void 0&&(k=f),(b!==k||!h.has(a))&&(h.set(a,k),this.fire(`change:${a}`,a,k,b))}}),this[a]=d}bind(...a){if(!a.length||!Aw(a))throw new M("observable-bind-wrong-properties",this);if(new Set(a).size!==a.length)throw new M("observable-bind-duplicate-properties",this);Cd(this);const d=this[Fa];a.forEach(f=>{if(d.has(f))throw new M("observable-bind-rebind",this)});const h=new Map;return a.forEach(f=>{const b={property:f,to:[]};d.set(f,b),h.set(f,b)}),{to:c5,toMany:d5,_observable:this,_bindProperties:a,_to:[],_bindings:h}}unbind(...a){if(!this[Ba])return;const d=this[Fa],h=this[tl];if(a.length){if(!Aw(a))throw new M("observable-unbind-wrong-properties",this);a.forEach(f=>{const b=d.get(f);b&&(b.to.forEach(([k,C])=>{const y=h.get(k),P=y[C];P.delete(b),P.size||delete y[C],Object.keys(y).length||(h.delete(k),this.stopListening(k,"change"))}),d.delete(f))})}else h.forEach((f,b)=>{this.stopListening(b,"change")}),h.clear(),d.clear()}decorate(a){Cd(this);const d=this[a];if(!d)throw new M("observablemixin-cannot-decorate-undefined",this,{object:this,methodName:a});this.on(a,(h,f)=>{h.return=d.apply(this,f)}),this[a]=function(...h){return this.fire(a,h)},this[a][yw]=d,this[mo]||(this[mo]=[]),this[mo].push(a)}stopListening(a,d,h){if(!a&&this[mo]){for(const f of this[mo])this[f]=this[f][yw];delete this[mo]}super.stopListening(a,d,h)}}return e}["set","bind","unbind","decorate","on","once","off","listenTo","stopListening","fire","delegate","stopDelegating","_addEventListener","_removeEventListener"].forEach(s=>{Ae[s]=Hk.prototype[s]});function Cd(s){s[Ba]||(Object.defineProperty(s,Ba,{value:new Map}),Object.defineProperty(s,tl,{value:new Map}),Object.defineProperty(s,Fa,{value:new Map}))}function c5(...s){const e=h5(...s),i=Array.from(this._bindings.keys()),a=i.length;if(!e.callback&&e.to.length>1)throw new M("observable-bind-to-no-callback",this);if(a>1&&e.callback)throw new M("observable-bind-to-extra-callback",this);e.to.forEach(d=>{if(d.properties.length&&d.properties.length!==a)throw new M("observable-bind-to-properties-length",this);d.properties.length||(d.properties=this._bindProperties)}),this._to=e.to,e.callback&&(this._bindings.get(i[0]).callback=e.callback),m5(this._observable,this._to),g5(this),this._bindProperties.forEach(d=>{Wk(this._observable,d)})}function d5(s,e,i){if(this._bindings.size>1)throw new M("observable-bind-to-many-not-one-binding",this);this.to(...u5(s,e),i)}function u5(s,e){const i=s.map(a=>[a,e]);return Array.prototype.concat.apply([],i)}function Aw(s){return s.every(e=>typeof e=="string")}function h5(...s){if(!s.length)throw new M("observable-bind-to-parse-error",null);const e={to:[]};let i;return typeof s[s.length-1]=="function"&&(e.callback=s.pop()),s.forEach(a=>{if(typeof a=="string")i.properties.push(a);else if(typeof a=="object")i={observable:a,properties:[]},e.to.push(i);else throw new M("observable-bind-to-parse-error",null)}),e}function f5(s,e,i,a){const d=s[tl],h=d.get(i),f=h||{};f[a]||(f[a]=new Set),f[a].add(e),h||d.set(i,f)}function g5(s){let e;s._bindings.forEach((i,a)=>{s._to.forEach(d=>{e=d.properties[i.callback?0:s._bindProperties.indexOf(a)],i.to.push([d.observable,e]),f5(s._observable,i,d.observable,e)})})}function Wk(s,e){const a=s[Fa].get(e);let d;a.callback?d=a.callback.apply(s,a.to.map(h=>h[0][h[1]])):(d=a.to[0],d=d[0][d[1]]),Object.prototype.hasOwnProperty.call(s,e)?s[e]=d:s.set(e,d)}function m5(s,e){e.forEach(i=>{const a=s[tl];let d;a.get(i.observable)||s.listenTo(i.observable,"change",(h,f)=>{d=a.get(i.observable)[f],d&&d.forEach(b=>{Wk(s,b.property)})})})}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Qd(s){let e=0;for(const i of s)e++;return e}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function fe(s,e){const i=Math.min(s.length,e.length);for(let a=0;a<i;a++)if(s[a]!=e[a])return a;return s.length==e.length?"same":s.length<e.length?"prefix":"extension"}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function $e(s){return!!(s&&s[Symbol.iterator])}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function za(s){if(s){if(s.defaultView)return s instanceof s.defaultView.Document;if(s.ownerDocument&&s.ownerDocument.defaultView)return s instanceof s.ownerDocument.defaultView.Node}return!1}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function ja(s){const e=Object.prototype.toString.apply(s);return e=="[object Window]"||e=="[object global]"}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const qk=Ni(wt());function Ni(s){if(!s)return qk;class e extends s{listenTo(a,d,h,f={}){if(za(a)||ja(a)){const b={capture:!!f.useCapture,passive:!!f.usePassive},k=this._getProxyEmitter(a,b)||new p5(a,b);this.listenTo(k,d,h,f)}else super.listenTo(a,d,h,f)}stopListening(a,d,h){if(za(a)||ja(a)){const f=this._getAllProxyEmitters(a);for(const b of f)this.stopListening(b,d,h)}else super.stopListening(a,d,h)}_getProxyEmitter(a,d){return XT(this,Uk(a,d))}_getAllProxyEmitters(a){return[{capture:!1,passive:!1},{capture:!1,passive:!0},{capture:!0,passive:!1},{capture:!0,passive:!0}].map(d=>this._getProxyEmitter(a,d)).filter(d=>!!d)}}return e}["_getProxyEmitter","_getAllProxyEmitters","on","once","off","listenTo","stopListening","fire","delegate","stopDelegating","_addEventListener","_removeEventListener"].forEach(s=>{Ni[s]=qk.prototype[s]});class p5 extends wt(){constructor(e,i){super(),B_(this,Uk(e,i)),this._domNode=e,this._options=i}attach(e){if(this._domListeners&&this._domListeners[e])return;const i=this._createDomListener(e);this._domNode.addEventListener(e,i,this._options),this._domListeners||(this._domListeners={}),this._domListeners[e]=i}detach(e){let i;this._domListeners[e]&&(!(i=this._events[e])||!i.callbacks.length)&&this._domListeners[e].removeListener()}_addEventListener(e,i,a){this.attach(e),wt().prototype._addEventListener.call(this,e,i,a)}_removeEventListener(e,i){wt().prototype._removeEventListener.call(this,e,i),this.detach(e)}_createDomListener(e){const i=a=>{this.fire(e,a)};return i.removeListener=()=>{this._domNode.removeEventListener(e,i,this._options),delete this._domListeners[e]},i}}function b5(s){return s["data-ck-expando"]||(s["data-ck-expando"]=Yn())}function Uk(s,e){let i=b5(s);for(const a of Object.keys(e).sort())e[a]&&(i+="-"+a);return i}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let Xd;try{Xd={window,document}}catch{/* istanbul ignore next -- @preserve */Xd={window:{},document:{}}}const ct=Xd;/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function w5(s){const e=[];let i=s;for(;i&&i.nodeType!=Node.DOCUMENT_NODE;)e.unshift(i),i=i.parentNode;return e}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Gk(s){const e=s.ownerDocument.defaultView.getComputedStyle(s);return{top:parseInt(e.borderTopWidth,10),right:parseInt(e.borderRightWidth,10),bottom:parseInt(e.borderBottomWidth,10),left:parseInt(e.borderLeftWidth,10)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Sn(s){return Object.prototype.toString.call(s)=="[object Text]"}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Kk(s){return Object.prototype.toString.apply(s)=="[object Range]"}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Yk(s){return!s||!s.parentNode||s.offsetParent===ct.document.body?null:s.offsetParent}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Jk=["top","right","bottom","left","width","height"];class Qt{constructor(e){const i=Kk(e);if(Object.defineProperty(this,"_source",{value:e._source||e,writable:!0,enumerable:!1}),Zd(e)||i)if(i){const a=Qt.getDomRangeRects(e);pa(this,Qt.getBoundingRect(a))}else pa(this,e.getBoundingClientRect());else if(ja(e)){const{innerWidth:a,innerHeight:d}=e;pa(this,{top:0,right:a,bottom:d,left:0,width:a,height:d})}else pa(this,e)}clone(){return new Qt(this)}moveTo(e,i){return this.top=i,this.right=e+this.width,this.bottom=i+this.height,this.left=e,this}moveBy(e,i){return this.top+=i,this.right+=e,this.left+=e,this.bottom+=i,this}getIntersection(e){const i={top:Math.max(this.top,e.top),right:Math.min(this.right,e.right),bottom:Math.min(this.bottom,e.bottom),left:Math.max(this.left,e.left),width:0,height:0};if(i.width=i.right-i.left,i.height=i.bottom-i.top,i.width<0||i.height<0)return null;{const a=new Qt(i);return a._source=this._source,a}}getIntersectionArea(e){const i=this.getIntersection(e);return i?i.getArea():0}getArea(){return this.width*this.height}getVisible(){const e=this._source;let i=this.clone();if(Cw(e))return i;let a=e,d=e.parentNode||e.commonAncestorContainer,h;for(;d&&!Cw(d);){const f=_5(d)==="visible";a instanceof HTMLElement&&xw(a)==="absolute"&&(h=a);const b=xw(d);if(f||h&&(b==="relative"&&f||b!=="relative")){a=d,d=d.parentNode;continue}const k=new Qt(d),C=i.getIntersection(k);if(C)C.getArea()<i.getArea()&&(i=C);else return null;a=d,d=d.parentNode}return i}isEqual(e){for(const i of Jk)if(this[i]!==e[i])return!1;return!0}contains(e){const i=this.getIntersection(e);return!!(i&&i.isEqual(e))}toAbsoluteRect(){const{scrollX:e,scrollY:i}=ct.window,a=this.clone().moveBy(e,i);if(Zd(a._source)){const d=Yk(a._source);d&&k5(a,d)}return a}excludeScrollbarsAndBorders(){const e=this._source;let i,a,d;if(ja(e))i=e.innerWidth-e.document.documentElement.clientWidth,a=e.innerHeight-e.document.documentElement.clientHeight,d=e.getComputedStyle(e.document.documentElement).direction;else{const h=Gk(e);i=e.offsetWidth-e.clientWidth-h.left-h.right,a=e.offsetHeight-e.clientHeight-h.top-h.bottom,d=e.ownerDocument.defaultView.getComputedStyle(e).direction,this.left+=h.left,this.top+=h.top,this.right-=h.right,this.bottom-=h.bottom,this.width=this.right-this.left,this.height=this.bottom-this.top}return this.width-=i,d==="ltr"?this.right-=i:this.left+=i,this.height-=a,this.bottom-=a,this}static getDomRangeRects(e){const i=[],a=Array.from(e.getClientRects());if(a.length)for(const d of a)i.push(new Qt(d));else{let d=e.startContainer;Sn(d)&&(d=d.parentNode);const h=new Qt(d.getBoundingClientRect());h.right=h.left,h.width=0,i.push(h)}return i}static getBoundingRect(e){const i={left:Number.POSITIVE_INFINITY,top:Number.POSITIVE_INFINITY,right:Number.NEGATIVE_INFINITY,bottom:Number.NEGATIVE_INFINITY,width:0,height:0};let a=0;for(const d of e)a++,i.left=Math.min(i.left,d.left),i.top=Math.min(i.top,d.top),i.right=Math.max(i.right,d.right),i.bottom=Math.max(i.bottom,d.bottom);return a==0?null:(i.width=i.right-i.left,i.height=i.bottom-i.top,new Qt(i))}}function pa(s,e){for(const i of Jk)s[i]=e[i]}function Cw(s){return Zd(s)?s===s.ownerDocument.body:!1}function Zd(s){return s!==null&&typeof s=="object"&&s.nodeType===1&&typeof s.getBoundingClientRect=="function"}function xw(s){return s instanceof HTMLElement?s.ownerDocument.defaultView.getComputedStyle(s).position:"static"}function _5(s){return s instanceof HTMLElement?s.ownerDocument.defaultView.getComputedStyle(s).overflow:"visible"}function k5(s,e){const i=new Qt(e),a=Gk(e);let d=0,h=0;d-=i.left,h-=i.top,d+=e.scrollLeft,h+=e.scrollTop,d-=a.left,h-=a.top,s.moveBy(d,h)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Rt{constructor(e,i){Rt._observerInstance||Rt._createObserver(),this._element=e,this._callback=i,Rt._addElementCallback(e,i),Rt._observerInstance.observe(e)}get element(){return this._element}destroy(){Rt._deleteElementCallback(this._element,this._callback)}static _addElementCallback(e,i){Rt._elementCallbacks||(Rt._elementCallbacks=new Map);let a=Rt._elementCallbacks.get(e);a||(a=new Set,Rt._elementCallbacks.set(e,a)),a.add(i)}static _deleteElementCallback(e,i){const a=Rt._getElementCallbacks(e);a&&(a.delete(i),a.size||(Rt._elementCallbacks.delete(e),Rt._observerInstance.unobserve(e))),Rt._elementCallbacks&&!Rt._elementCallbacks.size&&(Rt._observerInstance=null,Rt._elementCallbacks=null)}static _getElementCallbacks(e){return Rt._elementCallbacks?Rt._elementCallbacks.get(e):null}static _createObserver(){Rt._observerInstance=new ct.window.ResizeObserver(e=>{for(const i of e){const a=Rt._getElementCallbacks(i.target);if(a)for(const d of a)d(i)}})}}Rt._observerInstance=null;Rt._elementCallbacks=null;/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Eu(s){return e=>e+s}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function ba(s){let e=0;for(;s.previousSibling;)s=s.previousSibling,e++;return e}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function xd(s){return s&&s.nodeType===Node.COMMENT_NODE}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Qk(s){try{ct.document.createAttribute(s)}catch{return!1}return!0}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function tu(s){return!!(s&&s.getClientRects&&s.getClientRects().length)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Tu({element:s,target:e,positions:i,limiter:a,fitInViewport:d,viewportOffsetConfig:h}){Js(e)&&(e=e()),Js(a)&&(a=a());const f=Yk(s),b=v5(h),k=new Qt(s),C=Ew(e,b);let y;if(!C||!b.getIntersection(C))return null;const P={targetRect:C,elementRect:k,positionedElementAncestor:f,viewportRect:b};if(!a&&!d)y=new Xk(i[0],P);else{if(a){const R=Ew(a,b);R&&(P.limiterRect=R)}y=y5(i,P)}return y}function Ew(s,e){const i=new Qt(s).getVisible();return i?i.getIntersection(e):null}function v5(s){s=Object.assign({top:0,bottom:0,left:0,right:0},s);const e=new Qt(ct.window);return e.top+=s.top,e.height-=s.top,e.bottom-=s.bottom,e.height-=s.bottom,e}function y5(s,e){const{elementRect:i}=e,a=i.getArea(),d=s.map(b=>new Xk(b,e)).filter(b=>!!b.name);let h=0,f=null;for(const b of d){const{limiterIntersectionArea:k,viewportIntersectionArea:C}=b;if(k===a)return b;const y=C**2+k**2;y>h&&(h=y,f=b)}return f}class Xk{constructor(e,i){const a=e(i.targetRect,i.elementRect,i.viewportRect,i.limiterRect);if(!a)return;const{left:d,top:h,name:f,config:b}=a;this.name=f,this.config=b,this._positioningFunctionCoordinates={left:d,top:h},this._options=i}get left(){return this._absoluteRect.left}get top(){return this._absoluteRect.top}get limiterIntersectionArea(){const e=this._options.limiterRect;return e?e.getIntersectionArea(this._rect):0}get viewportIntersectionArea(){return this._options.viewportRect.getIntersectionArea(this._rect)}get _rect(){return this._cachedRect?this._cachedRect:(this._cachedRect=this._options.elementRect.clone().moveTo(this._positioningFunctionCoordinates.left,this._positioningFunctionCoordinates.top),this._cachedRect)}get _absoluteRect(){return this._cachedAbsoluteRect?this._cachedAbsoluteRect:(this._cachedAbsoluteRect=this._rect.toAbsoluteRect(),this._cachedAbsoluteRect)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const A5={ctrl:"⌃",cmd:"⌘",alt:"⌥",shift:"⇧"},C5={ctrl:"Ctrl+",alt:"Alt+",shift:"Shift+"},qt=S5(),x5=Object.fromEntries(Object.entries(qt).map(([s,e])=>[e,s.charAt(0).toUpperCase()+s.slice(1)]));function $a(s){let e;if(typeof s=="string"){if(e=qt[s.toLowerCase()],!e)throw new M("keyboard-unknown-key",null,{key:s})}else e=s.keyCode+(s.altKey?qt.alt:0)+(s.ctrlKey?qt.ctrl:0)+(s.shiftKey?qt.shift:0)+(s.metaKey?qt.cmd:0);return e}function Zk(s){return typeof s=="string"&&(s=P5(s)),s.map(e=>typeof e=="string"?E5(e):e).reduce((e,i)=>i+e,0)}function Tw(s){let e=Zk(s);return Object.entries(Ye.isMac||Ye.isiOS?A5:C5).reduce((d,[h,f])=>(e&qt[h]&&(e&=~qt[h],d+=f),d),"")+(e?x5[e]:"")}function tv(s,e){const i=e==="ltr";switch(s){case qt.arrowleft:return i?"left":"right";case qt.arrowright:return i?"right":"left";case qt.arrowup:return"up";case qt.arrowdown:return"down"}}function E5(s){if(s.endsWith("!"))return $a(s.slice(0,-1));const e=$a(s);return(Ye.isMac||Ye.isiOS)&&e==qt.ctrl?qt.cmd:e}function T5(s,e){const i=tv(s,e);return i==="down"||i==="right"}function S5(){const s={arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,delete:46,enter:13,space:32,esc:27,tab:9,ctrl:1114112,shift:2228224,alt:4456448,cmd:8912896};for(let e=65;e<=90;e++){const i=String.fromCharCode(e);s[i.toLowerCase()]=e}for(let e=48;e<=57;e++)s[e-48]=e;for(let e=112;e<=123;e++)s["f"+(e-111)]=e;for(const e of"`-=[];',./\\")s[e]=e.charCodeAt(0);return s}function P5(s){return s.split("+").map(e=>e.trim())}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function ke(s){return Array.isArray(s)?s:[s]}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 *//* istanbul ignore else -- @preserve */ct.window.CKEDITOR_TRANSLATIONS||(ct.window.CKEDITOR_TRANSLATIONS={});/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class pr extends wt(){constructor(e={},i={}){super();const a=$e(e);if(a||(i=e),this._items=[],this._itemMap=new Map,this._idProperty=i.idProperty||"id",this._bindToExternalToInternalMap=new WeakMap,this._bindToInternalToExternalMap=new WeakMap,this._skippedIndexesFromExternal=[],a)for(const d of e)this._items.push(d),this._itemMap.set(this._getItemIdBeforeAdding(d),d)}get length(){return this._items.length}get first(){return this._items[0]||null}get last(){return this._items[this.length-1]||null}add(e,i){return this.addMany([e],i)}addMany(e,i){if(i===void 0)i=this._items.length;else if(i>this._items.length||i<0)throw new M("collection-add-item-invalid-index",this);let a=0;for(const d of e){const h=this._getItemIdBeforeAdding(d),f=i+a;this._items.splice(f,0,d),this._itemMap.set(h,d),this.fire("add",d,f),a++}return this.fire("change",{added:e,removed:[],index:i}),this}get(e){let i;if(typeof e=="string")i=this._itemMap.get(e);else if(typeof e=="number")i=this._items[e];else throw new M("collection-get-invalid-arg",this);return i||null}has(e){if(typeof e=="string")return this._itemMap.has(e);{const i=this._idProperty,a=e[i];return a&&this._itemMap.has(a)}}getIndex(e){let i;return typeof e=="string"?i=this._itemMap.get(e):i=e,i?this._items.indexOf(i):-1}remove(e){const[i,a]=this._remove(e);return this.fire("change",{added:[],removed:[i],index:a}),i}map(e,i){return this._items.map(e,i)}forEach(e,i){this._items.forEach(e,i)}find(e,i){return this._items.find(e,i)}filter(e,i){return this._items.filter(e,i)}clear(){this._bindToCollection&&(this.stopListening(this._bindToCollection),this._bindToCollection=null);const e=Array.from(this._items);for(;this.length;)this._remove(0);this.fire("change",{added:[],removed:e,index:0})}bindTo(e){if(this._bindToCollection)throw new M("collection-bind-to-rebind",this);return this._bindToCollection=e,{as:i=>{this._setUpBindToBinding(a=>new i(a))},using:i=>{typeof i=="function"?this._setUpBindToBinding(i):this._setUpBindToBinding(a=>a[i])}}}_setUpBindToBinding(e){const i=this._bindToCollection,a=(d,h,f)=>{const b=i._bindToCollection==this,k=i._bindToInternalToExternalMap.get(h);if(b&&k)this._bindToExternalToInternalMap.set(h,k),this._bindToInternalToExternalMap.set(k,h);else{const C=e(h);if(!C){this._skippedIndexesFromExternal.push(f);return}let y=f;for(const P of this._skippedIndexesFromExternal)f>P&&y--;for(const P of i._skippedIndexesFromExternal)y>=P&&y++;this._bindToExternalToInternalMap.set(h,C),this._bindToInternalToExternalMap.set(C,h),this.add(C,y);for(let P=0;P<i._skippedIndexesFromExternal.length;P++)y<=i._skippedIndexesFromExternal[P]&&i._skippedIndexesFromExternal[P]++}};for(const d of i)a(null,d,i.getIndex(d));this.listenTo(i,"add",a),this.listenTo(i,"remove",(d,h,f)=>{const b=this._bindToExternalToInternalMap.get(h);b&&this.remove(b),this._skippedIndexesFromExternal=this._skippedIndexesFromExternal.reduce((k,C)=>(f<C&&k.push(C-1),f>C&&k.push(C),k),[])})}_getItemIdBeforeAdding(e){const i=this._idProperty;let a;if(i in e){if(a=e[i],typeof a!="string")throw new M("collection-add-invalid-id",this);if(this.get(a))throw new M("collection-add-item-already-exists",this)}else e[i]=a=Yn();return a}_remove(e){let i,a,d,h=!1;const f=this._idProperty;if(typeof e=="string"?(a=e,d=this._itemMap.get(a),h=!d,d&&(i=this._items.indexOf(d))):typeof e=="number"?(i=e,d=this._items[i],h=!d,d&&(a=d[f])):(d=e,a=d[f],i=this._items.indexOf(d),h=i==-1||!this._itemMap.get(a)),h)throw new M("collection-remove-404",this);this._items.splice(i,1),this._itemMap.delete(a);const b=this._bindToInternalToExternalMap.get(d);return this._bindToInternalToExternalMap.delete(d),this._bindToExternalToInternalMap.delete(b),this.fire("remove",d,i),[d,i]}[Symbol.iterator](){return this._items[Symbol.iterator]()}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function ev(s){const e=s.next();return e.done?null:e.value}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class jo extends Ni(Ae()){constructor(){super(),this._elements=new Set,this._nextEventLoopTimeout=null,this.set("isFocused",!1),this.set("focusedElement",null)}add(e){if(this._elements.has(e))throw new M("focustracker-add-element-already-exist",this);this.listenTo(e,"focus",()=>this._focus(e),{useCapture:!0}),this.listenTo(e,"blur",()=>this._blur(),{useCapture:!0}),this._elements.add(e)}remove(e){e===this.focusedElement&&this._blur(),this._elements.has(e)&&(this.stopListening(e),this._elements.delete(e))}destroy(){this.stopListening()}_focus(e){clearTimeout(this._nextEventLoopTimeout),this.focusedElement=e,this.isFocused=!0}_blur(){clearTimeout(this._nextEventLoopTimeout),this._nextEventLoopTimeout=setTimeout(()=>{this.focusedElement=null,this.isFocused=!1},0)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class el{constructor(){this._listener=new(Ni())}listenTo(e){this._listener.listenTo(e,"keydown",(i,a)=>{this._listener.fire("_keydown:"+$a(a),a)})}set(e,i,a={}){const d=Zk(e),h=a.priority;this._listener.listenTo(this._listener,"_keydown:"+d,(f,b)=>{i(b,()=>{b.preventDefault(),b.stopPropagation(),f.stop()}),f.return=!0},{priority:h})}press(e){return!!this._listener.fire("_keydown:"+$a(e),e)}stopListening(e){this._listener.stopListening(e)}destroy(){this.stopListening()}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function I5(s){const e=new Map;for(const i in s)e.set(i,s[i]);return e}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function er(s){return $e(s)?new Map(s):I5(s)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const M5=1e4;function R5(s,e,i,a){if(Math.max(e.length,s.length)>M5)return s.slice(0,i).concat(e).concat(s.slice(i+a,s.length));{const d=Array.from(s);return d.splice(i,a,...e),d}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function O5(s,e){let i;function a(...d){a.cancel(),i=setTimeout(()=>s(...d),e)}return a.cancel=()=>{clearTimeout(i)},a}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function N5(s){return!!s&&s.length==1&&/[\u0300-\u036f\u1ab0-\u1aff\u1dc0-\u1dff\u20d0-\u20ff\ufe20-\ufe2f]/.test(s)}function D5(s){return!!s&&s.length==1&&/[\ud800-\udbff]/.test(s)}function L5(s){return!!s&&s.length==1&&/[\udc00-\udfff]/.test(s)}function nv(s,e){return D5(s.charAt(e-1))&&L5(s.charAt(e))}function iv(s,e){return N5(s.charAt(e))}const V5=F5();function B5(s,e){const i=String(s).matchAll(V5);return Array.from(i).some(a=>a.index<e&&e<a.index+a[0].length)}function F5(){const s=[/\p{Emoji}[\u{E0020}-\u{E007E}]+\u{E007F}/u,/\p{Emoji}\u{FE0F}?\u{20E3}/u,/\p{Emoji}\u{FE0F}/u,/(?=\p{General_Category=Other_Symbol})\p{Emoji}\p{Emoji_Modifier}*/u],e=/\p{Regional_Indicator}{2}/u.source,i="(?:"+s.map(d=>d.source).join("|")+")",a=`${e}|${i}(?:‍${i})*`;return new RegExp(a,"ug")}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class oe extends Ae(){constructor(e){super(),this._disableStack=new Set,this.editor=e,this.set("isEnabled",!0)}forceDisabled(e){this._disableStack.add(e),this._disableStack.size==1&&(this.on("set:isEnabled",Sw,{priority:"highest"}),this.isEnabled=!1)}clearForceDisabled(e){this._disableStack.delete(e),this._disableStack.size==0&&(this.off("set:isEnabled",Sw),this.isEnabled=!0)}destroy(){this.stopListening()}static get isContextPlugin(){return!1}}function Sw(s){s.return=!1,s.stop()}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ov extends Ae(){constructor(e){super(),this.editor=e,this.set("value",void 0),this.set("isEnabled",!1),this._affectsData=!0,this._isEnabledBasedOnSelection=!0,this._disableStack=new Set,this.decorate("execute"),this.listenTo(this.editor.model.document,"change",()=>{this.refresh()}),this.listenTo(e,"change:isReadOnly",()=>{this.refresh()}),this.on("set:isEnabled",i=>{if(!this.affectsData)return;const a=e.model.document.selection,h=!(a.getFirstPosition().root.rootName=="$graveyard")&&e.model.canEditAt(a);(e.isReadOnly||this._isEnabledBasedOnSelection&&!h)&&(i.return=!1,i.stop())},{priority:"highest"}),this.on("execute",i=>{this.isEnabled||i.stop()},{priority:"high"})}get affectsData(){return this._affectsData}set affectsData(e){this._affectsData=e}refresh(){this.isEnabled=!0}forceDisabled(e){this._disableStack.add(e),this._disableStack.size==1&&(this.on("set:isEnabled",Pw,{priority:"highest"}),this.isEnabled=!1)}clearForceDisabled(e){this._disableStack.delete(e),this._disableStack.size==0&&(this.off("set:isEnabled",Pw),this.refresh())}execute(...e){}destroy(){this.stopListening()}}function Pw(s){s.return=!1,s.stop()}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class $F extends wt(){constructor(e,i=[],a=[]){super(),this._plugins=new Map,this._context=e,this._availablePlugins=new Map;for(const d of i)d.pluginName&&this._availablePlugins.set(d.pluginName,d);this._contextPlugins=new Map;for(const[d,h]of a)this._contextPlugins.set(d,h),this._contextPlugins.set(h,d),d.pluginName&&this._availablePlugins.set(d.pluginName,d)}*[Symbol.iterator](){for(const e of this._plugins)typeof e[0]=="function"&&(yield e)}get(e){const i=this._plugins.get(e);if(!i){let a=e;throw typeof e=="function"&&(a=e.pluginName||e.name),new M("plugincollection-plugin-not-loaded",this._context,{plugin:a})}return i}has(e){return this._plugins.has(e)}init(e,i=[],a=[]){const d=this,h=this._context;D(e),Z(e);const f=e.filter(B=>!P(B,i)),b=[...$(f)];Q(b,a);const k=J(b);return G(k,"init").then(()=>G(k,"afterInit")).then(()=>k);function C(B){return typeof B=="function"}function y(B){return C(B)&&!!B.isContextPlugin}function P(B,K){return K.some(W=>W===B||R(B)===W||R(W)===B)}function R(B){return C(B)?B.pluginName||B.name:B}function D(B,K=new Set){B.forEach(W=>{C(W)&&(K.has(W)||(K.add(W),W.pluginName&&!d._availablePlugins.has(W.pluginName)&&d._availablePlugins.set(W.pluginName,W),W.requires&&D(W.requires,K)))})}function $(B,K=new Set){return B.map(W=>C(W)?W:d._availablePlugins.get(W)).reduce((W,it)=>K.has(it)?W:(K.add(it),it.requires&&(Z(it.requires,it),$(it.requires,K).forEach(Ht=>W.add(Ht))),W.add(it)),new Set)}function Z(B,K=null){B.map(W=>C(W)?W:d._availablePlugins.get(W)||W).forEach(W=>{nt(W,K),ot(W,K),Lt(W,K)})}function nt(B,K){if(!C(B))throw K?new M("plugincollection-soft-required",h,{missingPlugin:B,requiredBy:R(K)}):new M("plugincollection-plugin-not-found",h,{plugin:B})}function ot(B,K){if(y(K)&&!y(B))throw new M("plugincollection-context-required",h,{plugin:R(B),requiredBy:R(K)})}function Lt(B,K){if(K&&P(B,i))throw new M("plugincollection-required",h,{plugin:R(B),requiredBy:R(K)})}function J(B){return B.map(K=>{let W=d._contextPlugins.get(K);return W=W||new K(h),d._add(K,W),W})}function G(B,K){return B.reduce((W,it)=>!it[K]||d._contextPlugins.has(it)?W:W.then(it[K].bind(it)),Promise.resolve())}function Q(B,K){for(const W of K){if(typeof W!="function")throw new M("plugincollection-replace-plugin-invalid-type",null,{pluginItem:W});const it=W.pluginName;if(!it)throw new M("plugincollection-replace-plugin-missing-name",null,{pluginItem:W});if(W.requires&&W.requires.length)throw new M("plugincollection-plugin-for-replacing-cannot-have-dependencies",null,{pluginName:it});const Ht=d._availablePlugins.get(it);if(!Ht)throw new M("plugincollection-plugin-for-replacing-not-exist",null,{pluginName:it});const Te=B.indexOf(Ht);if(Te===-1){if(d._contextPlugins.has(Ht))return;throw new M("plugincollection-plugin-for-replacing-not-loaded",null,{pluginName:it})}if(Ht.requires&&Ht.requires.length)throw new M("plugincollection-replaced-plugin-cannot-have-dependencies",null,{pluginName:it});B.splice(Te,1,W),d._availablePlugins.set(it,W)}}}destroy(){const e=[];for(const[,i]of this)typeof i.destroy=="function"&&!this._contextPlugins.has(i)&&e.push(i.destroy());return Promise.all(e)}_add(e,i){this._plugins.set(e,i);const a=e.pluginName;if(a){if(this._plugins.has(a))throw new M("plugincollection-plugin-name-conflict",null,{pluginName:a,plugin1:this._plugins.get(a).constructor,plugin2:e});this._plugins.set(a,i)}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let Di=class{is(){throw new Error("is() method is abstract")}};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let Li=class extends wt(Di){constructor(e){super(),this.document=e,this.parent=null}get index(){let e;if(!this.parent)return null;if((e=this.parent.getChildIndex(this))==-1)throw new M("view-node-not-found-in-parent",this);return e}get nextSibling(){const e=this.index;return e!==null&&this.parent.getChild(e+1)||null}get previousSibling(){const e=this.index;return e!==null&&this.parent.getChild(e-1)||null}get root(){let e=this;for(;e.parent;)e=e.parent;return e}isAttached(){return this.root.is("rootElement")}getPath(){const e=[];let i=this;for(;i.parent;)e.unshift(i.index),i=i.parent;return e}getAncestors(e={}){const i=[];let a=e.includeSelf?this:this.parent;for(;a;)i[e.parentFirst?"push":"unshift"](a),a=a.parent;return i}getCommonAncestor(e,i={}){const a=this.getAncestors(i),d=e.getAncestors(i);let h=0;for(;a[h]==d[h]&&a[h];)h++;return h===0?null:a[h-1]}isBefore(e){if(this==e||this.root!==e.root)return!1;const i=this.getPath(),a=e.getPath(),d=fe(i,a);switch(d){case"prefix":return!0;case"extension":return!1;default:return i[d]<a[d]}}isAfter(e){return this==e||this.root!==e.root?!1:!this.isBefore(e)}_remove(){this.parent._removeChildren(this.index)}_fireChange(e,i){this.fire(`change:${e}`,i),this.parent&&this.parent._fireChange(e,i)}toJSON(){const e=Bk(this);return delete e.parent,e}};Li.prototype.is=function(s){return s==="node"||s==="view:node"};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let Dt=class eu extends Li{constructor(e,i){super(e),this._textData=i}get data(){return this._textData}get _data(){return this.data}set _data(e){this._fireChange("text",this),this._textData=e}isSimilar(e){return e instanceof eu?this===e||this.data===e.data:!1}_clone(){return new eu(this.document,this.data)}};Dt.prototype.is=function(s){return s==="$text"||s==="view:$text"||s==="text"||s==="view:text"||s==="node"||s==="view:node"};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let dn=class extends Di{constructor(e,i,a){if(super(),this.textNode=e,i<0||i>e.data.length)throw new M("view-textproxy-wrong-offsetintext",this);if(a<0||i+a>e.data.length)throw new M("view-textproxy-wrong-length",this);this.data=e.data.substring(i,i+a),this.offsetInText=i}get offsetSize(){return this.data.length}get isPartial(){return this.data.length!==this.textNode.data.length}get parent(){return this.textNode.parent}get root(){return this.textNode.root}get document(){return this.textNode.document}getAncestors(e={}){const i=[];let a=e.includeSelf?this.textNode:this.parent;for(;a!==null;)i[e.parentFirst?"push":"unshift"](a),a=a.parent;return i}};dn.prototype.is=function(s){return s==="$textProxy"||s==="view:$textProxy"||s==="textProxy"||s==="view:textProxy"};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class nr{constructor(...e){this._patterns=[],this.add(...e)}add(...e){for(let i of e)(typeof i=="string"||i instanceof RegExp)&&(i={name:i}),this._patterns.push(i)}match(...e){for(const i of e)for(const a of this._patterns){const d=Iw(i,a);if(d)return{element:i,pattern:a,match:d}}return null}matchAll(...e){const i=[];for(const a of e)for(const d of this._patterns){const h=Iw(a,d);h&&i.push({element:a,pattern:d,match:h})}return i.length>0?i:null}getElementName(){if(this._patterns.length!==1)return null;const e=this._patterns[0],i=e.name;return typeof e!="function"&&i&&!(i instanceof RegExp)?i:null}}function Iw(s,e){if(typeof e=="function")return e(s);const i={};return e.name&&(i.name=z5(e.name,s.name),!i.name)||e.attributes&&(i.attributes=W5(e.attributes,s),!i.attributes)||e.classes&&(i.classes=q5(e.classes,s),!i.classes)||e.styles&&(i.styles=U5(e.styles,s),!i.styles)?null:i}function z5(s,e){return s instanceof RegExp?!!e.match(s):s===e}function Su(s,e,i){const a=j5(s),d=Array.from(e),h=[];if(a.forEach(([f,b])=>{d.forEach(k=>{$5(f,k)&&H5(b,k,i)&&h.push(k)})}),!(!a.length||h.length<a.length))return h}function j5(s){return Array.isArray(s)?s.map(e=>Mn(e)?((e.key===void 0||e.value===void 0)&&In("matcher-pattern-missing-key-or-value",e),[e.key,e.value]):[e,!0]):Mn(s)?Object.entries(s):[[s,!0]]}function $5(s,e){return s===!0||s===e||s instanceof RegExp&&e.match(s)}function H5(s,e,i){if(s===!0)return!0;const a=i(e);return s===a||s instanceof RegExp&&!!String(a).match(s)}function W5(s,e){const i=new Set(e.getAttributeKeys());return Mn(s)?(s.style!==void 0&&In("matcher-pattern-deprecated-attributes-style-key",s),s.class!==void 0&&In("matcher-pattern-deprecated-attributes-class-key",s)):(i.delete("style"),i.delete("class")),Su(s,i,a=>e.getAttribute(a))}function q5(s,e){return Su(s,e.getClassNames(),()=>{})}function U5(s,e){return Su(s,e.getStyleNames(!0),i=>e.getStyle(i))}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class G5{constructor(e){this._styles={},this._styleProcessor=e}get isEmpty(){return!Object.entries(this._styles).length}get size(){return this.isEmpty?0:this.getStyleNames().length}setTo(e){this.clear();const i=K5(e);for(const[a,d]of i)this._styleProcessor.toNormalizedForm(a,d,this._styles)}has(e){if(this.isEmpty)return!1;const a=this._styleProcessor.getReducedForm(e,this._styles).find(([d])=>d===e);return Array.isArray(a)}set(e,i){if(ge(e))for(const[a,d]of Object.entries(e))this._styleProcessor.toNormalizedForm(a,d,this._styles);else this._styleProcessor.toNormalizedForm(e,i,this._styles)}remove(e){const i=Y5(e);l5(this._styles,i),delete this._styles[e],this._cleanEmptyObjectsOnPath(i)}getNormalized(e){return this._styleProcessor.getNormalized(e,this._styles)}toString(){return this.isEmpty?"":this._getStylesEntries().map(e=>e.join(":")).sort().join(";")+";"}getAsString(e){if(this.isEmpty)return;if(this._styles[e]&&!ge(this._styles[e]))return this._styles[e];const a=this._styleProcessor.getReducedForm(e,this._styles).find(([d])=>d===e);if(Array.isArray(a))return a[1]}getStyleNames(e=!1){return this.isEmpty?[]:e?this._styleProcessor.getStyleNames(this._styles):this._getStylesEntries().map(([a])=>a)}clear(){this._styles={}}_getStylesEntries(){const e=[],i=Object.keys(this._styles);for(const a of i)e.push(...this._styleProcessor.getReducedForm(a,this._styles));return e}_cleanEmptyObjectsOnPath(e){const i=e.split(".");if(!(i.length>1))return;const d=i.splice(0,i.length-1).join("."),h=KI(this._styles,d);if(!h)return;!Object.keys(h).length&&this.remove(d)}}function K5(s){let e=null,i=0,a=0,d=null;const h=new Map;if(s==="")return h;s.charAt(s.length-1)!=";"&&(s=s+";");for(let f=0;f<s.length;f++){const b=s.charAt(f);if(e===null)switch(b){case":":d||(d=s.substr(i,f-i),a=f+1);break;case'"':case"'":e=b;break;case";":{const k=s.substr(a,f-a);d&&h.set(d.trim(),k.trim()),d=null,i=f+1;break}}else b===e&&(e=null)}return h}function Y5(s){return s.replace("-",".")}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let Qe=class sv extends Li{constructor(e,i,a,d){if(super(e),this._unsafeAttributesToRender=[],this._customProperties=new Map,this.name=i,this._attrs=J5(a),this._children=[],d&&this._insertChild(0,d),this._classes=new Set,this._attrs.has("class")){const h=this._attrs.get("class");Mw(this._classes,h),this._attrs.delete("class")}this._styles=new G5(this.document.stylesProcessor),this._attrs.has("style")&&(this._styles.setTo(this._attrs.get("style")),this._attrs.delete("style"))}get childCount(){return this._children.length}get isEmpty(){return this._children.length===0}getChild(e){return this._children[e]}getChildIndex(e){return this._children.indexOf(e)}getChildren(){return this._children[Symbol.iterator]()}*getAttributeKeys(){this._classes.size>0&&(yield"class"),this._styles.isEmpty||(yield"style"),yield*this._attrs.keys()}*getAttributes(){yield*this._attrs.entries(),this._classes.size>0&&(yield["class",this.getAttribute("class")]),this._styles.isEmpty||(yield["style",this.getAttribute("style")])}getAttribute(e){if(e=="class")return this._classes.size>0?[...this._classes].join(" "):void 0;if(e=="style"){const i=this._styles.toString();return i==""?void 0:i}return this._attrs.get(e)}hasAttribute(e){return e=="class"?this._classes.size>0:e=="style"?!this._styles.isEmpty:this._attrs.has(e)}isSimilar(e){if(!(e instanceof sv))return!1;if(this===e)return!0;if(this.name!=e.name||this._attrs.size!==e._attrs.size||this._classes.size!==e._classes.size||this._styles.size!==e._styles.size)return!1;for(const[i,a]of this._attrs)if(!e._attrs.has(i)||e._attrs.get(i)!==a)return!1;for(const i of this._classes)if(!e._classes.has(i))return!1;for(const i of this._styles.getStyleNames())if(!e._styles.has(i)||e._styles.getAsString(i)!==this._styles.getAsString(i))return!1;return!0}hasClass(...e){for(const i of e)if(!this._classes.has(i))return!1;return!0}getClassNames(){return this._classes.keys()}getStyle(e){return this._styles.getAsString(e)}getNormalizedStyle(e){return this._styles.getNormalized(e)}getStyleNames(e){return this._styles.getStyleNames(e)}hasStyle(...e){for(const i of e)if(!this._styles.has(i))return!1;return!0}findAncestor(...e){const i=new nr(...e);let a=this.parent;for(;a&&!a.is("documentFragment");){if(i.match(a))return a;a=a.parent}return null}getCustomProperty(e){return this._customProperties.get(e)}*getCustomProperties(){yield*this._customProperties.entries()}getIdentity(){const e=Array.from(this._classes).sort().join(","),i=this._styles.toString(),a=Array.from(this._attrs).map(d=>`${d[0]}="${d[1]}"`).sort().join(" ");return this.name+(e==""?"":` class="${e}"`)+(i?` style="${i}"`:"")+(a==""?"":` ${a}`)}shouldRenderUnsafeAttribute(e){return this._unsafeAttributesToRender.includes(e)}_clone(e=!1){const i=[];if(e)for(const d of this.getChildren())i.push(d._clone(e));const a=new this.constructor(this.document,this.name,this._attrs,i);return a._classes=new Set(this._classes),a._styles.set(this._styles.getNormalized()),a._customProperties=new Map(this._customProperties),a.getFillerOffset=this.getFillerOffset,a._unsafeAttributesToRender=this._unsafeAttributesToRender,a}_appendChild(e){return this._insertChild(this.childCount,e)}_insertChild(e,i){this._fireChange("children",this);let a=0;const d=Q5(this.document,i);for(const h of d)h.parent!==null&&h._remove(),h.parent=this,h.document=this.document,this._children.splice(e,0,h),e++,a++;return a}_removeChildren(e,i=1){this._fireChange("children",this);for(let a=e;a<e+i;a++)this._children[a].parent=null;return this._children.splice(e,i)}_setAttribute(e,i){const a=String(i);this._fireChange("attributes",this),e=="class"?Mw(this._classes,a):e=="style"?this._styles.setTo(a):this._attrs.set(e,a)}_removeAttribute(e){return this._fireChange("attributes",this),e=="class"?this._classes.size>0?(this._classes.clear(),!0):!1:e=="style"?this._styles.isEmpty?!1:(this._styles.clear(),!0):this._attrs.delete(e)}_addClass(e){this._fireChange("attributes",this);for(const i of ke(e))this._classes.add(i)}_removeClass(e){this._fireChange("attributes",this);for(const i of ke(e))this._classes.delete(i)}_setStyle(e,i){this._fireChange("attributes",this),typeof e!="string"?this._styles.set(e):this._styles.set(e,i)}_removeStyle(e){this._fireChange("attributes",this);for(const i of ke(e))this._styles.remove(i)}_setCustomProperty(e,i){this._customProperties.set(e,i)}_removeCustomProperty(e){return this._customProperties.delete(e)}};Qe.prototype.is=function(s,e){return e?e===this.name&&(s==="element"||s==="view:element"):s==="element"||s==="view:element"||s==="node"||s==="view:node"};function J5(s){const e=er(s);for(const[i,a]of e)a===null?e.delete(i):typeof a!="string"&&e.set(i,String(a));return e}function Mw(s,e){const i=e.split(/\s+/);s.clear(),i.forEach(a=>s.add(a))}function Q5(s,e){return typeof e=="string"?[new Dt(s,e)]:($e(e)||(e=[e]),Array.from(e).map(i=>typeof i=="string"?new Dt(s,i):i instanceof dn?new Dt(s,i.data):i))}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ir extends Qe{constructor(e,i,a,d){super(e,i,a,d),this.getFillerOffset=X5}}ir.prototype.is=function(s,e){return e?e===this.name&&(s==="containerElement"||s==="view:containerElement"||s==="element"||s==="view:element"):s==="containerElement"||s==="view:containerElement"||s==="element"||s==="view:element"||s==="node"||s==="view:node"};function X5(){const s=[...this.getChildren()],e=s[this.childCount-1];if(e&&e.is("element","br"))return this.childCount;for(const i of s)if(!i.is("uiElement"))return null;return this.childCount}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class nl extends Ae(ir){constructor(e,i,a,d){super(e,i,a,d),this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("placeholder",void 0),this.bind("isReadOnly").to(e),this.bind("isFocused").to(e,"isFocused",h=>h&&e.selection.editableElement==this),this.listenTo(e.selection,"change",()=>{this.isFocused=e.isFocused&&e.selection.editableElement==this})}destroy(){this.stopListening()}}nl.prototype.is=function(s,e){return e?e===this.name&&(s==="editableElement"||s==="view:editableElement"||s==="containerElement"||s==="view:containerElement"||s==="element"||s==="view:element"):s==="editableElement"||s==="view:editableElement"||s==="containerElement"||s==="view:containerElement"||s==="element"||s==="view:element"||s==="node"||s==="view:node"};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Rw=Symbol("rootName");class Z5 extends nl{constructor(e,i){super(e,i),this.rootName="main"}get rootName(){return this.getCustomProperty(Rw)}set rootName(e){this._setCustomProperty(Rw,e)}set _name(e){this.name=e}}Z5.prototype.is=function(s,e){return e?e===this.name&&(s==="rootElement"||s==="view:rootElement"||s==="editableElement"||s==="view:editableElement"||s==="containerElement"||s==="view:containerElement"||s==="element"||s==="view:element"):s==="rootElement"||s==="view:rootElement"||s==="editableElement"||s==="view:editableElement"||s==="containerElement"||s==="view:containerElement"||s==="element"||s==="view:element"||s==="node"||s==="view:node"};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let Ai=class{constructor(e={}){if(!e.boundaries&&!e.startPosition)throw new M("view-tree-walker-no-start-position",null);if(e.direction&&e.direction!="forward"&&e.direction!="backward")throw new M("view-tree-walker-unknown-direction",e.startPosition,{direction:e.direction});this.boundaries=e.boundaries||null,e.startPosition?this._position=U._createAt(e.startPosition):this._position=U._createAt(e.boundaries[e.direction=="backward"?"end":"start"]),this.direction=e.direction||"forward",this.singleCharacters=!!e.singleCharacters,this.shallow=!!e.shallow,this.ignoreElementEnd=!!e.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null}[Symbol.iterator](){return this}get position(){return this._position}skip(e){let i,a;do a=this.position,i=this.next();while(!i.done&&e(i.value));i.done||(this._position=a)}next(){return this.direction=="forward"?this._next():this._previous()}_next(){let e=this.position.clone();const i=this.position,a=e.parent;if(a.parent===null&&e.offset===a.childCount)return{done:!0,value:void 0};if(a===this._boundaryEndParent&&e.offset==this.boundaries.end.offset)return{done:!0,value:void 0};let d;if(a instanceof Dt){if(e.isAtEnd)return this._position=U._createAfter(a),this._next();d=a.data[e.offset]}else d=a.getChild(e.offset);if(d instanceof Qe){if(!this.shallow)e=new U(d,0);else{if(this.boundaries&&this.boundaries.end.isBefore(e))return{done:!0,value:void 0};e.offset++}return this._position=e,this._formatReturnValue("elementStart",d,i,e,1)}if(d instanceof Dt){if(this.singleCharacters)return e=new U(d,0),this._position=e,this._next();let h=d.data.length,f;return d==this._boundaryEndParent?(h=this.boundaries.end.offset,f=new dn(d,0,h),e=U._createAfter(f)):(f=new dn(d,0,d.data.length),e.offset++),this._position=e,this._formatReturnValue("text",f,i,e,h)}if(typeof d=="string"){let h;this.singleCharacters?h=1:h=(a===this._boundaryEndParent?this.boundaries.end.offset:a.data.length)-e.offset;const f=new dn(a,e.offset,h);return e.offset+=h,this._position=e,this._formatReturnValue("text",f,i,e,h)}return e=U._createAfter(a),this._position=e,this.ignoreElementEnd?this._next():this._formatReturnValue("elementEnd",a,i,e)}_previous(){let e=this.position.clone();const i=this.position,a=e.parent;if(a.parent===null&&e.offset===0)return{done:!0,value:void 0};if(a==this._boundaryStartParent&&e.offset==this.boundaries.start.offset)return{done:!0,value:void 0};let d;if(a instanceof Dt){if(e.isAtStart)return this._position=U._createBefore(a),this._previous();d=a.data[e.offset-1]}else d=a.getChild(e.offset-1);if(d instanceof Qe)return this.shallow?(e.offset--,this._position=e,this._formatReturnValue("elementStart",d,i,e,1)):(e=new U(d,d.childCount),this._position=e,this.ignoreElementEnd?this._previous():this._formatReturnValue("elementEnd",d,i,e));if(d instanceof Dt){if(this.singleCharacters)return e=new U(d,d.data.length),this._position=e,this._previous();let h=d.data.length,f;if(d==this._boundaryStartParent){const b=this.boundaries.start.offset;f=new dn(d,b,d.data.length-b),h=f.data.length,e=U._createBefore(f)}else f=new dn(d,0,d.data.length),e.offset--;return this._position=e,this._formatReturnValue("text",f,i,e,h)}if(typeof d=="string"){let h;if(this.singleCharacters)h=1;else{const b=a===this._boundaryStartParent?this.boundaries.start.offset:0;h=e.offset-b}e.offset-=h;const f=new dn(a,e.offset,h);return this._position=e,this._formatReturnValue("text",f,i,e,h)}return e=U._createBefore(a),this._position=e,this._formatReturnValue("elementStart",a,i,e,1)}_formatReturnValue(e,i,a,d,h){return i instanceof dn&&(i.offsetInText+i.data.length==i.textNode.data.length&&(this.direction=="forward"&&!(this.boundaries&&this.boundaries.end.isEqual(this.position))?(d=U._createAfter(i.textNode),this._position=d):a=U._createAfter(i.textNode)),i.offsetInText===0&&(this.direction=="backward"&&!(this.boundaries&&this.boundaries.start.isEqual(this.position))?(d=U._createBefore(i.textNode),this._position=d):a=U._createBefore(i.textNode))),{done:!1,value:{type:e,item:i,previousPosition:a,nextPosition:d,length:h}}}};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let U=class En extends Di{constructor(e,i){super(),this.parent=e,this.offset=i}get nodeAfter(){return this.parent.is("$text")?null:this.parent.getChild(this.offset)||null}get nodeBefore(){return this.parent.is("$text")?null:this.parent.getChild(this.offset-1)||null}get isAtStart(){return this.offset===0}get isAtEnd(){const e=this.parent.is("$text")?this.parent.data.length:this.parent.childCount;return this.offset===e}get root(){return this.parent.root}get editableElement(){let e=this.parent;for(;!(e instanceof nl);)if(e.parent)e=e.parent;else return null;return e}getShiftedBy(e){const i=En._createAt(this),a=i.offset+e;return i.offset=a<0?0:a,i}getLastMatchingPosition(e,i={}){i.startPosition=this;const a=new Ai(i);return a.skip(e),a.position}getAncestors(){return this.parent.is("documentFragment")?[this.parent]:this.parent.getAncestors({includeSelf:!0})}getCommonAncestor(e){const i=this.getAncestors(),a=e.getAncestors();let d=0;for(;i[d]==a[d]&&i[d];)d++;return d===0?null:i[d-1]}isEqual(e){return this.parent==e.parent&&this.offset==e.offset}isBefore(e){return this.compareWith(e)=="before"}isAfter(e){return this.compareWith(e)=="after"}compareWith(e){if(this.root!==e.root)return"different";if(this.isEqual(e))return"same";const i=this.parent.is("node")?this.parent.getPath():[],a=e.parent.is("node")?e.parent.getPath():[];i.push(this.offset),a.push(e.offset);const d=fe(i,a);switch(d){case"prefix":return"before";case"extension":return"after";default:return i[d]<a[d]?"before":"after"}}getWalker(e={}){return e.startPosition=this,new Ai(e)}clone(){return new En(this.parent,this.offset)}static _createAt(e,i){if(e instanceof En)return new this(e.parent,e.offset);{const a=e;if(i=="end")i=a.is("$text")?a.data.length:a.childCount;else{if(i=="before")return this._createBefore(a);if(i=="after")return this._createAfter(a);if(i!==0&&!i)throw new M("view-createpositionat-offset-required",a)}return new En(a,i)}}static _createAfter(e){if(e.is("$textProxy"))return new En(e.textNode,e.offsetInText+e.data.length);if(!e.parent)throw new M("view-position-after-root",e,{root:e});return new En(e.parent,e.index+1)}static _createBefore(e){if(e.is("$textProxy"))return new En(e.textNode,e.offsetInText);if(!e.parent)throw new M("view-position-before-root",e,{root:e});return new En(e.parent,e.index)}};U.prototype.is=function(s){return s==="position"||s==="view:position"};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let at=class Hn extends Di{constructor(e,i=null){super(),this.start=e.clone(),this.end=i?i.clone():e.clone()}*[Symbol.iterator](){yield*new Ai({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return this.start.parent===this.end.parent}get root(){return this.start.root}getEnlarged(){let e=this.start.getLastMatchingPosition(wa,{direction:"backward"}),i=this.end.getLastMatchingPosition(wa);return e.parent.is("$text")&&e.isAtStart&&(e=U._createBefore(e.parent)),i.parent.is("$text")&&i.isAtEnd&&(i=U._createAfter(i.parent)),new Hn(e,i)}getTrimmed(){let e=this.start.getLastMatchingPosition(wa);if(e.isAfter(this.end)||e.isEqual(this.end))return new Hn(e,e);let i=this.end.getLastMatchingPosition(wa,{direction:"backward"});const a=e.nodeAfter,d=i.nodeBefore;return a&&a.is("$text")&&(e=new U(a,0)),d&&d.is("$text")&&(i=new U(d,d.data.length)),new Hn(e,i)}isEqual(e){return this==e||this.start.isEqual(e.start)&&this.end.isEqual(e.end)}containsPosition(e){return e.isAfter(this.start)&&e.isBefore(this.end)}containsRange(e,i=!1){e.isCollapsed&&(i=!1);const a=this.containsPosition(e.start)||i&&this.start.isEqual(e.start),d=this.containsPosition(e.end)||i&&this.end.isEqual(e.end);return a&&d}getDifference(e){const i=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&i.push(new Hn(this.start,e.start)),this.containsPosition(e.end)&&i.push(new Hn(e.end,this.end))):i.push(this.clone()),i}getIntersection(e){if(this.isIntersecting(e)){let i=this.start,a=this.end;return this.containsPosition(e.start)&&(i=e.start),this.containsPosition(e.end)&&(a=e.end),new Hn(i,a)}return null}getWalker(e={}){return e.boundaries=this,new Ai(e)}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;let e=this.start.nodeAfter,i=this.end.nodeBefore;return this.start.parent.is("$text")&&this.start.isAtEnd&&this.start.parent.nextSibling&&(e=this.start.parent.nextSibling),this.end.parent.is("$text")&&this.end.isAtStart&&this.end.parent.previousSibling&&(i=this.end.parent.previousSibling),e&&e.is("element")&&e===i?e:null}clone(){return new Hn(this.start,this.end)}*getItems(e={}){e.boundaries=this,e.ignoreElementEnd=!0;const i=new Ai(e);for(const a of i)yield a.item}*getPositions(e={}){e.boundaries=this;const i=new Ai(e);yield i.position;for(const a of i)yield a.nextPosition}isIntersecting(e){return this.start.isBefore(e.end)&&this.end.isAfter(e.start)}static _createFromParentsAndOffsets(e,i,a,d){return new this(new U(e,i),new U(a,d))}static _createFromPositionAndShift(e,i){const a=e,d=e.getShiftedBy(i);return i>0?new this(a,d):new this(d,a)}static _createIn(e){return this._createFromParentsAndOffsets(e,0,e,e.childCount)}static _createOn(e){const i=e.is("$textProxy")?e.offsetSize:1;return this._createFromPositionAndShift(U._createBefore(e),i)}};at.prototype.is=function(s){return s==="range"||s==="view:range"};function wa(s){return!!(s.item.is("attributeElement")||s.item.is("uiElement"))}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let xi=class rv extends wt(Di){constructor(...e){super(),this._ranges=[],this._lastRangeBackward=!1,this._isFake=!1,this._fakeSelectionLabel="",e.length&&this.setTo(...e)}get isFake(){return this._isFake}get fakeSelectionLabel(){return this._fakeSelectionLabel}get anchor(){if(!this._ranges.length)return null;const e=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?e.end:e.start).clone()}get focus(){if(!this._ranges.length)return null;const e=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?e.start:e.end).clone()}get isCollapsed(){return this.rangeCount===1&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}get editableElement(){return this.anchor?this.anchor.editableElement:null}*getRanges(){for(const e of this._ranges)yield e.clone()}getFirstRange(){let e=null;for(const i of this._ranges)(!e||i.start.isBefore(e.start))&&(e=i);return e?e.clone():null}getLastRange(){let e=null;for(const i of this._ranges)(!e||i.end.isAfter(e.end))&&(e=i);return e?e.clone():null}getFirstPosition(){const e=this.getFirstRange();return e?e.start.clone():null}getLastPosition(){const e=this.getLastRange();return e?e.end.clone():null}isEqual(e){if(this.isFake!=e.isFake||this.isFake&&this.fakeSelectionLabel!=e.fakeSelectionLabel||this.rangeCount!=e.rangeCount)return!1;if(this.rangeCount===0)return!0;if(!this.anchor.isEqual(e.anchor)||!this.focus.isEqual(e.focus))return!1;for(const i of this._ranges){let a=!1;for(const d of e._ranges)if(i.isEqual(d)){a=!0;break}if(!a)return!1}return!0}isSimilar(e){if(this.isBackward!=e.isBackward)return!1;const i=Qd(this.getRanges()),a=Qd(e.getRanges());if(i!=a)return!1;if(i==0)return!0;for(let d of this.getRanges()){d=d.getTrimmed();let h=!1;for(let f of e.getRanges())if(f=f.getTrimmed(),d.start.isEqual(f.start)&&d.end.isEqual(f.end)){h=!0;break}if(!h)return!1}return!0}getSelectedElement(){return this.rangeCount!==1?null:this.getFirstRange().getContainedElement()}setTo(...e){let[i,a,d]=e;if(typeof a=="object"&&(d=a,a=void 0),i===null)this._setRanges([]),this._setFakeOptions(d);else if(i instanceof rv||i instanceof Pu)this._setRanges(i.getRanges(),i.isBackward),this._setFakeOptions({fake:i.isFake,label:i.fakeSelectionLabel});else if(i instanceof at)this._setRanges([i],d&&d.backward),this._setFakeOptions(d);else if(i instanceof U)this._setRanges([new at(i)]),this._setFakeOptions(d);else if(i instanceof Li){const h=!!d&&!!d.backward;let f;if(a===void 0)throw new M("view-selection-setto-required-second-parameter",this);a=="in"?f=at._createIn(i):a=="on"?f=at._createOn(i):f=new at(U._createAt(i,a)),this._setRanges([f],h),this._setFakeOptions(d)}else if($e(i))this._setRanges(i,d&&d.backward),this._setFakeOptions(d);else throw new M("view-selection-setto-not-selectable",this);this.fire("change")}setFocus(e,i){if(this.anchor===null)throw new M("view-selection-setfocus-no-ranges",this);const a=U._createAt(e,i);if(a.compareWith(this.focus)=="same")return;const d=this.anchor;this._ranges.pop(),a.compareWith(d)=="before"?this._addRange(new at(a,d),!0):this._addRange(new at(d,a)),this.fire("change")}_setRanges(e,i=!1){e=Array.from(e),this._ranges=[];for(const a of e)this._addRange(a);this._lastRangeBackward=!!i}_setFakeOptions(e={}){this._isFake=!!e.fake,this._fakeSelectionLabel=e.fake&&e.label||""}_addRange(e,i=!1){if(!(e instanceof at))throw new M("view-selection-add-range-not-range",this);this._pushRange(e),this._lastRangeBackward=!!i}_pushRange(e){for(const i of this._ranges)if(e.isIntersecting(i))throw new M("view-selection-range-intersects",this,{addedRange:e,intersectingRange:i});this._ranges.push(new at(e.start,e.end))}};xi.prototype.is=function(s){return s==="selection"||s==="view:selection"};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let Pu=class extends wt(Di){constructor(...e){super(),this._selection=new xi,this._selection.delegate("change").to(this),e.length&&this._selection.setTo(...e)}get isFake(){return this._selection.isFake}get fakeSelectionLabel(){return this._selection.fakeSelectionLabel}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get isCollapsed(){return this._selection.isCollapsed}get rangeCount(){return this._selection.rangeCount}get isBackward(){return this._selection.isBackward}get editableElement(){return this._selection.editableElement}get _ranges(){return this._selection._ranges}*getRanges(){yield*this._selection.getRanges()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getSelectedElement(){return this._selection.getSelectedElement()}isEqual(e){return this._selection.isEqual(e)}isSimilar(e){return this._selection.isSimilar(e)}_setTo(...e){this._selection.setTo(...e)}_setFocus(e,i){this._selection.setFocus(e,i)}};Pu.prototype.is=function(s){return s==="selection"||s=="documentSelection"||s=="view:selection"||s=="view:documentSelection"};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class il extends Ro{constructor(e,i,a){super(e,i),this.startRange=a,this._eventPhase="none",this._currentTarget=null}get eventPhase(){return this._eventPhase}get currentTarget(){return this._currentTarget}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Ed=Symbol("bubbling contexts");function nu(s){class e extends s{fire(a,...d){try{const h=a instanceof Ro?a:new Ro(this,a),f=Td(this);if(!f.size)return;if(ms(h,"capturing",this),po(f,"$capture",h,...d))return h.return;const b=h.startRange||this.selection.getFirstRange(),k=b?b.getContainedElement():null,C=k?!!av(f,k):!1;let y=k||tN(b);if(ms(h,"atTarget",y),!C){if(po(f,"$text",h,...d))return h.return;ms(h,"bubbling",y)}for(;y;){if(y.is("rootElement")){if(po(f,"$root",h,...d))return h.return}else if(y.is("element")&&po(f,y.name,h,...d))return h.return;if(po(f,y,h,...d))return h.return;y=y.parent,ms(h,"bubbling",y)}return ms(h,"bubbling",this),po(f,"$document",h,...d),h.return}catch(h){/* istanbul ignore next -- @preserve */M.rethrowUnexpectedError(h,this)}}_addEventListener(a,d,h){const f=ke(h.context||"$document"),b=Td(this);for(const k of f){let C=b.get(k);C||(C=new(wt()),b.set(k,C)),this.listenTo(C,a,d,h)}}_removeEventListener(a,d){const h=Td(this);for(const f of h.values())this.stopListening(f,a,d)}}return e}{const s=nu(Object);["fire","_addEventListener","_removeEventListener"].forEach(e=>{nu[e]=s.prototype[e]})}function ms(s,e,i){s instanceof il&&(s._eventPhase=e,s._currentTarget=i)}function po(s,e,i,...a){const d=typeof e=="string"?s.get(e):av(s,e);return d?(d.fire(i,...a),i.stop.called):!1}function av(s,e){for(const[i,a]of s)if(typeof i=="function"&&i(e))return a;return null}function Td(s){return s[Ed]||(s[Ed]=new Map),s[Ed]}function tN(s){if(!s)return null;const e=s.start.parent,i=s.end.parent,a=e.getPath(),d=i.getPath();return a.length>d.length?e:i}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let eN=class extends nu(Ae()){constructor(e){super(),this._postFixers=new Set,this.selection=new Pu,this.roots=new pr({idProperty:"rootName"}),this.stylesProcessor=e,this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("isSelecting",!1),this.set("isComposing",!1)}getRoot(e="main"){return this.roots.get(e)}registerPostFixer(e){this._postFixers.add(e)}destroy(){this.roots.forEach(e=>e.destroy()),this.stopListening()}_callPostFixers(e){let i=!1;do for(const a of this._postFixers)if(i=a(e),i)break;while(i)}};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const lv=10;class Io extends Qe{constructor(e,i,a,d){super(e,i,a,d),this._priority=lv,this._id=null,this._clonesGroup=null,this.getFillerOffset=nN}get priority(){return this._priority}get id(){return this._id}getElementsWithSameId(){if(this.id===null)throw new M("attribute-element-get-elements-with-same-id-no-id",this);return new Set(this._clonesGroup)}isSimilar(e){return this.id!==null||e.id!==null?this.id===e.id:super.isSimilar(e)&&this.priority==e.priority}_clone(e=!1){const i=super._clone(e);return i._priority=this._priority,i._id=this._id,i}}Io.DEFAULT_PRIORITY=lv;Io.prototype.is=function(s,e){return e?e===this.name&&(s==="attributeElement"||s==="view:attributeElement"||s==="element"||s==="view:element"):s==="attributeElement"||s==="view:attributeElement"||s==="element"||s==="view:element"||s==="node"||s==="view:node"};function nN(){if(Sd(this))return null;let s=this.parent;for(;s&&s.is("attributeElement");){if(Sd(s)>1)return null;s=s.parent}return!s||Sd(s)>1?null:this.childCount}function Sd(s){return Array.from(s.getChildren()).filter(e=>!e.is("uiElement")).length}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Iu extends Qe{constructor(e,i,a,d){super(e,i,a,d),this.getFillerOffset=iN}_insertChild(e,i){if(i&&(i instanceof Li||Array.from(i).length>0))throw new M("view-emptyelement-cannot-add",[this,i]);return 0}}Iu.prototype.is=function(s,e){return e?e===this.name&&(s==="emptyElement"||s==="view:emptyElement"||s==="element"||s==="view:element"):s==="emptyElement"||s==="view:emptyElement"||s==="element"||s==="view:element"||s==="node"||s==="view:node"};function iN(){return null}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ol extends Qe{constructor(e,i,a,d){super(e,i,a,d),this.getFillerOffset=oN}_insertChild(e,i){if(i&&(i instanceof Li||Array.from(i).length>0))throw new M("view-uielement-cannot-add",[this,i]);return 0}render(e,i){return this.toDomElement(e)}toDomElement(e){const i=e.createElement(this.name);for(const a of this.getAttributeKeys())i.setAttribute(a,this.getAttribute(a));return i}}ol.prototype.is=function(s,e){return e?e===this.name&&(s==="uiElement"||s==="view:uiElement"||s==="element"||s==="view:element"):s==="uiElement"||s==="view:uiElement"||s==="element"||s==="view:element"||s==="node"||s==="view:node"};function oN(){return null}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Mu extends Qe{constructor(e,i,a,d){super(e,i,a,d),this.getFillerOffset=sN}_insertChild(e,i){if(i&&(i instanceof Li||Array.from(i).length>0))throw new M("view-rawelement-cannot-add",[this,i]);return 0}render(e,i){}}Mu.prototype.is=function(s,e){return e?e===this.name&&(s==="rawElement"||s==="view:rawElement"||s==="element"||s==="view:element"):s==="rawElement"||s==="view:rawElement"||s===this.name||s==="view:"+this.name||s==="element"||s==="view:element"||s==="node"||s==="view:node"};function sN(){return null}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let Ei=class extends wt(Di){constructor(e,i){super(),this._children=[],this._customProperties=new Map,this.document=e,i&&this._insertChild(0,i)}[Symbol.iterator](){return this._children[Symbol.iterator]()}get childCount(){return this._children.length}get isEmpty(){return this.childCount===0}get root(){return this}get parent(){return null}get name(){}get getFillerOffset(){}getCustomProperty(e){return this._customProperties.get(e)}*getCustomProperties(){yield*this._customProperties.entries()}_appendChild(e){return this._insertChild(this.childCount,e)}getChild(e){return this._children[e]}getChildIndex(e){return this._children.indexOf(e)}getChildren(){return this._children[Symbol.iterator]()}_insertChild(e,i){this._fireChange("children",this);let a=0;const d=rN(this.document,i);for(const h of d)h.parent!==null&&h._remove(),h.parent=this,this._children.splice(e,0,h),e++,a++;return a}_removeChildren(e,i=1){this._fireChange("children",this);for(let a=e;a<e+i;a++)this._children[a].parent=null;return this._children.splice(e,i)}_fireChange(e,i){this.fire("change:"+e,i)}_setCustomProperty(e,i){this._customProperties.set(e,i)}_removeCustomProperty(e){return this._customProperties.delete(e)}};Ei.prototype.is=function(s){return s==="documentFragment"||s==="view:documentFragment"};function rN(s,e){return typeof e=="string"?[new Dt(s,e)]:($e(e)||(e=[e]),Array.from(e).map(i=>typeof i=="string"?new Dt(s,i):i instanceof dn?new Dt(s,i.data):i))}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class aN{constructor(e){this._cloneGroups=new Map,this._slotFactory=null,this.document=e}setSelection(...e){this.document.selection._setTo(...e)}setSelectionFocus(e,i){this.document.selection._setFocus(e,i)}createDocumentFragment(e){return new Ei(this.document,e)}createText(e){return new Dt(this.document,e)}createAttributeElement(e,i,a={}){const d=new Io(this.document,e,i);return typeof a.priority=="number"&&(d._priority=a.priority),a.id&&(d._id=a.id),a.renderUnsafeAttributes&&d._unsafeAttributesToRender.push(...a.renderUnsafeAttributes),d}createContainerElement(e,i,a={},d={}){let h=null;Mn(a)?d=a:h=a;const f=new ir(this.document,e,i,h);return d.renderUnsafeAttributes&&f._unsafeAttributesToRender.push(...d.renderUnsafeAttributes),f}createEditableElement(e,i,a={}){const d=new nl(this.document,e,i);return a.renderUnsafeAttributes&&d._unsafeAttributesToRender.push(...a.renderUnsafeAttributes),d}createEmptyElement(e,i,a={}){const d=new Iu(this.document,e,i);return a.renderUnsafeAttributes&&d._unsafeAttributesToRender.push(...a.renderUnsafeAttributes),d}createUIElement(e,i,a){const d=new ol(this.document,e,i);return a&&(d.render=a),d}createRawElement(e,i,a,d={}){const h=new Mu(this.document,e,i);return a&&(h.render=a),d.renderUnsafeAttributes&&h._unsafeAttributesToRender.push(...d.renderUnsafeAttributes),h}setAttribute(e,i,a){a._setAttribute(e,i)}removeAttribute(e,i){i._removeAttribute(e)}addClass(e,i){i._addClass(e)}removeClass(e,i){i._removeClass(e)}setStyle(e,i,a){Mn(e)&&a===void 0?i._setStyle(e):a._setStyle(e,i)}removeStyle(e,i){i._removeStyle(e)}setCustomProperty(e,i,a){a._setCustomProperty(e,i)}removeCustomProperty(e,i){return i._removeCustomProperty(e)}breakAttributes(e){return e instanceof U?this._breakAttributes(e):this._breakAttributesRange(e)}breakContainer(e){const i=e.parent;if(!i.is("containerElement"))throw new M("view-writer-break-non-container-element",this.document);if(!i.parent)throw new M("view-writer-break-root",this.document);if(e.isAtStart)return U._createBefore(i);if(!e.isAtEnd){const a=i._clone(!1);this.insert(U._createAfter(i),a);const d=new at(e,U._createAt(i,"end")),h=new U(a,0);this.move(d,h)}return U._createAfter(i)}mergeAttributes(e){const i=e.offset,a=e.parent;if(a.is("$text"))return e;if(a.is("attributeElement")&&a.childCount===0){const f=a.parent,b=a.index;return a._remove(),this._removeFromClonedElementsGroup(a),this.mergeAttributes(new U(f,b))}const d=a.getChild(i-1),h=a.getChild(i);if(!d||!h)return e;if(d.is("$text")&&h.is("$text"))return Nw(d,h);if(d.is("attributeElement")&&h.is("attributeElement")&&d.isSimilar(h)){const f=d.childCount;return d._appendChild(h.getChildren()),h._remove(),this._removeFromClonedElementsGroup(h),this.mergeAttributes(new U(d,f))}return e}mergeContainers(e){const i=e.nodeBefore,a=e.nodeAfter;if(!i||!a||!i.is("containerElement")||!a.is("containerElement"))throw new M("view-writer-merge-containers-invalid-position",this.document);const d=i.getChild(i.childCount-1),h=d instanceof Dt?U._createAt(d,"end"):U._createAt(i,"end");return this.move(at._createIn(a),U._createAt(i,"end")),this.remove(at._createOn(a)),h}insert(e,i){i=$e(i)?[...i]:[i],cv(i,this.document);const a=i.reduce((f,b)=>{const k=f[f.length-1],C=!b.is("uiElement");return!k||k.breakAttributes!=C?f.push({breakAttributes:C,nodes:[b]}):k.nodes.push(b),f},[]);let d=null,h=e;for(const{nodes:f,breakAttributes:b}of a){const k=this._insertNodes(h,f,b);d||(d=k.start),h=k.end}return d?new at(d,h):new at(e)}remove(e){const i=e instanceof at?e:at._createOn(e);if(ps(i,this.document),i.isCollapsed)return new Ei(this.document);const{start:a,end:d}=this._breakAttributesRange(i,!0),h=a.parent,f=d.offset-a.offset,b=h._removeChildren(a.offset,f);for(const C of b)this._removeFromClonedElementsGroup(C);const k=this.mergeAttributes(a);return i.start=k,i.end=k.clone(),new Ei(this.document,b)}clear(e,i){ps(e,this.document);const a=e.getWalker({direction:"backward",ignoreElementEnd:!0});for(const d of a){const h=d.item;let f;if(h.is("element")&&i.isSimilar(h))f=at._createOn(h);else if(!d.nextPosition.isAfter(e.start)&&h.is("$textProxy")){const b=h.getAncestors().find(k=>k.is("element")&&i.isSimilar(k));b&&(f=at._createIn(b))}f&&(f.end.isAfter(e.end)&&(f.end=e.end),f.start.isBefore(e.start)&&(f.start=e.start),this.remove(f))}}move(e,i){let a;if(i.isAfter(e.end)){i=this._breakAttributes(i,!0);const d=i.parent,h=d.childCount;e=this._breakAttributesRange(e,!0),a=this.remove(e),i.offset+=d.childCount-h}else a=this.remove(e);return this.insert(i,a)}wrap(e,i){if(!(i instanceof Io))throw new M("view-writer-wrap-invalid-attribute",this.document);if(ps(e,this.document),e.isCollapsed){let a=e.start;a.parent.is("element")&&!lN(a.parent)&&(a=a.getLastMatchingPosition(h=>h.item.is("uiElement"))),a=this._wrapPosition(a,i);const d=this.document.selection;return d.isCollapsed&&d.getFirstPosition().isEqual(e.start)&&this.setSelection(a),new at(a)}else return this._wrapRange(e,i)}unwrap(e,i){if(!(i instanceof Io))throw new M("view-writer-unwrap-invalid-attribute",this.document);if(ps(e,this.document),e.isCollapsed)return e;const{start:a,end:d}=this._breakAttributesRange(e,!0),h=a.parent,f=this._unwrapChildren(h,a.offset,d.offset,i),b=this.mergeAttributes(f.start);b.isEqual(f.start)||f.end.offset--;const k=this.mergeAttributes(f.end);return new at(b,k)}rename(e,i){const a=new ir(this.document,e,i.getAttributes());return this.insert(U._createAfter(i),a),this.move(at._createIn(i),U._createAt(a,0)),this.remove(at._createOn(i)),a}clearClonedElementsGroup(e){this._cloneGroups.delete(e)}createPositionAt(e,i){return U._createAt(e,i)}createPositionAfter(e){return U._createAfter(e)}createPositionBefore(e){return U._createBefore(e)}createRange(e,i){return new at(e,i)}createRangeOn(e){return at._createOn(e)}createRangeIn(e){return at._createIn(e)}createSelection(...e){return new xi(...e)}createSlot(e="children"){if(!this._slotFactory)throw new M("view-writer-invalid-create-slot-context",this.document);return this._slotFactory(this,e)}_registerSlotFactory(e){this._slotFactory=e}_clearSlotFactory(){this._slotFactory=null}_insertNodes(e,i,a){let d;if(a?d=iu(e):d=e.parent.is("$text")?e.parent.parent:e.parent,!d)throw new M("view-writer-invalid-position-container",this.document);let h;a?h=this._breakAttributes(e,!0):h=e.parent.is("$text")?Pd(e):e;const f=d._insertChild(h.offset,i);for(const y of i)this._addToClonedElementsGroup(y);const b=h.getShiftedBy(f),k=this.mergeAttributes(h);k.isEqual(h)||b.offset--;const C=this.mergeAttributes(b);return new at(k,C)}_wrapChildren(e,i,a,d){let h=i;const f=[];for(;h<a;){const k=e.getChild(h),C=k.is("$text"),y=k.is("attributeElement");if(y&&this._wrapAttributeElement(d,k))f.push(new U(e,h));else if(C||!y||cN(d,k)){const P=d._clone();k._remove(),P._appendChild(k),e._insertChild(h,P),this._addToClonedElementsGroup(P),f.push(new U(e,h))}else this._wrapChildren(k,0,k.childCount,d);h++}let b=0;for(const k of f){if(k.offset-=b,k.offset==i)continue;this.mergeAttributes(k).isEqual(k)||(b++,a--)}return at._createFromParentsAndOffsets(e,i,e,a)}_unwrapChildren(e,i,a,d){let h=i;const f=[];for(;h<a;){const k=e.getChild(h);if(!k.is("attributeElement")){h++;continue}if(k.isSimilar(d)){const C=k.getChildren(),y=k.childCount;k._remove(),e._insertChild(h,C),this._removeFromClonedElementsGroup(k),f.push(new U(e,h),new U(e,h+y)),h+=y,a+=y-1;continue}if(this._unwrapAttributeElement(d,k)){f.push(new U(e,h),new U(e,h+1)),h++;continue}this._unwrapChildren(k,0,k.childCount,d),h++}let b=0;for(const k of f){if(k.offset-=b,k.offset==i||k.offset==a)continue;this.mergeAttributes(k).isEqual(k)||(b++,a--)}return at._createFromParentsAndOffsets(e,i,e,a)}_wrapRange(e,i){const{start:a,end:d}=this._breakAttributesRange(e,!0),h=a.parent,f=this._wrapChildren(h,a.offset,d.offset,i),b=this.mergeAttributes(f.start);b.isEqual(f.start)||f.end.offset--;const k=this.mergeAttributes(f.end);return new at(b,k)}_wrapPosition(e,i){if(i.isSimilar(e.parent))return Ow(e.clone());e.parent.is("$text")&&(e=Pd(e));const a=this.createAttributeElement("_wrapPosition-fake-element");a._priority=Number.POSITIVE_INFINITY,a.isSimilar=()=>!1,e.parent._insertChild(e.offset,a);const d=new at(e,e.getShiftedBy(1));this.wrap(d,i);const h=new U(a.parent,a.index);a._remove();const f=h.nodeBefore,b=h.nodeAfter;return f instanceof Dt&&b instanceof Dt?Nw(f,b):Ow(h)}_wrapAttributeElement(e,i){if(!Dw(e,i)||e.name!==i.name||e.priority!==i.priority)return!1;for(const a of e.getAttributeKeys())if(!(a==="class"||a==="style")&&i.hasAttribute(a)&&i.getAttribute(a)!==e.getAttribute(a))return!1;for(const a of e.getStyleNames())if(i.hasStyle(a)&&i.getStyle(a)!==e.getStyle(a))return!1;for(const a of e.getAttributeKeys())a==="class"||a==="style"||i.hasAttribute(a)||this.setAttribute(a,e.getAttribute(a),i);for(const a of e.getStyleNames())i.hasStyle(a)||this.setStyle(a,e.getStyle(a),i);for(const a of e.getClassNames())i.hasClass(a)||this.addClass(a,i);return!0}_unwrapAttributeElement(e,i){if(!Dw(e,i)||e.name!==i.name||e.priority!==i.priority)return!1;for(const a of e.getAttributeKeys())if(!(a==="class"||a==="style")&&(!i.hasAttribute(a)||i.getAttribute(a)!==e.getAttribute(a)))return!1;if(!i.hasClass(...e.getClassNames()))return!1;for(const a of e.getStyleNames())if(!i.hasStyle(a)||i.getStyle(a)!==e.getStyle(a))return!1;for(const a of e.getAttributeKeys())a==="class"||a==="style"||this.removeAttribute(a,i);return this.removeClass(Array.from(e.getClassNames()),i),this.removeStyle(Array.from(e.getStyleNames()),i),!0}_breakAttributesRange(e,i=!1){const a=e.start,d=e.end;if(ps(e,this.document),e.isCollapsed){const k=this._breakAttributes(e.start,i);return new at(k,k)}const h=this._breakAttributes(d,i),f=h.parent.childCount,b=this._breakAttributes(a,i);return h.offset+=h.parent.childCount-f,new at(b,h)}_breakAttributes(e,i=!1){const a=e.offset,d=e.parent;if(e.parent.is("emptyElement"))throw new M("view-writer-cannot-break-empty-element",this.document);if(e.parent.is("uiElement"))throw new M("view-writer-cannot-break-ui-element",this.document);if(e.parent.is("rawElement"))throw new M("view-writer-cannot-break-raw-element",this.document);if(!i&&d.is("$text")&&ou(d.parent)||ou(d))return e.clone();if(d.is("$text"))return this._breakAttributes(Pd(e),i);const h=d.childCount;if(a==h){const f=new U(d.parent,d.index+1);return this._breakAttributes(f,i)}else if(a===0){const f=new U(d.parent,d.index);return this._breakAttributes(f,i)}else{const f=d.index+1,b=d._clone();d.parent._insertChild(f,b),this._addToClonedElementsGroup(b);const k=d.childCount-a,C=d._removeChildren(a,k);b._appendChild(C);const y=new U(d.parent,f);return this._breakAttributes(y,i)}}_addToClonedElementsGroup(e){if(!e.root.is("rootElement"))return;if(e.is("element"))for(const d of e.getChildren())this._addToClonedElementsGroup(d);const i=e.id;if(!i)return;let a=this._cloneGroups.get(i);a||(a=new Set,this._cloneGroups.set(i,a)),a.add(e),e._clonesGroup=a}_removeFromClonedElementsGroup(e){if(e.is("element"))for(const d of e.getChildren())this._removeFromClonedElementsGroup(d);const i=e.id;if(!i)return;const a=this._cloneGroups.get(i);a&&a.delete(e)}}function lN(s){return Array.from(s.getChildren()).some(e=>!e.is("uiElement"))}function iu(s){let e=s.parent;for(;!ou(e);){if(!e)return;e=e.parent}return e}function cN(s,e){return s.priority<e.priority?!0:s.priority>e.priority?!1:s.getIdentity()<e.getIdentity()}function Ow(s){const e=s.nodeBefore;if(e&&e.is("$text"))return new U(e,e.data.length);const i=s.nodeAfter;return i&&i.is("$text")?new U(i,0):s}function Pd(s){if(s.offset==s.parent.data.length)return new U(s.parent.parent,s.parent.index+1);if(s.offset===0)return new U(s.parent.parent,s.parent.index);const e=s.parent.data.slice(s.offset);return s.parent._data=s.parent.data.slice(0,s.offset),s.parent.parent._insertChild(s.parent.index+1,new Dt(s.root.document,e)),new U(s.parent.parent,s.parent.index+1)}function Nw(s,e){const i=s.data.length;return s._data+=e.data,e._remove(),new U(s,i)}const dN=[Dt,Io,ir,Iu,Mu,ol];function cv(s,e){for(const i of s){if(!dN.some(a=>i instanceof a))throw new M("view-writer-insert-invalid-node-type",e);i.is("$text")||cv(i.getChildren(),e)}}function ou(s){return s&&(s.is("containerElement")||s.is("documentFragment"))}function ps(s,e){const i=iu(s.start),a=iu(s.end);if(!i||!a||i!==a)throw new M("view-writer-invalid-range-container",e)}function Dw(s,e){return s.id===null&&e.id===null}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const dv=s=>s.createTextNode(" "),uv=s=>{const e=s.createElement("span");return e.dataset.ckeFiller="true",e.innerText=" ",e},hv=s=>{const e=s.createElement("br");return e.dataset.ckeFiller="true",e},Pn=7,Lw="⁠".repeat(Pn);function Wn(s){return typeof s=="string"?s.substr(0,Pn)===Lw:Sn(s)&&s.data.substr(0,Pn)===Lw}function _a(s){return s.data.length==Pn&&Wn(s)}function Vw(s){const e=typeof s=="string"?s:s.data;return Wn(s)?e.slice(Pn):e}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const uN=hv(ct.document),hN=dv(ct.document),fN=uv(ct.document),ka="data-ck-unsafe-attribute-",Bw="data-ck-unsafe-element";class gN{constructor(e,{blockFillerMode:i,renderingMode:a="editing"}={}){this._domToViewMapping=new WeakMap,this._viewToDomMapping=new WeakMap,this._fakeSelectionMapping=new WeakMap,this._rawContentElementMatcher=new nr,this._inlineObjectElementMatcher=new nr,this._elementsWithTemporaryCustomProperties=new Set,this.document=e,this.renderingMode=a,this.blockFillerMode=i||(a==="editing"?"br":"nbsp"),this.preElements=["pre"],this.blockElements=["address","article","aside","blockquote","caption","center","dd","details","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","legend","li","main","menu","nav","ol","p","pre","section","summary","table","tbody","td","tfoot","th","thead","tr","ul"],this.inlineObjectElements=["object","iframe","input","button","textarea","select","option","video","embed","audio","img","canvas"],this.unsafeElements=["script","style"],this._domDocument=this.renderingMode==="editing"?ct.document:ct.document.implementation.createHTMLDocument("")}bindFakeSelection(e,i){this._fakeSelectionMapping.set(e,new xi(i))}fakeSelectionToView(e){return this._fakeSelectionMapping.get(e)}bindElements(e,i){this._domToViewMapping.set(e,i),this._viewToDomMapping.set(i,e)}unbindDomElement(e){const i=this._domToViewMapping.get(e);if(i){this._domToViewMapping.delete(e),this._viewToDomMapping.delete(i);for(const a of Array.from(e.children))this.unbindDomElement(a)}}bindDocumentFragments(e,i){this._domToViewMapping.set(e,i),this._viewToDomMapping.set(i,e)}shouldRenderAttribute(e,i,a){return this.renderingMode==="data"?!0:(e=e.toLowerCase(),e.startsWith("on")||e==="srcdoc"&&i.match(/\bon\S+\s*=|javascript:|<\s*\/*script/i)?!1:a==="img"&&(e==="src"||e==="srcset")||a==="source"&&e==="srcset"?!0:!i.match(/^\s*(javascript:|data:(image\/svg|text\/x?html))/i))}setContentOf(e,i){if(this.renderingMode==="data"){e.innerHTML=i;return}const a=new DOMParser().parseFromString(i,"text/html"),d=a.createDocumentFragment(),h=a.body.childNodes;for(;h.length>0;)d.appendChild(h[0]);const f=a.createTreeWalker(d,NodeFilter.SHOW_ELEMENT),b=[];let k;for(;k=f.nextNode();)b.push(k);for(const C of b){for(const P of C.getAttributeNames())this.setDomElementAttribute(C,P,C.getAttribute(P));const y=C.tagName.toLowerCase();this._shouldRenameElement(y)&&(zw(y),C.replaceWith(this._createReplacementDomElement(y,C)))}for(;e.firstChild;)e.firstChild.remove();e.append(d)}viewToDom(e,i={}){if(e.is("$text")){const a=this._processDataFromViewText(e);return this._domDocument.createTextNode(a)}else{const a=e;if(this.mapViewToDom(a))if(a.getCustomProperty("editingPipeline:doNotReuseOnce"))this._elementsWithTemporaryCustomProperties.add(a);else return this.mapViewToDom(a);let d;if(a.is("documentFragment"))d=this._domDocument.createDocumentFragment(),i.bind&&this.bindDocumentFragments(d,a);else{if(a.is("uiElement"))return a.name==="$comment"?d=this._domDocument.createComment(a.getCustomProperty("$rawContent")):d=a.render(this._domDocument,this),i.bind&&this.bindElements(d,a),d;this._shouldRenameElement(a.name)?(zw(a.name),d=this._createReplacementDomElement(a.name)):a.hasAttribute("xmlns")?d=this._domDocument.createElementNS(a.getAttribute("xmlns"),a.name):d=this._domDocument.createElement(a.name),a.is("rawElement")&&a.render(d,this),i.bind&&this.bindElements(d,a);for(const h of a.getAttributeKeys())this.setDomElementAttribute(d,h,a.getAttribute(h),a)}if(i.withChildren!==!1)for(const h of this.viewChildrenToDom(a,i))d.appendChild(h);return d}}setDomElementAttribute(e,i,a,d){const h=this.shouldRenderAttribute(i,a,e.tagName.toLowerCase())||d&&d.shouldRenderUnsafeAttribute(i);if(h||In("domconverter-unsafe-attribute-detected",{domElement:e,key:i,value:a}),!Qk(i)){In("domconverter-invalid-attribute-detected",{domElement:e,key:i,value:a});return}e.hasAttribute(i)&&!h?e.removeAttribute(i):e.hasAttribute(ka+i)&&h&&e.removeAttribute(ka+i),e.setAttribute(h?i:ka+i,a)}removeDomElementAttribute(e,i){i!=Bw&&(e.removeAttribute(i),e.removeAttribute(ka+i))}*viewChildrenToDom(e,i={}){const a=e.getFillerOffset&&e.getFillerOffset();let d=0;for(const h of e.getChildren()){a===d&&(yield this._getBlockFiller());const f=h.is("element")&&!!h.getCustomProperty("dataPipeline:transparentRendering")&&!ev(h.getAttributes());f&&this.renderingMode=="data"?yield*this.viewChildrenToDom(h,i):(f&&In("domconverter-transparent-rendering-unsupported-in-editing-pipeline",{viewElement:h}),yield this.viewToDom(h,i)),d++}a===d&&(yield this._getBlockFiller())}viewRangeToDom(e){const i=this.viewPositionToDom(e.start),a=this.viewPositionToDom(e.end),d=this._domDocument.createRange();return d.setStart(i.parent,i.offset),d.setEnd(a.parent,a.offset),d}viewPositionToDom(e){const i=e.parent;if(i.is("$text")){const a=this.findCorrespondingDomText(i);if(!a)return null;let d=e.offset;return Wn(a)&&(d+=Pn),{parent:a,offset:d}}else{let a,d,h;if(e.offset===0){if(a=this.mapViewToDom(i),!a)return null;h=a.childNodes[0]}else{const b=e.nodeBefore;if(d=b.is("$text")?this.findCorrespondingDomText(b):this.mapViewToDom(b),!d)return null;a=d.parentNode,h=d.nextSibling}if(Sn(h)&&Wn(h))return{parent:h,offset:Pn};const f=d?ba(d)+1:0;return{parent:a,offset:f}}}domToView(e,i={}){const a=[],d=this._domToView(e,i,a),h=d.next().value;return!h||(d.next(),this._processDomInlineNodes(null,a,i),h.is("$text")&&h.data.length==0)?null:h}*domChildrenToView(e,i={},a=[]){for(let d=0;d<e.childNodes.length;d++){const h=e.childNodes[d],f=this._domToView(h,i,a),b=f.next().value;b!==null&&(this._isBlockViewElement(b)&&this._processDomInlineNodes(e,a,i),yield b,f.next())}this._processDomInlineNodes(e,a,i)}domSelectionToView(e){if(bN(e))return new xi([]);if(e.rangeCount===1){let d=e.getRangeAt(0).startContainer;Sn(d)&&(d=d.parentNode);const h=this.fakeSelectionToView(d);if(h)return h}const i=this.isDomSelectionBackward(e),a=[];for(let d=0;d<e.rangeCount;d++){const h=e.getRangeAt(d),f=this.domRangeToView(h);f&&a.push(f)}return new xi(a,{backward:i})}domRangeToView(e){const i=this.domPositionToView(e.startContainer,e.startOffset),a=this.domPositionToView(e.endContainer,e.endOffset);return i&&a?new at(i,a):null}domPositionToView(e,i=0){if(this.isBlockFiller(e))return this.domPositionToView(e.parentNode,ba(e));const a=this.mapDomToView(e);if(a&&(a.is("uiElement")||a.is("rawElement")))return U._createBefore(a);if(Sn(e)){if(_a(e))return this.domPositionToView(e.parentNode,ba(e));const d=this.findCorrespondingViewText(e);let h=i;return d?(Wn(e)&&(h-=Pn,h=h<0?0:h),new U(d,h)):null}else{if(i===0){const d=this.mapDomToView(e);if(d)return new U(d,0)}else{const d=e.childNodes[i-1];if(Sn(d)&&_a(d)||d&&this.isBlockFiller(d))return this.domPositionToView(d.parentNode,ba(d));const h=Sn(d)?this.findCorrespondingViewText(d):this.mapDomToView(d);if(h&&h.parent)return new U(h.parent,h.index+1)}return null}}mapDomToView(e){return this.getHostViewElement(e)||this._domToViewMapping.get(e)}findCorrespondingViewText(e){if(_a(e))return null;const i=this.getHostViewElement(e);if(i)return i;const a=e.previousSibling;if(a){if(!this.isElement(a))return null;const d=this.mapDomToView(a);if(d){const h=d.nextSibling;return h instanceof Dt?h:null}}else{const d=this.mapDomToView(e.parentNode);if(d){const h=d.getChild(0);return h instanceof Dt?h:null}}return null}mapViewToDom(e){return this._viewToDomMapping.get(e)}findCorrespondingDomText(e){const i=e.previousSibling;return i&&this.mapViewToDom(i)?this.mapViewToDom(i).nextSibling:!i&&e.parent&&this.mapViewToDom(e.parent)?this.mapViewToDom(e.parent).childNodes[0]:null}focus(e){const i=this.mapViewToDom(e);if(i&&i.ownerDocument.activeElement!==i){const{scrollX:a,scrollY:d}=ct.window,h=[];Fw(i,f=>{const{scrollLeft:b,scrollTop:k}=f;h.push([b,k])}),i.focus(),Fw(i,f=>{const[b,k]=h.shift();f.scrollLeft=b,f.scrollTop=k}),ct.window.scrollTo(a,d)}}_clearDomSelection(){const e=this.mapViewToDom(this.document.selection.editableElement);if(!e)return;const i=e.ownerDocument.defaultView.getSelection(),a=this.domSelectionToView(i);a&&a.rangeCount>0&&i.removeAllRanges()}isElement(e){return e&&e.nodeType==Node.ELEMENT_NODE}isDocumentFragment(e){return e&&e.nodeType==Node.DOCUMENT_FRAGMENT_NODE}isBlockFiller(e){return this.blockFillerMode=="br"?e.isEqualNode(uN):e.tagName==="BR"&&fv(e,this.blockElements)&&e.parentNode.childNodes.length===1?!0:e.isEqualNode(fN)||pN(e,this.blockElements)}isDomSelectionBackward(e){if(e.isCollapsed)return!1;const i=this._domDocument.createRange();try{i.setStart(e.anchorNode,e.anchorOffset),i.setEnd(e.focusNode,e.focusOffset)}catch{return!1}const a=i.collapsed;return i.detach(),a}getHostViewElement(e){const i=w5(e);for(i.pop();i.length;){const a=i.pop(),d=this._domToViewMapping.get(a);if(d&&(d.is("uiElement")||d.is("rawElement")))return d}return null}isDomSelectionCorrect(e){return this._isDomSelectionPositionCorrect(e.anchorNode,e.anchorOffset)&&this._isDomSelectionPositionCorrect(e.focusNode,e.focusOffset)}registerRawContentMatcher(e){this._rawContentElementMatcher.add(e)}registerInlineObjectMatcher(e){this._inlineObjectElementMatcher.add(e)}_clearTemporaryCustomProperties(){for(const e of this._elementsWithTemporaryCustomProperties)e._removeCustomProperty("editingPipeline:doNotReuseOnce");this._elementsWithTemporaryCustomProperties.clear()}_getBlockFiller(){switch(this.blockFillerMode){case"nbsp":return dv(this._domDocument);case"markedNbsp":return uv(this._domDocument);case"br":return hv(this._domDocument)}}_isDomSelectionPositionCorrect(e,i){if(Sn(e)&&Wn(e)&&i<Pn||this.isElement(e)&&Wn(e.childNodes[i]))return!1;const a=this.mapDomToView(e);return!(a&&(a.is("uiElement")||a.is("rawElement")))}*_domToView(e,i,a){if(this.isBlockFiller(e))return null;const d=this.getHostViewElement(e);if(d)return d;if(xd(e)&&i.skipComments)return null;if(Sn(e)){if(_a(e))return null;{const h=e.data;if(h==="")return null;const f=new Dt(this.document,h);return a.push(f),f}}else{let h=this.mapDomToView(e);if(h)return this._isInlineObjectElement(h)&&a.push(h),h;if(this.isDocumentFragment(e))h=new Ei(this.document),i.bind&&this.bindDocumentFragments(e,h);else{h=this._createViewElement(e,i),i.bind&&this.bindElements(e,h);const b=e.attributes;if(b)for(let k=b.length,C=0;C<k;C++)h._setAttribute(b[C].name,b[C].value);if(this._isViewElementWithRawContent(h,i))return h._setCustomProperty("$rawContent",e.innerHTML),this._isBlockViewElement(h)||a.push(h),h;if(xd(e))return h._setCustomProperty("$rawContent",e.data),h}yield h;const f=[];if(i.withChildren!==!1)for(const b of this.domChildrenToView(e,i,f))h._appendChild(b);if(this._isInlineObjectElement(h))a.push(h);else for(const b of f)a.push(b)}}_processDomInlineNodes(e,i,a){if(!i.length||e&&!this.isDocumentFragment(e)&&!this._isBlockDomElement(e))return;let d=!1;for(let h=0;h<i.length;h++){const f=i[h];if(!f.is("$text")){d=!1;continue}let b,k=!1;if(mN(f,this.preElements))b=Vw(f.data);else{b=f.data.replace(/[ \n\t\r]{1,}/g," "),k=/[^\S\u00A0]/.test(b.charAt(b.length-1));const C=h>0?i[h-1]:null,y=h+1<i.length?i[h+1]:null,P=!C||C.is("element")&&C.name=="br"||d,R=y?!1:!Wn(f.data);a.withChildren!==!1&&(P&&(b=b.replace(/^ /,"")),R&&(b=b.replace(/ $/,""))),b=Vw(b),b=b.replace(/ \u00A0/g,"  ");const D=y&&y.is("element")&&y.name!="br",$=y&&y.is("$text")&&y.data.charAt(0)==" ";(/[ \u00A0]\u00A0$/.test(b)||!y||D||$)&&(b=b.replace(/\u00A0$/," ")),(P||C&&C.is("element")&&C.name!="br")&&(b=b.replace(/^\u00A0/," "))}b.length==0&&f.parent?(f._remove(),i.splice(h,1),h--):(f._data=b,d=k)}i.length=0}_processDataFromViewText(e){let i=e.data;if(e.getAncestors().some(a=>this.preElements.includes(a.name)))return i;if(i.charAt(0)==" "){const a=this._getTouchingInlineViewNode(e,!1);(a&&a.is("$textProxy")&&this._nodeEndsWithSpace(a)||!a)&&(i=" "+i.substr(1))}if(i.charAt(i.length-1)==" "){const a=this._getTouchingInlineViewNode(e,!0),d=a&&a.is("$textProxy")&&a.data.charAt(0)==" ";(i.charAt(i.length-2)==" "||!a||d)&&(i=i.substr(0,i.length-1)+" ")}return i.replace(/ {2}/g,"  ")}_nodeEndsWithSpace(e){if(e.getAncestors().some(a=>this.preElements.includes(a.name)))return!1;const i=this._processDataFromViewText(e);return i.charAt(i.length-1)==" "}_getTouchingInlineViewNode(e,i){const a=new Ai({startPosition:i?U._createAfter(e):U._createBefore(e),direction:i?"forward":"backward"});for(const d of a){if(d.item.is("element","br"))return null;if(this._isInlineObjectElement(d.item))return d.item;if(d.item.is("containerElement"))return null;if(d.item.is("$textProxy"))return d.item}return null}_isBlockDomElement(e){return this.isElement(e)&&this.blockElements.includes(e.tagName.toLowerCase())}_isBlockViewElement(e){return e.is("element")&&this.blockElements.includes(e.name)}_isInlineObjectElement(e){return e.is("element")?e.name=="br"||this.inlineObjectElements.includes(e.name)||!!this._inlineObjectElementMatcher.match(e):!1}_createViewElement(e,i){if(xd(e))return new ol(this.document,"$comment");const a=i.keepOriginalCase?e.tagName:e.tagName.toLowerCase();return new Qe(this.document,a)}_isViewElementWithRawContent(e,i){return i.withChildren!==!1&&e.is("element")&&!!this._rawContentElementMatcher.match(e)}_shouldRenameElement(e){const i=e.toLowerCase();return this.renderingMode==="editing"&&this.unsafeElements.includes(i)}_createReplacementDomElement(e,i){const a=this._domDocument.createElement("span");if(a.setAttribute(Bw,e),i){for(;i.firstChild;)a.appendChild(i.firstChild);for(const d of i.getAttributeNames())a.setAttribute(d,i.getAttribute(d))}return a}}function mN(s,e){return s.getAncestors().some(i=>i.is("element")&&e.includes(i.name))}function Fw(s,e){let i=s;for(;i;)e(i),i=i.parentElement}function pN(s,e){return s.isEqualNode(hN)&&fv(s,e)&&s.parentNode.childNodes.length===1}function fv(s,e){const i=s.parentNode;return!!i&&!!i.tagName&&e.includes(i.tagName.toLowerCase())}function zw(s){s==="script"&&In("domconverter-unsafe-script-element-detected"),s==="style"&&In("domconverter-unsafe-style-element-detected")}function bN(s){if(!Ye.isGecko||!s.rangeCount)return!1;const e=s.getRangeAt(0).startContainer;try{Object.prototype.toString.call(e)}catch{return!0}return!1}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ru extends Ni(){constructor(e){super(),this._isEnabled=!1,this.view=e,this.document=e.document}get isEnabled(){return this._isEnabled}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}destroy(){this.disable(),this.stopListening()}checkShouldIgnoreEventFromTarget(e){return e&&e.nodeType===3&&(e=e.parentNode),!e||e.nodeType!==1?!1:e.matches("[data-cke-ignore-events], [data-cke-ignore-events] *")}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class sl{constructor(e,i,a){this.view=e,this.document=e.document,this.domEvent=i,this.domTarget=i.target,dI(this,a)}get target(){return this.view.domConverter.mapDomToView(this.domTarget)}preventDefault(){this.domEvent.preventDefault()}stopPropagation(){this.domEvent.stopPropagation()}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class wN extends Ru{constructor(){super(...arguments),this.useCapture=!1}observe(e){(typeof this.domEventType=="string"?[this.domEventType]:this.domEventType).forEach(a=>{this.listenTo(e,a,(d,h)=>{this.isEnabled&&!this.checkShouldIgnoreEventFromTarget(h.target)&&this.onDomEvent(h)},{useCapture:this.useCapture})})}stopObserving(e){this.stopListening(e)}fire(e,i,a){this.isEnabled&&this.document.fire(e,new sl(this.view,i,a))}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Jn{is(){throw new Error("is() method is abstract")}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let $o=class extends Jn{constructor(e){super(),this.parent=null,this._attrs=er(e)}get document(){return null}get index(){let e;if(!this.parent)return null;if((e=this.parent.getChildIndex(this))===null)throw new M("model-node-not-found-in-parent",this);return e}get startOffset(){let e;if(!this.parent)return null;if((e=this.parent.getChildStartOffset(this))===null)throw new M("model-node-not-found-in-parent",this);return e}get offsetSize(){return 1}get endOffset(){return this.parent?this.startOffset+this.offsetSize:null}get nextSibling(){const e=this.index;return e!==null&&this.parent.getChild(e+1)||null}get previousSibling(){const e=this.index;return e!==null&&this.parent.getChild(e-1)||null}get root(){let e=this;for(;e.parent;)e=e.parent;return e}isAttached(){return this.parent===null?!1:this.root.isAttached()}getPath(){const e=[];let i=this;for(;i.parent;)e.unshift(i.startOffset),i=i.parent;return e}getAncestors(e={}){const i=[];let a=e.includeSelf?this:this.parent;for(;a;)i[e.parentFirst?"push":"unshift"](a),a=a.parent;return i}getCommonAncestor(e,i={}){const a=this.getAncestors(i),d=e.getAncestors(i);let h=0;for(;a[h]==d[h]&&a[h];)h++;return h===0?null:a[h-1]}isBefore(e){if(this==e||this.root!==e.root)return!1;const i=this.getPath(),a=e.getPath(),d=fe(i,a);switch(d){case"prefix":return!0;case"extension":return!1;default:return i[d]<a[d]}}isAfter(e){return this==e||this.root!==e.root?!1:!this.isBefore(e)}hasAttribute(e){return this._attrs.has(e)}getAttribute(e){return this._attrs.get(e)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}toJSON(){const e={};return this._attrs.size&&(e.attributes=Array.from(this._attrs).reduce((i,a)=>(i[a[0]]=a[1],i),{})),e}_clone(e){return new this.constructor(this._attrs)}_remove(){this.parent._removeChildren(this.index)}_setAttribute(e,i){this._attrs.set(e,i)}_setAttributesTo(e){this._attrs=er(e)}_removeAttribute(e){return this._attrs.delete(e)}_clearAttributes(){this._attrs.clear()}};$o.prototype.is=function(s){return s==="node"||s==="model:node"};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let Gs=class{constructor(e){this._nodes=[],e&&this._insertNodes(0,e)}[Symbol.iterator](){return this._nodes[Symbol.iterator]()}get length(){return this._nodes.length}get maxOffset(){return this._nodes.reduce((e,i)=>e+i.offsetSize,0)}getNode(e){return this._nodes[e]||null}getNodeIndex(e){const i=this._nodes.indexOf(e);return i==-1?null:i}getNodeStartOffset(e){const i=this.getNodeIndex(e);return i===null?null:this._nodes.slice(0,i).reduce((a,d)=>a+d.offsetSize,0)}indexToOffset(e){if(e==this._nodes.length)return this.maxOffset;const i=this._nodes[e];if(!i)throw new M("model-nodelist-index-out-of-bounds",this);return this.getNodeStartOffset(i)}offsetToIndex(e){let i=0;for(const a of this._nodes){if(e>=i&&e<i+a.offsetSize)return this.getNodeIndex(a);i+=a.offsetSize}if(i!=e)throw new M("model-nodelist-offset-out-of-bounds",this,{offset:e,nodeList:this});return this.length}_insertNodes(e,i){for(const a of i)if(!(a instanceof $o))throw new M("model-nodelist-insertnodes-not-node",this);this._nodes=R5(this._nodes,Array.from(i),e,0)}_removeNodes(e,i=1){return this._nodes.splice(e,i)}toJSON(){return this._nodes.map(e=>e.toJSON())}};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let zt=class su extends $o{constructor(e,i){super(i),this._data=e||""}get offsetSize(){return this.data.length}get data(){return this._data}toJSON(){const e=super.toJSON();return e.data=this.data,e}_clone(){return new su(this.data,this.getAttributes())}static fromJSON(e){return new su(e.data,e.attributes)}};zt.prototype.is=function(s){return s==="$text"||s==="model:$text"||s==="text"||s==="model:text"||s==="node"||s==="model:node"};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ke extends Jn{constructor(e,i,a){if(super(),this.textNode=e,i<0||i>e.offsetSize)throw new M("model-textproxy-wrong-offsetintext",this);if(a<0||i+a>e.offsetSize)throw new M("model-textproxy-wrong-length",this);this.data=e.data.substring(i,i+a),this.offsetInText=i}get startOffset(){return this.textNode.startOffset!==null?this.textNode.startOffset+this.offsetInText:null}get offsetSize(){return this.data.length}get endOffset(){return this.startOffset!==null?this.startOffset+this.offsetSize:null}get isPartial(){return this.offsetSize!==this.textNode.offsetSize}get parent(){return this.textNode.parent}get root(){return this.textNode.root}getPath(){const e=this.textNode.getPath();return e.length>0&&(e[e.length-1]+=this.offsetInText),e}getAncestors(e={}){const i=[];let a=e.includeSelf?this:this.parent;for(;a;)i[e.parentFirst?"push":"unshift"](a),a=a.parent;return i}hasAttribute(e){return this.textNode.hasAttribute(e)}getAttribute(e){return this.textNode.getAttribute(e)}getAttributes(){return this.textNode.getAttributes()}getAttributeKeys(){return this.textNode.getAttributeKeys()}}Ke.prototype.is=function(s){return s==="$textProxy"||s==="model:$textProxy"||s==="textProxy"||s==="model:textProxy"};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let Pi=class Ma extends $o{constructor(e,i,a){super(i),this._children=new Gs,this.name=e,a&&this._insertChild(0,a)}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return this.childCount===0}getChild(e){return this._children.getNode(e)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(e){return this._children.getNodeIndex(e)}getChildStartOffset(e){return this._children.getNodeStartOffset(e)}offsetToIndex(e){return this._children.offsetToIndex(e)}getNodeByPath(e){let i=this;for(const a of e)i=i.getChild(i.offsetToIndex(a));return i}findAncestor(e,i={}){let a=i.includeSelf?this:this.parent;for(;a;){if(a.name===e)return a;a=a.parent}return null}toJSON(){const e=super.toJSON();if(e.name=this.name,this._children.length>0){e.children=[];for(const i of this._children)e.children.push(i.toJSON())}return e}_clone(e=!1){const i=e?Array.from(this._children).map(a=>a._clone(!0)):void 0;return new Ma(this.name,this.getAttributes(),i)}_appendChild(e){this._insertChild(this.childCount,e)}_insertChild(e,i){const a=_N(i);for(const d of a)d.parent!==null&&d._remove(),d.parent=this;this._children._insertNodes(e,a)}_removeChildren(e,i=1){const a=this._children._removeNodes(e,i);for(const d of a)d.parent=null;return a}static fromJSON(e){let i;if(e.children){i=[];for(const a of e.children)a.name?i.push(Ma.fromJSON(a)):i.push(zt.fromJSON(a))}return new Ma(e.name,e.attributes,i)}};Pi.prototype.is=function(s,e){return e?e===this.name&&(s==="element"||s==="model:element"):s==="element"||s==="model:element"||s==="node"||s==="model:node"};function _N(s){return typeof s=="string"?[new zt(s)]:($e(s)||(s=[s]),Array.from(s).map(e=>typeof e=="string"?new zt(e):e instanceof Ke?new zt(e.data,e.getAttributes()):e))}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class To{constructor(e){if(!e||!e.boundaries&&!e.startPosition)throw new M("model-tree-walker-no-start-position",null);const i=e.direction||"forward";if(i!="forward"&&i!="backward")throw new M("model-tree-walker-unknown-direction",e,{direction:i});this.direction=i,this.boundaries=e.boundaries||null,e.startPosition?this._position=e.startPosition.clone():this._position=q._createAt(this.boundaries[this.direction=="backward"?"end":"start"]),this.position.stickiness="toNone",this.singleCharacters=!!e.singleCharacters,this.shallow=!!e.shallow,this.ignoreElementEnd=!!e.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null,this._visitedParent=this.position.parent}[Symbol.iterator](){return this}get position(){return this._position}skip(e){let i,a,d,h;do d=this.position,h=this._visitedParent,{done:i,value:a}=this.next();while(!i&&e(a));i||(this._position=d,this._visitedParent=h)}next(){return this.direction=="forward"?this._next():this._previous()}_next(){const e=this.position,i=this.position.clone(),a=this._visitedParent;if(a.parent===null&&i.offset===a.maxOffset)return{done:!0,value:void 0};if(a===this._boundaryEndParent&&i.offset==this.boundaries.end.offset)return{done:!0,value:void 0};const d=Ks(i,a),h=d||gv(i,a,d);if(h instanceof Pi){if(!this.shallow)i.path.push(0),this._visitedParent=h;else{if(this.boundaries&&this.boundaries.end.isBefore(i))return{done:!0,value:void 0};i.offset++}return this._position=i,bi("elementStart",h,e,i,1)}if(h instanceof zt){let f;if(this.singleCharacters)f=1;else{let C=h.endOffset;this._boundaryEndParent==a&&this.boundaries.end.offset<C&&(C=this.boundaries.end.offset),f=C-i.offset}const b=i.offset-h.startOffset,k=new Ke(h,b,f);return i.offset+=f,this._position=i,bi("text",k,e,i,f)}return i.path.pop(),i.offset++,this._position=i,this._visitedParent=a.parent,this.ignoreElementEnd?this._next():bi("elementEnd",a,e,i)}_previous(){const e=this.position,i=this.position.clone(),a=this._visitedParent;if(a.parent===null&&i.offset===0)return{done:!0,value:void 0};if(a==this._boundaryStartParent&&i.offset==this.boundaries.start.offset)return{done:!0,value:void 0};const d=i.parent,h=Ks(i,d),f=h||mv(i,d,h);if(f instanceof Pi)return i.offset--,this.shallow?(this._position=i,bi("elementStart",f,e,i,1)):(i.path.push(f.maxOffset),this._position=i,this._visitedParent=f,this.ignoreElementEnd?this._previous():bi("elementEnd",f,e,i));if(f instanceof zt){let b;if(this.singleCharacters)b=1;else{let y=f.startOffset;this._boundaryStartParent==a&&this.boundaries.start.offset>y&&(y=this.boundaries.start.offset),b=i.offset-y}const k=i.offset-f.startOffset,C=new Ke(f,k-b,b);return i.offset-=b,this._position=i,bi("text",C,e,i,b)}return i.path.pop(),this._position=i,this._visitedParent=a.parent,bi("elementStart",a,e,i,1)}}function bi(s,e,i,a,d){return{done:!1,value:{type:s,item:e,previousPosition:i,nextPosition:a,length:d}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class q extends Jn{constructor(e,i,a="toNone"){if(super(),!e.is("element")&&!e.is("documentFragment"))throw new M("model-position-root-invalid",e);if(!(i instanceof Array)||i.length===0)throw new M("model-position-path-incorrect-format",e,{path:i});e.is("rootElement")?i=i.slice():(i=[...e.getPath(),...i],e=e.root),this.root=e,this.path=i,this.stickiness=a}get offset(){return this.path[this.path.length-1]}set offset(e){this.path[this.path.length-1]=e}get parent(){let e=this.root;for(let i=0;i<this.path.length-1;i++)if(e=e.getChild(e.offsetToIndex(this.path[i])),!e)throw new M("model-position-path-incorrect",this,{position:this});if(e.is("$text"))throw new M("model-position-path-incorrect",this,{position:this});return e}get index(){return this.parent.offsetToIndex(this.offset)}get textNode(){return Ks(this,this.parent)}get nodeAfter(){const e=this.parent;return gv(this,e,Ks(this,e))}get nodeBefore(){const e=this.parent;return mv(this,e,Ks(this,e))}get isAtStart(){return this.offset===0}get isAtEnd(){return this.offset==this.parent.maxOffset}compareWith(e){if(this.root!=e.root)return"different";const i=fe(this.path,e.path);switch(i){case"same":return"same";case"prefix":return"before";case"extension":return"after";default:return this.path[i]<e.path[i]?"before":"after"}}getLastMatchingPosition(e,i={}){i.startPosition=this;const a=new To(i);return a.skip(e),a.position}getParentPath(){return this.path.slice(0,-1)}getAncestors(){const e=this.parent;return e.is("documentFragment")?[e]:e.getAncestors({includeSelf:!0})}findAncestor(e){const i=this.parent;return i.is("element")?i.findAncestor(e,{includeSelf:!0}):null}getCommonPath(e){if(this.root!=e.root)return[];const i=fe(this.path,e.path),a=typeof i=="string"?Math.min(this.path.length,e.path.length):i;return this.path.slice(0,a)}getCommonAncestor(e){const i=this.getAncestors(),a=e.getAncestors();let d=0;for(;i[d]==a[d]&&i[d];)d++;return d===0?null:i[d-1]}getShiftedBy(e){const i=this.clone(),a=i.offset+e;return i.offset=a<0?0:a,i}isAfter(e){return this.compareWith(e)=="after"}isBefore(e){return this.compareWith(e)=="before"}isEqual(e){return this.compareWith(e)=="same"}isTouching(e){if(this.root!==e.root)return!1;const i=Math.min(this.path.length,e.path.length);for(let a=0;a<i;a++){const d=this.path[a]-e.path[a];if(d<-1||d>1)return!1;if(d===1)return jw(e,this,a);if(d===-1)return jw(this,e,a)}return this.path.length===e.path.length?!0:this.path.length>e.path.length?ru(this.path,i):ru(e.path,i)}hasSameParentAs(e){if(this.root!==e.root)return!1;const i=this.getParentPath(),a=e.getParentPath();return fe(i,a)=="same"}getTransformedByOperation(e){let i;switch(e.type){case"insert":i=this._getTransformedByInsertOperation(e);break;case"move":case"remove":case"reinsert":i=this._getTransformedByMoveOperation(e);break;case"split":i=this._getTransformedBySplitOperation(e);break;case"merge":i=this._getTransformedByMergeOperation(e);break;default:i=q._createAt(this);break}return i}_getTransformedByInsertOperation(e){return this._getTransformedByInsertion(e.position,e.howMany)}_getTransformedByMoveOperation(e){return this._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany)}_getTransformedBySplitOperation(e){const i=e.movedRange;return i.containsPosition(this)||i.start.isEqual(this)&&this.stickiness=="toNext"?this._getCombined(e.splitPosition,e.moveTargetPosition):e.graveyardPosition?this._getTransformedByMove(e.graveyardPosition,e.insertionPosition,1):this._getTransformedByInsertion(e.insertionPosition,1)}_getTransformedByMergeOperation(e){const i=e.movedRange,a=i.containsPosition(this)||i.start.isEqual(this);let d;return a?(d=this._getCombined(e.sourcePosition,e.targetPosition),e.sourcePosition.isBefore(e.targetPosition)&&(d=d._getTransformedByDeletion(e.deletionPosition,1))):this.isEqual(e.deletionPosition)?d=q._createAt(e.deletionPosition):d=this._getTransformedByMove(e.deletionPosition,e.graveyardPosition,1),d}_getTransformedByDeletion(e,i){const a=q._createAt(this);if(this.root!=e.root)return a;if(fe(e.getParentPath(),this.getParentPath())=="same"){if(e.offset<this.offset){if(e.offset+i>this.offset)return null;a.offset-=i}}else if(fe(e.getParentPath(),this.getParentPath())=="prefix"){const d=e.path.length-1;if(e.offset<=this.path[d]){if(e.offset+i>this.path[d])return null;a.path[d]-=i}}return a}_getTransformedByInsertion(e,i){const a=q._createAt(this);if(this.root!=e.root)return a;if(fe(e.getParentPath(),this.getParentPath())=="same")(e.offset<this.offset||e.offset==this.offset&&this.stickiness!="toPrevious")&&(a.offset+=i);else if(fe(e.getParentPath(),this.getParentPath())=="prefix"){const d=e.path.length-1;e.offset<=this.path[d]&&(a.path[d]+=i)}return a}_getTransformedByMove(e,i,a){if(i=i._getTransformedByDeletion(e,a),e.isEqual(i))return q._createAt(this);const d=this._getTransformedByDeletion(e,a);return d===null||e.isEqual(this)&&this.stickiness=="toNext"||e.getShiftedBy(a).isEqual(this)&&this.stickiness=="toPrevious"?this._getCombined(e,i):d._getTransformedByInsertion(i,a)}_getCombined(e,i){const a=e.path.length-1,d=q._createAt(i);return d.stickiness=this.stickiness,d.offset=d.offset+this.path[a]-e.offset,d.path=[...d.path,...this.path.slice(a+1)],d}toJSON(){return{root:this.root.toJSON(),path:Array.from(this.path),stickiness:this.stickiness}}clone(){return new this.constructor(this.root,this.path,this.stickiness)}static _createAt(e,i,a="toNone"){if(e instanceof q)return new q(e.root,e.path,e.stickiness);{const d=e;if(i=="end")i=d.maxOffset;else{if(i=="before")return this._createBefore(d,a);if(i=="after")return this._createAfter(d,a);if(i!==0&&!i)throw new M("model-createpositionat-offset-required",[this,e])}if(!d.is("element")&&!d.is("documentFragment"))throw new M("model-position-parent-incorrect",[this,e]);const h=d.getPath();return h.push(i),new this(d.root,h,a)}}static _createAfter(e,i){if(!e.parent)throw new M("model-position-after-root",[this,e],{root:e});return this._createAt(e.parent,e.endOffset,i)}static _createBefore(e,i){if(!e.parent)throw new M("model-position-before-root",e,{root:e});return this._createAt(e.parent,e.startOffset,i)}static fromJSON(e,i){if(e.root==="$graveyard"){const a=new q(i.graveyard,e.path);return a.stickiness=e.stickiness,a}if(!i.getRoot(e.root))throw new M("model-position-fromjson-no-root",i,{rootName:e.root});return new q(i.getRoot(e.root),e.path,e.stickiness)}}q.prototype.is=function(s){return s==="position"||s==="model:position"};function Ks(s,e){const i=e.getChild(e.offsetToIndex(s.offset));return i&&i.is("$text")&&i.startOffset<s.offset?i:null}function gv(s,e,i){return i!==null?null:e.getChild(e.offsetToIndex(s.offset))}function mv(s,e,i){return i!==null?null:e.getChild(e.offsetToIndex(s.offset)-1)}function jw(s,e,i){return!(i+1===s.path.length||!ru(e.path,i+1)||!kN(s,i+1))}function ru(s,e){for(;e<s.length;){if(s[e]!==0)return!1;e++}return!0}function kN(s,e){let i=s.parent,a=s.path.length-1,d=0;for(;a>=e;){if(s.path[a]+d!==i.maxOffset)return!1;d=1,a--,i=i.parent}return!0}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class V extends Jn{constructor(e,i){super(),this.start=q._createAt(e),this.end=i?q._createAt(i):q._createAt(e),this.start.stickiness=this.isCollapsed?"toNone":"toNext",this.end.stickiness=this.isCollapsed?"toNone":"toPrevious"}*[Symbol.iterator](){yield*new To({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){const e=this.start.getParentPath(),i=this.end.getParentPath();return fe(e,i)=="same"}get root(){return this.start.root}containsPosition(e){return e.isAfter(this.start)&&e.isBefore(this.end)}containsRange(e,i=!1){e.isCollapsed&&(i=!1);const a=this.containsPosition(e.start)||i&&this.start.isEqual(e.start),d=this.containsPosition(e.end)||i&&this.end.isEqual(e.end);return a&&d}containsItem(e){const i=q._createBefore(e);return this.containsPosition(i)||this.start.isEqual(i)}isEqual(e){return this.start.isEqual(e.start)&&this.end.isEqual(e.end)}isIntersecting(e){return this.start.isBefore(e.end)&&this.end.isAfter(e.start)}getDifference(e){const i=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&i.push(new V(this.start,e.start)),this.containsPosition(e.end)&&i.push(new V(e.end,this.end))):i.push(new V(this.start,this.end)),i}getIntersection(e){if(this.isIntersecting(e)){let i=this.start,a=this.end;return this.containsPosition(e.start)&&(i=e.start),this.containsPosition(e.end)&&(a=e.end),new V(i,a)}return null}getJoined(e,i=!1){let a=this.isIntersecting(e);if(a||(this.start.isBefore(e.start)?a=i?this.end.isTouching(e.start):this.end.isEqual(e.start):a=i?e.end.isTouching(this.start):e.end.isEqual(this.start)),!a)return null;let d=this.start,h=this.end;return e.start.isBefore(d)&&(d=e.start),e.end.isAfter(h)&&(h=e.end),new V(d,h)}getMinimalFlatRanges(){const e=[],i=this.start.getCommonPath(this.end).length,a=q._createAt(this.start);let d=a.parent;for(;a.path.length>i+1;){const h=d.maxOffset-a.offset;h!==0&&e.push(new V(a,a.getShiftedBy(h))),a.path=a.path.slice(0,-1),a.offset++,d=d.parent}for(;a.path.length<=this.end.path.length;){const h=this.end.path[a.path.length-1],f=h-a.offset;f!==0&&e.push(new V(a,a.getShiftedBy(f))),a.offset=h,a.path.push(0)}return e}getWalker(e={}){return e.boundaries=this,new To(e)}*getItems(e={}){e.boundaries=this,e.ignoreElementEnd=!0;const i=new To(e);for(const a of i)yield a.item}*getPositions(e={}){e.boundaries=this;const i=new To(e);yield i.position;for(const a of i)yield a.nextPosition}getTransformedByOperation(e){switch(e.type){case"insert":return this._getTransformedByInsertOperation(e);case"move":case"remove":case"reinsert":return this._getTransformedByMoveOperation(e);case"split":return[this._getTransformedBySplitOperation(e)];case"merge":return[this._getTransformedByMergeOperation(e)]}return[new V(this.start,this.end)]}getTransformedByOperations(e){const i=[new V(this.start,this.end)];for(const a of e)for(let d=0;d<i.length;d++){const h=i[d].getTransformedByOperation(a);i.splice(d,1,...h),d+=h.length-1}for(let a=0;a<i.length;a++){const d=i[a];for(let h=a+1;h<i.length;h++){const f=i[h];(d.containsRange(f)||f.containsRange(d)||d.isEqual(f))&&i.splice(h,1)}}return i}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;const e=this.start.nodeAfter,i=this.end.nodeBefore;return e&&e.is("element")&&e===i?e:null}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}clone(){return new this.constructor(this.start,this.end)}_getTransformedByInsertOperation(e,i=!1){return this._getTransformedByInsertion(e.position,e.howMany,i)}_getTransformedByMoveOperation(e,i=!1){const a=e.sourcePosition,d=e.howMany,h=e.targetPosition;return this._getTransformedByMove(a,h,d,i)}_getTransformedBySplitOperation(e){const i=this.start._getTransformedBySplitOperation(e);let a=this.end._getTransformedBySplitOperation(e);return this.end.isEqual(e.insertionPosition)&&(a=this.end.getShiftedBy(1)),i.root!=a.root&&(a=this.end.getShiftedBy(-1)),new V(i,a)}_getTransformedByMergeOperation(e){if(this.start.isEqual(e.targetPosition)&&this.end.isEqual(e.deletionPosition))return new V(this.start);let i=this.start._getTransformedByMergeOperation(e),a=this.end._getTransformedByMergeOperation(e);return i.root!=a.root&&(a=this.end.getShiftedBy(-1)),i.isAfter(a)?(e.sourcePosition.isBefore(e.targetPosition)?(i=q._createAt(a),i.offset=0):(e.deletionPosition.isEqual(i)||(a=e.deletionPosition),i=e.targetPosition),new V(i,a)):new V(i,a)}_getTransformedByInsertion(e,i,a=!1){if(a&&this.containsPosition(e))return[new V(this.start,e),new V(e.getShiftedBy(i),this.end._getTransformedByInsertion(e,i))];{const d=new V(this.start,this.end);return d.start=d.start._getTransformedByInsertion(e,i),d.end=d.end._getTransformedByInsertion(e,i),[d]}}_getTransformedByMove(e,i,a,d=!1){if(this.isCollapsed){const P=this.start._getTransformedByMove(e,i,a);return[new V(P)]}const h=V._createFromPositionAndShift(e,a),f=i._getTransformedByDeletion(e,a);if(this.containsPosition(i)&&!d&&(h.containsPosition(this.start)||h.containsPosition(this.end))){const P=this.start._getTransformedByMove(e,i,a),R=this.end._getTransformedByMove(e,i,a);return[new V(P,R)]}let b;const k=this.getDifference(h);let C=null;const y=this.getIntersection(h);if(k.length==1?C=new V(k[0].start._getTransformedByDeletion(e,a),k[0].end._getTransformedByDeletion(e,a)):k.length==2&&(C=new V(this.start,this.end._getTransformedByDeletion(e,a))),C?b=C._getTransformedByInsertion(f,a,y!==null||d):b=[],y){const P=new V(y.start._getCombined(h.start,f),y.end._getCombined(h.start,f));b.length==2?b.splice(1,0,P):b.push(P)}return b}_getTransformedByDeletion(e,i){let a=this.start._getTransformedByDeletion(e,i),d=this.end._getTransformedByDeletion(e,i);return a==null&&d==null?null:(a==null&&(a=e),d==null&&(d=e),new V(a,d))}static _createFromPositionAndShift(e,i){const a=e,d=e.getShiftedBy(i);return i>0?new this(a,d):new this(d,a)}static _createIn(e){return new this(q._createAt(e,0),q._createAt(e,e.maxOffset))}static _createOn(e){return this._createFromPositionAndShift(q._createBefore(e),e.offsetSize)}static _createFromRanges(e){if(e.length===0)throw new M("range-create-from-ranges-empty-array",null);if(e.length==1)return e[0].clone();const i=e[0];e.sort((h,f)=>h.start.isAfter(f.start)?1:-1);const a=e.indexOf(i),d=new this(i.start,i.end);if(a>0)for(let h=a-1;e[h].end.isEqual(d.start);h++)d.start=q._createAt(e[h].start);for(let h=a+1;h<e.length&&e[h].start.isEqual(d.end);h++)d.end=q._createAt(e[h].end);return d}static fromJSON(e,i){return new this(q.fromJSON(e.start,i),q.fromJSON(e.end,i))}}V.prototype.is=function(s){return s==="range"||s==="model:range"};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class vN extends wt(){constructor(){super(),this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._viewToModelLengthCallbacks=new Map,this._markerNameToElements=new Map,this._elementToMarkerNames=new Map,this._deferredBindingRemovals=new Map,this._unboundMarkerNames=new Set,this.on("modelToViewPosition",(e,i)=>{if(i.viewPosition)return;const a=this._modelToViewMapping.get(i.modelPosition.parent);if(!a)throw new M("mapping-model-position-view-parent-not-found",this,{modelPosition:i.modelPosition});i.viewPosition=this.findPositionIn(a,i.modelPosition.offset)},{priority:"low"}),this.on("viewToModelPosition",(e,i)=>{if(i.modelPosition)return;const a=this.findMappedViewAncestor(i.viewPosition),d=this._viewToModelMapping.get(a),h=this._toModelOffset(i.viewPosition.parent,i.viewPosition.offset,a);i.modelPosition=q._createAt(d,h)},{priority:"low"})}bindElements(e,i){this._modelToViewMapping.set(e,i),this._viewToModelMapping.set(i,e)}unbindViewElement(e,i={}){const a=this.toModelElement(e);if(this._elementToMarkerNames.has(e))for(const d of this._elementToMarkerNames.get(e))this._unboundMarkerNames.add(d);i.defer?this._deferredBindingRemovals.set(e,e.root):(this._viewToModelMapping.delete(e),this._modelToViewMapping.get(a)==e&&this._modelToViewMapping.delete(a))}unbindModelElement(e){const i=this.toViewElement(e);this._modelToViewMapping.delete(e),this._viewToModelMapping.get(i)==e&&this._viewToModelMapping.delete(i)}bindElementToMarker(e,i){const a=this._markerNameToElements.get(i)||new Set;a.add(e);const d=this._elementToMarkerNames.get(e)||new Set;d.add(i),this._markerNameToElements.set(i,a),this._elementToMarkerNames.set(e,d)}unbindElementFromMarkerName(e,i){const a=this._markerNameToElements.get(i);a&&(a.delete(e),a.size==0&&this._markerNameToElements.delete(i));const d=this._elementToMarkerNames.get(e);d&&(d.delete(i),d.size==0&&this._elementToMarkerNames.delete(e))}flushUnboundMarkerNames(){const e=Array.from(this._unboundMarkerNames);return this._unboundMarkerNames.clear(),e}flushDeferredBindings(){for(const[e,i]of this._deferredBindingRemovals)e.root==i&&this.unbindViewElement(e);this._deferredBindingRemovals=new Map}clearBindings(){this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._markerNameToElements=new Map,this._elementToMarkerNames=new Map,this._unboundMarkerNames=new Set,this._deferredBindingRemovals=new Map}toModelElement(e){return this._viewToModelMapping.get(e)}toViewElement(e){return this._modelToViewMapping.get(e)}toModelRange(e){return new V(this.toModelPosition(e.start),this.toModelPosition(e.end))}toViewRange(e){return new at(this.toViewPosition(e.start),this.toViewPosition(e.end))}toModelPosition(e){const i={viewPosition:e,mapper:this};return this.fire("viewToModelPosition",i),i.modelPosition}toViewPosition(e,i={}){const a={modelPosition:e,mapper:this,isPhantom:i.isPhantom};return this.fire("modelToViewPosition",a),a.viewPosition}markerNameToElements(e){const i=this._markerNameToElements.get(e);if(!i)return null;const a=new Set;for(const d of i)if(d.is("attributeElement"))for(const h of d.getElementsWithSameId())a.add(h);else a.add(d);return a}registerViewToModelLength(e,i){this._viewToModelLengthCallbacks.set(e,i)}findMappedViewAncestor(e){let i=e.parent;for(;!this._viewToModelMapping.has(i);)i=i.parent;return i}_toModelOffset(e,i,a){if(a!=e){const h=this._toModelOffset(e.parent,e.index,a),f=this._toModelOffset(e,i,e);return h+f}if(e.is("$text"))return i;let d=0;for(let h=0;h<i;h++)d+=this.getModelLength(e.getChild(h));return d}getModelLength(e){if(this._viewToModelLengthCallbacks.get(e.name))return this._viewToModelLengthCallbacks.get(e.name)(e);if(this._viewToModelMapping.has(e))return 1;if(e.is("$text"))return e.data.length;if(e.is("uiElement"))return 0;{let i=0;for(const a of e.getChildren())i+=this.getModelLength(a);return i}}findPositionIn(e,i){let a,d=0,h=0,f=0;if(e.is("$text"))return new U(e,i);for(;h<i;)a=e.getChild(f),d=this.getModelLength(a),h+=d,f++;return h==i?this._moveViewPositionToTextNode(new U(e,f)):this.findPositionIn(a,i-(h-d))}_moveViewPositionToTextNode(e){const i=e.nodeBefore,a=e.nodeAfter;return i instanceof Dt?new U(i,i.data.length):a instanceof Dt?new U(a,0):e}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class yN{constructor(){this._consumable=new Map,this._textProxyRegistry=new Map}add(e,i){i=va(i),e instanceof Ke&&(e=this._getSymbolForTextProxy(e)),this._consumable.has(e)||this._consumable.set(e,new Map),this._consumable.get(e).set(i,!0)}consume(e,i){return i=va(i),e instanceof Ke&&(e=this._getSymbolForTextProxy(e)),this.test(e,i)?(this._consumable.get(e).set(i,!1),!0):!1}test(e,i){i=va(i),e instanceof Ke&&(e=this._getSymbolForTextProxy(e));const a=this._consumable.get(e);if(a===void 0)return null;const d=a.get(i);return d===void 0?null:d}revert(e,i){i=va(i),e instanceof Ke&&(e=this._getSymbolForTextProxy(e));const a=this.test(e,i);return a===!1?(this._consumable.get(e).set(i,!0),!0):a===!0?!1:null}verifyAllConsumed(e){const i=[];for(const[a,d]of this._consumable)for(const[h,f]of d){const b=h.split(":")[0];f&&e==b&&i.push({event:h,item:a.name||a.description})}if(i.length)throw new M("conversion-model-consumable-not-consumed",null,{items:i})}_getSymbolForTextProxy(e){let i=null;const a=this._textProxyRegistry.get(e.startOffset);if(a){const d=a.get(e.endOffset);d&&(i=d.get(e.parent))}return i||(i=this._addSymbolForTextProxy(e)),i}_addSymbolForTextProxy(e){const i=e.startOffset,a=e.endOffset,d=e.parent,h=Symbol("$textProxy:"+e.data);let f,b;return f=this._textProxyRegistry.get(i),f||(f=new Map,this._textProxyRegistry.set(i,f)),b=f.get(a),b||(b=new Map,f.set(a,b)),b.set(d,h),h}}function va(s){const e=s.split(":");return e[0]=="insert"?e[0]:e[0]=="addMarker"||e[0]=="removeMarker"?s:e.length>1?e[0]+":"+e[1]:e[0]}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class AN extends wt(){constructor(e){super(),this._conversionApi={dispatcher:this,...e},this._firedEventsMap=new WeakMap}convertChanges(e,i,a){const d=this._createConversionApi(a,e.getRefreshedItems());for(const f of e.getMarkersToRemove())this._convertMarkerRemove(f.name,f.range,d);const h=this._reduceChanges(e.getChanges());for(const f of h)f.type==="insert"?this._convertInsert(V._createFromPositionAndShift(f.position,f.length),d):f.type==="reinsert"?this._convertReinsert(V._createFromPositionAndShift(f.position,f.length),d):f.type==="remove"?this._convertRemove(f.position,f.length,f.name,d):this._convertAttribute(f.range,f.attributeKey,f.attributeOldValue,f.attributeNewValue,d);d.mapper.flushDeferredBindings();for(const f of d.mapper.flushUnboundMarkerNames()){const b=i.get(f).getRange();this._convertMarkerRemove(f,b,d),this._convertMarkerAdd(f,b,d)}for(const f of e.getMarkersToAdd())this._convertMarkerAdd(f.name,f.range,d);d.consumable.verifyAllConsumed("insert")}convert(e,i,a,d={}){const h=this._createConversionApi(a,void 0,d);this._convertInsert(e,h);for(const[f,b]of i)this._convertMarkerAdd(f,b,h);h.consumable.verifyAllConsumed("insert")}convertSelection(e,i,a){const d=this._createConversionApi(a);this.fire("cleanSelection",{selection:e},d);const h=e.getFirstPosition().root;if(!d.mapper.toViewElement(h))return;const f=Array.from(i.getMarkersAtPosition(e.getFirstPosition()));if(this._addConsumablesForSelection(d.consumable,e,f),this.fire("selection",{selection:e},d),!!e.isCollapsed){for(const b of f)if(d.consumable.test(e,"addMarker:"+b.name)){const k=b.getRange();if(!CN(e.getFirstPosition(),b,d.mapper))continue;const C={item:e,markerName:b.name,markerRange:k};this.fire(`addMarker:${b.name}`,C,d)}for(const b of e.getAttributeKeys())if(d.consumable.test(e,"attribute:"+b)){const k={item:e,range:e.getFirstRange(),attributeKey:b,attributeOldValue:null,attributeNewValue:e.getAttribute(b)};this.fire(`attribute:${b}:$text`,k,d)}}}_convertInsert(e,i,a={}){a.doNotAddConsumables||this._addConsumablesForInsert(i.consumable,e);for(const d of Array.from(e.getWalker({shallow:!0})).map($w))this._testAndFire("insert",d,i)}_convertRemove(e,i,a,d){this.fire(`remove:${a}`,{position:e,length:i},d)}_convertAttribute(e,i,a,d,h){this._addConsumablesForRange(h.consumable,e,`attribute:${i}`);for(const f of e){const b={item:f.item,range:V._createFromPositionAndShift(f.previousPosition,f.length),attributeKey:i,attributeOldValue:a,attributeNewValue:d};this._testAndFire(`attribute:${i}`,b,h)}}_convertReinsert(e,i){const a=Array.from(e.getWalker({shallow:!0}));this._addConsumablesForInsert(i.consumable,a);for(const d of a.map($w))this._testAndFire("insert",{...d,reconversion:!0},i)}_convertMarkerAdd(e,i,a){if(i.root.rootName=="$graveyard")return;const d=`addMarker:${e}`;if(a.consumable.add(i,d),this.fire(d,{markerName:e,markerRange:i},a),!!a.consumable.consume(i,d)){this._addConsumablesForRange(a.consumable,i,d);for(const h of i.getItems()){if(!a.consumable.test(h,d))continue;const f={item:h,range:V._createOn(h),markerName:e,markerRange:i};this.fire(d,f,a)}}}_convertMarkerRemove(e,i,a){i.root.rootName!="$graveyard"&&this.fire(`removeMarker:${e}`,{markerName:e,markerRange:i},a)}_reduceChanges(e){const i={changes:e};return this.fire("reduceChanges",i),i.changes}_addConsumablesForInsert(e,i){for(const a of i){const d=a.item;if(e.test(d,"insert")===null){e.add(d,"insert");for(const h of d.getAttributeKeys())e.add(d,"attribute:"+h)}}return e}_addConsumablesForRange(e,i,a){for(const d of i.getItems())e.add(d,a);return e}_addConsumablesForSelection(e,i,a){e.add(i,"selection");for(const d of a)e.add(i,"addMarker:"+d.name);for(const d of i.getAttributeKeys())e.add(i,"attribute:"+d);return e}_testAndFire(e,i,a){const d=xN(e,i),h=i.item.is("$textProxy")?a.consumable._getSymbolForTextProxy(i.item):i.item,f=this._firedEventsMap.get(a),b=f.get(h);if(!b)f.set(h,new Set([d]));else if(!b.has(d))b.add(d);else return;this.fire(d,i,a)}_testAndFireAddAttributes(e,i){const a={item:e,range:V._createOn(e)};for(const d of a.item.getAttributeKeys())a.attributeKey=d,a.attributeOldValue=null,a.attributeNewValue=a.item.getAttribute(d),this._testAndFire(`attribute:${d}`,a,i)}_createConversionApi(e,i=new Set,a={}){const d={...this._conversionApi,consumable:new yN,writer:e,options:a,convertItem:h=>this._convertInsert(V._createOn(h),d),convertChildren:h=>this._convertInsert(V._createIn(h),d,{doNotAddConsumables:!0}),convertAttributes:h=>this._testAndFireAddAttributes(h,d),canReuseView:h=>!i.has(d.mapper.toModelElement(h))};return this._firedEventsMap.set(d,new Map),d}}function CN(s,e,i){const a=e.getRange(),d=Array.from(s.getAncestors());return d.shift(),d.reverse(),!d.some(f=>{if(a.containsItem(f))return!!i.toViewElement(f).getCustomProperty("addHighlight")})}function xN(s,e){const i=e.item.is("element")?e.item.name:"$text";return`${s}:${i}`}function $w(s){const e=s.item,i=V._createFromPositionAndShift(s.previousPosition,s.length);return{item:e,range:i}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class rl extends wt(Jn){constructor(...e){super(),this._lastRangeBackward=!1,this._attrs=new Map,this._ranges=[],e.length&&this.setTo(...e)}get anchor(){if(this._ranges.length>0){const e=this._ranges[this._ranges.length-1];return this._lastRangeBackward?e.end:e.start}return null}get focus(){if(this._ranges.length>0){const e=this._ranges[this._ranges.length-1];return this._lastRangeBackward?e.start:e.end}return null}get isCollapsed(){return this._ranges.length===1?this._ranges[0].isCollapsed:!1}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}isEqual(e){if(this.rangeCount!=e.rangeCount)return!1;if(this.rangeCount===0)return!0;if(!this.anchor.isEqual(e.anchor)||!this.focus.isEqual(e.focus))return!1;for(const i of this._ranges){let a=!1;for(const d of e._ranges)if(i.isEqual(d)){a=!0;break}if(!a)return!1}return!0}*getRanges(){for(const e of this._ranges)yield new V(e.start,e.end)}getFirstRange(){let e=null;for(const i of this._ranges)(!e||i.start.isBefore(e.start))&&(e=i);return e?new V(e.start,e.end):null}getLastRange(){let e=null;for(const i of this._ranges)(!e||i.end.isAfter(e.end))&&(e=i);return e?new V(e.start,e.end):null}getFirstPosition(){const e=this.getFirstRange();return e?e.start.clone():null}getLastPosition(){const e=this.getLastRange();return e?e.end.clone():null}setTo(...e){let[i,a,d]=e;if(typeof a=="object"&&(d=a,a=void 0),i===null)this._setRanges([]);else if(i instanceof rl)this._setRanges(i.getRanges(),i.isBackward);else if(i&&typeof i.getRanges=="function")this._setRanges(i.getRanges(),i.isBackward);else if(i instanceof V)this._setRanges([i],!!d&&!!d.backward);else if(i instanceof q)this._setRanges([new V(i)]);else if(i instanceof $o){const h=!!d&&!!d.backward;let f;if(a=="in")f=V._createIn(i);else if(a=="on")f=V._createOn(i);else if(a!==void 0)f=new V(q._createAt(i,a));else throw new M("model-selection-setto-required-second-parameter",[this,i]);this._setRanges([f],h)}else if($e(i))this._setRanges(i,d&&!!d.backward);else throw new M("model-selection-setto-not-selectable",[this,i])}_setRanges(e,i=!1){const a=Array.from(e),d=a.some(h=>{if(!(h instanceof V))throw new M("model-selection-set-ranges-not-range",[this,e]);return this._ranges.every(f=>!f.isEqual(h))});a.length===this._ranges.length&&!d||(this._replaceAllRanges(a),this._lastRangeBackward=!!i,this.fire("change:range",{directChange:!0}))}setFocus(e,i){if(this.anchor===null)throw new M("model-selection-setfocus-no-ranges",[this,e]);const a=q._createAt(e,i);if(a.compareWith(this.focus)=="same")return;const d=this.anchor;this._ranges.length&&this._popRange(),a.compareWith(d)=="before"?(this._pushRange(new V(a,d)),this._lastRangeBackward=!0):(this._pushRange(new V(d,a)),this._lastRangeBackward=!1),this.fire("change:range",{directChange:!0})}getAttribute(e){return this._attrs.get(e)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}hasAttribute(e){return this._attrs.has(e)}removeAttribute(e){this.hasAttribute(e)&&(this._attrs.delete(e),this.fire("change:attribute",{attributeKeys:[e],directChange:!0}))}setAttribute(e,i){this.getAttribute(e)!==i&&(this._attrs.set(e,i),this.fire("change:attribute",{attributeKeys:[e],directChange:!0}))}getSelectedElement(){return this.rangeCount!==1?null:this.getFirstRange().getContainedElement()}*getSelectedBlocks(){const e=new WeakSet;for(const i of this.getRanges()){const a=Hw(i.start,e);TN(a,i)&&(yield a);for(const h of i.getWalker()){const f=h.item;h.type=="elementEnd"&&EN(f,e,i)&&(yield f)}const d=Hw(i.end,e);SN(d,i)&&(yield d)}}containsEntireContent(e=this.anchor.root){const i=q._createAt(e,0),a=q._createAt(e,"end");return i.isTouching(this.getFirstPosition())&&a.isTouching(this.getLastPosition())}_pushRange(e){this._checkRange(e),this._ranges.push(new V(e.start,e.end))}_checkRange(e){for(let i=0;i<this._ranges.length;i++)if(e.isIntersecting(this._ranges[i]))throw new M("model-selection-range-intersects",[this,e],{addedRange:e,intersectingRange:this._ranges[i]})}_replaceAllRanges(e){this._removeAllRanges();for(const i of e)this._pushRange(i)}_removeAllRanges(){for(;this._ranges.length>0;)this._popRange()}_popRange(){this._ranges.pop()}}rl.prototype.is=function(s){return s==="selection"||s==="model:selection"};function pv(s,e){return e.has(s)?!1:(e.add(s),s.root.document.model.schema.isBlock(s)&&!!s.parent)}function EN(s,e,i){return pv(s,e)&&Ou(s,i)}function Hw(s,e){const a=s.parent.root.document.model.schema,d=s.parent.getAncestors({parentFirst:!0,includeSelf:!0});let h=!1;const f=d.find(b=>h?!1:(h=a.isLimit(b),!h&&pv(b,e)));return d.forEach(b=>e.add(b)),f}function Ou(s,e){const i=PN(s);return i?!e.containsRange(V._createOn(i),!0):!0}function TN(s,e){return s?e.isCollapsed||s.isEmpty?!0:e.start.isTouching(q._createAt(s,s.maxOffset))?!1:Ou(s,e):!1}function SN(s,e){return s?e.isCollapsed||s.isEmpty?!0:e.end.isTouching(q._createAt(s,0))?!1:Ou(s,e):!1}function PN(s){const e=s.root.document.model.schema;let i=s.parent;for(;i;){if(e.isBlock(i))return i;i=i.parent}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class No extends wt(V){constructor(e,i){super(e,i),IN.call(this)}detach(){this.stopListening()}toRange(){return new V(this.start,this.end)}static fromRange(e){return new No(e.start,e.end)}}No.prototype.is=function(s){return s==="liveRange"||s==="model:liveRange"||s=="range"||s==="model:range"};function IN(){this.listenTo(this.root.document.model,"applyOperation",(s,e)=>{const i=e[0];i.isDocumentOperation&&MN.call(this,i)},{priority:"low"})}function MN(s){const e=this.getTransformedByOperation(s),i=V._createFromRanges(e),a=!i.isEqual(this),d=RN(this,s);let h=null;if(a){i.root.rootName=="$graveyard"&&(s.type=="remove"?h=s.sourcePosition:h=s.deletionPosition);const f=this.toRange();this.start=i.start,this.end=i.end,this.fire("change:range",f,{deletionPosition:h})}else d&&this.fire("change:content",this.toRange(),{deletionPosition:h})}function RN(s,e){switch(e.type){case"insert":return s.containsPosition(e.position);case"move":case"remove":case"reinsert":case"merge":return s.containsPosition(e.sourcePosition)||s.start.isEqual(e.sourcePosition)||s.containsPosition(e.targetPosition);case"split":return s.containsPosition(e.splitPosition)||s.containsPosition(e.insertionPosition)}return!1}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const or="selection:";class bv extends wt(Jn){constructor(e){super(),this._selection=new ON(e),this._selection.delegate("change:range").to(this),this._selection.delegate("change:attribute").to(this),this._selection.delegate("change:marker").to(this)}get isCollapsed(){return this._selection.isCollapsed}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get rangeCount(){return this._selection.rangeCount}get hasOwnRange(){return this._selection.hasOwnRange}get isBackward(){return this._selection.isBackward}get isGravityOverridden(){return this._selection.isGravityOverridden}get markers(){return this._selection.markers}get _ranges(){return this._selection._ranges}getRanges(){return this._selection.getRanges()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getSelectedBlocks(){return this._selection.getSelectedBlocks()}getSelectedElement(){return this._selection.getSelectedElement()}containsEntireContent(e){return this._selection.containsEntireContent(e)}destroy(){this._selection.destroy()}getAttributeKeys(){return this._selection.getAttributeKeys()}getAttributes(){return this._selection.getAttributes()}getAttribute(e){return this._selection.getAttribute(e)}hasAttribute(e){return this._selection.hasAttribute(e)}refresh(){this._selection.updateMarkers(),this._selection._updateAttributes(!1)}observeMarkers(e){this._selection.observeMarkers(e)}_setFocus(e,i){this._selection.setFocus(e,i)}_setTo(...e){this._selection.setTo(...e)}_setAttribute(e,i){this._selection.setAttribute(e,i)}_removeAttribute(e){this._selection.removeAttribute(e)}_getStoredAttributes(){return this._selection.getStoredAttributes()}_overrideGravity(){return this._selection.overrideGravity()}_restoreGravity(e){this._selection.restoreGravity(e)}static _getStoreAttributeKey(e){return or+e}static _isStoreAttributeKey(e){return e.startsWith(or)}}bv.prototype.is=function(s){return s==="selection"||s=="model:selection"||s=="documentSelection"||s=="model:documentSelection"};class ON extends rl{constructor(e){super(),this.markers=new pr({idProperty:"name"}),this._attributePriority=new Map,this._selectionRestorePosition=null,this._hasChangedRange=!1,this._overriddenGravityRegister=new Set,this._observedMarkers=new Set,this._model=e.model,this._document=e,this.listenTo(this._model,"applyOperation",(i,a)=>{const d=a[0];!d.isDocumentOperation||d.type=="marker"||d.type=="rename"||d.type=="noop"||(this._ranges.length==0&&this._selectionRestorePosition&&this._fixGraveyardSelection(this._selectionRestorePosition),this._selectionRestorePosition=null,this._hasChangedRange&&(this._hasChangedRange=!1,this.fire("change:range",{directChange:!1})))},{priority:"lowest"}),this.on("change:range",()=>{this._validateSelectionRanges(this.getRanges())}),this.listenTo(this._model.markers,"update",(i,a,d,h)=>{this._updateMarker(a,h)}),this.listenTo(this._document,"change",(i,a)=>{NN(this._model,a)})}get isCollapsed(){return this._ranges.length===0?this._document._getDefaultRange().isCollapsed:super.isCollapsed}get anchor(){return super.anchor||this._document._getDefaultRange().start}get focus(){return super.focus||this._document._getDefaultRange().end}get rangeCount(){return this._ranges.length?this._ranges.length:1}get hasOwnRange(){return this._ranges.length>0}get isGravityOverridden(){return!!this._overriddenGravityRegister.size}destroy(){for(let e=0;e<this._ranges.length;e++)this._ranges[e].detach();this.stopListening()}*getRanges(){this._ranges.length?yield*super.getRanges():yield this._document._getDefaultRange()}getFirstRange(){return super.getFirstRange()||this._document._getDefaultRange()}getLastRange(){return super.getLastRange()||this._document._getDefaultRange()}setTo(...e){super.setTo(...e),this._updateAttributes(!0),this.updateMarkers()}setFocus(e,i){super.setFocus(e,i),this._updateAttributes(!0),this.updateMarkers()}setAttribute(e,i){if(this._setAttribute(e,i)){const a=[e];this.fire("change:attribute",{attributeKeys:a,directChange:!0})}}removeAttribute(e){if(this._removeAttribute(e)){const i=[e];this.fire("change:attribute",{attributeKeys:i,directChange:!0})}}overrideGravity(){const e=Yn();return this._overriddenGravityRegister.add(e),this._overriddenGravityRegister.size===1&&this._updateAttributes(!0),e}restoreGravity(e){if(!this._overriddenGravityRegister.has(e))throw new M("document-selection-gravity-wrong-restore",this,{uid:e});this._overriddenGravityRegister.delete(e),this.isGravityOverridden||this._updateAttributes(!0)}observeMarkers(e){this._observedMarkers.add(e),this.updateMarkers()}_replaceAllRanges(e){this._validateSelectionRanges(e),super._replaceAllRanges(e)}_popRange(){this._ranges.pop().detach()}_pushRange(e){const i=this._prepareRange(e);i&&this._ranges.push(i)}_validateSelectionRanges(e){for(const i of e)if(!this._document._validateSelectionRange(i))throw new M("document-selection-wrong-position",this,{range:i})}_prepareRange(e){if(this._checkRange(e),e.root==this._document.graveyard)return;const i=No.fromRange(e);return i.on("change:range",(a,d,h)=>{if(this._hasChangedRange=!0,i.root==this._document.graveyard){this._selectionRestorePosition=h.deletionPosition;const f=this._ranges.indexOf(i);this._ranges.splice(f,1),i.detach()}}),i}updateMarkers(){if(!this._observedMarkers.size)return;const e=[];let i=!1;for(const d of this._model.markers){const h=d.name.split(":",1)[0];if(!this._observedMarkers.has(h))continue;const f=d.getRange();for(const b of this.getRanges())f.containsRange(b,!b.isCollapsed)&&e.push(d)}const a=Array.from(this.markers);for(const d of e)this.markers.has(d)||(this.markers.add(d),i=!0);for(const d of Array.from(this.markers))e.includes(d)||(this.markers.remove(d),i=!0);i&&this.fire("change:marker",{oldMarkers:a,directChange:!1})}_updateMarker(e,i){const a=e.name.split(":",1)[0];if(!this._observedMarkers.has(a))return;let d=!1;const h=Array.from(this.markers),f=this.markers.has(e);if(!i)f&&(this.markers.remove(e),d=!0);else{let b=!1;for(const k of this.getRanges())if(i.containsRange(k,!k.isCollapsed)){b=!0;break}b&&!f?(this.markers.add(e),d=!0):!b&&f&&(this.markers.remove(e),d=!0)}d&&this.fire("change:marker",{oldMarkers:h,directChange:!1})}_updateAttributes(e){const i=er(this._getSurroundingAttributes()),a=er(this.getAttributes());if(e)this._attributePriority=new Map,this._attrs=new Map;else for(const[h,f]of this._attributePriority)f=="low"&&(this._attrs.delete(h),this._attributePriority.delete(h));this._setAttributesTo(i);const d=[];for(const[h,f]of this.getAttributes())(!a.has(h)||a.get(h)!==f)&&d.push(h);for(const[h]of a)this.hasAttribute(h)||d.push(h);d.length>0&&this.fire("change:attribute",{attributeKeys:d,directChange:!1})}_setAttribute(e,i,a=!0){const d=a?"normal":"low";return d=="low"&&this._attributePriority.get(e)=="normal"||super.getAttribute(e)===i?!1:(this._attrs.set(e,i),this._attributePriority.set(e,d),!0)}_removeAttribute(e,i=!0){const a=i?"normal":"low";return a=="low"&&this._attributePriority.get(e)=="normal"||(this._attributePriority.set(e,a),!super.hasAttribute(e))?!1:(this._attrs.delete(e),!0)}_setAttributesTo(e){const i=new Set;for(const[a,d]of this.getAttributes())e.get(a)!==d&&this._removeAttribute(a,!1);for(const[a,d]of e)this._setAttribute(a,d,!1)&&i.add(a);return i}*getStoredAttributes(){const e=this.getFirstPosition().parent;if(this.isCollapsed&&e.isEmpty)for(const i of e.getAttributeKeys())i.startsWith(or)&&(yield[i.substr(or.length),e.getAttribute(i)])}_getSurroundingAttributes(){const e=this.getFirstPosition(),i=this._model.schema;if(e.root.rootName=="$graveyard")return null;let a=null;if(this.isCollapsed){const d=e.textNode?e.textNode:e.nodeBefore,h=e.textNode?e.textNode:e.nodeAfter;if(this.isGravityOverridden||(a=bs(d,i)),a||(a=bs(h,i)),!this.isGravityOverridden&&!a){let f=d;for(;f&&!a;)f=f.previousSibling,a=bs(f,i)}if(!a){let f=h;for(;f&&!a;)f=f.nextSibling,a=bs(f,i)}a||(a=this.getStoredAttributes())}else{const d=this.getFirstRange();for(const h of d){if(h.item.is("element")&&i.isObject(h.item)){a=bs(h.item,i);break}if(h.type=="text"){a=h.item.getAttributes();break}}}return a}_fixGraveyardSelection(e){const i=this._model.schema.getNearestSelectionRange(e);i&&this._pushRange(i)}}function bs(s,e){if(!s)return null;if(s instanceof Ke||s instanceof zt)return s.getAttributes();if(!e.isInline(s))return null;if(!e.isObject(s))return[];const i=[];for(const[a,d]of s.getAttributes())e.checkAttribute("$text",a)&&e.getAttributeProperties(a).copyFromObject!==!1&&i.push([a,d]);return i}function NN(s,e){const i=s.document.differ;for(const a of i.getChanges()){if(a.type!="insert")continue;const d=a.position.parent;a.length===d.maxOffset&&s.enqueueChange(e,f=>{const b=Array.from(d.getAttributeKeys()).filter(k=>k.startsWith(or));for(const k of b)f.removeAttribute(k,d)})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function DN(){return(s,e,i)=>{if(!i.consumable.consume(e.item,s.name))return;const a=i.writer,d=i.mapper.toViewPosition(e.range.start),h=a.createText(e.item.data);a.insert(d,h)}}function LN(){return(s,e,i)=>{i.convertAttributes(e.item),!e.reconversion&&e.item.is("element")&&!e.item.isEmpty&&i.convertChildren(e.item)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function VN(s){const{schema:e,document:i}=s.model;for(const a of i.getRoots())if(a.isEmpty&&!e.checkChild(a,"$text")&&e.checkChild(a,"paragraph"))return s.insertElement("paragraph",a),!0;return!1}function wv(s,e,i){const a=i.createContext(s);return!(!i.checkChild(a,"paragraph")||!i.checkChild(a.push("paragraph"),e))}function _v(s,e){const i=e.createElement("paragraph");return e.insert(i,s),e.createPositionAt(i,0)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Ww(){return(s,e,i)=>{if(!e.modelRange&&i.consumable.consume(e.viewItem,{name:!0})){const{modelRange:a,modelCursor:d}=i.convertChildren(e.viewItem,e.modelCursor);e.modelRange=a,e.modelCursor=d}}}function BN(){return(s,e,{schema:i,consumable:a,writer:d})=>{let h=e.modelCursor;if(!a.test(e.viewItem))return;if(!i.checkChild(h,"$text")){if(!wv(h,"$text",i)||e.viewItem.data.trim().length==0)return;const b=h.nodeBefore;h=_v(h,d),b&&b.is("element","$marker")&&(d.move(d.createRangeOn(b),h),h=d.createPositionAfter(b))}a.consume(e.viewItem);const f=d.createText(e.viewItem.data);d.insert(f,h),e.modelRange=d.createRange(h,h.getShiftedBy(f.offsetSize)),e.modelCursor=e.modelRange.end}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ys{constructor(){this._consumables=new Map}add(e,i){let a;if(e.is("$text")||e.is("documentFragment")){this._consumables.set(e,!0);return}this._consumables.has(e)?a=this._consumables.get(e):(a=new FN(e),this._consumables.set(e,a)),a.add(i)}test(e,i){const a=this._consumables.get(e);return a===void 0?null:e.is("$text")||e.is("documentFragment")?a:a.test(i)}consume(e,i){return this.test(e,i)?(e.is("$text")||e.is("documentFragment")?this._consumables.set(e,!1):this._consumables.get(e).consume(i),!0):!1}revert(e,i){const a=this._consumables.get(e);a!==void 0&&(e.is("$text")||e.is("documentFragment")?this._consumables.set(e,!0):a.revert(i))}static consumablesFromElement(e){const i={element:e,name:!0,attributes:[],classes:[],styles:[]},a=e.getAttributeKeys();for(const f of a)f=="style"||f=="class"||i.attributes.push(f);const d=e.getClassNames();for(const f of d)i.classes.push(f);const h=e.getStyleNames();for(const f of h)i.styles.push(f);return i}static createFrom(e,i){if(i||(i=new Ys),e.is("$text"))return i.add(e),i;e.is("element")&&i.add(e,Ys.consumablesFromElement(e)),e.is("documentFragment")&&i.add(e);for(const a of e.getChildren())i=Ys.createFrom(a,i);return i}}const ya=["attributes","classes","styles"];class FN{constructor(e){this.element=e,this._canConsumeName=null,this._consumables={attributes:new Map,styles:new Map,classes:new Map}}add(e){e.name&&(this._canConsumeName=!0);for(const i of ya)i in e&&this._add(i,e[i])}test(e){if(e.name&&!this._canConsumeName)return this._canConsumeName;for(const i of ya)if(i in e){const a=this._test(i,e[i]);if(a!==!0)return a}return!0}consume(e){e.name&&(this._canConsumeName=!1);for(const i of ya)i in e&&this._consume(i,e[i])}revert(e){e.name&&(this._canConsumeName=!0);for(const i of ya)i in e&&this._revert(i,e[i])}_add(e,i){const a=_e(i)?i:[i],d=this._consumables[e];for(const h of a){if(e==="attributes"&&(h==="class"||h==="style"))throw new M("viewconsumable-invalid-attribute",this);if(d.set(h,!0),e==="styles")for(const f of this.element.document.stylesProcessor.getRelatedStyles(h))d.set(f,!0)}}_test(e,i){const a=_e(i)?i:[i],d=this._consumables[e];for(const h of a)if(e==="attributes"&&(h==="class"||h==="style")){const f=h=="class"?"classes":"styles",b=this._test(f,[...this._consumables[f].keys()]);if(b!==!0)return b}else{const f=d.get(h);if(f===void 0)return null;if(!f)return!1}return!0}_consume(e,i){const a=_e(i)?i:[i],d=this._consumables[e];for(const h of a)if(e==="attributes"&&(h==="class"||h==="style")){const f=h=="class"?"classes":"styles";this._consume(f,[...this._consumables[f].keys()])}else if(d.set(h,!1),e=="styles")for(const f of this.element.document.stylesProcessor.getRelatedStyles(h))d.set(f,!1)}_revert(e,i){const a=_e(i)?i:[i],d=this._consumables[e];for(const h of a)if(e==="attributes"&&(h==="class"||h==="style")){const f=h=="class"?"classes":"styles";this._revert(f,[...this._consumables[f].keys()])}else d.get(h)===!1&&d.set(h,!0)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ha{constructor(e){if(e instanceof Ha)return e;let i;typeof e=="string"?i=[e]:Array.isArray(e)?i=e:i=e.getAncestors({includeSelf:!0}),this._items=i.map(zN)}get length(){return this._items.length}get last(){return this._items[this._items.length-1]}[Symbol.iterator](){return this._items[Symbol.iterator]()}push(e){const i=new Ha([e]);return i._items=[...this._items,...i._items],i}getItem(e){return this._items[e]}*getNames(){yield*this._items.map(e=>e.name)}endsWith(e){return Array.from(this.getNames()).join(" ").endsWith(e)}startsWith(e){return Array.from(this.getNames()).join(" ").startsWith(e)}}function zN(s){return typeof s=="string"||s.is("documentFragment")?{name:typeof s=="string"?s:"$documentFragment",*getAttributeKeys(){},getAttribute(){}}:{name:s.is("element")?s.name:"$text",*getAttributeKeys(){yield*s.getAttributeKeys()},getAttribute(e){return s.getAttribute(e)}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class jN extends wt(){constructor(e){super(),this._splitParts=new Map,this._cursorParents=new Map,this._modelCursor=null,this._emptyElementsToKeep=new Set,this.conversionApi={...e,consumable:null,writer:null,store:null,convertItem:(i,a)=>this._convertItem(i,a),convertChildren:(i,a)=>this._convertChildren(i,a),safeInsert:(i,a)=>this._safeInsert(i,a),updateConversionResult:(i,a)=>this._updateConversionResult(i,a),splitToAllowedParent:(i,a)=>this._splitToAllowedParent(i,a),getSplitParts:i=>this._getSplitParts(i),keepEmptyElement:i=>this._keepEmptyElement(i)}}convert(e,i,a=["$root"]){this.fire("viewCleanup",e),this._modelCursor=HN(a,i),this.conversionApi.writer=i,this.conversionApi.consumable=Ys.createFrom(e),this.conversionApi.store={};const{modelRange:d}=this._convertItem(e,this._modelCursor),h=i.createDocumentFragment();if(d){this._removeEmptyElements();for(const f of Array.from(this._modelCursor.parent.getChildren()))i.append(f,h);h.markers=$N(h,i)}return this._modelCursor=null,this._splitParts.clear(),this._cursorParents.clear(),this._emptyElementsToKeep.clear(),this.conversionApi.writer=null,this.conversionApi.store=null,h}_convertItem(e,i){const a={viewItem:e,modelCursor:i,modelRange:null};if(e.is("element")?this.fire(`element:${e.name}`,a,this.conversionApi):e.is("$text")?this.fire("text",a,this.conversionApi):this.fire("documentFragment",a,this.conversionApi),a.modelRange&&!(a.modelRange instanceof V))throw new M("view-conversion-dispatcher-incorrect-result",this);return{modelRange:a.modelRange,modelCursor:a.modelCursor}}_convertChildren(e,i){let a=i.is("position")?i:q._createAt(i,0);const d=new V(a);for(const h of Array.from(e.getChildren())){const f=this._convertItem(h,a);f.modelRange instanceof V&&(d.end=f.modelRange.end,a=f.modelCursor)}return{modelRange:d,modelCursor:a}}_safeInsert(e,i){const a=this._splitToAllowedParent(e,i);return a?(this.conversionApi.writer.insert(e,a.position),!0):!1}_updateConversionResult(e,i){const a=this._getSplitParts(e),d=this.conversionApi.writer;i.modelRange||(i.modelRange=d.createRange(d.createPositionBefore(e),d.createPositionAfter(a[a.length-1])));const h=this._cursorParents.get(e);h?i.modelCursor=d.createPositionAt(h,0):i.modelCursor=i.modelRange.end}_splitToAllowedParent(e,i){const{schema:a,writer:d}=this.conversionApi;let h=a.findAllowedParent(i,e);if(h){if(h===i.parent)return{position:i};this._modelCursor.parent.getAncestors().includes(h)&&(h=null)}if(!h)return wv(i,e,a)?{position:_v(i,d)}:null;const f=this.conversionApi.writer.split(i,h),b=[];for(const C of f.range.getWalker())if(C.type=="elementEnd")b.push(C.item);else{const y=b.pop(),P=C.item;this._registerSplitPair(y,P)}const k=f.range.end.parent;return this._cursorParents.set(e,k),{position:f.position,cursorParent:k}}_registerSplitPair(e,i){this._splitParts.has(e)||this._splitParts.set(e,[e]);const a=this._splitParts.get(e);this._splitParts.set(i,a),a.push(i)}_getSplitParts(e){let i;return this._splitParts.has(e)?i=this._splitParts.get(e):i=[e],i}_keepEmptyElement(e){this._emptyElementsToKeep.add(e)}_removeEmptyElements(){let e=!1;for(const i of this._splitParts.keys())i.isEmpty&&!this._emptyElementsToKeep.has(i)&&(this.conversionApi.writer.remove(i),this._splitParts.delete(i),e=!0);e&&this._removeEmptyElements()}}function $N(s,e){const i=new Set,a=new Map,d=V._createIn(s).getItems();for(const h of d)h.is("element","$marker")&&i.add(h);for(const h of i){const f=h.getAttribute("data-name"),b=e.createPositionBefore(h);a.has(f)?a.get(f).end=b.clone():a.set(f,new V(b.clone())),e.remove(h)}return a}function HN(s,e){let i;for(const a of new Ha(s)){const d={};for(const f of a.getAttributeKeys())d[f]=a.getAttribute(f);const h=e.createElement(a.name,d);i&&e.insert(h,i),i=q._createAt(h,0)}return i}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class WN{getHtml(e){const a=ct.document.implementation.createHTMLDocument("").createElement("div");return a.appendChild(e),a.innerHTML}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class qN{constructor(e){this.skipComments=!0,this.domParser=new DOMParser,this.domConverter=new gN(e,{renderingMode:"data"}),this.htmlWriter=new WN}toData(e){const i=this.domConverter.viewToDom(e);return this.htmlWriter.getHtml(i)}toView(e){const i=this._toDom(e);return this.domConverter.domToView(i,{skipComments:this.skipComments})}registerRawContentMatcher(e){this.domConverter.registerRawContentMatcher(e)}useFillerType(e){this.domConverter.blockFillerMode=e=="marked"?"markedNbsp":"nbsp"}_toDom(e){e.match(/<(?:html|body|head|meta)(?:\s[^>]*)?>/i)||(e=`<body>${e}</body>`);const i=this.domParser.parseFromString(e,"text/html"),a=i.createDocumentFragment(),d=i.body.childNodes;for(;d.length>0;)a.appendChild(d[0]);return a}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class XF extends wt(){constructor(e,i){super(),this.model=e,this.mapper=new vN,this.downcastDispatcher=new AN({mapper:this.mapper,schema:e.schema}),this.downcastDispatcher.on("insert:$text",DN(),{priority:"lowest"}),this.downcastDispatcher.on("insert",LN(),{priority:"lowest"}),this.upcastDispatcher=new jN({schema:e.schema}),this.viewDocument=new eN(i),this.stylesProcessor=i,this.htmlProcessor=new qN(this.viewDocument),this.processor=this.htmlProcessor,this._viewWriter=new aN(this.viewDocument),this.upcastDispatcher.on("text",BN(),{priority:"lowest"}),this.upcastDispatcher.on("element",Ww(),{priority:"lowest"}),this.upcastDispatcher.on("documentFragment",Ww(),{priority:"lowest"}),Ae().prototype.decorate.call(this,"init"),Ae().prototype.decorate.call(this,"set"),Ae().prototype.decorate.call(this,"get"),Ae().prototype.decorate.call(this,"toView"),Ae().prototype.decorate.call(this,"toModel"),this.on("init",()=>{this.fire("ready")},{priority:"lowest"}),this.on("ready",()=>{this.model.enqueueChange({isUndoable:!1},VN)},{priority:"lowest"})}get(e={}){const{rootName:i="main",trim:a="empty"}=e;if(!this._checkIfRootsExists([i]))throw new M("datacontroller-get-non-existent-root",this);const d=this.model.document.getRoot(i);return d.isAttached()||In("datacontroller-get-detached-root",this),a==="empty"&&!this.model.hasContent(d,{ignoreWhitespaces:!0})?"":this.stringify(d,e)}stringify(e,i={}){const a=this.toView(e,i);return this.processor.toData(a)}toView(e,i={}){const a=this.viewDocument,d=this._viewWriter;this.mapper.clearBindings();const h=V._createIn(e),f=new Ei(a);this.mapper.bindElements(e,f);const b=e.is("documentFragment")?e.markers:UN(e);return this.downcastDispatcher.convert(h,b,d,i),f}init(e){if(this.model.document.version)throw new M("datacontroller-init-document-not-empty",this);let i={};if(typeof e=="string"?i.main=e:i=e,!this._checkIfRootsExists(Object.keys(i)))throw new M("datacontroller-init-non-existent-root",this);return this.model.enqueueChange({isUndoable:!1},a=>{for(const d of Object.keys(i)){const h=this.model.document.getRoot(d);a.insert(this.parse(i[d],h),h,0)}}),Promise.resolve()}set(e,i={}){let a={};if(typeof e=="string"?a.main=e:a=e,!this._checkIfRootsExists(Object.keys(a)))throw new M("datacontroller-set-non-existent-root",this);this.model.enqueueChange(i.batchType||{},d=>{d.setSelection(null),d.removeSelectionAttribute(this.model.document.selection.getAttributeKeys());for(const h of Object.keys(a)){const f=this.model.document.getRoot(h);d.remove(d.createRangeIn(f)),d.insert(this.parse(a[h],f),f,0)}})}parse(e,i="$root"){const a=this.processor.toView(e);return this.toModel(a,i)}toModel(e,i="$root"){return this.model.change(a=>this.upcastDispatcher.convert(e,a,i))}addStyleProcessorRules(e){e(this.stylesProcessor)}registerRawContentMatcher(e){this.processor&&this.processor!==this.htmlProcessor&&this.processor.registerRawContentMatcher(e),this.htmlProcessor.registerRawContentMatcher(e)}destroy(){this.stopListening()}_checkIfRootsExists(e){for(const i of e)if(!this.model.document.getRoot(i))return!1;return!0}}function UN(s){const e=[],i=s.root.document;if(!i)return new Map;const a=V._createIn(s);for(const d of i.model.markers){const h=d.getRange(),f=h.isCollapsed,b=h.start.isEqual(a.start)||h.end.isEqual(a.end);if(f&&b)e.push([d.name,h]);else{const k=a.getIntersection(h);k&&e.push([d.name,k])}}return e.sort(([d,h],[f,b])=>{if(h.end.compareWith(b.start)!=="after")return 1;if(h.start.compareWith(b.end)!=="before")return-1;switch(h.start.compareWith(b.start)){case"before":return 1;case"after":return-1;default:switch(h.end.compareWith(b.end)){case"before":return 1;case"after":return-1;default:return f.localeCompare(d)}}}),new Map(e)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class He{constructor(e){this.baseVersion=e,this.isDocumentOperation=this.baseVersion!==null,this.batch=null}_validate(){}toJSON(){const e=Object.assign({},this);return e.__className=this.constructor.className,delete e.batch,delete e.isDocumentOperation,e}static get className(){return"Operation"}static fromJSON(e,i){return new this(e.baseVersion)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Nu(s,e){const i=kv(e),a=i.reduce((f,b)=>f+b.offsetSize,0),d=s.parent;ar(s);const h=s.index;return d._insertChild(h,i),rr(d,h+i.length),rr(d,h),new V(s,s.getShiftedBy(a))}function GN(s){if(!s.isFlat)throw new M("operation-utils-remove-range-not-flat",this);const e=s.start.parent;ar(s.start),ar(s.end);const i=e._removeChildren(s.start.index,s.end.index-s.start.index);return rr(e,s.start.index),i}function sr(s,e){if(!s.isFlat)throw new M("operation-utils-move-range-not-flat",this);const i=GN(s);return e=e._getTransformedByDeletion(s.start,s.end.offset-s.start.offset),Nu(e,i)}function KN(s,e,i){ar(s.start),ar(s.end);for(const a of s.getItems({shallow:!0})){const d=a.is("$textProxy")?a.textNode:a;i!==null?d._setAttribute(e,i):d._removeAttribute(e),rr(d.parent,d.index)}rr(s.end.parent,s.end.index)}function kv(s){const e=[];function i(a){if(typeof a=="string")e.push(new zt(a));else if(a instanceof Ke)e.push(new zt(a.data,a.getAttributes()));else if(a instanceof $o)e.push(a);else if($e(a))for(const d of a)i(d)}i(s);for(let a=1;a<e.length;a++){const d=e[a],h=e[a-1];d instanceof zt&&h instanceof zt&&vv(d,h)&&(e.splice(a-1,2,new zt(h.data+d.data,h.getAttributes())),a--)}return e}function rr(s,e){const i=s.getChild(e-1),a=s.getChild(e);if(i&&a&&i.is("$text")&&a.is("$text")&&vv(i,a)){const d=new zt(i.data+a.data,i.getAttributes());s._removeChildren(e-1,2),s._insertChild(e-1,d)}}function ar(s){const e=s.textNode,i=s.parent;if(e){const a=s.offset-e.startOffset,d=e.index;i._removeChildren(d,1);const h=new zt(e.data.substr(0,a),e.getAttributes()),f=new zt(e.data.substr(a),e.getAttributes());i._insertChild(d,[h,f])}}function vv(s,e){const i=s.getAttributes(),a=e.getAttributes();for(const d of i){if(d[1]!==e.getAttribute(d[0]))return!1;a.next()}return a.next().done}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Et extends He{constructor(e,i,a,d){super(d),this.sourcePosition=e.clone(),this.sourcePosition.stickiness="toNext",this.howMany=i,this.targetPosition=a.clone(),this.targetPosition.stickiness="toNone"}get type(){return this.targetPosition.root.rootName=="$graveyard"?"remove":this.sourcePosition.root.rootName=="$graveyard"?"reinsert":"move"}get affectedSelectable(){return[V._createFromPositionAndShift(this.sourcePosition,this.howMany),V._createFromPositionAndShift(this.targetPosition,0)]}clone(){return new Et(this.sourcePosition,this.howMany,this.targetPosition,this.baseVersion)}getMovedRangeStart(){return this.targetPosition._getTransformedByDeletion(this.sourcePosition,this.howMany)}getReversed(){const e=this.sourcePosition._getTransformedByInsertion(this.targetPosition,this.howMany);return new Et(this.getMovedRangeStart(),this.howMany,e,this.baseVersion+1)}_validate(){const e=this.sourcePosition.parent,i=this.targetPosition.parent,a=this.sourcePosition.offset,d=this.targetPosition.offset;if(a+this.howMany>e.maxOffset)throw new M("move-operation-nodes-do-not-exist",this);if(e===i&&a<d&&d<a+this.howMany)throw new M("move-operation-range-into-itself",this);if(this.sourcePosition.root==this.targetPosition.root&&fe(this.sourcePosition.getParentPath(),this.targetPosition.getParentPath())=="prefix"){const h=this.sourcePosition.path.length-1;if(this.targetPosition.path[h]>=a&&this.targetPosition.path[h]<a+this.howMany)throw new M("move-operation-node-into-itself",this)}}_execute(){sr(V._createFromPositionAndShift(this.sourcePosition,this.howMany),this.targetPosition)}toJSON(){const e=super.toJSON();return e.sourcePosition=this.sourcePosition.toJSON(),e.targetPosition=this.targetPosition.toJSON(),e}static get className(){return"MoveOperation"}static fromJSON(e,i){const a=q.fromJSON(e.sourcePosition,i),d=q.fromJSON(e.targetPosition,i);return new this(a,e.howMany,d,e.baseVersion)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ie extends He{constructor(e,i,a){super(a),this.position=e.clone(),this.position.stickiness="toNone",this.nodes=new Gs(kv(i)),this.shouldReceiveAttributes=!1}get type(){return"insert"}get howMany(){return this.nodes.maxOffset}get affectedSelectable(){return this.position.clone()}clone(){const e=new Gs([...this.nodes].map(a=>a._clone(!0))),i=new ie(this.position,e,this.baseVersion);return i.shouldReceiveAttributes=this.shouldReceiveAttributes,i}getReversed(){const e=this.position.root.document.graveyard,i=new q(e,[0]);return new Et(this.position,this.nodes.maxOffset,i,this.baseVersion+1)}_validate(){const e=this.position.parent;if(!e||e.maxOffset<this.position.offset)throw new M("insert-operation-position-invalid",this)}_execute(){const e=this.nodes;this.nodes=new Gs([...e].map(i=>i._clone(!0))),Nu(this.position,e)}toJSON(){const e=super.toJSON();return e.position=this.position.toJSON(),e.nodes=this.nodes.toJSON(),e}static get className(){return"InsertOperation"}static fromJSON(e,i){const a=[];for(const h of e.nodes)h.name?a.push(Pi.fromJSON(h)):a.push(zt.fromJSON(h));const d=new ie(q.fromJSON(e.position,i),a,e.baseVersion);return d.shouldReceiveAttributes=e.shouldReceiveAttributes,d}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ot extends He{constructor(e,i,a,d,h){super(h),this.splitPosition=e.clone(),this.splitPosition.stickiness="toNext",this.howMany=i,this.insertionPosition=a,this.graveyardPosition=d?d.clone():null,this.graveyardPosition&&(this.graveyardPosition.stickiness="toNext")}get type(){return"split"}get moveTargetPosition(){const e=this.insertionPosition.path.slice();return e.push(0),new q(this.insertionPosition.root,e)}get movedRange(){const e=this.splitPosition.getShiftedBy(Number.POSITIVE_INFINITY);return new V(this.splitPosition,e)}get affectedSelectable(){const e=[V._createFromPositionAndShift(this.splitPosition,0),V._createFromPositionAndShift(this.insertionPosition,0)];return this.graveyardPosition&&e.push(V._createFromPositionAndShift(this.graveyardPosition,0)),e}clone(){return new Ot(this.splitPosition,this.howMany,this.insertionPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const e=this.splitPosition.root.document.graveyard,i=new q(e,[0]);return new le(this.moveTargetPosition,this.howMany,this.splitPosition,i,this.baseVersion+1)}_validate(){const e=this.splitPosition.parent,i=this.splitPosition.offset;if(!e||e.maxOffset<i)throw new M("split-operation-position-invalid",this);if(e.parent){if(this.howMany!=e.maxOffset-this.splitPosition.offset)throw new M("split-operation-how-many-invalid",this);if(this.graveyardPosition&&!this.graveyardPosition.nodeAfter)throw new M("split-operation-graveyard-position-invalid",this)}else throw new M("split-operation-split-in-root",this)}_execute(){const e=this.splitPosition.parent;if(this.graveyardPosition)sr(V._createFromPositionAndShift(this.graveyardPosition,1),this.insertionPosition);else{const a=e._clone();Nu(this.insertionPosition,a)}const i=new V(q._createAt(e,this.splitPosition.offset),q._createAt(e,e.maxOffset));sr(i,this.moveTargetPosition)}toJSON(){const e=super.toJSON();return e.splitPosition=this.splitPosition.toJSON(),e.insertionPosition=this.insertionPosition.toJSON(),this.graveyardPosition&&(e.graveyardPosition=this.graveyardPosition.toJSON()),e}static get className(){return"SplitOperation"}static getInsertionPosition(e){const i=e.path.slice(0,-1);return i[i.length-1]++,new q(e.root,i,"toPrevious")}static fromJSON(e,i){const a=q.fromJSON(e.splitPosition,i),d=q.fromJSON(e.insertionPosition,i),h=e.graveyardPosition?q.fromJSON(e.graveyardPosition,i):null;return new this(a,e.howMany,d,h,e.baseVersion)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class le extends He{constructor(e,i,a,d,h){super(h),this.sourcePosition=e.clone(),this.sourcePosition.stickiness="toPrevious",this.howMany=i,this.targetPosition=a.clone(),this.targetPosition.stickiness="toNext",this.graveyardPosition=d.clone()}get type(){return"merge"}get deletionPosition(){return new q(this.sourcePosition.root,this.sourcePosition.path.slice(0,-1))}get movedRange(){const e=this.sourcePosition.getShiftedBy(Number.POSITIVE_INFINITY);return new V(this.sourcePosition,e)}get affectedSelectable(){const e=this.sourcePosition.parent;return[V._createOn(e),V._createFromPositionAndShift(this.targetPosition,0),V._createFromPositionAndShift(this.graveyardPosition,0)]}clone(){return new le(this.sourcePosition,this.howMany,this.targetPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const e=this.targetPosition._getTransformedByMergeOperation(this),i=this.sourcePosition.path.slice(0,-1),a=new q(this.sourcePosition.root,i)._getTransformedByMergeOperation(this);return new Ot(e,this.howMany,a,this.graveyardPosition,this.baseVersion+1)}_validate(){const e=this.sourcePosition.parent,i=this.targetPosition.parent;if(e.parent)if(i.parent){if(this.howMany!=e.maxOffset)throw new M("merge-operation-how-many-invalid",this)}else throw new M("merge-operation-target-position-invalid",this);else throw new M("merge-operation-source-position-invalid",this)}_execute(){const e=this.sourcePosition.parent,i=V._createIn(e);sr(i,this.targetPosition),sr(V._createOn(e),this.graveyardPosition)}toJSON(){const e=super.toJSON();return e.sourcePosition=e.sourcePosition.toJSON(),e.targetPosition=e.targetPosition.toJSON(),e.graveyardPosition=e.graveyardPosition.toJSON(),e}static get className(){return"MergeOperation"}static fromJSON(e,i){const a=q.fromJSON(e.sourcePosition,i),d=q.fromJSON(e.targetPosition,i),h=q.fromJSON(e.graveyardPosition,i);return new this(a,e.howMany,d,h,e.baseVersion)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Fe extends He{constructor(e,i,a,d,h,f){super(f),this.name=e,this.oldRange=i?i.clone():null,this.newRange=a?a.clone():null,this.affectsData=h,this._markers=d}get type(){return"marker"}get affectedSelectable(){const e=[];return this.oldRange&&e.push(this.oldRange.clone()),this.newRange&&(this.oldRange?e.push(...this.newRange.getDifference(this.oldRange)):e.push(this.newRange.clone())),e}clone(){return new Fe(this.name,this.oldRange,this.newRange,this._markers,this.affectsData,this.baseVersion)}getReversed(){return new Fe(this.name,this.newRange,this.oldRange,this._markers,this.affectsData,this.baseVersion+1)}_execute(){this.newRange?this._markers._set(this.name,this.newRange,!0,this.affectsData):this._markers._remove(this.name)}toJSON(){const e=super.toJSON();return this.oldRange&&(e.oldRange=this.oldRange.toJSON()),this.newRange&&(e.newRange=this.newRange.toJSON()),delete e._markers,e}static get className(){return"MarkerOperation"}static fromJSON(e,i){return new Fe(e.name,e.oldRange?V.fromJSON(e.oldRange,i):null,e.newRange?V.fromJSON(e.newRange,i):null,i.model.markers,e.affectsData,e.baseVersion)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Gt extends He{constructor(e,i,a,d,h){super(h),this.range=e.clone(),this.key=i,this.oldValue=a===void 0?null:a,this.newValue=d===void 0?null:d}get type(){return this.oldValue===null?"addAttribute":this.newValue===null?"removeAttribute":"changeAttribute"}get affectedSelectable(){return this.range.clone()}clone(){return new Gt(this.range,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new Gt(this.range,this.key,this.newValue,this.oldValue,this.baseVersion+1)}toJSON(){const e=super.toJSON();return e.range=this.range.toJSON(),e}_validate(){if(!this.range.isFlat)throw new M("attribute-operation-range-not-flat",this);for(const e of this.range.getItems({shallow:!0})){if(this.oldValue!==null&&!Va(e.getAttribute(this.key),this.oldValue))throw new M("attribute-operation-wrong-old-value",this,{item:e,key:this.key,value:this.oldValue});if(this.oldValue===null&&this.newValue!==null&&e.hasAttribute(this.key))throw new M("attribute-operation-attribute-exists",this,{node:e,key:this.key})}}_execute(){Va(this.oldValue,this.newValue)||KN(this.range,this.key,this.newValue)}static get className(){return"AttributeOperation"}static fromJSON(e,i){return new Gt(V.fromJSON(e.range,i),e.key,e.oldValue,e.newValue,e.baseVersion)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Xt extends He{get type(){return"noop"}get affectedSelectable(){return null}clone(){return new Xt(this.baseVersion)}getReversed(){return new Xt(this.baseVersion+1)}_execute(){}static get className(){return"NoOperation"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ee extends He{constructor(e,i,a,d){super(d),this.position=e,this.position.stickiness="toNext",this.oldName=i,this.newName=a}get type(){return"rename"}get affectedSelectable(){return this.position.nodeAfter}clone(){return new Ee(this.position.clone(),this.oldName,this.newName,this.baseVersion)}getReversed(){return new Ee(this.position.clone(),this.newName,this.oldName,this.baseVersion+1)}_validate(){const e=this.position.nodeAfter;if(e instanceof Pi){if(e.name!==this.oldName)throw new M("rename-operation-wrong-name",this)}else throw new M("rename-operation-wrong-position",this)}_execute(){const e=this.position.nodeAfter;e.name=this.newName}toJSON(){const e=super.toJSON();return e.position=this.position.toJSON(),e}static get className(){return"RenameOperation"}static fromJSON(e,i){return new Ee(q.fromJSON(e.position,i),e.oldName,e.newName,e.baseVersion)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Gn extends He{constructor(e,i,a,d,h){super(h),this.root=e,this.key=i,this.oldValue=a===void 0?null:a,this.newValue=d===void 0?null:d}get type(){return this.oldValue===null?"addRootAttribute":this.newValue===null?"removeRootAttribute":"changeRootAttribute"}get affectedSelectable(){return this.root}clone(){return new Gn(this.root,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new Gn(this.root,this.key,this.newValue,this.oldValue,this.baseVersion+1)}_validate(){if(this.root!=this.root.root||this.root.is("documentFragment"))throw new M("rootattribute-operation-not-a-root",this,{root:this.root,key:this.key});if(this.oldValue!==null&&this.root.getAttribute(this.key)!==this.oldValue)throw new M("rootattribute-operation-wrong-old-value",this,{root:this.root,key:this.key});if(this.oldValue===null&&this.newValue!==null&&this.root.hasAttribute(this.key))throw new M("rootattribute-operation-attribute-exists",this,{root:this.root,key:this.key})}_execute(){this.newValue!==null?this.root._setAttribute(this.key,this.newValue):this.root._removeAttribute(this.key)}toJSON(){const e=super.toJSON();return e.root=this.root.toJSON(),e}static get className(){return"RootAttributeOperation"}static fromJSON(e,i){if(!i.getRoot(e.root))throw new M("rootattribute-operation-fromjson-no-root",this,{rootName:e.root});return new Gn(i.getRoot(e.root),e.key,e.oldValue,e.newValue,e.baseVersion)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Kn extends He{constructor(e,i,a,d,h){if(super(h),this.rootName=e,this.elementName=i,this.isAdd=a,this._document=d,!this._document.getRoot(this.rootName)){const f=this._document.createRoot(this.elementName,this.rootName);f._isAttached=!1}}get type(){return this.isAdd?"addRoot":"detachRoot"}get affectedSelectable(){return this._document.getRoot(this.rootName)}clone(){return new Kn(this.rootName,this.elementName,this.isAdd,this._document,this.baseVersion)}getReversed(){return new Kn(this.rootName,this.elementName,!this.isAdd,this._document,this.baseVersion+1)}_execute(){this._document.getRoot(this.rootName)._isAttached=this.isAdd}toJSON(){const e=super.toJSON();return delete e._document,e}static get className(){return"RootOperation"}static fromJSON(e,i){return new Kn(e.rootName,e.elementName,e.isAdd,i,e.baseVersion)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Ze={};Ze[Gt.className]=Gt;Ze[ie.className]=ie;Ze[Fe.className]=Fe;Ze[Et.className]=Et;Ze[Xt.className]=Xt;Ze[He.className]=He;Ze[Ee.className]=Ee;Ze[Gn.className]=Gn;Ze[Kn.className]=Kn;Ze[Ot.className]=Ot;Ze[le.className]=le;/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const qw=new Map;function ut(s,e,i){let a=qw.get(s);a||(a=new Map,qw.set(s,a)),a.set(e,i)}ut(Gt,Gt,(s,e,i)=>{if(s.key===e.key&&s.range.start.hasSameParentAs(e.range.start)){const a=s.range.getDifference(e.range).map(h=>new Gt(h,s.key,s.oldValue,s.newValue,0)),d=s.range.getIntersection(e.range);return d&&i.aIsStrong&&a.push(new Gt(d,e.key,e.newValue,s.newValue,0)),a.length==0?[new Xt(0)]:a}else return[s]});ut(Gt,ie,(s,e)=>{if(s.range.start.hasSameParentAs(e.position)&&s.range.containsPosition(e.position)){const a=s.range._getTransformedByInsertion(e.position,e.howMany,!e.shouldReceiveAttributes).map(d=>new Gt(d,s.key,s.oldValue,s.newValue,s.baseVersion));if(e.shouldReceiveAttributes){const d=yv(e,s.key,s.oldValue);d&&a.unshift(d)}return a}return s.range=s.range._getTransformedByInsertion(e.position,e.howMany,!1)[0],[s]});function yv(s,e,i){const d=s.nodes.getNode(0).getAttribute(e);if(d==i)return null;const h=new V(s.position,s.position.getShiftedBy(s.howMany));return new Gt(h,e,d,i,0)}ut(Gt,le,(s,e)=>{const i=[];s.range.start.hasSameParentAs(e.deletionPosition)&&(s.range.containsPosition(e.deletionPosition)||s.range.start.isEqual(e.deletionPosition))&&i.push(V._createFromPositionAndShift(e.graveyardPosition,1));const a=s.range._getTransformedByMergeOperation(e);return a.isCollapsed||i.push(a),i.map(d=>new Gt(d,s.key,s.oldValue,s.newValue,s.baseVersion))});ut(Gt,Et,(s,e)=>YN(s.range,e).map(a=>new Gt(a,s.key,s.oldValue,s.newValue,s.baseVersion)));function YN(s,e){const i=V._createFromPositionAndShift(e.sourcePosition,e.howMany);let a=null,d=[];i.containsRange(s,!0)?a=s:s.start.hasSameParentAs(i.start)?(d=s.getDifference(i),a=s.getIntersection(i)):d=[s];const h=[];for(let f of d){f=f._getTransformedByDeletion(e.sourcePosition,e.howMany);const b=e.getMovedRangeStart(),k=f.start.hasSameParentAs(b),C=f._getTransformedByInsertion(b,e.howMany,k);h.push(...C)}return a&&h.push(a._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany,!1)[0]),h}ut(Gt,Ot,(s,e)=>{if(s.range.end.isEqual(e.insertionPosition))return e.graveyardPosition||s.range.end.offset++,[s];if(s.range.start.hasSameParentAs(e.splitPosition)&&s.range.containsPosition(e.splitPosition)){const i=s.clone();return i.range=new V(e.moveTargetPosition.clone(),s.range.end._getCombined(e.splitPosition,e.moveTargetPosition)),s.range.end=e.splitPosition.clone(),s.range.end.stickiness="toPrevious",[s,i]}return s.range=s.range._getTransformedBySplitOperation(e),[s]});ut(ie,Gt,(s,e)=>{const i=[s];if(s.shouldReceiveAttributes&&s.position.hasSameParentAs(e.range.start)&&e.range.containsPosition(s.position)){const a=yv(s,e.key,e.newValue);a&&i.push(a)}return i});ut(ie,ie,(s,e,i)=>s.position.isEqual(e.position)&&i.aIsStrong?[s]:(s.position=s.position._getTransformedByInsertOperation(e),[s]));ut(ie,Et,(s,e)=>(s.position=s.position._getTransformedByMoveOperation(e),[s]));ut(ie,Ot,(s,e)=>(s.position=s.position._getTransformedBySplitOperation(e),[s]));ut(ie,le,(s,e)=>(s.position=s.position._getTransformedByMergeOperation(e),[s]));ut(Fe,ie,(s,e)=>(s.oldRange&&(s.oldRange=s.oldRange._getTransformedByInsertOperation(e)[0]),s.newRange&&(s.newRange=s.newRange._getTransformedByInsertOperation(e)[0]),[s]));ut(Fe,Fe,(s,e,i)=>{if(s.name==e.name)if(i.aIsStrong)s.oldRange=e.newRange?e.newRange.clone():null;else return[new Xt(0)];return[s]});ut(Fe,le,(s,e)=>(s.oldRange&&(s.oldRange=s.oldRange._getTransformedByMergeOperation(e)),s.newRange&&(s.newRange=s.newRange._getTransformedByMergeOperation(e)),[s]));ut(Fe,Et,(s,e,i)=>{if(s.oldRange&&(s.oldRange=V._createFromRanges(s.oldRange._getTransformedByMoveOperation(e))),s.newRange){if(i.abRelation){const a=V._createFromRanges(s.newRange._getTransformedByMoveOperation(e));if(i.abRelation.side=="left"&&e.targetPosition.isEqual(s.newRange.start))return s.newRange.end=a.end,s.newRange.start.path=i.abRelation.path,[s];if(i.abRelation.side=="right"&&e.targetPosition.isEqual(s.newRange.end))return s.newRange.start=a.start,s.newRange.end.path=i.abRelation.path,[s]}s.newRange=V._createFromRanges(s.newRange._getTransformedByMoveOperation(e))}return[s]});ut(Fe,Ot,(s,e,i)=>{if(s.oldRange&&(s.oldRange=s.oldRange._getTransformedBySplitOperation(e)),s.newRange){if(i.abRelation){const a=s.newRange._getTransformedBySplitOperation(e);return s.newRange.start.isEqual(e.splitPosition)&&i.abRelation.wasStartBeforeMergedElement?s.newRange.start=q._createAt(e.insertionPosition):s.newRange.start.isEqual(e.splitPosition)&&!i.abRelation.wasInLeftElement&&(s.newRange.start=q._createAt(e.moveTargetPosition)),s.newRange.end.isEqual(e.splitPosition)&&i.abRelation.wasInRightElement?s.newRange.end=q._createAt(e.moveTargetPosition):s.newRange.end.isEqual(e.splitPosition)&&i.abRelation.wasEndBeforeMergedElement?s.newRange.end=q._createAt(e.insertionPosition):s.newRange.end=a.end,[s]}s.newRange=s.newRange._getTransformedBySplitOperation(e)}return[s]});ut(le,ie,(s,e)=>(s.sourcePosition.hasSameParentAs(e.position)&&(s.howMany+=e.howMany),s.sourcePosition=s.sourcePosition._getTransformedByInsertOperation(e),s.targetPosition=s.targetPosition._getTransformedByInsertOperation(e),[s]));ut(le,le,(s,e,i)=>{if(s.sourcePosition.isEqual(e.sourcePosition)&&s.targetPosition.isEqual(e.targetPosition))if(i.bWasUndone){const a=e.graveyardPosition.path.slice();return a.push(0),s.sourcePosition=new q(e.graveyardPosition.root,a),s.howMany=0,[s]}else return[new Xt(0)];if(s.sourcePosition.isEqual(e.sourcePosition)&&!s.targetPosition.isEqual(e.targetPosition)&&!i.bWasUndone&&i.abRelation!="splitAtSource"){const a=s.targetPosition.root.rootName=="$graveyard",d=e.targetPosition.root.rootName=="$graveyard";if(d&&!a||!(a&&!d)&&i.aIsStrong){const k=e.targetPosition._getTransformedByMergeOperation(e),C=s.targetPosition._getTransformedByMergeOperation(e);return[new Et(k,s.howMany,C,0)]}else return[new Xt(0)]}return s.sourcePosition.hasSameParentAs(e.targetPosition)&&(s.howMany+=e.howMany),s.sourcePosition=s.sourcePosition._getTransformedByMergeOperation(e),s.targetPosition=s.targetPosition._getTransformedByMergeOperation(e),(!s.graveyardPosition.isEqual(e.graveyardPosition)||!i.aIsStrong)&&(s.graveyardPosition=s.graveyardPosition._getTransformedByMergeOperation(e)),[s]});ut(le,Et,(s,e,i)=>{const a=V._createFromPositionAndShift(e.sourcePosition,e.howMany);return e.type=="remove"&&!i.bWasUndone&&!i.forceWeakRemove&&s.deletionPosition.hasSameParentAs(e.sourcePosition)&&a.containsPosition(s.sourcePosition)?[new Xt(0)]:(s.sourcePosition.hasSameParentAs(e.targetPosition)&&(s.howMany+=e.howMany),s.sourcePosition.hasSameParentAs(e.sourcePosition)&&(s.howMany-=e.howMany),s.sourcePosition=s.sourcePosition._getTransformedByMoveOperation(e),s.targetPosition=s.targetPosition._getTransformedByMoveOperation(e),s.graveyardPosition.isEqual(e.targetPosition)||(s.graveyardPosition=s.graveyardPosition._getTransformedByMoveOperation(e)),[s])});ut(le,Ot,(s,e,i)=>{if(e.graveyardPosition&&(s.graveyardPosition=s.graveyardPosition._getTransformedByDeletion(e.graveyardPosition,1),s.deletionPosition.isEqual(e.graveyardPosition)&&(s.howMany=e.howMany)),s.targetPosition.isEqual(e.splitPosition)){const a=e.howMany!=0,d=e.graveyardPosition&&s.deletionPosition.isEqual(e.graveyardPosition);if(a||d||i.abRelation=="mergeTargetNotMoved")return s.sourcePosition=s.sourcePosition._getTransformedBySplitOperation(e),[s]}if(s.sourcePosition.isEqual(e.splitPosition)){if(i.abRelation=="mergeSourceNotMoved")return s.howMany=0,s.targetPosition=s.targetPosition._getTransformedBySplitOperation(e),[s];if(i.abRelation=="mergeSameElement"||s.sourcePosition.offset>0)return s.sourcePosition=e.moveTargetPosition.clone(),s.targetPosition=s.targetPosition._getTransformedBySplitOperation(e),[s]}return s.sourcePosition.hasSameParentAs(e.splitPosition)&&(s.howMany=e.splitPosition.offset),s.sourcePosition=s.sourcePosition._getTransformedBySplitOperation(e),s.targetPosition=s.targetPosition._getTransformedBySplitOperation(e),[s]});ut(Et,ie,(s,e)=>{const a=V._createFromPositionAndShift(s.sourcePosition,s.howMany)._getTransformedByInsertOperation(e,!1)[0];return s.sourcePosition=a.start,s.howMany=a.end.offset-a.start.offset,s.targetPosition.isEqual(e.position)||(s.targetPosition=s.targetPosition._getTransformedByInsertOperation(e)),[s]});ut(Et,Et,(s,e,i)=>{const a=V._createFromPositionAndShift(s.sourcePosition,s.howMany),d=V._createFromPositionAndShift(e.sourcePosition,e.howMany);let h=i.aIsStrong,f=!i.aIsStrong;i.abRelation=="insertBefore"||i.baRelation=="insertAfter"?f=!0:(i.abRelation=="insertAfter"||i.baRelation=="insertBefore")&&(f=!1);let b;if(s.targetPosition.isEqual(e.targetPosition)&&f?b=s.targetPosition._getTransformedByDeletion(e.sourcePosition,e.howMany):b=s.targetPosition._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),Uw(s,e)&&Uw(e,s))return[e.getReversed()];if(a.containsPosition(e.targetPosition)&&a.containsRange(d,!0))return a.start=a.start._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),a.end=a.end._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),So([a],b);if(d.containsPosition(s.targetPosition)&&d.containsRange(a,!0))return a.start=a.start._getCombined(e.sourcePosition,e.getMovedRangeStart()),a.end=a.end._getCombined(e.sourcePosition,e.getMovedRangeStart()),So([a],b);const y=fe(s.sourcePosition.getParentPath(),e.sourcePosition.getParentPath());if(y=="prefix"||y=="extension")return a.start=a.start._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),a.end=a.end._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),So([a],b);s.type=="remove"&&e.type!="remove"&&!i.aWasUndone&&!i.forceWeakRemove?h=!0:s.type!="remove"&&e.type=="remove"&&!i.bWasUndone&&!i.forceWeakRemove&&(h=!1);const P=[],R=a.getDifference(d);for(const $ of R){$.start=$.start._getTransformedByDeletion(e.sourcePosition,e.howMany),$.end=$.end._getTransformedByDeletion(e.sourcePosition,e.howMany);const Z=fe($.start.getParentPath(),e.getMovedRangeStart().getParentPath())=="same",nt=$._getTransformedByInsertion(e.getMovedRangeStart(),e.howMany,Z);P.push(...nt)}const D=a.getIntersection(d);return D!==null&&h&&(D.start=D.start._getCombined(e.sourcePosition,e.getMovedRangeStart()),D.end=D.end._getCombined(e.sourcePosition,e.getMovedRangeStart()),P.length===0?P.push(D):P.length==1?d.start.isBefore(a.start)||d.start.isEqual(a.start)?P.unshift(D):P.push(D):P.splice(1,0,D)),P.length===0?[new Xt(s.baseVersion)]:So(P,b)});ut(Et,Ot,(s,e,i)=>{let a=s.targetPosition.clone();(!s.targetPosition.isEqual(e.insertionPosition)||!e.graveyardPosition||i.abRelation=="moveTargetAfter")&&(a=s.targetPosition._getTransformedBySplitOperation(e));const d=V._createFromPositionAndShift(s.sourcePosition,s.howMany);if(d.end.isEqual(e.insertionPosition))return e.graveyardPosition||s.howMany++,s.targetPosition=a,[s];if(d.start.hasSameParentAs(e.splitPosition)&&d.containsPosition(e.splitPosition)){let b=new V(e.splitPosition,d.end);b=b._getTransformedBySplitOperation(e);const k=[new V(d.start,e.splitPosition),b];return So(k,a)}s.targetPosition.isEqual(e.splitPosition)&&i.abRelation=="insertAtSource"&&(a=e.moveTargetPosition),s.targetPosition.isEqual(e.insertionPosition)&&i.abRelation=="insertBetween"&&(a=s.targetPosition);const f=[d._getTransformedBySplitOperation(e)];if(e.graveyardPosition){const b=d.start.isEqual(e.graveyardPosition)||d.containsPosition(e.graveyardPosition);s.howMany>1&&b&&!i.aWasUndone&&f.push(V._createFromPositionAndShift(e.insertionPosition,1))}return So(f,a)});ut(Et,le,(s,e,i)=>{const a=V._createFromPositionAndShift(s.sourcePosition,s.howMany);if(e.deletionPosition.hasSameParentAs(s.sourcePosition)&&a.containsPosition(e.sourcePosition)){if(s.type=="remove"&&!i.forceWeakRemove){if(!i.aWasUndone){const f=[];let b=e.graveyardPosition.clone(),k=e.targetPosition._getTransformedByMergeOperation(e);s.howMany>1&&(f.push(new Et(s.sourcePosition,s.howMany-1,s.targetPosition,0)),b=b._getTransformedByMove(s.sourcePosition,s.targetPosition,s.howMany-1),k=k._getTransformedByMove(s.sourcePosition,s.targetPosition,s.howMany-1));const C=e.deletionPosition._getCombined(s.sourcePosition,s.targetPosition),y=new Et(b,1,C,0),P=y.getMovedRangeStart().path.slice();P.push(0);const R=new q(y.targetPosition.root,P);k=k._getTransformedByMove(b,C,1);const D=new Et(k,e.howMany,R,0);return f.push(y),f.push(D),f}}else if(s.howMany==1)return i.bWasUndone?(s.sourcePosition=e.graveyardPosition.clone(),s.targetPosition=s.targetPosition._getTransformedByMergeOperation(e),[s]):[new Xt(0)]}const h=V._createFromPositionAndShift(s.sourcePosition,s.howMany)._getTransformedByMergeOperation(e);return s.sourcePosition=h.start,s.howMany=h.end.offset-h.start.offset,s.targetPosition=s.targetPosition._getTransformedByMergeOperation(e),[s]});ut(Ee,ie,(s,e)=>(s.position=s.position._getTransformedByInsertOperation(e),[s]));ut(Ee,le,(s,e)=>s.position.isEqual(e.deletionPosition)?(s.position=e.graveyardPosition.clone(),s.position.stickiness="toNext",[s]):(s.position=s.position._getTransformedByMergeOperation(e),[s]));ut(Ee,Et,(s,e)=>(s.position=s.position._getTransformedByMoveOperation(e),[s]));ut(Ee,Ee,(s,e,i)=>{if(s.position.isEqual(e.position))if(i.aIsStrong)s.oldName=e.newName;else return[new Xt(0)];return[s]});ut(Ee,Ot,(s,e)=>{const i=s.position.path,a=e.splitPosition.getParentPath();if(fe(i,a)=="same"&&!e.graveyardPosition){const d=new Ee(s.position.getShiftedBy(1),s.oldName,s.newName,0);return[s,d]}return s.position=s.position._getTransformedBySplitOperation(e),[s]});ut(Gn,Gn,(s,e,i)=>{if(s.root===e.root&&s.key===e.key){if(!i.aIsStrong||s.newValue===e.newValue)return[new Xt(0)];s.oldValue=e.newValue}return[s]});ut(Kn,Kn,(s,e)=>s.rootName===e.rootName&&s.isAdd===e.isAdd?[new Xt(0)]:[s]);ut(Ot,ie,(s,e)=>(s.splitPosition.hasSameParentAs(e.position)&&s.splitPosition.offset<e.position.offset&&(s.howMany+=e.howMany),s.splitPosition=s.splitPosition._getTransformedByInsertOperation(e),s.insertionPosition=s.insertionPosition._getTransformedByInsertOperation(e),[s]));ut(Ot,le,(s,e,i)=>{if(!s.graveyardPosition&&!i.bWasUndone&&s.splitPosition.hasSameParentAs(e.sourcePosition)){const a=e.graveyardPosition.path.slice();a.push(0);const d=new q(e.graveyardPosition.root,a),h=Ot.getInsertionPosition(new q(e.graveyardPosition.root,a)),f=new Ot(d,0,h,null,0);return s.splitPosition=s.splitPosition._getTransformedByMergeOperation(e),s.insertionPosition=Ot.getInsertionPosition(s.splitPosition),s.graveyardPosition=f.insertionPosition.clone(),s.graveyardPosition.stickiness="toNext",[f,s]}return s.splitPosition.hasSameParentAs(e.deletionPosition)&&!s.splitPosition.isAfter(e.deletionPosition)&&s.howMany--,s.splitPosition.hasSameParentAs(e.targetPosition)&&(s.howMany+=e.howMany),s.splitPosition=s.splitPosition._getTransformedByMergeOperation(e),s.insertionPosition=Ot.getInsertionPosition(s.splitPosition),s.graveyardPosition&&(s.graveyardPosition=s.graveyardPosition._getTransformedByMergeOperation(e)),[s]});ut(Ot,Et,(s,e,i)=>{const a=V._createFromPositionAndShift(e.sourcePosition,e.howMany);if(s.graveyardPosition){const h=a.start.isEqual(s.graveyardPosition)||a.containsPosition(s.graveyardPosition);if(!i.bWasUndone&&h){const f=s.splitPosition._getTransformedByMoveOperation(e),b=s.graveyardPosition._getTransformedByMoveOperation(e),k=b.path.slice();k.push(0);const C=new q(b.root,k);return[new Et(f,s.howMany,C,0)]}s.graveyardPosition=s.graveyardPosition._getTransformedByMoveOperation(e)}const d=s.splitPosition.isEqual(e.targetPosition);if(d&&(i.baRelation=="insertAtSource"||i.abRelation=="splitBefore"))return s.howMany+=e.howMany,s.splitPosition=s.splitPosition._getTransformedByDeletion(e.sourcePosition,e.howMany),s.insertionPosition=Ot.getInsertionPosition(s.splitPosition),[s];if(d&&i.abRelation&&i.abRelation.howMany){const{howMany:h,offset:f}=i.abRelation;return s.howMany+=h,s.splitPosition=s.splitPosition.getShiftedBy(f),[s]}if(s.splitPosition.hasSameParentAs(e.sourcePosition)&&a.containsPosition(s.splitPosition)){const h=e.howMany-(s.splitPosition.offset-e.sourcePosition.offset);return s.howMany-=h,s.splitPosition.hasSameParentAs(e.targetPosition)&&s.splitPosition.offset<e.targetPosition.offset&&(s.howMany+=e.howMany),s.splitPosition=e.sourcePosition.clone(),s.insertionPosition=Ot.getInsertionPosition(s.splitPosition),[s]}return e.sourcePosition.isEqual(e.targetPosition)||(s.splitPosition.hasSameParentAs(e.sourcePosition)&&s.splitPosition.offset<=e.sourcePosition.offset&&(s.howMany-=e.howMany),s.splitPosition.hasSameParentAs(e.targetPosition)&&s.splitPosition.offset<e.targetPosition.offset&&(s.howMany+=e.howMany)),s.splitPosition.stickiness="toNone",s.splitPosition=s.splitPosition._getTransformedByMoveOperation(e),s.splitPosition.stickiness="toNext",s.graveyardPosition?s.insertionPosition=s.insertionPosition._getTransformedByMoveOperation(e):s.insertionPosition=Ot.getInsertionPosition(s.splitPosition),[s]});ut(Ot,Ot,(s,e,i)=>{if(s.splitPosition.isEqual(e.splitPosition)){if(!s.graveyardPosition&&!e.graveyardPosition)return[new Xt(0)];if(s.graveyardPosition&&e.graveyardPosition&&s.graveyardPosition.isEqual(e.graveyardPosition))return[new Xt(0)];if(i.abRelation=="splitBefore")return s.howMany=0,s.graveyardPosition=s.graveyardPosition._getTransformedBySplitOperation(e),[s]}if(s.graveyardPosition&&e.graveyardPosition&&s.graveyardPosition.isEqual(e.graveyardPosition)){const a=s.splitPosition.root.rootName=="$graveyard",d=e.splitPosition.root.rootName=="$graveyard";if(d&&!a||!(a&&!d)&&i.aIsStrong){const k=[];return e.howMany&&k.push(new Et(e.moveTargetPosition,e.howMany,e.splitPosition,0)),s.howMany&&k.push(new Et(s.splitPosition,s.howMany,s.moveTargetPosition,0)),k}else return[new Xt(0)]}if(s.graveyardPosition&&(s.graveyardPosition=s.graveyardPosition._getTransformedBySplitOperation(e)),s.splitPosition.isEqual(e.insertionPosition)&&i.abRelation=="splitBefore")return s.howMany++,[s];if(e.splitPosition.isEqual(s.insertionPosition)&&i.baRelation=="splitBefore"){const a=e.insertionPosition.path.slice();a.push(0);const d=new q(e.insertionPosition.root,a),h=new Et(s.insertionPosition,1,d,0);return[s,h]}return s.splitPosition.hasSameParentAs(e.splitPosition)&&s.splitPosition.offset<e.splitPosition.offset&&(s.howMany-=e.howMany),s.splitPosition=s.splitPosition._getTransformedBySplitOperation(e),s.insertionPosition=Ot.getInsertionPosition(s.splitPosition),[s]});function Uw(s,e){return s.targetPosition._getTransformedByDeletion(e.sourcePosition,e.howMany)===null}function So(s,e){const i=[];for(let a=0;a<s.length;a++){const d=s[a],h=new Et(d.start,d.end.offset-d.start.offset,e,0);i.push(h);for(let f=a+1;f<s.length;f++)s[f]=s[f]._getTransformedByMove(h.sourcePosition,h.targetPosition,h.howMany)[0];e=e._getTransformedByMove(h.sourcePosition,h.targetPosition,h.howMany)}return i}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class JN extends wt(q){constructor(e,i,a="toNone"){if(super(e,i,a),!this.root.is("rootElement"))throw new M("model-liveposition-root-not-rootelement",e);QN.call(this)}detach(){this.stopListening()}toPosition(){return new q(this.root,this.path.slice(),this.stickiness)}static fromPosition(e,i){return new this(e.root,e.path.slice(),i||e.stickiness)}}JN.prototype.is=function(s){return s==="livePosition"||s==="model:livePosition"||s=="position"||s==="model:position"};function QN(){this.listenTo(this.root.document.model,"applyOperation",(s,e)=>{const i=e[0];i.isDocumentOperation&&XN.call(this,i)},{priority:"low"})}function XN(s){const e=this.getTransformedByOperation(s);if(!this.isEqual(e)){const i=this.toPosition();this.path=e.path,this.root=e.root,this.fire("change",i)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ZN{constructor(e){this._changesInElement=new Map,this._elementSnapshots=new Map,this._changedMarkers=new Map,this._changedRoots=new Map,this._changeCount=0,this._cachedChanges=null,this._cachedChangesWithGraveyard=null,this._refreshedItems=new Set,this._markerCollection=e}get isEmpty(){return this._changesInElement.size==0&&this._changedMarkers.size==0&&this._changedRoots.size==0}bufferOperation(e){const i=e;switch(i.type){case"insert":{if(this._isInInsertedElement(i.position.parent))return;this._markInsert(i.position.parent,i.position.offset,i.nodes.maxOffset);break}case"addAttribute":case"removeAttribute":case"changeAttribute":{for(const a of i.range.getItems({shallow:!0}))this._isInInsertedElement(a.parent)||this._markAttribute(a);break}case"remove":case"move":case"reinsert":{if(i.sourcePosition.isEqual(i.targetPosition)||i.sourcePosition.getShiftedBy(i.howMany).isEqual(i.targetPosition))return;const a=this._isInInsertedElement(i.sourcePosition.parent),d=this._isInInsertedElement(i.targetPosition.parent);a||this._markRemove(i.sourcePosition.parent,i.sourcePosition.offset,i.howMany),d||this._markInsert(i.targetPosition.parent,i.getMovedRangeStart().offset,i.howMany);break}case"rename":{if(this._isInInsertedElement(i.position.parent))return;this._markRemove(i.position.parent,i.position.offset,1),this._markInsert(i.position.parent,i.position.offset,1);const a=V._createFromPositionAndShift(i.position,1);for(const d of this._markerCollection.getMarkersIntersectingRange(a)){const h=d.getData();this.bufferMarkerChange(d.name,h,h)}break}case"split":{const a=i.splitPosition.parent;this._isInInsertedElement(a)||this._markRemove(a,i.splitPosition.offset,i.howMany),this._isInInsertedElement(i.insertionPosition.parent)||this._markInsert(i.insertionPosition.parent,i.insertionPosition.offset,1),i.graveyardPosition&&this._markRemove(i.graveyardPosition.parent,i.graveyardPosition.offset,1);break}case"merge":{const a=i.sourcePosition.parent;this._isInInsertedElement(a.parent)||this._markRemove(a.parent,a.startOffset,1);const d=i.graveyardPosition.parent;this._markInsert(d,i.graveyardPosition.offset,1);const h=i.targetPosition.parent;this._isInInsertedElement(h)||this._markInsert(h,i.targetPosition.offset,a.maxOffset);break}case"detachRoot":case"addRoot":{const a=i.affectedSelectable;if(!a._isLoaded||a.isAttached()==i.isAdd)return;this._bufferRootStateChange(i.rootName,i.isAdd);break}case"addRootAttribute":case"removeRootAttribute":case"changeRootAttribute":{if(!i.root._isLoaded)return;const a=i.root.rootName;this._bufferRootAttributeChange(a,i.key,i.oldValue,i.newValue);break}}this._cachedChanges=null}bufferMarkerChange(e,i,a){i.range&&i.range.root.is("rootElement")&&!i.range.root._isLoaded&&(i.range=null),a.range&&a.range.root.is("rootElement")&&!a.range.root._isLoaded&&(a.range=null);let d=this._changedMarkers.get(e);d?d.newMarkerData=a:(d={newMarkerData:a,oldMarkerData:i},this._changedMarkers.set(e,d)),d.oldMarkerData.range==null&&a.range==null&&this._changedMarkers.delete(e)}getMarkersToRemove(){const e=[];for(const[i,a]of this._changedMarkers)a.oldMarkerData.range!=null&&e.push({name:i,range:a.oldMarkerData.range});return e}getMarkersToAdd(){const e=[];for(const[i,a]of this._changedMarkers)a.newMarkerData.range!=null&&e.push({name:i,range:a.newMarkerData.range});return e}getChangedMarkers(){return Array.from(this._changedMarkers).map(([e,i])=>({name:e,data:{oldRange:i.oldMarkerData.range,newRange:i.newMarkerData.range}}))}hasDataChanges(){if(this._changesInElement.size>0||this._changedRoots.size>0)return!0;for(const{newMarkerData:e,oldMarkerData:i}of this._changedMarkers.values()){if(e.affectsData!==i.affectsData)return!0;if(e.affectsData){const a=e.range&&!i.range,d=!e.range&&i.range,h=e.range&&i.range&&!e.range.isEqual(i.range);if(a||d||h)return!0}}return!1}getChanges(e={}){if(this._cachedChanges)return e.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice();let i=[];for(const a of this._changesInElement.keys()){const d=this._changesInElement.get(a).sort((y,P)=>y.offset===P.offset?y.type!=P.type?y.type=="remove"?-1:1:0:y.offset<P.offset?-1:1),h=this._elementSnapshots.get(a),f=Gw(a.getChildren()),b=tD(h.length,d);let k=0,C=0;for(const y of b)if(y==="i")i.push(this._getInsertDiff(a,k,f[k])),k++;else if(y==="r")i.push(this._getRemoveDiff(a,k,h[C])),C++;else if(y==="a"){const P=f[k].attributes,R=h[C].attributes;let D;if(f[k].name=="$text")D=new V(q._createAt(a,k),q._createAt(a,k+1));else{const $=a.offsetToIndex(k);D=new V(q._createAt(a,k),q._createAt(a.getChild($),0))}i.push(...this._getAttributesDiff(D,R,P)),k++,C++}else k++,C++}i.sort((a,d)=>a.position.root!=d.position.root?a.position.root.rootName<d.position.root.rootName?-1:1:a.position.isEqual(d.position)?a.changeCount-d.changeCount:a.position.isBefore(d.position)?-1:1);for(let a=1,d=0;a<i.length;a++){const h=i[d],f=i[a],b=h.type=="remove"&&f.type=="remove"&&h.name=="$text"&&f.name=="$text"&&h.position.isEqual(f.position),k=h.type=="insert"&&f.type=="insert"&&h.name=="$text"&&f.name=="$text"&&h.position.parent==f.position.parent&&h.position.offset+h.length==f.position.offset,C=h.type=="attribute"&&f.type=="attribute"&&h.position.parent==f.position.parent&&h.range.isFlat&&f.range.isFlat&&h.position.offset+h.length==f.position.offset&&h.attributeKey==f.attributeKey&&h.attributeOldValue==f.attributeOldValue&&h.attributeNewValue==f.attributeNewValue;b||k||C?(h.length++,C&&(h.range.end=h.range.end.getShiftedBy(1)),i[a]=null):d=a}i=i.filter(a=>a);for(const a of i)delete a.changeCount,a.type=="attribute"&&(delete a.position,delete a.length);return this._changeCount=0,this._cachedChangesWithGraveyard=i,this._cachedChanges=i.filter(eD),e.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice()}getChangedRoots(){return Array.from(this._changedRoots.values()).map(e=>{const i={...e};return i.state!==void 0&&delete i.attributes,i})}getRefreshedItems(){return new Set(this._refreshedItems)}reset(){this._changesInElement.clear(),this._elementSnapshots.clear(),this._changedMarkers.clear(),this._changedRoots.clear(),this._refreshedItems=new Set,this._cachedChanges=null}_bufferRootStateChange(e,i){if(!this._changedRoots.has(e)){this._changedRoots.set(e,{name:e,state:i?"attached":"detached"});return}const a=this._changedRoots.get(e);a.state!==void 0?(delete a.state,a.attributes===void 0&&this._changedRoots.delete(e)):a.state=i?"attached":"detached"}_bufferRootAttributeChange(e,i,a,d){const h=this._changedRoots.get(e)||{name:e},f=h.attributes||{};if(f[i]){const b=f[i];d===b.oldValue?delete f[i]:b.newValue=d}else f[i]={oldValue:a,newValue:d};Object.entries(f).length===0?(delete h.attributes,h.state===void 0&&this._changedRoots.delete(e)):(h.attributes=f,this._changedRoots.set(e,h))}_refreshItem(e){if(this._isInInsertedElement(e.parent))return;this._markRemove(e.parent,e.startOffset,e.offsetSize),this._markInsert(e.parent,e.startOffset,e.offsetSize),this._refreshedItems.add(e);const i=V._createOn(e);for(const a of this._markerCollection.getMarkersIntersectingRange(i)){const d=a.getData();this.bufferMarkerChange(a.name,d,d)}this._cachedChanges=null}_bufferRootLoad(e){if(e.isAttached()){this._bufferRootStateChange(e.rootName,!0),this._markInsert(e,0,e.maxOffset);for(const i of e.getAttributeKeys())this._bufferRootAttributeChange(e.rootName,i,null,e.getAttribute(i));for(const i of this._markerCollection)if(i.getRange().root==e){const a=i.getData();this.bufferMarkerChange(i.name,{...a,range:null},a)}}}_markInsert(e,i,a){if(e.root.is("rootElement")&&!e.root._isLoaded)return;const d={type:"insert",offset:i,howMany:a,count:this._changeCount++};this._markChange(e,d)}_markRemove(e,i,a){if(e.root.is("rootElement")&&!e.root._isLoaded)return;const d={type:"remove",offset:i,howMany:a,count:this._changeCount++};this._markChange(e,d),this._removeAllNestedChanges(e,i,a)}_markAttribute(e){if(e.root.is("rootElement")&&!e.root._isLoaded)return;const i={type:"attribute",offset:e.startOffset,howMany:e.offsetSize,count:this._changeCount++};this._markChange(e.parent,i)}_markChange(e,i){this._makeSnapshot(e);const a=this._getChangesForElement(e);this._handleChange(i,a),a.push(i);for(let d=0;d<a.length;d++)a[d].howMany<1&&(a.splice(d,1),d--)}_getChangesForElement(e){let i;return this._changesInElement.has(e)?i=this._changesInElement.get(e):(i=[],this._changesInElement.set(e,i)),i}_makeSnapshot(e){this._elementSnapshots.has(e)||this._elementSnapshots.set(e,Gw(e.getChildren()))}_handleChange(e,i){e.nodesToHandle=e.howMany;for(const a of i){const d=e.offset+e.howMany,h=a.offset+a.howMany;if(e.type=="insert"&&(a.type=="insert"&&(e.offset<=a.offset?a.offset+=e.howMany:e.offset<h&&(a.howMany+=e.nodesToHandle,e.nodesToHandle=0)),a.type=="remove"&&e.offset<a.offset&&(a.offset+=e.howMany),a.type=="attribute")){if(e.offset<=a.offset)a.offset+=e.howMany;else if(e.offset<h){const f=a.howMany;a.howMany=e.offset-a.offset,i.unshift({type:"attribute",offset:d,howMany:f-a.howMany,count:this._changeCount++})}}if(e.type=="remove"){if(a.type=="insert"){if(d<=a.offset)a.offset-=e.howMany;else if(d<=h)if(e.offset<a.offset){const f=d-a.offset;a.offset=e.offset,a.howMany-=f,e.nodesToHandle-=f}else a.howMany-=e.nodesToHandle,e.nodesToHandle=0;else if(e.offset<=a.offset)e.nodesToHandle-=a.howMany,a.howMany=0;else if(e.offset<h){const f=h-e.offset;a.howMany-=f,e.nodesToHandle-=f}}if(a.type=="remove"&&(d<=a.offset?a.offset-=e.howMany:e.offset<a.offset&&(e.nodesToHandle+=a.howMany,a.howMany=0)),a.type=="attribute"){if(d<=a.offset)a.offset-=e.howMany;else if(e.offset<a.offset){const f=d-a.offset;a.offset=e.offset,a.howMany-=f}else if(e.offset<h)if(d<=h){const f=a.howMany;a.howMany=e.offset-a.offset;const b=f-a.howMany-e.nodesToHandle;i.unshift({type:"attribute",offset:e.offset,howMany:b,count:this._changeCount++})}else a.howMany-=h-e.offset}}if(e.type=="attribute"){if(a.type=="insert")if(e.offset<a.offset&&d>a.offset){if(d>h){const f={type:"attribute",offset:h,howMany:d-h,count:this._changeCount++};this._handleChange(f,i),i.push(f)}e.nodesToHandle=a.offset-e.offset,e.howMany=e.nodesToHandle}else e.offset>=a.offset&&e.offset<h&&(d>h?(e.nodesToHandle=d-h,e.offset=h):e.nodesToHandle=0);if(a.type=="remove"&&e.offset<a.offset&&d>a.offset){const f={type:"attribute",offset:a.offset,howMany:d-a.offset,count:this._changeCount++};this._handleChange(f,i),i.push(f),e.nodesToHandle=a.offset-e.offset,e.howMany=e.nodesToHandle}a.type=="attribute"&&(e.offset>=a.offset&&d<=h?(e.nodesToHandle=0,e.howMany=0,e.offset=0):e.offset<=a.offset&&d>=h&&(a.howMany=0))}}e.howMany=e.nodesToHandle,delete e.nodesToHandle}_getInsertDiff(e,i,a){return{type:"insert",position:q._createAt(e,i),name:a.name,attributes:new Map(a.attributes),length:1,changeCount:this._changeCount++,_element:a.element}}_getRemoveDiff(e,i,a){return{type:"remove",position:q._createAt(e,i),name:a.name,attributes:new Map(a.attributes),length:1,changeCount:this._changeCount++,_element:a.element}}_getAttributesDiff(e,i,a){const d=[];a=new Map(a);for(const[h,f]of i){const b=a.has(h)?a.get(h):null;b!==f&&d.push({type:"attribute",position:e.start,range:e.clone(),length:1,attributeKey:h,attributeOldValue:f,attributeNewValue:b,changeCount:this._changeCount++}),a.delete(h)}for(const[h,f]of a)d.push({type:"attribute",position:e.start,range:e.clone(),length:1,attributeKey:h,attributeOldValue:null,attributeNewValue:f,changeCount:this._changeCount++});return d}_isInInsertedElement(e){const i=e.parent;if(!i)return!1;const a=this._changesInElement.get(i),d=e.startOffset;if(a){for(const h of a)if(h.type=="insert"&&d>=h.offset&&d<h.offset+h.howMany)return!0}return this._isInInsertedElement(i)}_removeAllNestedChanges(e,i,a){const d=new V(q._createAt(e,i),q._createAt(e,i+a));for(const h of d.getItems({shallow:!0}))h.is("element")&&(this._elementSnapshots.delete(h),this._changesInElement.delete(h),this._removeAllNestedChanges(h,0,h.maxOffset))}}function Gw(s){const e=[];for(const i of s)if(i.is("$text"))for(let a=0;a<i.data.length;a++)e.push({name:"$text",attributes:new Map(i.getAttributes())});else e.push({name:i.name,attributes:new Map(i.getAttributes()),element:i});return e}function tD(s,e){const i=[];let a=0,d=0;for(const h of e){if(h.offset>a){for(let f=0;f<h.offset-a;f++)i.push("e");d+=h.offset-a}if(h.type=="insert"){for(let f=0;f<h.howMany;f++)i.push("i");a=h.offset+h.howMany}else if(h.type=="remove"){for(let f=0;f<h.howMany;f++)i.push("r");a=h.offset,d+=h.howMany}else i.push(..."a".repeat(h.howMany).split("")),a=h.offset+h.howMany,d+=h.howMany}if(d<s)for(let h=0;h<s-d-a;h++)i.push("e");return i}function eD(s){const e="position"in s&&s.position.root.rootName=="$graveyard",i="range"in s&&s.range.root.rootName=="$graveyard";return!e&&!i}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class nD{constructor(){this._operations=[],this._undoPairs=new Map,this._undoneOperations=new Set,this._baseVersionToOperationIndex=new Map,this._version=0,this._gaps=new Map}get version(){return this._version}set version(e){this._operations.length&&e>this._version+1&&this._gaps.set(this._version,e),this._version=e}get lastOperation(){return this._operations[this._operations.length-1]}addOperation(e){if(e.baseVersion!==this.version)throw new M("model-document-history-addoperation-incorrect-version",this,{operation:e,historyVersion:this.version});this._operations.push(e),this._version++,this._baseVersionToOperationIndex.set(e.baseVersion,this._operations.length-1)}getOperations(e,i=this.version){if(!this._operations.length)return[];const a=this._operations[0];e===void 0&&(e=a.baseVersion);let d=i-1;for(const[b,k]of this._gaps)e>b&&e<k&&(e=k),d>b&&d<k&&(d=b-1);if(d<a.baseVersion||e>this.lastOperation.baseVersion)return[];let h=this._baseVersionToOperationIndex.get(e);h===void 0&&(h=0);let f=this._baseVersionToOperationIndex.get(d);return f===void 0&&(f=this._operations.length-1),this._operations.slice(h,f+1)}getOperation(e){const i=this._baseVersionToOperationIndex.get(e);if(i!==void 0)return this._operations[i]}setOperationAsUndone(e,i){this._undoPairs.set(i,e),this._undoneOperations.add(e)}isUndoingOperation(e){return this._undoPairs.has(e)}isUndoneOperation(e){return this._undoneOperations.has(e)}getUndoneOperation(e){return this._undoPairs.get(e)}reset(){this._version=0,this._undoPairs=new Map,this._operations=[],this._undoneOperations=new Set,this._gaps=new Map,this._baseVersionToOperationIndex=new Map}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Av extends Pi{constructor(e,i,a="main"){super(i),this._isAttached=!0,this._isLoaded=!0,this._document=e,this.rootName=a}get document(){return this._document}isAttached(){return this._isAttached}toJSON(){return this.rootName}}Av.prototype.is=function(s,e){return e?e===this.name&&(s==="rootElement"||s==="model:rootElement"||s==="element"||s==="model:element"):s==="rootElement"||s==="model:rootElement"||s==="element"||s==="model:element"||s==="node"||s==="model:node"};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Kw="$graveyard";class ZF extends wt(){constructor(e){super(),this.model=e,this.history=new nD,this.selection=new bv(this),this.roots=new pr({idProperty:"rootName"}),this.differ=new ZN(e.markers),this.isReadOnly=!1,this._postFixers=new Set,this._hasSelectionChangedFromTheLastChangeBlock=!1,this.createRoot("$root",Kw),this.listenTo(e,"applyOperation",(i,a)=>{const d=a[0];d.isDocumentOperation&&this.differ.bufferOperation(d)},{priority:"high"}),this.listenTo(e,"applyOperation",(i,a)=>{const d=a[0];d.isDocumentOperation&&this.history.addOperation(d)},{priority:"low"}),this.listenTo(this.selection,"change",()=>{this._hasSelectionChangedFromTheLastChangeBlock=!0}),this.listenTo(e.markers,"update",(i,a,d,h,f)=>{const b={...a.getData(),range:h};this.differ.bufferMarkerChange(a.name,f,b),d===null&&a.on("change",(k,C)=>{const y=a.getData();this.differ.bufferMarkerChange(a.name,{...y,range:C},y)})}),this.registerPostFixer(i=>{let a=!1;for(const d of this.roots)!d.isAttached()&&!d.isEmpty&&(i.remove(i.createRangeIn(d)),a=!0);for(const d of this.model.markers)d.getRange().root.isAttached()||(i.removeMarker(d),a=!0);return a})}get version(){return this.history.version}set version(e){this.history.version=e}get graveyard(){return this.getRoot(Kw)}createRoot(e="$root",i="main"){if(this.roots.get(i))throw new M("model-document-createroot-name-exists",this,{name:i});const a=new Av(this,e,i);return this.roots.add(a),a}destroy(){this.selection.destroy(),this.stopListening()}getRoot(e="main"){return this.roots.get(e)}getRootNames(e=!1){return this.getRoots(e).map(i=>i.rootName)}getRoots(e=!1){return this.roots.filter(i=>i!=this.graveyard&&(e||i.isAttached())&&i._isLoaded)}registerPostFixer(e){this._postFixers.add(e)}toJSON(){const e=Bk(this);return e.selection="[engine.model.DocumentSelection]",e.model="[engine.model.Model]",e}_handleChangeBlock(e){this._hasDocumentChangedFromTheLastChangeBlock()&&(this._callPostFixers(e),this.selection.refresh(),this.differ.hasDataChanges()?this.fire("change:data",e.batch):this.fire("change",e.batch),this.selection.refresh(),this.differ.reset()),this._hasSelectionChangedFromTheLastChangeBlock=!1}_hasDocumentChangedFromTheLastChangeBlock(){return!this.differ.isEmpty||this._hasSelectionChangedFromTheLastChangeBlock}_getDefaultRoot(){const e=this.getRoots();return e.length?e[0]:this.graveyard}_getDefaultRange(){const e=this._getDefaultRoot(),i=this.model,a=i.schema,d=i.createPositionFromPath(e,[0]);return a.getNearestSelectionRange(d)||i.createRange(d)}_validateSelectionRange(e){return Yw(e.start)&&Yw(e.end)}_callPostFixers(e){let i=!1;do for(const a of this._postFixers)if(this.selection.refresh(),i=a(e),i)break;while(i)}}function Yw(s){const e=s.textNode;if(e){const i=e.data,a=s.offset-e.startOffset;return!nv(i,a)&&!iv(i,a)}return!0}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class t4 extends wt(){constructor(){super(...arguments),this._markers=new Map}[Symbol.iterator](){return this._markers.values()}has(e){const i=e instanceof xo?e.name:e;return this._markers.has(i)}get(e){return this._markers.get(e)||null}_set(e,i,a=!1,d=!1){const h=e instanceof xo?e.name:e;if(h.includes(","))throw new M("markercollection-incorrect-marker-name",this);const f=this._markers.get(h);if(f){const C=f.getData(),y=f.getRange();let P=!1;return y.isEqual(i)||(f._attachLiveRange(No.fromRange(i)),P=!0),a!=f.managedUsingOperations&&(f._managedUsingOperations=a,P=!0),typeof d=="boolean"&&d!=f.affectsData&&(f._affectsData=d,P=!0),P&&this.fire(`update:${h}`,f,y,i,C),f}const b=No.fromRange(i),k=new xo(h,b,a,d);return this._markers.set(h,k),this.fire(`update:${h}`,k,null,i,{...k.getData(),range:null}),k}_remove(e){const i=e instanceof xo?e.name:e,a=this._markers.get(i);return a?(this._markers.delete(i),this.fire(`update:${i}`,a,a.getRange(),null,a.getData()),this._destroyMarker(a),!0):!1}_refresh(e){const i=e instanceof xo?e.name:e,a=this._markers.get(i);if(!a)throw new M("markercollection-refresh-marker-not-exists",this);const d=a.getRange();this.fire(`update:${i}`,a,d,d,a.getData())}*getMarkersAtPosition(e){for(const i of this)i.getRange().containsPosition(e)&&(yield i)}*getMarkersIntersectingRange(e){for(const i of this)i.getRange().getIntersection(e)!==null&&(yield i)}destroy(){for(const e of this._markers.values())this._destroyMarker(e);this._markers=null,this.stopListening()}*getMarkersGroup(e){for(const i of this._markers.values())i.name.startsWith(e+":")&&(yield i)}_destroyMarker(e){e.stopListening(),e._detachLiveRange()}}class xo extends wt(Jn){constructor(e,i,a,d){super(),this.name=e,this._liveRange=this._attachLiveRange(i),this._managedUsingOperations=a,this._affectsData=d}get managedUsingOperations(){if(!this._liveRange)throw new M("marker-destroyed",this);return this._managedUsingOperations}get affectsData(){if(!this._liveRange)throw new M("marker-destroyed",this);return this._affectsData}getData(){return{range:this.getRange(),affectsData:this.affectsData,managedUsingOperations:this.managedUsingOperations}}getStart(){if(!this._liveRange)throw new M("marker-destroyed",this);return this._liveRange.start.clone()}getEnd(){if(!this._liveRange)throw new M("marker-destroyed",this);return this._liveRange.end.clone()}getRange(){if(!this._liveRange)throw new M("marker-destroyed",this);return this._liveRange.toRange()}_attachLiveRange(e){return this._liveRange&&this._detachLiveRange(),e.delegate("change:range").to(this),e.delegate("change:content").to(this),this._liveRange=e,e}_detachLiveRange(){this._liveRange.stopDelegating("change:range",this),this._liveRange.stopDelegating("change:content",this),this._liveRange.detach(),this._liveRange=null}}xo.prototype.is=function(s){return s==="marker"||s==="model:marker"};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Du extends Jn{constructor(e){super(),this.markers=new Map,this._children=new Gs,e&&this._insertChild(0,e)}[Symbol.iterator](){return this.getChildren()}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return this.childCount===0}get nextSibling(){return null}get previousSibling(){return null}get root(){return this}get parent(){return null}get document(){return null}isAttached(){return!1}getAncestors(){return[]}getChild(e){return this._children.getNode(e)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(e){return this._children.getNodeIndex(e)}getChildStartOffset(e){return this._children.getNodeStartOffset(e)}getPath(){return[]}getNodeByPath(e){let i=this;for(const a of e)i=i.getChild(i.offsetToIndex(a));return i}offsetToIndex(e){return this._children.offsetToIndex(e)}toJSON(){const e=[];for(const i of this._children)e.push(i.toJSON());return e}static fromJSON(e){const i=[];for(const a of e)a.name?i.push(Pi.fromJSON(a)):i.push(zt.fromJSON(a));return new Du(i)}_appendChild(e){this._insertChild(this.childCount,e)}_insertChild(e,i){const a=iD(i);for(const d of a)d.parent!==null&&d._remove(),d.parent=this;this._children._insertNodes(e,a)}_removeChildren(e,i=1){const a=this._children._removeNodes(e,i);for(const d of a)d.parent=null;return a}}Du.prototype.is=function(s){return s==="documentFragment"||s==="model:documentFragment"};function iD(s){return typeof s=="string"?[new zt(s)]:($e(s)||(s=[s]),Array.from(s).map(e=>typeof e=="string"?new zt(e):e instanceof Ke?new zt(e.data,e.getAttributes()):e))}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class oD extends wN{constructor(){super(...arguments),this.domEventType=["mousedown","mouseup","mouseover","mouseout"]}onDomEvent(e){this.fire(e.type,e)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class sD{constructor(e){this.document=e}createDocumentFragment(e){return new Ei(this.document,e)}createElement(e,i,a){return new Qe(this.document,e,i,a)}createText(e){return new Dt(this.document,e)}clone(e,i=!1){return e._clone(i)}appendChild(e,i){return i._appendChild(e)}insertChild(e,i,a){return a._insertChild(e,i)}removeChildren(e,i,a){return a._removeChildren(e,i)}remove(e){const i=e.parent;return i?this.removeChildren(i.getChildIndex(e),1,i):[]}replace(e,i){const a=e.parent;if(a){const d=a.getChildIndex(e);return this.removeChildren(d,1,a),this.insertChild(d,i,a),!0}return!1}unwrapElement(e){const i=e.parent;if(i){const a=i.getChildIndex(e);this.remove(e),this.insertChild(a,e.getChildren(),i)}}rename(e,i){const a=new Qe(this.document,e,i.getAttributes(),i.getChildren());return this.replace(i,a)?a:null}setAttribute(e,i,a){a._setAttribute(e,i)}removeAttribute(e,i){i._removeAttribute(e)}addClass(e,i){i._addClass(e)}removeClass(e,i){i._removeClass(e)}setStyle(e,i,a){Mn(e)&&a===void 0?i._setStyle(e):a._setStyle(e,i)}removeStyle(e,i){i._removeStyle(e)}setCustomProperty(e,i,a){a._setCustomProperty(e,i)}removeCustomProperty(e,i){return i._removeCustomProperty(e)}createPositionAt(e,i){return U._createAt(e,i)}createPositionAfter(e){return U._createAfter(e)}createPositionBefore(e){return U._createBefore(e)}createRange(e,i){return new at(e,i)}createRangeOn(e){return at._createOn(e)}createRangeIn(e){return at._createIn(e)}createSelection(...e){return new xi(...e)}}const Cv="/feadmin/assets/cancel-2962aadd.svg",rD="/feadmin/assets/caption-ec45b48a.svg",aD="/feadmin/assets/check-cf419419.svg",lD="/feadmin/assets/cog-e7555208.svg",cD="/feadmin/assets/color-palette-b09aace2.svg",dD="/feadmin/assets/eraser-a21799f1.svg",uD="/feadmin/assets/history-818f4a0a.svg",hD="/feadmin/assets/low-vision-eac614d1.svg",fD="/feadmin/assets/text-alternative-d601e744.svg",gD="/feadmin/assets/loupe-95351ccf.svg",mD="/feadmin/assets/previous-arrow-187fc8d0.svg",pD="/feadmin/assets/next-arrow-481751f2.svg",bD="/feadmin/assets/image-1cf26051.svg",wD="/feadmin/assets/image-upload-32b8376d.svg",_D="/feadmin/assets/image-asset-manager-fc4f9790.svg",kD="/feadmin/assets/image-url-a80206db.svg",vD="/feadmin/assets/align-bottom-bf11cd09.svg",yD="/feadmin/assets/align-middle-7cf43f6d.svg",AD="/feadmin/assets/align-top-9e7d1a06.svg",CD="/feadmin/assets/align-left-2ef14d58.svg",xD="/feadmin/assets/align-center-f5f09d71.svg",ED="/feadmin/assets/align-right-d0a43422.svg",TD="/feadmin/assets/align-justify-47258822.svg",SD="/feadmin/assets/object-left-2d0eaafa.svg",PD="/feadmin/assets/object-center-60074dfe.svg",ID="/feadmin/assets/object-right-62ea642a.svg",MD="/feadmin/assets/object-full-width-9e4407d3.svg",RD="/feadmin/assets/object-inline-f5d51af3.svg",OD="/feadmin/assets/object-inline-left-b249fa3f.svg",ND="/feadmin/assets/object-inline-right-2014deb8.svg",DD="/feadmin/assets/object-size-full-08567969.svg",LD="/feadmin/assets/object-size-large-d8d373a8.svg",VD="/feadmin/assets/object-size-small-efd5e5ba.svg",BD="/feadmin/assets/object-size-medium-6cae5033.svg",FD="/feadmin/assets/pencil-bca6aeb4.svg",zD="/feadmin/assets/pilcrow-cee1b098.svg",jD="/feadmin/assets/quote-0d213473.svg",$D="/feadmin/assets/three-vertical-dots-34433102.svg",HD="/feadmin/assets/drag-indicator-0ed9c36c.svg",WD="/feadmin/assets/bold-0cfdefe4.svg",qD="/feadmin/assets/paragraph-43bf19d4.svg",UD="/feadmin/assets/plus-af0551dd.svg",GD="/feadmin/assets/text-313c66d2.svg",KD="/feadmin/assets/importexport-3e0f11ac.svg",YD="/feadmin/assets/redo-f4b36d10.svg",JD="/feadmin/assets/undo-45690a9b.svg",QD="/feadmin/assets/bulletedlist-630f16a6.svg",XD="/feadmin/assets/numberedlist-b048773e.svg",ZD="/feadmin/assets/todolist-8674bdaf.svg",tL="/feadmin/assets/codeblock-53f94e5f.svg",eL="/feadmin/assets/browse-files-c30b8b52.svg",nL="/feadmin/assets/heading1-db9c20f0.svg",iL="/feadmin/assets/heading2-9fd5a377.svg",oL="/feadmin/assets/heading3-ecd67992.svg",sL="/feadmin/assets/heading4-bf96ab87.svg",rL="/feadmin/assets/heading5-973c65df.svg",aL="/feadmin/assets/heading6-b844f5e2.svg",lL="/feadmin/assets/horizontalline-3def4c3e.svg",cL="/feadmin/assets/html-565235e4.svg",dL="/feadmin/assets/indent-c99e5848.svg",uL="/feadmin/assets/outdent-aebba0b0.svg",hL="/feadmin/assets/table-d4d07a3b.svg";/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Jw={bold:WD,cancel:Cv,caption:rD,check:aD,cog:lD,colorPalette:cD,eraser:dD,history:uD,image:bD,imageUpload:wD,imageAssetManager:_D,imageUrl:kD,lowVision:hD,textAlternative:fD,loupe:gD,previousArrow:mD,nextArrow:pD,importExport:KD,paragraph:qD,plus:UD,text:GD,alignBottom:vD,alignMiddle:yD,alignTop:AD,alignLeft:CD,alignCenter:xD,alignRight:ED,alignJustify:TD,objectLeft:OD,objectCenter:PD,objectRight:ND,objectFullWidth:MD,objectInline:RD,objectBlockLeft:SD,objectBlockRight:ID,objectSizeFull:DD,objectSizeLarge:LD,objectSizeSmall:VD,objectSizeMedium:BD,pencil:FD,pilcrow:zD,quote:jD,threeVerticalDots:$D,dragIndicator:HD,redo:YD,undo:JD,bulletedList:QD,numberedList:XD,todoList:ZD,codeBlock:tL,browseFiles:eL,heading1:nL,heading2:iL,heading3:oL,heading4:sL,heading5:rL,heading6:aL,horizontalLine:lL,html:cL,indent:dL,outdent:uL,table:hL};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class fL{constructor(e,i=20){this._batch=null,this.model=e,this._size=0,this.limit=i,this._isLocked=!1,this._changeCallback=(a,d)=>{d.isLocal&&d.isUndoable&&d!==this._batch&&this._reset(!0)},this._selectionChangeCallback=()=>{this._reset()},this.model.document.on("change",this._changeCallback),this.model.document.selection.on("change:range",this._selectionChangeCallback),this.model.document.selection.on("change:attribute",this._selectionChangeCallback)}get batch(){return this._batch||(this._batch=this.model.createBatch({isTyping:!0})),this._batch}get size(){return this._size}input(e){this._size+=e,this._size>=this.limit&&this._reset(!0)}get isLocked(){return this._isLocked}lock(){this._isLocked=!0}unlock(){this._isLocked=!1}destroy(){this.model.document.off("change",this._changeCallback),this.model.document.selection.off("change:range",this._selectionChangeCallback),this.model.document.selection.off("change:attribute",this._selectionChangeCallback)}_reset(e=!1){(!this.isLocked||e)&&(this._batch=null,this._size=0)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Qw extends ov{constructor(e,i){super(e),this.direction=i,this._buffer=new fL(e.model,e.config.get("typing.undoStep")),this._isEnabledBasedOnSelection=!1}get buffer(){return this._buffer}execute(e={}){const i=this.editor.model,a=i.document;i.enqueueChange(this._buffer.batch,d=>{this._buffer.lock();const h=d.createSelection(e.selection||a.selection);if(!i.canEditAt(h))return;const f=e.sequence||1,b=h.isCollapsed;if(h.isCollapsed&&i.modifySelection(h,{direction:this.direction,unit:e.unit,treatEmojiAsSingleUnit:!0}),this._shouldEntireContentBeReplacedWithParagraph(f)){this._replaceEntireContentWithParagraph(d);return}if(this._shouldReplaceFirstBlockWithParagraph(h,f)){this.editor.execute("paragraph",{selection:h});return}if(h.isCollapsed)return;let k=0;h.getFirstRange().getMinimalFlatRanges().forEach(C=>{k+=Qd(C.getWalker({singleCharacters:!0,ignoreElementEnd:!0,shallow:!0}))}),i.deleteContent(h,{doNotResetEntireContent:b,direction:this.direction}),this._buffer.input(k),d.setSelection(h),this._buffer.unlock()})}_shouldEntireContentBeReplacedWithParagraph(e){if(e>1)return!1;const i=this.editor.model,d=i.document.selection,h=i.schema.getLimitElement(d);if(!(d.isCollapsed&&d.containsEntireContent(h))||!i.schema.checkChild(h,"paragraph"))return!1;const b=h.getChild(0);return!(b&&b.is("element","paragraph"))}_replaceEntireContentWithParagraph(e){const i=this.editor.model,d=i.document.selection,h=i.schema.getLimitElement(d),f=e.createElement("paragraph");e.remove(e.createRangeIn(h)),e.insert(f,h),e.setSelection(f,0)}_shouldReplaceFirstBlockWithParagraph(e,i){const a=this.editor.model;if(i>1||this.direction!="backward"||!e.isCollapsed)return!1;const d=e.getFirstPosition(),h=a.schema.getLimitElement(d),f=h.getChild(0);return!(d.parent!=f||!e.containsEntireContent(f)||!a.schema.checkChild(h,"paragraph")||f.name=="paragraph")}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const gL="character",Xw="word",mL="codePoint",qn="selection",Eo="backward",qs="forward",xv={deleteContent:{unit:qn,direction:Eo},deleteContentBackward:{unit:mL,direction:Eo},deleteWordBackward:{unit:Xw,direction:Eo},deleteHardLineBackward:{unit:qn,direction:Eo},deleteSoftLineBackward:{unit:qn,direction:Eo},deleteContentForward:{unit:gL,direction:qs},deleteWordForward:{unit:Xw,direction:qs},deleteHardLineForward:{unit:qn,direction:qs},deleteSoftLineForward:{unit:qn,direction:qs}};class pL extends Ru{constructor(e){super(e);const i=e.document;let a=0;i.on("keydown",()=>{a++}),i.on("keyup",()=>{a=0}),i.on("beforeinput",(d,h)=>{if(!this.isEnabled)return;const{targetRanges:f,domEvent:b,inputType:k}=h,C=xv[k];if(!C)return;const y={direction:C.direction,unit:C.unit,sequence:a};y.unit==qn&&(y.selectionToRemove=e.createSelection(f[0])),k==="deleteContentBackward"&&(Ye.isAndroid&&(y.sequence=1),wL(f)&&(y.unit=qn,y.selectionToRemove=e.createSelection(f)));const P=new il(i,"delete",f[0]);i.fire(P,new sl(e,b,y)),P.stop.called&&d.stop()}),Ye.isBlink&&bL(this)}observe(){}stopObserving(){}}function bL(s){const e=s.view,i=e.document;let a=null,d=!1;i.on("keydown",(b,{keyCode:k})=>{a=k,d=!1}),i.on("keyup",(b,{keyCode:k,domEvent:C})=>{const y=i.selection,P=s.isEnabled&&k==a&&h(k)&&!y.isCollapsed&&!d;if(a=null,P){const R=y.getFirstRange(),D=new il(i,"delete",R),$={unit:qn,direction:f(k),selectionToRemove:y};i.fire(D,new sl(e,C,$))}}),i.on("beforeinput",(b,{inputType:k})=>{const C=xv[k];h(a)&&C&&C.direction==f(a)&&(d=!0)},{priority:"high"}),i.on("beforeinput",(b,{inputType:k,data:C})=>{a==qt.delete&&k=="insertText"&&C==""&&b.stop()},{priority:"high"});function h(b){return b==qt.backspace||b==qt.delete}function f(b){return b==qt.backspace?Eo:qs}}function wL(s){if(s.length!=1||s[0].isCollapsed)return!1;const e=s[0].getWalker({direction:"backward",singleCharacters:!0,ignoreElementEnd:!0});let i=0;for(const{nextPosition:a}of e){if(!a.parent.is("$text"))i++;else{const d=a.parent.data,h=a.offset;if(nv(d,h)||iv(d,h)||B5(d,h))continue;i++}if(i>1)return!0}return!1}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ev extends oe{static get pluginName(){return"Delete"}init(){const e=this.editor,i=e.editing.view,a=i.document,d=e.model.document;i.addObserver(pL),this._undoOnBackspace=!1;const h=new Qw(e,"forward");e.commands.add("deleteForward",h),e.commands.add("forwardDelete",h),e.commands.add("delete",new Qw(e,"backward")),this.listenTo(a,"delete",(f,b)=>{a.isComposing||b.preventDefault();const{direction:k,sequence:C,selectionToRemove:y,unit:P}=b,R=k==="forward"?"deleteForward":"delete",D={sequence:C};if(P=="selection"){const $=Array.from(y.getRanges()).map(Z=>e.editing.mapper.toModelRange(Z));D.selection=e.model.createSelection($)}else D.unit=P;e.execute(R,D),i.scrollToTheSelection()},{priority:"low"}),this.editor.plugins.has("UndoEditing")&&(this.listenTo(a,"delete",(f,b)=>{this._undoOnBackspace&&b.direction=="backward"&&b.sequence==1&&b.unit=="codePoint"&&(this._undoOnBackspace=!1,e.execute("undo"),b.preventDefault(),f.stop())},{context:"$capture"}),this.listenTo(d,"change",()=>{this._undoOnBackspace=!1}))}requestUndoOnBackspace(){this.editor.plugins.has("UndoEditing")&&(this._undoOnBackspace=!0)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class al extends pr{constructor(e=[]){super(e,{idProperty:"viewUid"}),this.on("add",(i,a,d)=>{this._renderViewIntoCollectionParent(a,d)}),this.on("remove",(i,a)=>{a.element&&this._parentElement&&a.element.remove()}),this._parentElement=null}destroy(){this.map(e=>e.destroy())}setParent(e){this._parentElement=e;for(const i of this)this._renderViewIntoCollectionParent(i)}delegate(...e){if(!e.length||!_L(e))throw new M("ui-viewcollection-delegate-wrong-events",this);return{to:i=>{for(const a of this)for(const d of e)a.delegate(d).to(i);this.on("add",(a,d)=>{for(const h of e)d.delegate(h).to(i)}),this.on("remove",(a,d)=>{for(const h of e)d.stopDelegating(h,i)})}}}_renderViewIntoCollectionParent(e,i){e.isRendered||e.render(),e.element&&this._parentElement&&this._parentElement.insertBefore(e.element,this._parentElement.children[i])}remove(e){return super.remove(e)}}function _L(s){return s.every(e=>typeof e=="string")}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class $t extends Ni(Ae()){constructor(e){super(),this.element=null,this.isRendered=!1,this.locale=e,this.t=e&&e.t,this._viewCollections=new pr,this._unboundChildren=this.createCollection(),this._viewCollections.on("add",(i,a)=>{a.locale=e,a.t=e&&e.t}),this.decorate("render")}get bindTemplate(){return this._bindTemplate?this._bindTemplate:this._bindTemplate=Ti.bind(this,this)}createCollection(e){const i=new al(e);return this._viewCollections.add(i),i}registerChild(e){$e(e)||(e=[e]);for(const i of e)this._unboundChildren.add(i)}deregisterChild(e){$e(e)||(e=[e]);for(const i of e)this._unboundChildren.remove(i)}setTemplate(e){this.template=new Ti(e)}extendTemplate(e){Ti.extend(this.template,e)}render(){if(this.isRendered)throw new M("ui-view-render-already-rendered",this);this.template&&(this.element=this.template.render(),this.registerChild(this.template.getViews())),this.isRendered=!0}destroy(){this.stopListening(),this._viewCollections.map(e=>e.destroy()),this.template&&this.template._revertData&&this.template.revert(this.element)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const kL="http://www.w3.org/1999/xhtml";class Ti extends wt(){constructor(e){super(),Object.assign(this,t_(Zw(e))),this._isRendered=!1,this._revertData=null}render(){const e=this._renderNode({intoFragment:!0});return this._isRendered=!0,e}apply(e){return this._revertData=i_(),this._renderNode({node:e,intoFragment:!1,isApplying:!0,revertData:this._revertData}),e}revert(e){if(!this._revertData)throw new M("ui-template-revert-not-applied",[this,e]);this._revertTemplateFromNode(e,this._revertData)}*getViews(){function*e(i){if(i.children)for(const a of i.children)Wa(a)?yield a:Lu(a)&&(yield*e(a))}yield*e(this)}static bind(e,i){return{to(a,d){return new vL({eventNameOrFunction:a,attribute:a,observable:e,emitter:i,callback:d})},if(a,d,h){return new Tv({observable:e,emitter:i,attribute:a,valueIfTrue:d,callback:h})}}}static extend(e,i){if(e._isRendered)throw new M("template-extend-render",[this,e]);Mv(e,t_(Zw(i)))}_renderNode(e){let i;if(e.node?i=this.tag&&this.text:i=this.tag?this.text:!this.text,i)throw new M("ui-template-wrong-syntax",this);return this.text?this._renderText(e):this._renderElement(e)}_renderElement(e){let i=e.node;return i||(i=e.node=document.createElementNS(this.ns||kL,this.tag)),this._renderAttributes(e),this._renderElementChildren(e),this._setUpListeners(e),i}_renderText(e){let i=e.node;return i?e.revertData.text=i.textContent:i=e.node=document.createTextNode(""),Ra(this.text)?this._bindToObservable({schema:this.text,updater:AL(i),data:e}):i.textContent=this.text.join(""),i}_renderAttributes(e){if(!this.attributes)return;const i=e.node,a=e.revertData;for(const d in this.attributes){const h=i.getAttribute(d),f=this.attributes[d];a&&(a.attributes[d]=h);const b=n_(f)?f[0].ns:null;if(Ra(f)){const k=n_(f)?f[0].value:f;a&&o_(d)&&k.unshift(h),this._bindToObservable({schema:k,updater:CL(i,d,b),data:e})}else if(d=="style"&&typeof f[0]!="string")this._renderStyleAttribute(f[0],e);else{a&&h&&o_(d)&&f.unshift(h);const k=f.map(C=>C&&(C.value||C)).reduce((C,y)=>C.concat(y),[]).reduce(Iv,"");Do(k)||i.setAttributeNS(b,d,k)}}}_renderStyleAttribute(e,i){const a=i.node;for(const d in e){const h=e[d];Ra(h)?this._bindToObservable({schema:[h],updater:xL(a,d),data:i}):a.style[d]=h}}_renderElementChildren(e){const i=e.node,a=e.intoFragment?document.createDocumentFragment():i,d=e.isApplying;let h=0;for(const f of this.children)if(Vu(f)){if(!d){f.setParent(i);for(const b of f)a.appendChild(b.element)}}else if(Wa(f))d||(f.isRendered||f.render(),a.appendChild(f.element));else if(za(f))a.appendChild(f);else if(d){const b=e.revertData,k=i_();b.children.push(k),f._renderNode({intoFragment:!1,node:a.childNodes[h++],isApplying:!0,revertData:k})}else a.appendChild(f.render());e.intoFragment&&i.appendChild(a)}_setUpListeners(e){if(this.eventListeners)for(const i in this.eventListeners){const a=this.eventListeners[i].map(d=>{const[h,f]=i.split("@");return d.activateDomEventListener(h,f,e)});e.revertData&&e.revertData.bindings.push(a)}}_bindToObservable({schema:e,updater:i,data:a}){const d=a.revertData;Sv(e,i,a);const h=e.filter(f=>!Do(f)).filter(f=>f.observable).map(f=>f.activateAttributeListener(e,i,a));d&&d.bindings.push(h)}_revertTemplateFromNode(e,i){for(const d of i.bindings)for(const h of d)h();if(i.text){e.textContent=i.text;return}const a=e;for(const d in i.attributes){const h=i.attributes[d];h===null?a.removeAttribute(d):a.setAttribute(d,h)}for(let d=0;d<i.children.length;++d)this._revertTemplateFromNode(a.childNodes[d],i.children[d])}}class br{constructor(e){this.attribute=e.attribute,this.observable=e.observable,this.emitter=e.emitter,this.callback=e.callback}getValue(e){const i=this.observable[this.attribute];return this.callback?this.callback(i,e):i}activateAttributeListener(e,i,a){const d=()=>Sv(e,i,a);return this.emitter.listenTo(this.observable,`change:${this.attribute}`,d),()=>{this.emitter.stopListening(this.observable,`change:${this.attribute}`,d)}}}class vL extends br{constructor(e){super(e),this.eventNameOrFunction=e.eventNameOrFunction}activateDomEventListener(e,i,a){const d=(h,f)=>{(!i||f.target.matches(i))&&(typeof this.eventNameOrFunction=="function"?this.eventNameOrFunction(f):this.observable.fire(this.eventNameOrFunction,f))};return this.emitter.listenTo(a.node,e,d),()=>{this.emitter.stopListening(a.node,e,d)}}}class Tv extends br{constructor(e){super(e),this.valueIfTrue=e.valueIfTrue}getValue(e){const i=super.getValue(e);return Do(i)?!1:this.valueIfTrue||!0}}function Ra(s){return s?(s.value&&(s=s.value),Array.isArray(s)?s.some(Ra):s instanceof br):!1}function yL(s,e){return s.map(i=>i instanceof br?i.getValue(e):i)}function Sv(s,e,{node:i}){const a=yL(s,i);let d;s.length==1&&s[0]instanceof Tv?d=a[0]:d=a.reduce(Iv,""),Do(d)?e.remove():e.set(d)}function AL(s){return{set(e){s.textContent=e},remove(){s.textContent=""}}}function CL(s,e,i){return{set(a){s.setAttributeNS(i,e,a)},remove(){s.removeAttributeNS(i,e)}}}function xL(s,e){return{set(i){s.style[e]=i},remove(){s.style[e]=null}}}function Zw(s){return sO(s,i=>{if(i&&(i instanceof br||Lu(i)||Wa(i)||Vu(i)))return i})}function t_(s){if(typeof s=="string"?s=SL(s):s.text&&PL(s),s.on&&(s.eventListeners=TL(s.on),delete s.on),!s.text){s.attributes&&EL(s.attributes);const e=[];if(s.children)if(Vu(s.children))e.push(s.children);else for(const i of s.children)Lu(i)||Wa(i)||za(i)?e.push(i):e.push(new Ti(i));s.children=e}return s}function EL(s){for(const e in s)s[e].value&&(s[e].value=ke(s[e].value)),Pv(s,e)}function TL(s){for(const e in s)Pv(s,e);return s}function SL(s){return{text:[s]}}function PL(s){s.text=ke(s.text)}function Pv(s,e){s[e]=ke(s[e])}function Iv(s,e){return Do(e)?s:Do(s)?e:`${s} ${e}`}function e_(s,e){for(const i in e)s[i]?s[i].push(...e[i]):s[i]=e[i]}function Mv(s,e){if(e.attributes&&(s.attributes||(s.attributes={}),e_(s.attributes,e.attributes)),e.eventListeners&&(s.eventListeners||(s.eventListeners={}),e_(s.eventListeners,e.eventListeners)),e.text&&s.text.push(...e.text),e.children&&e.children.length){if(s.children.length!=e.children.length)throw new M("ui-template-extend-children-mismatch",s);let i=0;for(const a of e.children)Mv(s.children[i++],a)}}function Do(s){return!s&&s!==0}function Wa(s){return s instanceof $t}function Lu(s){return s instanceof Ti}function Vu(s){return s instanceof al}function n_(s){return ge(s[0])&&s[0].ns}function i_(){return{children:[],bindings:[],attributes:{}}}function o_(s){return s=="class"||s=="style"}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Vi extends $t{constructor(){super();const e=this.bindTemplate;this.set("content",""),this.set("viewBox","0 0 20 20"),this.set("fillColor",""),this.set("isColorInherited",!0),this.set("isVisible",!0),this.setTemplate({tag:"svg",ns:"http://www.w3.org/2000/svg",attributes:{class:["ck","ck-icon",e.if("isVisible","ck-hidden",i=>!i),"ck-reset_all-excluded",e.if("isColorInherited","ck-icon_inherit-color")],viewBox:e.to("viewBox")}})}render(){super.render(),this._updateXMLContent(),this._colorFillPaths(),this.on("change:content",()=>{this._updateXMLContent(),this._colorFillPaths()}),this.on("change:fillColor",()=>{this._colorFillPaths()})}_updateXMLContent(){if(this.content){const i=new DOMParser().parseFromString(this.content.trim(),"image/svg+xml").querySelector("svg"),a=i.getAttribute("viewBox");a&&(this.viewBox=a);for(const{name:d,value:h}of Array.from(i.attributes))Vi.presentationalAttributeNames.includes(d)&&this.element.setAttribute(d,h);for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(;i.childNodes.length>0;)this.element.appendChild(i.childNodes[0])}}_colorFillPaths(){this.fillColor&&this.element.querySelectorAll(".ck-icon__fill").forEach(e=>{e.style.fill=this.fillColor})}}Vi.presentationalAttributeNames=["alignment-baseline","baseline-shift","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-rendering","cursor","direction","display","dominant-baseline","fill","fill-opacity","fill-rule","filter","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","image-rendering","letter-spacing","lighting-color","marker-end","marker-mid","marker-start","mask","opacity","overflow","paint-order","pointer-events","shape-rendering","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-anchor","text-decoration","text-overflow","text-rendering","transform","unicode-bidi","vector-effect","visibility","white-space","word-spacing","writing-mode"];/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class IL extends $t{constructor(){super(),this.set({style:void 0,text:void 0,id:void 0});const e=this.bindTemplate;this.setTemplate({tag:"span",attributes:{class:["ck","ck-button__label"],style:e.to("style"),id:e.to("id")},children:[{text:e.to("text")}]})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Bu extends $t{constructor(e,i=new IL){super(e),this._focusDelayed=null;const a=this.bindTemplate,d=Yn();this.set("ariaLabel",void 0),this.set("ariaLabelledBy",`ck-editor__aria-label_${d}`),this.set("class",void 0),this.set("labelStyle",void 0),this.set("icon",void 0),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isVisible",!0),this.set("isToggleable",!1),this.set("keystroke",void 0),this.set("label",void 0),this.set("role",void 0),this.set("tabindex",-1),this.set("tooltip",!1),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.set("withKeystroke",!1),this.children=this.createCollection(),this.labelView=this._setupLabelView(i),this.iconView=new Vi,this.iconView.extendTemplate({attributes:{class:"ck-button__icon"}}),this.keystrokeView=this._createKeystrokeView(),this.bind("_tooltipString").to(this,"tooltip",this,"label",this,"keystroke",this._getTooltipString.bind(this));const h={tag:"button",attributes:{class:["ck","ck-button",a.to("class"),a.if("isEnabled","ck-disabled",f=>!f),a.if("isVisible","ck-hidden",f=>!f),a.to("isOn",f=>f?"ck-on":"ck-off"),a.if("withText","ck-button_with-text"),a.if("withKeystroke","ck-button_with-keystroke")],role:a.to("role"),type:a.to("type",f=>f||"button"),tabindex:a.to("tabindex"),"aria-label":a.to("ariaLabel"),"aria-labelledby":a.to("ariaLabelledBy"),"aria-disabled":a.if("isEnabled",!0,f=>!f),"aria-pressed":a.to("isOn",f=>this.isToggleable?String(!!f):!1),"data-cke-tooltip-text":a.to("_tooltipString"),"data-cke-tooltip-position":a.to("tooltipPosition")},children:this.children,on:{click:a.to(f=>{this.isEnabled?this.fire("execute"):f.preventDefault()})}};Ye.isSafari&&(this._focusDelayed||(this._focusDelayed=O5(()=>this.focus(),0)),h.on.mousedown=a.to(()=>{this._focusDelayed()}),h.on.mouseup=a.to(()=>{this._focusDelayed.cancel()})),this.setTemplate(h)}render(){super.render(),this.icon&&(this.iconView.bind("content").to(this,"icon"),this.children.add(this.iconView)),this.children.add(this.labelView),this.withKeystroke&&this.keystroke&&this.children.add(this.keystrokeView)}focus(){this.element.focus()}destroy(){this._focusDelayed&&this._focusDelayed.cancel(),super.destroy()}_setupLabelView(e){return e.bind("text","style","id").to(this,"label","labelStyle","ariaLabelledBy"),e}_createKeystrokeView(){const e=new $t;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__keystroke"]},children:[{text:this.bindTemplate.to("keystroke",i=>Tw(i))}]}),e}_getTooltipString(e,i,a){return e?typeof e=="string"?e:(a&&(a=Tw(a)),e instanceof Function?e(i,a):`${i}${a?` (${a})`:""}`):""}}var ML={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};const lr=ML,Rv={};for(const s of Object.keys(lr))Rv[lr[s]]=s;const Y={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};var Ov=Y;for(const s of Object.keys(Y)){if(!("channels"in Y[s]))throw new Error("missing channels property: "+s);if(!("labels"in Y[s]))throw new Error("missing channel labels property: "+s);if(Y[s].labels.length!==Y[s].channels)throw new Error("channel and label counts mismatch: "+s);const{channels:e,labels:i}=Y[s];delete Y[s].channels,delete Y[s].labels,Object.defineProperty(Y[s],"channels",{value:e}),Object.defineProperty(Y[s],"labels",{value:i})}Y.rgb.hsl=function(s){const e=s[0]/255,i=s[1]/255,a=s[2]/255,d=Math.min(e,i,a),h=Math.max(e,i,a),f=h-d;let b,k;h===d?b=0:e===h?b=(i-a)/f:i===h?b=2+(a-e)/f:a===h&&(b=4+(e-i)/f),b=Math.min(b*60,360),b<0&&(b+=360);const C=(d+h)/2;return h===d?k=0:C<=.5?k=f/(h+d):k=f/(2-h-d),[b,k*100,C*100]};Y.rgb.hsv=function(s){let e,i,a,d,h;const f=s[0]/255,b=s[1]/255,k=s[2]/255,C=Math.max(f,b,k),y=C-Math.min(f,b,k),P=function(R){return(C-R)/6/y+1/2};return y===0?(d=0,h=0):(h=y/C,e=P(f),i=P(b),a=P(k),f===C?d=a-i:b===C?d=1/3+e-a:k===C&&(d=2/3+i-e),d<0?d+=1:d>1&&(d-=1)),[d*360,h*100,C*100]};Y.rgb.hwb=function(s){const e=s[0],i=s[1];let a=s[2];const d=Y.rgb.hsl(s)[0],h=1/255*Math.min(e,Math.min(i,a));return a=1-1/255*Math.max(e,Math.max(i,a)),[d,h*100,a*100]};Y.rgb.cmyk=function(s){const e=s[0]/255,i=s[1]/255,a=s[2]/255,d=Math.min(1-e,1-i,1-a),h=(1-e-d)/(1-d)||0,f=(1-i-d)/(1-d)||0,b=(1-a-d)/(1-d)||0;return[h*100,f*100,b*100,d*100]};function RL(s,e){return(s[0]-e[0])**2+(s[1]-e[1])**2+(s[2]-e[2])**2}Y.rgb.keyword=function(s){const e=Rv[s];if(e)return e;let i=1/0,a;for(const d of Object.keys(lr)){const h=lr[d],f=RL(s,h);f<i&&(i=f,a=d)}return a};Y.keyword.rgb=function(s){return lr[s]};Y.rgb.xyz=function(s){let e=s[0]/255,i=s[1]/255,a=s[2]/255;e=e>.04045?((e+.055)/1.055)**2.4:e/12.92,i=i>.04045?((i+.055)/1.055)**2.4:i/12.92,a=a>.04045?((a+.055)/1.055)**2.4:a/12.92;const d=e*.4124+i*.3576+a*.1805,h=e*.2126+i*.7152+a*.0722,f=e*.0193+i*.1192+a*.9505;return[d*100,h*100,f*100]};Y.rgb.lab=function(s){const e=Y.rgb.xyz(s);let i=e[0],a=e[1],d=e[2];i/=95.047,a/=100,d/=108.883,i=i>.008856?i**(1/3):7.787*i+16/116,a=a>.008856?a**(1/3):7.787*a+16/116,d=d>.008856?d**(1/3):7.787*d+16/116;const h=116*a-16,f=500*(i-a),b=200*(a-d);return[h,f,b]};Y.hsl.rgb=function(s){const e=s[0]/360,i=s[1]/100,a=s[2]/100;let d,h,f;if(i===0)return f=a*255,[f,f,f];a<.5?d=a*(1+i):d=a+i-a*i;const b=2*a-d,k=[0,0,0];for(let C=0;C<3;C++)h=e+1/3*-(C-1),h<0&&h++,h>1&&h--,6*h<1?f=b+(d-b)*6*h:2*h<1?f=d:3*h<2?f=b+(d-b)*(2/3-h)*6:f=b,k[C]=f*255;return k};Y.hsl.hsv=function(s){const e=s[0];let i=s[1]/100,a=s[2]/100,d=i;const h=Math.max(a,.01);a*=2,i*=a<=1?a:2-a,d*=h<=1?h:2-h;const f=(a+i)/2,b=a===0?2*d/(h+d):2*i/(a+i);return[e,b*100,f*100]};Y.hsv.rgb=function(s){const e=s[0]/60,i=s[1]/100;let a=s[2]/100;const d=Math.floor(e)%6,h=e-Math.floor(e),f=255*a*(1-i),b=255*a*(1-i*h),k=255*a*(1-i*(1-h));switch(a*=255,d){case 0:return[a,k,f];case 1:return[b,a,f];case 2:return[f,a,k];case 3:return[f,b,a];case 4:return[k,f,a];case 5:return[a,f,b]}};Y.hsv.hsl=function(s){const e=s[0],i=s[1]/100,a=s[2]/100,d=Math.max(a,.01);let h,f;f=(2-i)*a;const b=(2-i)*d;return h=i*d,h/=b<=1?b:2-b,h=h||0,f/=2,[e,h*100,f*100]};Y.hwb.rgb=function(s){const e=s[0]/360;let i=s[1]/100,a=s[2]/100;const d=i+a;let h;d>1&&(i/=d,a/=d);const f=Math.floor(6*e),b=1-a;h=6*e-f,f&1&&(h=1-h);const k=i+h*(b-i);let C,y,P;switch(f){default:case 6:case 0:C=b,y=k,P=i;break;case 1:C=k,y=b,P=i;break;case 2:C=i,y=b,P=k;break;case 3:C=i,y=k,P=b;break;case 4:C=k,y=i,P=b;break;case 5:C=b,y=i,P=k;break}return[C*255,y*255,P*255]};Y.cmyk.rgb=function(s){const e=s[0]/100,i=s[1]/100,a=s[2]/100,d=s[3]/100,h=1-Math.min(1,e*(1-d)+d),f=1-Math.min(1,i*(1-d)+d),b=1-Math.min(1,a*(1-d)+d);return[h*255,f*255,b*255]};Y.xyz.rgb=function(s){const e=s[0]/100,i=s[1]/100,a=s[2]/100;let d,h,f;return d=e*3.2406+i*-1.5372+a*-.4986,h=e*-.9689+i*1.8758+a*.0415,f=e*.0557+i*-.204+a*1.057,d=d>.0031308?1.055*d**(1/2.4)-.055:d*12.92,h=h>.0031308?1.055*h**(1/2.4)-.055:h*12.92,f=f>.0031308?1.055*f**(1/2.4)-.055:f*12.92,d=Math.min(Math.max(0,d),1),h=Math.min(Math.max(0,h),1),f=Math.min(Math.max(0,f),1),[d*255,h*255,f*255]};Y.xyz.lab=function(s){let e=s[0],i=s[1],a=s[2];e/=95.047,i/=100,a/=108.883,e=e>.008856?e**(1/3):7.787*e+16/116,i=i>.008856?i**(1/3):7.787*i+16/116,a=a>.008856?a**(1/3):7.787*a+16/116;const d=116*i-16,h=500*(e-i),f=200*(i-a);return[d,h,f]};Y.lab.xyz=function(s){const e=s[0],i=s[1],a=s[2];let d,h,f;h=(e+16)/116,d=i/500+h,f=h-a/200;const b=h**3,k=d**3,C=f**3;return h=b>.008856?b:(h-16/116)/7.787,d=k>.008856?k:(d-16/116)/7.787,f=C>.008856?C:(f-16/116)/7.787,d*=95.047,h*=100,f*=108.883,[d,h,f]};Y.lab.lch=function(s){const e=s[0],i=s[1],a=s[2];let d;d=Math.atan2(a,i)*360/2/Math.PI,d<0&&(d+=360);const f=Math.sqrt(i*i+a*a);return[e,f,d]};Y.lch.lab=function(s){const e=s[0],i=s[1],d=s[2]/360*2*Math.PI,h=i*Math.cos(d),f=i*Math.sin(d);return[e,h,f]};Y.rgb.ansi16=function(s,e=null){const[i,a,d]=s;let h=e===null?Y.rgb.hsv(s)[2]:e;if(h=Math.round(h/50),h===0)return 30;let f=30+(Math.round(d/255)<<2|Math.round(a/255)<<1|Math.round(i/255));return h===2&&(f+=60),f};Y.hsv.ansi16=function(s){return Y.rgb.ansi16(Y.hsv.rgb(s),s[2])};Y.rgb.ansi256=function(s){const e=s[0],i=s[1],a=s[2];return e===i&&i===a?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(i/255*5)+Math.round(a/255*5)};Y.ansi16.rgb=function(s){let e=s%10;if(e===0||e===7)return s>50&&(e+=3.5),e=e/10.5*255,[e,e,e];const i=(~~(s>50)+1)*.5,a=(e&1)*i*255,d=(e>>1&1)*i*255,h=(e>>2&1)*i*255;return[a,d,h]};Y.ansi256.rgb=function(s){if(s>=232){const h=(s-232)*10+8;return[h,h,h]}s-=16;let e;const i=Math.floor(s/36)/5*255,a=Math.floor((e=s%36)/6)/5*255,d=e%6/5*255;return[i,a,d]};Y.rgb.hex=function(s){const i=(((Math.round(s[0])&255)<<16)+((Math.round(s[1])&255)<<8)+(Math.round(s[2])&255)).toString(16).toUpperCase();return"000000".substring(i.length)+i};Y.hex.rgb=function(s){const e=s.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!e)return[0,0,0];let i=e[0];e[0].length===3&&(i=i.split("").map(b=>b+b).join(""));const a=parseInt(i,16),d=a>>16&255,h=a>>8&255,f=a&255;return[d,h,f]};Y.rgb.hcg=function(s){const e=s[0]/255,i=s[1]/255,a=s[2]/255,d=Math.max(Math.max(e,i),a),h=Math.min(Math.min(e,i),a),f=d-h;let b,k;return f<1?b=h/(1-f):b=0,f<=0?k=0:d===e?k=(i-a)/f%6:d===i?k=2+(a-e)/f:k=4+(e-i)/f,k/=6,k%=1,[k*360,f*100,b*100]};Y.hsl.hcg=function(s){const e=s[1]/100,i=s[2]/100,a=i<.5?2*e*i:2*e*(1-i);let d=0;return a<1&&(d=(i-.5*a)/(1-a)),[s[0],a*100,d*100]};Y.hsv.hcg=function(s){const e=s[1]/100,i=s[2]/100,a=e*i;let d=0;return a<1&&(d=(i-a)/(1-a)),[s[0],a*100,d*100]};Y.hcg.rgb=function(s){const e=s[0]/360,i=s[1]/100,a=s[2]/100;if(i===0)return[a*255,a*255,a*255];const d=[0,0,0],h=e%1*6,f=h%1,b=1-f;let k=0;switch(Math.floor(h)){case 0:d[0]=1,d[1]=f,d[2]=0;break;case 1:d[0]=b,d[1]=1,d[2]=0;break;case 2:d[0]=0,d[1]=1,d[2]=f;break;case 3:d[0]=0,d[1]=b,d[2]=1;break;case 4:d[0]=f,d[1]=0,d[2]=1;break;default:d[0]=1,d[1]=0,d[2]=b}return k=(1-i)*a,[(i*d[0]+k)*255,(i*d[1]+k)*255,(i*d[2]+k)*255]};Y.hcg.hsv=function(s){const e=s[1]/100,i=s[2]/100,a=e+i*(1-e);let d=0;return a>0&&(d=e/a),[s[0],d*100,a*100]};Y.hcg.hsl=function(s){const e=s[1]/100,a=s[2]/100*(1-e)+.5*e;let d=0;return a>0&&a<.5?d=e/(2*a):a>=.5&&a<1&&(d=e/(2*(1-a))),[s[0],d*100,a*100]};Y.hcg.hwb=function(s){const e=s[1]/100,i=s[2]/100,a=e+i*(1-e);return[s[0],(a-e)*100,(1-a)*100]};Y.hwb.hcg=function(s){const e=s[1]/100,a=1-s[2]/100,d=a-e;let h=0;return d<1&&(h=(a-d)/(1-d)),[s[0],d*100,h*100]};Y.apple.rgb=function(s){return[s[0]/65535*255,s[1]/65535*255,s[2]/65535*255]};Y.rgb.apple=function(s){return[s[0]/255*65535,s[1]/255*65535,s[2]/255*65535]};Y.gray.rgb=function(s){return[s[0]/100*255,s[0]/100*255,s[0]/100*255]};Y.gray.hsl=function(s){return[0,0,s[0]]};Y.gray.hsv=Y.gray.hsl;Y.gray.hwb=function(s){return[0,100,s[0]]};Y.gray.cmyk=function(s){return[0,0,0,s[0]]};Y.gray.lab=function(s){return[s[0],0,0]};Y.gray.hex=function(s){const e=Math.round(s[0]/100*255)&255,a=((e<<16)+(e<<8)+e).toString(16).toUpperCase();return"000000".substring(a.length)+a};Y.rgb.gray=function(s){return[(s[0]+s[1]+s[2])/3/255*100]};const qa=Ov;function OL(){const s={},e=Object.keys(qa);for(let i=e.length,a=0;a<i;a++)s[e[a]]={distance:-1,parent:null};return s}function NL(s){const e=OL(),i=[s];for(e[s].distance=0;i.length;){const a=i.pop(),d=Object.keys(qa[a]);for(let h=d.length,f=0;f<h;f++){const b=d[f],k=e[b];k.distance===-1&&(k.distance=e[a].distance+1,k.parent=a,i.unshift(b))}}return e}function DL(s,e){return function(i){return e(s(i))}}function LL(s,e){const i=[e[s].parent,s];let a=qa[e[s].parent][s],d=e[s].parent;for(;e[d].parent;)i.unshift(e[d].parent),a=DL(qa[e[d].parent][d],a),d=e[d].parent;return a.conversion=i,a}var VL=function(s){const e=NL(s),i={},a=Object.keys(e);for(let d=a.length,h=0;h<d;h++){const f=a[h];e[f].parent!==null&&(i[f]=LL(f,e))}return i};const au=Ov,BL=VL,ws={},FL=Object.keys(au);function zL(s){const e=function(...i){const a=i[0];return a==null?a:(a.length>1&&(i=a),s(i))};return"conversion"in s&&(e.conversion=s.conversion),e}function jL(s){const e=function(...i){const a=i[0];if(a==null)return a;a.length>1&&(i=a);const d=s(i);if(typeof d=="object")for(let h=d.length,f=0;f<h;f++)d[f]=Math.round(d[f]);return d};return"conversion"in s&&(e.conversion=s.conversion),e}FL.forEach(s=>{ws[s]={},Object.defineProperty(ws[s],"channels",{value:au[s].channels}),Object.defineProperty(ws[s],"labels",{value:au[s].labels});const e=BL(s);Object.keys(e).forEach(a=>{const d=e[a];ws[s][a]=jL(d),ws[s][a].raw=zL(d)})});/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class $L extends $t{constructor(e){super(e),this.set("text",void 0),this.set("for",void 0),this.id=`ck-editor__label_${Yn()}`;const i=this.bindTemplate;this.setTemplate({tag:"label",attributes:{class:["ck","ck-label"],id:this.id,for:i.to("for")},children:[{text:i.to("text")}]})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class HL extends $t{constructor(e,i){super(e);const a=`ck-labeled-field-view-${Yn()}`,d=`ck-labeled-field-view-status-${Yn()}`;this.fieldView=i(this,a,d),this.set("label",void 0),this.set("isEnabled",!0),this.set("isEmpty",!0),this.set("isFocused",!1),this.set("errorText",null),this.set("infoText",null),this.set("class",void 0),this.set("placeholder",void 0),this.labelView=this._createLabelView(a),this.statusView=this._createStatusView(d),this.fieldWrapperChildren=this.createCollection([this.fieldView,this.labelView]),this.bind("_statusText").to(this,"errorText",this,"infoText",(f,b)=>f||b);const h=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view",h.to("class"),h.if("isEnabled","ck-disabled",f=>!f),h.if("isEmpty","ck-labeled-field-view_empty"),h.if("isFocused","ck-labeled-field-view_focused"),h.if("placeholder","ck-labeled-field-view_placeholder"),h.if("errorText","ck-error")]},children:[{tag:"div",attributes:{class:["ck","ck-labeled-field-view__input-wrapper"]},children:this.fieldWrapperChildren},this.statusView]})}_createLabelView(e){const i=new $L(this.locale);return i.for=e,i.bind("text").to(this,"label"),i}_createStatusView(e){const i=new $t(this.locale),a=this.bindTemplate;return i.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view__status",a.if("errorText","ck-labeled-field-view__status_error"),a.if("_statusText","ck-hidden",d=>!d)],id:e,role:a.if("errorText","alert")},children:[{text:a.to("_statusText")}]}),i}focus(e){this.fieldView.focus(e)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class WL extends $t{constructor(e){super(e),this.set("value",void 0),this.set("id",void 0),this.set("placeholder",void 0),this.set("isReadOnly",!1),this.set("hasError",!1),this.set("ariaDescribedById",void 0),this.focusTracker=new jo,this.bind("isFocused").to(this.focusTracker),this.set("isEmpty",!0);const i=this.bindTemplate;this.setTemplate({tag:"input",attributes:{class:["ck","ck-input",i.if("isFocused","ck-input_focused"),i.if("isEmpty","ck-input-text_empty"),i.if("hasError","ck-error")],id:i.to("id"),placeholder:i.to("placeholder"),readonly:i.to("isReadOnly"),"aria-invalid":i.if("hasError",!0),"aria-describedby":i.to("ariaDescribedById")},on:{input:i.to((...a)=>{this.fire("input",...a),this._updateIsEmpty()}),change:i.to(this._updateIsEmpty.bind(this))}})}render(){super.render(),this.focusTracker.add(this.element),this._setDomElementValue(this.value),this._updateIsEmpty(),this.on("change:value",(e,i,a)=>{this._setDomElementValue(a),this._updateIsEmpty()})}destroy(){super.destroy(),this.focusTracker.destroy()}select(){this.element.select()}focus(){this.element.focus()}reset(){this.value=this.element.value="",this._updateIsEmpty()}_updateIsEmpty(){this.isEmpty=qL(this.element)}_setDomElementValue(e){this.element.value=!e&&e!==0?"":e}}function qL(s){return!s.value}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class UL extends WL{constructor(e){super(e),this.set("inputMode","text");const i=this.bindTemplate;this.extendTemplate({attributes:{inputmode:i.to("inputMode")}})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class GL extends UL{constructor(e){super(e),this.extendTemplate({attributes:{type:"text",class:["ck-input-text"]}})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class cr extends $t{constructor(e,i,a){super(e);const d=this.bindTemplate;this.buttonView=i,this.panelView=a,this.set("isOpen",!1),this.set("isEnabled",!0),this.set("class",void 0),this.set("id",void 0),this.set("panelPosition","auto"),this.panelView.bind("isVisible").to(this,"isOpen"),this.keystrokes=new el,this.focusTracker=new jo,this.setTemplate({tag:"div",attributes:{class:["ck","ck-dropdown",d.to("class"),d.if("isEnabled","ck-disabled",h=>!h)],id:d.to("id"),"aria-describedby":d.to("ariaDescribedById")},children:[i,a]}),i.extendTemplate({attributes:{class:["ck-dropdown__button"],"data-cke-tooltip-disabled":d.to("isOpen")}})}render(){super.render(),this.focusTracker.add(this.buttonView.element),this.focusTracker.add(this.panelView.element),this.listenTo(this.buttonView,"open",()=>{this.isOpen=!this.isOpen}),this.on("change:isOpen",(i,a,d)=>{if(d)if(this.panelPosition==="auto"){const h=cr._getOptimalPosition({element:this.panelView.element,target:this.buttonView.element,fitInViewport:!0,positions:this._panelPositions});this.panelView.position=h?h.name:this._panelPositions[0].name}else this.panelView.position=this.panelPosition}),this.keystrokes.listenTo(this.element);const e=(i,a)=>{this.isOpen&&(this.isOpen=!1,a())};this.keystrokes.set("arrowdown",(i,a)=>{this.buttonView.isEnabled&&!this.isOpen&&(this.isOpen=!0,a())}),this.keystrokes.set("arrowright",(i,a)=>{this.isOpen&&a()}),this.keystrokes.set("arrowleft",e),this.keystrokes.set("esc",e)}focus(){this.buttonView.focus()}get _panelPositions(){const{south:e,north:i,southEast:a,southWest:d,northEast:h,northWest:f,southMiddleEast:b,southMiddleWest:k,northMiddleEast:C,northMiddleWest:y}=cr.defaultPanelPositions;return this.locale.uiLanguageDirection!=="rtl"?[a,d,b,k,e,h,f,C,y,i]:[d,a,k,b,e,f,h,y,C,i]}}cr.defaultPanelPositions={south:(s,e)=>({top:s.bottom,left:s.left-(e.width-s.width)/2,name:"s"}),southEast:s=>({top:s.bottom,left:s.left,name:"se"}),southWest:(s,e)=>({top:s.bottom,left:s.left-e.width+s.width,name:"sw"}),southMiddleEast:(s,e)=>({top:s.bottom,left:s.left-(e.width-s.width)/4,name:"sme"}),southMiddleWest:(s,e)=>({top:s.bottom,left:s.left-(e.width-s.width)*3/4,name:"smw"}),north:(s,e)=>({top:s.top-e.height,left:s.left-(e.width-s.width)/2,name:"n"}),northEast:(s,e)=>({top:s.top-e.height,left:s.left,name:"ne"}),northWest:(s,e)=>({top:s.top-e.height,left:s.left-e.width+s.width,name:"nw"}),northMiddleEast:(s,e)=>({top:s.top-e.height,left:s.left-(e.width-s.width)/4,name:"nme"}),northMiddleWest:(s,e)=>({top:s.top-e.height,left:s.left-(e.width-s.width)*3/4,name:"nmw"})};cr._getOptimalPosition=Tu;/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class wr extends wt(){constructor(e){if(super(),this.focusables=e.focusables,this.focusTracker=e.focusTracker,this.keystrokeHandler=e.keystrokeHandler,this.actions=e.actions,e.actions&&e.keystrokeHandler)for(const i in e.actions){let a=e.actions[i];typeof a=="string"&&(a=[a]);for(const d of a)e.keystrokeHandler.set(d,(h,f)=>{this[i](),f()})}this.on("forwardCycle",()=>this.focusFirst(),{priority:"low"}),this.on("backwardCycle",()=>this.focusLast(),{priority:"low"})}get first(){return this.focusables.find(Id)||null}get last(){return this.focusables.filter(Id).slice(-1)[0]||null}get next(){return this._getDomFocusableItem(1)}get previous(){return this._getDomFocusableItem(-1)}get current(){let e=null;return this.focusTracker.focusedElement===null?null:(this.focusables.find((i,a)=>{const d=i.element===this.focusTracker.focusedElement;return d&&(e=a),d}),e)}focusFirst(){this._focus(this.first,1)}focusLast(){this._focus(this.last,-1)}focusNext(){const e=this.next;if(e&&this.focusables.getIndex(e)===this.current){this.fire("forwardCycle");return}e===this.first?this.fire("forwardCycle"):this._focus(e,1)}focusPrevious(){const e=this.previous;if(e&&this.focusables.getIndex(e)===this.current){this.fire("backwardCycle");return}e===this.last?this.fire("backwardCycle"):this._focus(e,-1)}_focus(e,i){e&&this.focusTracker.focusedElement!==e.element&&e.focus(i)}_getDomFocusableItem(e){const i=this.focusables.length;if(!i)return null;const a=this.current;if(a===null)return this[e===1?"first":"last"];let d=this.focusables.get(a),h=(a+i+e)%i;do{const f=this.focusables.get(h);if(Id(f)){d=f;break}h=(h+i+e)%i}while(h!==a);return d}}function Id(s){return Fu(s)&&tu(s.element)}function Fu(s){return"focus"in s&&typeof s.focus=="function"}function KL(s){return Fu(s)&&"focusCycler"in s&&s.focusCycler instanceof wr}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const YL=(s,e,i)=>{const a=new GL(s.locale);return a.set({id:e,ariaDescribedById:i}),a.bind("isReadOnly").to(s,"isEnabled",d=>!d),a.bind("hasError").to(s,"errorText",d=>!!d),a.on("input",()=>{s.errorText=null}),s.bind("isEmpty","isFocused","placeholder").to(a),a},dr=(s,e=0,i=1)=>s>i?i:s<e?e:s,ne=(s,e=0,i=Math.pow(10,e))=>Math.round(i*s)/i,JL=s=>eV(lu(s)),lu=s=>(s[0]==="#"&&(s=s.substring(1)),s.length<6?{r:parseInt(s[0]+s[0],16),g:parseInt(s[1]+s[1],16),b:parseInt(s[2]+s[2],16),a:s.length===4?ne(parseInt(s[3]+s[3],16)/255,2):1}:{r:parseInt(s.substring(0,2),16),g:parseInt(s.substring(2,4),16),b:parseInt(s.substring(4,6),16),a:s.length===8?ne(parseInt(s.substring(6,8),16)/255,2):1}),QL=s=>tV(ZL(s)),XL=({h:s,s:e,v:i,a})=>{const d=(200-e)*i/100;return{h:ne(s),s:ne(d>0&&d<200?e*i/100/(d<=100?d:200-d)*100:0),l:ne(d/2),a:ne(a,2)}},cu=s=>{const{h:e,s:i,l:a}=XL(s);return`hsl(${e}, ${i}%, ${a}%)`},ZL=({h:s,s:e,v:i,a})=>{s=s/360*6,e=e/100,i=i/100;const d=Math.floor(s),h=i*(1-e),f=i*(1-(s-d)*e),b=i*(1-(1-s+d)*e),k=d%6;return{r:ne([i,f,h,h,b,i][k]*255),g:ne([b,i,i,f,h,h][k]*255),b:ne([h,h,b,i,i,f][k]*255),a:ne(a,2)}},Aa=s=>{const e=s.toString(16);return e.length<2?"0"+e:e},tV=({r:s,g:e,b:i,a})=>{const d=a<1?Aa(ne(a*255)):"";return"#"+Aa(s)+Aa(e)+Aa(i)+d},eV=({r:s,g:e,b:i,a})=>{const d=Math.max(s,e,i),h=d-Math.min(s,e,i),f=h?d===s?(e-i)/h:d===e?2+(i-s)/h:4+(s-e)/h:0;return{h:ne(60*(f<0?f+6:f)),s:ne(d?h/d*100:0),v:ne(d/255*100),a}},Nv=(s,e)=>{if(s===e)return!0;for(const i in s)if(s[i]!==e[i])return!1;return!0},nV=(s,e)=>s.toLowerCase()===e.toLowerCase()?!0:Nv(lu(s),lu(e)),s_={},Dv=s=>{let e=s_[s];return e||(e=document.createElement("template"),e.innerHTML=s,s_[s]=e),e},zu=(s,e,i)=>{s.dispatchEvent(new CustomEvent(e,{bubbles:!0,detail:i}))};let Mo=!1;const du=s=>"touches"in s,iV=s=>Mo&&!du(s)?!1:(Mo||(Mo=du(s)),!0),r_=(s,e)=>{const i=du(e)?e.touches[0]:e,a=s.el.getBoundingClientRect();zu(s.el,"move",s.getMove({x:dr((i.pageX-(a.left+window.pageXOffset))/a.width),y:dr((i.pageY-(a.top+window.pageYOffset))/a.height)}))},oV=(s,e)=>{const i=e.keyCode;i>40||s.xy&&i<37||i<33||(e.preventDefault(),zu(s.el,"move",s.getMove({x:i===39?.01:i===37?-.01:i===34?.05:i===33?-.05:i===35?1:i===36?-1:0,y:i===40?.01:i===38?-.01:0},!0)))};class Lv{constructor(e,i,a,d){const h=Dv(`<div role="slider" tabindex="0" part="${i}" ${a}><div part="${i}-pointer"></div></div>`);e.appendChild(h.content.cloneNode(!0));const f=e.querySelector(`[part=${i}]`);f.addEventListener("mousedown",this),f.addEventListener("touchstart",this),f.addEventListener("keydown",this),this.el=f,this.xy=d,this.nodes=[f.firstChild,f]}set dragging(e){const i=e?document.addEventListener:document.removeEventListener;i(Mo?"touchmove":"mousemove",this),i(Mo?"touchend":"mouseup",this)}handleEvent(e){switch(e.type){case"mousedown":case"touchstart":if(e.preventDefault(),!iV(e)||!Mo&&e.button!=0)return;this.el.focus(),r_(this,e),this.dragging=!0;break;case"mousemove":case"touchmove":e.preventDefault(),r_(this,e);break;case"mouseup":case"touchend":this.dragging=!1;break;case"keydown":oV(this,e);break}}style(e){e.forEach((i,a)=>{for(const d in i)this.nodes[a].style.setProperty(d,i[d])})}}class sV extends Lv{constructor(e){super(e,"hue",'aria-label="Hue" aria-valuemin="0" aria-valuemax="360"',!1)}update({h:e}){this.h=e,this.style([{left:`${e/360*100}%`,color:cu({h:e,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuenow",`${ne(e)}`)}getMove(e,i){return{h:i?dr(this.h+e.x*360,0,360):360*e.x}}}class rV extends Lv{constructor(e){super(e,"saturation",'aria-label="Color"',!0)}update(e){this.hsva=e,this.style([{top:`${100-e.v}%`,left:`${e.s}%`,color:cu(e)},{"background-color":cu({h:e.h,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuetext",`Saturation ${ne(e.s)}%, Brightness ${ne(e.v)}%`)}getMove(e,i){return{s:i?dr(this.hsva.s+e.x*100,0,100):e.x*100,v:i?dr(this.hsva.v-e.y*100,0,100):Math.round(100-e.y*100)}}}const aV=':host{display:flex;flex-direction:column;position:relative;width:200px;height:200px;user-select:none;-webkit-user-select:none;cursor:default}:host([hidden]){display:none!important}[role=slider]{position:relative;touch-action:none;user-select:none;-webkit-user-select:none;outline:0}[role=slider]:last-child{border-radius:0 0 8px 8px}[part$=pointer]{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;display:flex;place-content:center center;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}[part$=pointer]::after{content:"";width:100%;height:100%;border-radius:inherit;background-color:currentColor}[role=slider]:focus [part$=pointer]{transform:translate(-50%,-50%) scale(1.1)}',lV="[part=hue]{flex:0 0 24px;background:linear-gradient(to right,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red 100%)}[part=hue-pointer]{top:50%;z-index:2}",cV="[part=saturation]{flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(to top,#000,transparent),linear-gradient(to right,#fff,rgba(255,255,255,0));box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}[part=saturation-pointer]{z-index:3}",Ca=Symbol("same"),Md=Symbol("color"),a_=Symbol("hsva"),Rd=Symbol("update"),l_=Symbol("parts"),c_=Symbol("css"),d_=Symbol("sliders");class dV extends HTMLElement{static get observedAttributes(){return["color"]}get[c_](){return[aV,lV,cV]}get[d_](){return[rV,sV]}get color(){return this[Md]}set color(e){if(!this[Ca](e)){const i=this.colorModel.toHsva(e);this[Rd](i),this[Md]=e}}constructor(){super();const e=Dv(`<style>${this[c_].join("")}</style>`),i=this.attachShadow({mode:"open"});i.appendChild(e.content.cloneNode(!0)),i.addEventListener("move",this),this[l_]=this[d_].map(a=>new a(i))}connectedCallback(){if(this.hasOwnProperty("color")){const e=this.color;delete this.color,this.color=e}else this.color||(this.color=this.colorModel.defaultColor)}attributeChangedCallback(e,i,a){const d=this.colorModel.fromAttr(a);this[Ca](d)||(this.color=d)}handleEvent(e){const i=this[a_],a={...i,...e.detail};this[Rd](a);let d;!Nv(a,i)&&!this[Ca](d=this.colorModel.fromHsva(a))&&(this[Md]=d,zu(this,"color-changed",{value:d}))}[Ca](e){return this.color&&this.colorModel.equal(e,this.color)}[Rd](e){this[a_]=e,this[l_].forEach(i=>i.update(e))}}const uV={defaultColor:"#000",toHsva:JL,fromHsva:({h:s,s:e,v:i})=>QL({h:s,s:e,v:i,a:1}),equal:nV,fromAttr:s=>s};class hV extends dV{get colorModel(){return uV}}class fV extends hV{}customElements.define("hex-color-picker",fV);/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class gV extends $t{constructor(e,i={}){super(e);const a=this.bindTemplate;this.set("label",i.label||""),this.set("class",i.class||null),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-form__header",a.to("class")]},children:this.children}),i.icon&&(this.iconView=new Vi,this.iconView.content=i.icon,this.children.add(this.iconView));const d=new $t(e);d.setTemplate({tag:"h2",attributes:{class:["ck","ck-form__header__label"]},children:[{text:a.to("label")}]}),this.children.add(d)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function mV(s){class e extends s{constructor(...a){super(...a),this._onDragBound=this._onDrag.bind(this),this._onDragEndBound=this._onDragEnd.bind(this),this._lastDraggingCoordinates={x:0,y:0},this.on("render",()=>{this._attachListeners()}),this.set("isDragging",!1)}_attachListeners(){this.listenTo(this.element,"mousedown",this._onDragStart.bind(this)),this.listenTo(this.element,"touchstart",this._onDragStart.bind(this))}_attachDragListeners(){this.listenTo(ct.document,"mouseup",this._onDragEndBound),this.listenTo(ct.document,"touchend",this._onDragEndBound),this.listenTo(ct.document,"mousemove",this._onDragBound),this.listenTo(ct.document,"touchmove",this._onDragBound)}_detachDragListeners(){this.stopListening(ct.document,"mouseup",this._onDragEndBound),this.stopListening(ct.document,"touchend",this._onDragEndBound),this.stopListening(ct.document,"mousemove",this._onDragBound),this.stopListening(ct.document,"touchmove",this._onDragBound)}_onDragStart(a,d){if(!this._isHandleElementPressed(d))return;this._attachDragListeners();let h=0,f=0;d instanceof MouseEvent?(h=d.clientX,f=d.clientY):(h=d.touches[0].clientX,f=d.touches[0].clientY),this._lastDraggingCoordinates={x:h,y:f},this.isDragging=!0}_onDrag(a,d){if(!this.isDragging){this._detachDragListeners();return}let h=0,f=0;d instanceof MouseEvent?(h=d.clientX,f=d.clientY):(h=d.touches[0].clientX,f=d.touches[0].clientY),d.preventDefault(),this.fire("drag",{deltaX:Math.round(h-this._lastDraggingCoordinates.x),deltaY:Math.round(f-this._lastDraggingCoordinates.y)}),this._lastDraggingCoordinates={x:h,y:f}}_onDragEnd(){this._detachDragListeners(),this.isDragging=!1}_isHandleElementPressed(a){return this.dragHandleElement?this.dragHandleElement===a.target||a.target instanceof HTMLElement&&this.dragHandleElement.contains(a.target):!1}}return e}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class pV extends $t{constructor(e){super(e),this.children=this.createCollection(),this.keystrokes=new el,this._focusTracker=new jo,this._focusables=new al,this.focusCycler=new wr({focusables:this._focusables,focusTracker:this._focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-dialog__actions"]},children:this.children})}render(){super.render(),this.keystrokes.listenTo(this.element)}setButtons(e){for(const i of e){const a=new Bu(this.locale);let d;a.on("execute",()=>i.onExecute()),i.onCreate&&i.onCreate(a);for(d in i)d!="onExecute"&&d!="onCreate"&&a.set(d,i[d]);this.children.add(a)}this._updateFocusCyclableItems()}focus(e){e===-1?this.focusCycler.focusLast():this.focusCycler.focusFirst()}_updateFocusCyclableItems(){Array.from(this.children).forEach(e=>{this._focusables.add(e),this._focusTracker.add(e.element)})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class bV extends $t{constructor(e){super(e),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-dialog__content"]},children:this.children})}reset(){for(;this.children.length;)this.children.remove(0)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const xn={SCREEN_CENTER:"screen-center",EDITOR_CENTER:"editor-center",EDITOR_TOP_SIDE:"editor-top-side",EDITOR_TOP_CENTER:"editor-top-center",EDITOR_BOTTOM_CENTER:"editor-bottom-center",EDITOR_ABOVE_CENTER:"editor-above-center",EDITOR_BELOW_CENTER:"editor-below-center"},u_=Eu("px");class ju extends mV($t){constructor(e,{getCurrentDomRoot:i,getViewportOffset:a}){super(e),this.wasMoved=!1;const d=this.bindTemplate,h=e.t;this.set("className",""),this.set("ariaLabel",h("Editor dialog")),this.set("isModal",!1),this.set("position",xn.SCREEN_CENTER),this.set("_isVisible",!1),this.set("_isTransparent",!1),this.set("_top",0),this.set("_left",0),this._getCurrentDomRoot=i,this._getViewportOffset=a,this.decorate("moveTo"),this.parts=this.createCollection(),this.keystrokes=new el,this.focusTracker=new jo,this._focusables=new al,this._focusCycler=new wr({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-dialog-overlay",d.if("isModal","ck-dialog-overlay__transparent",f=>!f),d.if("_isVisible","ck-hidden",f=>!f)],tabindex:"-1"},children:[{tag:"div",attributes:{tabindex:"-1",class:["ck","ck-dialog",d.to("className")],role:"dialog","aria-label":d.to("ariaLabel"),style:{top:d.to("_top",f=>u_(f)),left:d.to("_left",f=>u_(f)),visibility:d.if("_isTransparent","hidden")}},children:this.parts}]})}render(){super.render(),this.keystrokes.set("Esc",(e,i)=>{this.fire("close",{source:"escKeyPress"}),i()}),this.on("drag",(e,{deltaX:i,deltaY:a})=>{this.wasMoved=!0,this.moveBy(i,a)}),this.listenTo(ct.window,"resize",()=>{this._isVisible&&!this.wasMoved&&this.updatePosition()}),this.listenTo(ct.document,"scroll",()=>{this._isVisible&&!this.wasMoved&&this.updatePosition()}),this.on("change:_isVisible",(e,i,a)=>{a&&(this._isTransparent=!0,setTimeout(()=>{this.updatePosition(),this._isTransparent=!1,this.focus()},10))}),this.keystrokes.listenTo(this.element)}get dragHandleElement(){return this.headerView?this.headerView.element:null}setupParts({icon:e,title:i,hasCloseButton:a=!0,content:d,actionButtons:h}){i&&(this.headerView=new gV(this.locale,{icon:e}),a&&(this.closeButtonView=this._createCloseButton(),this.headerView.children.add(this.closeButtonView)),this.headerView.label=i,this.ariaLabel=i,this.parts.add(this.headerView,0)),d&&(d instanceof $t&&(d=[d]),this.contentView=new bV(this.locale),this.contentView.children.addMany(d),this.parts.add(this.contentView)),h&&(this.actionsView=new pV(this.locale),this.actionsView.setButtons(h),this.parts.add(this.actionsView)),this._updateFocusCyclableItems()}focus(){this._focusCycler.focusFirst()}moveTo(e,i){const a=this._getViewportRect(),d=this._getDialogRect();e+d.width>a.right&&(e=a.right-d.width),e<a.left&&(e=a.left),i<a.top&&(i=a.top),this._moveTo(e,i)}_moveTo(e,i){this._left=e,this._top=i}moveBy(e,i){this.moveTo(this._left+e,this._top+i)}_moveOffScreen(){this._moveTo(-9999,-9999)}updatePosition(){if(!this.element||!this.element.parentNode)return;const e=this._getViewportRect();let i=this.position,a;this._getCurrentDomRoot()?a=this._getVisibleDomRootRect(e):i=xn.SCREEN_CENTER;const d=ju.defaultOffset,h=this._getDialogRect();switch(i){case xn.EDITOR_TOP_SIDE:{if(a){const f=this.locale.contentLanguageDirection==="ltr"?a.right-h.width-d:a.left+d;this.moveTo(f,a.top+d)}else this._moveOffScreen();break}case xn.EDITOR_CENTER:{a?this.moveTo(Math.round(a.left+a.width/2-h.width/2),Math.round(a.top+a.height/2-h.height/2)):this._moveOffScreen();break}case xn.SCREEN_CENTER:{this.moveTo(Math.round((e.width-h.width)/2),Math.round((e.height-h.height)/2));break}case xn.EDITOR_TOP_CENTER:{a?this.moveTo(Math.round(a.left+a.width/2-h.width/2),a.top+d):this._moveOffScreen();break}case xn.EDITOR_BOTTOM_CENTER:{a?this.moveTo(Math.round(a.left+a.width/2-h.width/2),a.bottom-h.height-d):this._moveOffScreen();break}case xn.EDITOR_ABOVE_CENTER:{a?this.moveTo(Math.round(a.left+a.width/2-h.width/2),a.top-h.height-d):this._moveOffScreen();break}case xn.EDITOR_BELOW_CENTER:{a?this.moveTo(Math.round(a.left+a.width/2-h.width/2),a.bottom+d):this._moveOffScreen();break}}}_getVisibleDomRootRect(e){let i=new Qt(this._getCurrentDomRoot()).getVisible();if(i){if(i=e.getIntersection(i),!i)return null}else return null;return i}_getDialogRect(){return new Qt(this.element.firstElementChild)}_getViewportRect(){return wV(this._getViewportOffset())}_updateFocusCyclableItems(){const e=[];if(this.contentView)for(const i of this.contentView.children)Fu(i)&&e.push(i);this.actionsView&&e.push(this.actionsView),this.closeButtonView&&e.push(this.closeButtonView),e.forEach(i=>{this._focusables.add(i),this.focusTracker.add(i.element),KL(i)&&(this.listenTo(i.focusCycler,"forwardCycle",a=>{this._focusCycler.focusNext(),this._focusCycler.next!==this._focusCycler.focusables.get(this._focusCycler.current)&&a.stop()}),this.listenTo(i.focusCycler,"backwardCycle",a=>{this._focusCycler.focusPrevious(),this._focusCycler.previous!==this._focusCycler.focusables.get(this._focusCycler.current)&&a.stop()}))})}_createCloseButton(){const e=new Bu(this.locale),i=this.locale.t;return e.set({label:i("Close"),tooltip:!0,icon:Cv}),e.on("execute",()=>this.fire("close",{source:"closeButton"})),e}}ju.defaultOffset=15;function wV(s){s=Object.assign({top:0,bottom:0,left:0,right:0},s);const e=new Qt(ct.window);return e.top+=s.top,e.height-=s.top,e.bottom-=s.bottom,e.height-=s.bottom,e.left+=s.left,e.right-=s.right,e.width-=s.left+s.right,e}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const h_=Eu("px"),f_=ct.document.body,_V={top:-99999,left:-99999,name:"arrowless",config:{withArrow:!1}};class ze extends $t{constructor(e){super(e);const i=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("position","arrow_nw"),this.set("isVisible",!1),this.set("withArrow",!0),this.set("class",void 0),this._pinWhenIsVisibleCallback=null,this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-panel",i.to("position",a=>`ck-balloon-panel_${a}`),i.if("isVisible","ck-balloon-panel_visible"),i.if("withArrow","ck-balloon-panel_with-arrow"),i.to("class")],style:{top:i.to("top",h_),left:i.to("left",h_)}},children:this.content})}show(){this.isVisible=!0}hide(){this.isVisible=!1}attachTo(e){this.show();const i=ze.defaultPositions,a=Object.assign({},{element:this.element,positions:[i.southArrowNorth,i.southArrowNorthMiddleWest,i.southArrowNorthMiddleEast,i.southArrowNorthWest,i.southArrowNorthEast,i.northArrowSouth,i.northArrowSouthMiddleWest,i.northArrowSouthMiddleEast,i.northArrowSouthWest,i.northArrowSouthEast,i.viewportStickyNorth],limiter:f_,fitInViewport:!0},e),d=ze._getOptimalPosition(a)||_V,h=parseInt(d.left),f=parseInt(d.top),b=d.name,k=d.config||{},{withArrow:C=!0}=k;this.top=f,this.left=h,this.position=b,this.withArrow=C}pin(e){this.unpin(),this._pinWhenIsVisibleCallback=()=>{this.isVisible?this._startPinning(e):this._stopPinning()},this._startPinning(e),this.listenTo(this,"change:isVisible",this._pinWhenIsVisibleCallback)}unpin(){this._pinWhenIsVisibleCallback&&(this._stopPinning(),this.stopListening(this,"change:isVisible",this._pinWhenIsVisibleCallback),this._pinWhenIsVisibleCallback=null,this.hide())}_startPinning(e){this.attachTo(e);const i=uu(e.target),a=e.limiter?uu(e.limiter):f_;this.listenTo(ct.document,"scroll",(d,h)=>{const f=h.target,b=i&&f.contains(i),k=a&&f.contains(a);(b||k||!i||!a)&&this.attachTo(e)},{useCapture:!0}),this.listenTo(ct.window,"resize",()=>{this.attachTo(e)})}_stopPinning(){this.stopListening(ct.document,"scroll"),this.stopListening(ct.window,"resize")}}ze.arrowSideOffset=25;ze.arrowHeightOffset=10;ze.stickyVerticalOffset=20;ze._getOptimalPosition=Tu;ze.defaultPositions=Vv();function uu(s){return xu(s)?s:Kk(s)?s.commonAncestorContainer:typeof s=="function"?uu(s()):null}function Vv(s={}){const{sideOffset:e=ze.arrowSideOffset,heightOffset:i=ze.arrowHeightOffset,stickyVerticalOffset:a=ze.stickyVerticalOffset,config:d}=s;return{northWestArrowSouthWest:(b,k)=>({top:h(b,k),left:b.left-e,name:"arrow_sw",...d&&{config:d}}),northWestArrowSouthMiddleWest:(b,k)=>({top:h(b,k),left:b.left-k.width*.25-e,name:"arrow_smw",...d&&{config:d}}),northWestArrowSouth:(b,k)=>({top:h(b,k),left:b.left-k.width/2,name:"arrow_s",...d&&{config:d}}),northWestArrowSouthMiddleEast:(b,k)=>({top:h(b,k),left:b.left-k.width*.75+e,name:"arrow_sme",...d&&{config:d}}),northWestArrowSouthEast:(b,k)=>({top:h(b,k),left:b.left-k.width+e,name:"arrow_se",...d&&{config:d}}),northArrowSouthWest:(b,k)=>({top:h(b,k),left:b.left+b.width/2-e,name:"arrow_sw",...d&&{config:d}}),northArrowSouthMiddleWest:(b,k)=>({top:h(b,k),left:b.left+b.width/2-k.width*.25-e,name:"arrow_smw",...d&&{config:d}}),northArrowSouth:(b,k)=>({top:h(b,k),left:b.left+b.width/2-k.width/2,name:"arrow_s",...d&&{config:d}}),northArrowSouthMiddleEast:(b,k)=>({top:h(b,k),left:b.left+b.width/2-k.width*.75+e,name:"arrow_sme",...d&&{config:d}}),northArrowSouthEast:(b,k)=>({top:h(b,k),left:b.left+b.width/2-k.width+e,name:"arrow_se",...d&&{config:d}}),northEastArrowSouthWest:(b,k)=>({top:h(b,k),left:b.right-e,name:"arrow_sw",...d&&{config:d}}),northEastArrowSouthMiddleWest:(b,k)=>({top:h(b,k),left:b.right-k.width*.25-e,name:"arrow_smw",...d&&{config:d}}),northEastArrowSouth:(b,k)=>({top:h(b,k),left:b.right-k.width/2,name:"arrow_s",...d&&{config:d}}),northEastArrowSouthMiddleEast:(b,k)=>({top:h(b,k),left:b.right-k.width*.75+e,name:"arrow_sme",...d&&{config:d}}),northEastArrowSouthEast:(b,k)=>({top:h(b,k),left:b.right-k.width+e,name:"arrow_se",...d&&{config:d}}),southWestArrowNorthWest:b=>({top:f(b),left:b.left-e,name:"arrow_nw",...d&&{config:d}}),southWestArrowNorthMiddleWest:(b,k)=>({top:f(b),left:b.left-k.width*.25-e,name:"arrow_nmw",...d&&{config:d}}),southWestArrowNorth:(b,k)=>({top:f(b),left:b.left-k.width/2,name:"arrow_n",...d&&{config:d}}),southWestArrowNorthMiddleEast:(b,k)=>({top:f(b),left:b.left-k.width*.75+e,name:"arrow_nme",...d&&{config:d}}),southWestArrowNorthEast:(b,k)=>({top:f(b),left:b.left-k.width+e,name:"arrow_ne",...d&&{config:d}}),southArrowNorthWest:b=>({top:f(b),left:b.left+b.width/2-e,name:"arrow_nw",...d&&{config:d}}),southArrowNorthMiddleWest:(b,k)=>({top:f(b),left:b.left+b.width/2-k.width*.25-e,name:"arrow_nmw",...d&&{config:d}}),southArrowNorth:(b,k)=>({top:f(b),left:b.left+b.width/2-k.width/2,name:"arrow_n",...d&&{config:d}}),southArrowNorthMiddleEast:(b,k)=>({top:f(b),left:b.left+b.width/2-k.width*.75+e,name:"arrow_nme",...d&&{config:d}}),southArrowNorthEast:(b,k)=>({top:f(b),left:b.left+b.width/2-k.width+e,name:"arrow_ne",...d&&{config:d}}),southEastArrowNorthWest:b=>({top:f(b),left:b.right-e,name:"arrow_nw",...d&&{config:d}}),southEastArrowNorthMiddleWest:(b,k)=>({top:f(b),left:b.right-k.width*.25-e,name:"arrow_nmw",...d&&{config:d}}),southEastArrowNorth:(b,k)=>({top:f(b),left:b.right-k.width/2,name:"arrow_n",...d&&{config:d}}),southEastArrowNorthMiddleEast:(b,k)=>({top:f(b),left:b.right-k.width*.75+e,name:"arrow_nme",...d&&{config:d}}),southEastArrowNorthEast:(b,k)=>({top:f(b),left:b.right-k.width+e,name:"arrow_ne",...d&&{config:d}}),westArrowEast:(b,k)=>({top:b.top+b.height/2-k.height/2,left:b.left-k.width-i,name:"arrow_e",...d&&{config:d}}),eastArrowWest:(b,k)=>({top:b.top+b.height/2-k.height/2,left:b.right+i,name:"arrow_w",...d&&{config:d}}),viewportStickyNorth:(b,k,C,y)=>{const P=y||C;return!b.getIntersection(P)||P.height-b.height>a?null:{top:P.top+a,left:b.left+b.width/2-k.width/2,name:"arrowless",config:{withArrow:!1,...d}}}};function h(b,k){return b.top-k.height-i}function f(b){return b.bottom+i}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const g_="ck-tooltip";class ee extends Ni(){constructor(e){if(super(),this._currentElementWithTooltip=null,this._currentTooltipPosition=null,this._resizeObserver=null,ee._editors.add(e),ee._instance)return ee._instance;ee._instance=this,this.tooltipTextView=new $t(e.locale),this.tooltipTextView.set("text",""),this.tooltipTextView.setTemplate({tag:"span",attributes:{class:["ck","ck-tooltip__text"]},children:[{text:this.tooltipTextView.bindTemplate.to("text")}]}),this.balloonPanelView=new ze(e.locale),this.balloonPanelView.class=g_,this.balloonPanelView.content.add(this.tooltipTextView),this._pinTooltipDebounced=HO(this._pinTooltip,600),this.listenTo(ct.document,"mouseenter",this._onEnterOrFocus.bind(this),{useCapture:!0}),this.listenTo(ct.document,"mouseleave",this._onLeaveOrBlur.bind(this),{useCapture:!0}),this.listenTo(ct.document,"focus",this._onEnterOrFocus.bind(this),{useCapture:!0}),this.listenTo(ct.document,"blur",this._onLeaveOrBlur.bind(this),{useCapture:!0}),this.listenTo(ct.document,"scroll",this._onScroll.bind(this),{useCapture:!0}),this._watchdogExcluded=!0}destroy(e){const i=e.ui.view&&e.ui.view.body;ee._editors.delete(e),this.stopListening(e.ui),i&&i.has(this.balloonPanelView)&&i.remove(this.balloonPanelView),ee._editors.size||(this._unpinTooltip(),this.balloonPanelView.destroy(),this.stopListening(),ee._instance=null)}static getPositioningFunctions(e){const i=ee.defaultBalloonPositions;return{s:[i.southArrowNorth,i.southArrowNorthEast,i.southArrowNorthWest],n:[i.northArrowSouth],e:[i.eastArrowWest],w:[i.westArrowEast],sw:[i.southArrowNorthEast],se:[i.southArrowNorthWest]}[e]}_onEnterOrFocus(e,{target:i}){const a=Od(i);a&&a!==this._currentElementWithTooltip&&(this._unpinTooltip(),this._pinTooltipDebounced(a,kV(a)))}_onLeaveOrBlur(e,{target:i,relatedTarget:a}){if(e.name==="mouseleave"){if(!xu(i)||this._currentElementWithTooltip&&i!==this._currentElementWithTooltip)return;const d=Od(i),h=Od(a);d&&d!==h&&this._unpinTooltip()}else{if(this._currentElementWithTooltip&&i!==this._currentElementWithTooltip)return;this._unpinTooltip()}}_onScroll(e,{target:i}){this._currentElementWithTooltip&&(i.contains(this.balloonPanelView.element)&&i.contains(this._currentElementWithTooltip)||this._unpinTooltip())}_pinTooltip(e,{text:i,position:a,cssClass:d}){const h=ev(ee._editors.values()).ui.view.body;h.has(this.balloonPanelView)||h.add(this.balloonPanelView),this.tooltipTextView.text=i,this.balloonPanelView.pin({target:e,positions:ee.getPositioningFunctions(a)}),this._resizeObserver=new Rt(e,()=>{tu(e)||this._unpinTooltip()}),this.balloonPanelView.class=[g_,d].filter(f=>f).join(" ");for(const f of ee._editors)this.listenTo(f.ui,"update",this._updateTooltipPosition.bind(this),{priority:"low"});this._currentElementWithTooltip=e,this._currentTooltipPosition=a}_unpinTooltip(){this._pinTooltipDebounced.cancel(),this.balloonPanelView.unpin();for(const e of ee._editors)this.stopListening(e.ui,"update");this._currentElementWithTooltip=null,this._currentTooltipPosition=null,this._resizeObserver&&this._resizeObserver.destroy()}_updateTooltipPosition(){if(!tu(this._currentElementWithTooltip)){this._unpinTooltip();return}this.balloonPanelView.pin({target:this._currentElementWithTooltip,positions:ee.getPositioningFunctions(this._currentTooltipPosition)})}}ee.defaultBalloonPositions=Vv({heightOffset:5,sideOffset:13});ee._editors=new Set;ee._instance=null;function Od(s){return xu(s)?s.closest("[data-cke-tooltip-text]:not([data-cke-tooltip-disabled])"):null}function kV(s){return{text:s.dataset.ckeTooltipText,position:s.dataset.ckeTooltipPosition||"s",cssClass:s.dataset.ckeTooltipClass||""}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class vV extends HL{constructor(e,i){const a=e.t,d=Object.assign({},{showResetButton:!0,showIcon:!0,creator:YL},i);super(e,d.creator),this.label=i.label,this._viewConfig=d,this._viewConfig.showIcon&&(this.iconView=new Vi,this.iconView.content=Jw.loupe,this.fieldWrapperChildren.add(this.iconView,0),this.extendTemplate({attributes:{class:"ck-search__query_with-icon"}})),this._viewConfig.showResetButton&&(this.resetButtonView=new Bu(e),this.resetButtonView.set({label:a("Clear"),icon:Jw.cancel,class:"ck-search__reset",isVisible:!1,tooltip:!0}),this.resetButtonView.on("execute",()=>{this.reset(),this.focus(),this.fire("reset")}),this.resetButtonView.bind("isVisible").to(this.fieldView,"isEmpty",h=>!h),this.fieldWrapperChildren.add(this.resetButtonView),this.extendTemplate({attributes:{class:"ck-search__query_with-reset"}}))}reset(){this.fieldView.reset(),this._viewConfig.showResetButton&&(this.resetButtonView.isVisible=!1)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class yV extends $t{constructor(){super();const e=this.bindTemplate;this.set({isVisible:!1,primaryText:"",secondaryText:""}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-search__info",e.if("isVisible","ck-hidden",i=>!i)],tabindex:-1},children:[{tag:"span",children:[{text:[e.to("primaryText")]}]},{tag:"span",children:[{text:[e.to("secondaryText")]}]}]})}focus(){this.element.focus()}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class AV extends $t{constructor(e){super(e),this.children=this.createCollection(),this.focusTracker=new jo,this.setTemplate({tag:"div",attributes:{class:["ck","ck-search__results"],tabindex:-1},children:this.children}),this._focusCycler=new wr({focusables:this.children,focusTracker:this.focusTracker})}render(){super.render();for(const e of this.children)this.focusTracker.add(e.element)}focus(){this._focusCycler.focusFirst()}focusFirst(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class CV extends $t{constructor(e,i){super(e),this._config=i,this.filteredView=i.filteredView,this.queryView=this._createSearchTextQueryView(),this.focusTracker=new jo,this.keystrokes=new el,this.resultsView=new AV(e),this.children=this.createCollection(),this.focusableChildren=this.createCollection([this.queryView,this.resultsView]),this.set("isEnabled",!0),this.set("resultsCount",0),this.set("totalItemsCount",0),i.infoView&&i.infoView.instance?this.infoView=i.infoView.instance:(this.infoView=new yV,this._enableDefaultInfoViewBehavior(),this.on("render",()=>{this.search("")})),this.resultsView.children.addMany([this.infoView,this.filteredView]),this.focusCycler=new wr({focusables:this.focusableChildren,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.on("search",(a,{resultsCount:d,totalItemsCount:h})=>{this.resultsCount=d,this.totalItemsCount=h}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-search",i.class||null],tabindex:"-1"},children:this.children})}render(){super.render(),this.children.addMany([this.queryView,this.resultsView]);const e=i=>i.stopPropagation();for(const i of this.focusableChildren)this.focusTracker.add(i.element);this.keystrokes.listenTo(this.element),this.keystrokes.set("arrowright",e),this.keystrokes.set("arrowleft",e),this.keystrokes.set("arrowup",e),this.keystrokes.set("arrowdown",e)}focus(){this.queryView.focus()}reset(){this.queryView.reset(),this.search("")}search(e){const i=e?new RegExp(QO(e),"ig"):null,a=this.filteredView.filter(i);this.fire("search",{query:e,...a})}_createSearchTextQueryView(){const e=new vV(this.locale,this._config.queryView);return this.listenTo(e.fieldView,"input",()=>{this.search(e.fieldView.element.value)}),e.on("reset",()=>this.reset()),e.bind("isEnabled").to(this),e}_enableDefaultInfoViewBehavior(){const e=this.locale.t,i=this.infoView;this.on("search",(d,h)=>{if(h.resultsCount)i.set({isVisible:!1});else{const f=this._config.infoView&&this._config.infoView.text;let b,k;h.totalItemsCount?f&&f.notFound?(b=f.notFound.primary,k=f.notFound.secondary):(b=e("No results found"),k=""):f&&f.noSearchableItems?(b=f.noSearchableItems.primary,k=f.noSearchableItems.secondary):(b=e("No searchable items"),k=""),i.set({primaryText:a(b,h),secondaryText:a(k,h),isVisible:!0})}});function a(d,{query:h,resultsCount:f,totalItemsCount:b}){return typeof d=="function"?d(h,f,b):d}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ur extends CV{constructor(e,i){super(e,i),this._config=i;const a=Eu("px");this.extendTemplate({attributes:{class:["ck-autocomplete"]}});const d=this.resultsView.bindTemplate;this.resultsView.set("isVisible",!1),this.resultsView.set("_position","s"),this.resultsView.set("_width",0),this.resultsView.extendTemplate({attributes:{class:[d.if("isVisible","ck-hidden",h=>!h),d.to("_position",h=>`ck-search__results_${h}`)],style:{width:d.to("_width",a)}}}),this.focusTracker.on("change:isFocused",(h,f,b)=>{this._updateResultsVisibility(),b?this.resultsView.element.scrollTop=0:i.resetOnBlur&&this.queryView.reset()}),this.on("search",()=>{this._updateResultsVisibility(),this._updateResultsViewWidthAndPosition()}),this.keystrokes.set("esc",(h,f)=>{this.resultsView.isVisible&&(this.queryView.focus(),this.resultsView.isVisible=!1,f())}),this.listenTo(ct.document,"scroll",()=>{this._updateResultsViewWidthAndPosition()}),this.on("change:isEnabled",()=>{this._updateResultsVisibility()}),this.filteredView.on("execute",(h,{value:f})=>{this.focus(),this.reset(),this.queryView.fieldView.value=this.queryView.fieldView.element.value=f,this.resultsView.isVisible=!1}),this.resultsView.on("change:isVisible",()=>{this._updateResultsViewWidthAndPosition()})}_updateResultsViewWidthAndPosition(){if(!this.resultsView.isVisible)return;this.resultsView._width=new Qt(this.queryView.fieldView.element).width;const e=ur._getOptimalPosition({element:this.resultsView.element,target:this.queryView.element,fitInViewport:!0,positions:ur.defaultResultsPositions});this.resultsView._position=e?e.name:"s"}_updateResultsVisibility(){const e=typeof this._config.queryMinChars>"u"?0:this._config.queryMinChars,i=this.queryView.fieldView.element.value.length;this.resultsView.isVisible=this.focusTracker.isFocused&&this.isEnabled&&i>=e}}ur.defaultResultsPositions=[s=>({top:s.bottom,left:s.left,name:"s"}),(s,e)=>({top:s.top-e.height,left:s.left,name:"n"})];ur._getOptimalPosition=Tu;/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function*xV(s,e){for(const i of e)i&&s.getAttributeProperties(i[0]).copyOnEnter&&(yield i)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class EV extends ov{execute(){this.editor.model.change(e=>{this.enterBlock(e),this.fire("afterExecute",{writer:e})})}enterBlock(e){const i=this.editor.model,a=i.document.selection,d=i.schema,h=a.isCollapsed,f=a.getFirstRange(),b=f.start.parent,k=f.end.parent;if(d.isLimit(b)||d.isLimit(k))return!h&&b==k&&i.deleteContent(a),!1;if(h){const C=xV(e.model.schema,a.getAttributes());return m_(e,f.start),e.setSelectionAttribute(C),!0}else{const C=!(f.start.isAtStart&&f.end.isAtEnd),y=b==k;if(i.deleteContent(a,{leaveUnmerged:C}),C){if(y)return m_(e,a.focus),!0;e.setSelection(k,0)}}return!1}}function m_(s,e){s.split(e),s.setSelection(e.parent.nextSibling,0)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const TV={insertParagraph:{isSoft:!1},insertLineBreak:{isSoft:!0}};class SV extends Ru{constructor(e){super(e);const i=this.document;let a=!1;i.on("keydown",(d,h)=>{a=h.shiftKey}),i.on("beforeinput",(d,h)=>{if(!this.isEnabled)return;let f=h.inputType;Ye.isSafari&&a&&f=="insertParagraph"&&(f="insertLineBreak");const b=h.domEvent,k=TV[f];if(!k)return;const C=new il(i,"enter",h.targetRanges[0]);i.fire(C,new sl(e,b,{isSoft:k.isSoft})),C.stop.called&&d.stop()})}observe(){}stopObserving(){}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Bv extends oe{static get pluginName(){return"Enter"}init(){const e=this.editor,i=e.editing.view,a=i.document;i.addObserver(SV),e.commands.add("enter",new EV(e)),this.listenTo(a,"enter",(d,h)=>{a.isComposing||h.preventDefault(),!h.isSoft&&(e.execute("enter"),i.scrollToTheSelection())},{priority:"low"})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class PV extends wt(){constructor(){super(...arguments),this._stack=[]}add(e,i){const a=this._stack,d=a[0];this._insertDescriptor(e);const h=a[0];d!==h&&!Nd(d,h)&&this.fire("change:top",{oldDescriptor:d,newDescriptor:h,writer:i})}remove(e,i){const a=this._stack,d=a[0];this._removeDescriptor(e);const h=a[0];d!==h&&!Nd(d,h)&&this.fire("change:top",{oldDescriptor:d,newDescriptor:h,writer:i})}_insertDescriptor(e){const i=this._stack,a=i.findIndex(h=>h.id===e.id);if(Nd(e,i[a]))return;a>-1&&i.splice(a,1);let d=0;for(;i[d]&&IV(i[d],e);)d++;i.splice(d,0,e)}_removeDescriptor(e){const i=this._stack,a=i.findIndex(d=>d.id===e);a>-1&&i.splice(a,1)}}function Nd(s,e){return s&&e&&s.priority==e.priority&&Ua(s.classes)==Ua(e.classes)}function IV(s,e){return s.priority>e.priority?!0:s.priority<e.priority?!1:Ua(s.classes)>Ua(e.classes)}function Ua(s){return Array.isArray(s)?s.sort().join(","):s}const MV="/feadmin/assets/drag-handle-b6ef2631.svg";/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const RV="ck-widget",p_="ck-widget_selected";function un(s){return s.is("element")?!!s.getCustomProperty("widget"):!1}function Fv(s,e,i={}){if(!s.is("containerElement"))throw new M("widget-to-widget-wrong-element-type",null,{element:s});return e.setAttribute("contenteditable","false",s),e.addClass(RV,s),e.setCustomProperty("widget",!0,s),s.getFillerOffset=BV,e.setCustomProperty("widgetLabel",[],s),i.label&&LV(s,i.label),i.hasSelectionHandle&&FV(s,e),DV(s,e),s}function OV(s,e,i){if(e.classes&&i.addClass(ke(e.classes),s),e.attributes)for(const a in e.attributes)i.setAttribute(a,e.attributes[a],s)}function NV(s,e,i){if(e.classes&&i.removeClass(ke(e.classes),s),e.attributes)for(const a in e.attributes)i.removeAttribute(a,s)}function DV(s,e,i=OV,a=NV){const d=new PV;d.on("change:top",(b,k)=>{k.oldDescriptor&&a(s,k.oldDescriptor,k.writer),k.newDescriptor&&i(s,k.newDescriptor,k.writer)});const h=(b,k,C)=>d.add(k,C),f=(b,k,C)=>d.remove(k,C);e.setCustomProperty("addHighlight",h,s),e.setCustomProperty("removeHighlight",f,s)}function LV(s,e){s.getCustomProperty("widgetLabel").push(e)}function VV(s){return s.getCustomProperty("widgetLabel").reduce((i,a)=>typeof a=="function"?i?i+". "+a():a():i?i+". "+a:a,"")}function BV(){return null}function FV(s,e){const i=e.createUIElement("div",{class:"ck ck-widget__selection-handle"},function(a){const d=this.toDomElement(a),h=new Vi;return h.set("content",MV),h.render(),d.appendChild(h.element),d});e.insert(e.createPositionAt(s,0),i),e.addClass(["ck-widget_with-selection-handle"],s)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Tn="widget-type-around";function wi(s,e,i){return!!s&&un(s)&&!i.isInline(e)}function zV(s){return s.closest(".ck-widget__type-around__button")}function jV(s){return s.classList.contains("ck-widget__type-around__button_before")?"before":"after"}function $V(s,e){const i=s.closest(".ck-widget");return e.mapDomToView(i)}function _i(s){return s.getAttribute(Tn)}const HV="/feadmin/assets/return-arrow-1d309db3.svg";/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const zv=["before","after"],WV=new DOMParser().parseFromString(HV,"image/svg+xml").firstChild,b_="ck-widget__type-around_disabled";class qV extends oe{constructor(){super(...arguments),this._currentFakeCaretModelElement=null}static get pluginName(){return"WidgetTypeAround"}static get requires(){return[Bv,Ev]}init(){const e=this.editor,i=e.editing.view;this.on("change:isEnabled",(a,d,h)=>{i.change(f=>{for(const b of i.document.roots)h?f.removeClass(b_,b):f.addClass(b_,b)}),h||e.model.change(f=>{f.removeSelectionAttribute(Tn)})}),this._enableTypeAroundUIInjection(),this._enableInsertingParagraphsOnButtonClick(),this._enableInsertingParagraphsOnEnterKeypress(),this._enableInsertingParagraphsOnTypingKeystroke(),this._enableTypeAroundFakeCaretActivationUsingKeyboardArrows(),this._enableDeleteIntegration(),this._enableInsertContentIntegration(),this._enableInsertObjectIntegration(),this._enableDeleteContentIntegration()}destroy(){super.destroy(),this._currentFakeCaretModelElement=null}_insertParagraph(e,i){const a=this.editor,d=a.editing.view,h=a.model.schema.getAttributesWithProperty(e,"copyOnReplace",!0);a.execute("insertParagraph",{position:a.model.createPositionAt(e,i),attributes:h}),d.focus(),d.scrollToTheSelection()}_listenToIfEnabled(e,i,a,d){this.listenTo(e,i,(...h)=>{this.isEnabled&&a(...h)},d)}_insertParagraphAccordingToFakeCaretPosition(){const a=this.editor.model.document.selection,d=_i(a);if(!d)return!1;const h=a.getSelectedElement();return this._insertParagraph(h,d),!0}_enableTypeAroundUIInjection(){const e=this.editor,i=e.model.schema,a=e.locale.t,d={before:a("Insert paragraph before block"),after:a("Insert paragraph after block")};e.editing.downcastDispatcher.on("insert",(h,f,b)=>{const k=b.mapper.toViewElement(f.item);k&&wi(k,f.item,i)&&(UV(b.writer,d,k),k.getCustomProperty("widgetLabel").push(()=>this.isEnabled?a("Press Enter to type after or press Shift + Enter to type before the widget"):""))},{priority:"low"})}_enableTypeAroundFakeCaretActivationUsingKeyboardArrows(){const e=this.editor,i=e.model,a=i.document.selection,d=i.schema,h=e.editing.view;this._listenToIfEnabled(h.document,"arrowKey",(b,k)=>{this._handleArrowKeyPress(b,k)},{context:[un,"$text"],priority:"high"}),this._listenToIfEnabled(a,"change:range",(b,k)=>{k.directChange&&e.model.change(C=>{C.removeSelectionAttribute(Tn)})}),this._listenToIfEnabled(i.document,"change:data",()=>{const b=a.getSelectedElement();if(b){const k=e.editing.mapper.toViewElement(b);if(wi(k,b,d))return}e.model.change(k=>{k.removeSelectionAttribute(Tn)})}),this._listenToIfEnabled(e.editing.downcastDispatcher,"selection",(b,k,C)=>{const y=C.writer;if(this._currentFakeCaretModelElement){const $=C.mapper.toViewElement(this._currentFakeCaretModelElement);$&&(y.removeClass(zv.map(f),$),this._currentFakeCaretModelElement=null)}const P=k.selection.getSelectedElement();if(!P)return;const R=C.mapper.toViewElement(P);if(!wi(R,P,d))return;const D=_i(k.selection);D&&(y.addClass(f(D),R),this._currentFakeCaretModelElement=P)}),this._listenToIfEnabled(e.ui.focusTracker,"change:isFocused",(b,k,C)=>{C||e.model.change(y=>{y.removeSelectionAttribute(Tn)})});function f(b){return`ck-widget_type-around_show-fake-caret_${b}`}}_handleArrowKeyPress(e,i){const a=this.editor,d=a.model,h=d.document.selection,f=d.schema,b=a.editing.view,k=i.keyCode,C=T5(k,a.locale.contentLanguageDirection),y=b.document.selection.getSelectedElement(),P=a.editing.mapper.toModelElement(y);let R;wi(y,P,f)?R=this._handleArrowKeyPressOnSelectedWidget(C):h.isCollapsed?R=this._handleArrowKeyPressWhenSelectionNextToAWidget(C):i.shiftKey||(R=this._handleArrowKeyPressWhenNonCollapsedSelection(C)),R&&(i.preventDefault(),e.stop())}_handleArrowKeyPressOnSelectedWidget(e){const a=this.editor.model,d=a.document.selection,h=_i(d);return a.change(f=>{if(h){if(!(h===(e?"after":"before")))return f.removeSelectionAttribute(Tn),!0}else return f.setSelectionAttribute(Tn,e?"after":"before"),!0;return!1})}_handleArrowKeyPressWhenSelectionNextToAWidget(e){const i=this.editor,a=i.model,d=a.schema,h=i.plugins.get("Widget"),f=h._getObjectElementNextToSelection(e),b=i.editing.mapper.toViewElement(f);return wi(b,f,d)?(a.change(k=>{h._setSelectionOverElement(f),k.setSelectionAttribute(Tn,e?"before":"after")}),!0):!1}_handleArrowKeyPressWhenNonCollapsedSelection(e){const i=this.editor,a=i.model,d=a.schema,h=i.editing.mapper,f=a.document.selection,b=e?f.getLastPosition().nodeBefore:f.getFirstPosition().nodeAfter,k=h.toViewElement(b);return wi(k,b,d)?(a.change(C=>{C.setSelection(b,"on"),C.setSelectionAttribute(Tn,e?"after":"before")}),!0):!1}_enableInsertingParagraphsOnButtonClick(){const e=this.editor,i=e.editing.view;this._listenToIfEnabled(i.document,"mousedown",(a,d)=>{const h=zV(d.domTarget);if(!h)return;const f=jV(h),b=$V(h,i.domConverter),k=e.editing.mapper.toModelElement(b);this._insertParagraph(k,f),d.preventDefault(),a.stop()})}_enableInsertingParagraphsOnEnterKeypress(){const e=this.editor,i=e.model.document.selection,a=e.editing.view;this._listenToIfEnabled(a.document,"enter",(d,h)=>{if(d.eventPhase!="atTarget")return;const f=i.getSelectedElement(),b=e.editing.mapper.toViewElement(f),k=e.model.schema;let C;this._insertParagraphAccordingToFakeCaretPosition()?C=!0:wi(b,f,k)&&(this._insertParagraph(f,h.isSoft?"before":"after"),C=!0),C&&(h.preventDefault(),d.stop())},{context:un})}_enableInsertingParagraphsOnTypingKeystroke(){const i=this.editor.editing.view.document;this._listenToIfEnabled(i,"insertText",(a,d)=>{this._insertParagraphAccordingToFakeCaretPosition()&&(d.selection=i.selection)},{priority:"high"}),Ye.isAndroid?this._listenToIfEnabled(i,"keydown",(a,d)=>{d.keyCode==229&&this._insertParagraphAccordingToFakeCaretPosition()}):this._listenToIfEnabled(i,"compositionstart",()=>{this._insertParagraphAccordingToFakeCaretPosition()},{priority:"high"})}_enableDeleteIntegration(){const e=this.editor,i=e.editing.view,a=e.model,d=a.schema;this._listenToIfEnabled(i.document,"delete",(h,f)=>{if(h.eventPhase!="atTarget")return;const b=_i(a.document.selection);if(!b)return;const k=f.direction,C=a.document.selection.getSelectedElement(),y=b==="before",P=k=="forward";if(y===P)e.execute("delete",{selection:a.createSelection(C,"on")});else{const D=d.getNearestSelectionRange(a.createPositionAt(C,b),k);if(D)if(!D.isCollapsed)a.change($=>{$.setSelection(D),e.execute(P?"deleteForward":"delete")});else{const $=a.createSelection(D.start);if(a.modifySelection($,{direction:k}),!$.focus.isEqual(D.start))a.change(Z=>{Z.setSelection(D),e.execute(P?"deleteForward":"delete")});else{const Z=YV(d,D.start.parent);a.deleteContent(a.createSelection(Z,"on"),{doNotAutoparagraph:!0})}}}f.preventDefault(),h.stop()},{context:un})}_enableInsertContentIntegration(){const e=this.editor,i=this.editor.model,a=i.document.selection;this._listenToIfEnabled(e.model,"insertContent",(d,[h,f])=>{if(f&&!f.is("documentSelection"))return;const b=_i(a);if(b)return d.stop(),i.change(k=>{const C=a.getSelectedElement(),y=i.createPositionAt(C,b),P=k.createSelection(y),R=i.insertContent(h,P);return k.setSelection(P),R})},{priority:"high"})}_enableInsertObjectIntegration(){const e=this.editor,a=this.editor.model.document.selection;this._listenToIfEnabled(e.model,"insertObject",(d,h)=>{const[,f,b={}]=h;if(f&&!f.is("documentSelection"))return;const k=_i(a);k&&(b.findOptimalPosition=k,h[3]=b)},{priority:"high"})}_enableDeleteContentIntegration(){const e=this.editor,a=this.editor.model.document.selection;this._listenToIfEnabled(e.model,"deleteContent",(d,[h])=>{if(h&&!h.is("documentSelection"))return;_i(a)&&d.stop()},{priority:"high"})}}function UV(s,e,i){const a=s.createUIElement("div",{class:"ck ck-reset_all ck-widget__type-around"},function(d){const h=this.toDomElement(d);return GV(h,e),KV(h),h});s.insert(s.createPositionAt(i,"end"),a)}function GV(s,e){for(const i of zv){const a=new Ti({tag:"div",attributes:{class:["ck","ck-widget__type-around__button",`ck-widget__type-around__button_${i}`],title:e[i],"aria-hidden":"true"},children:[s.ownerDocument.importNode(WV,!0)]});s.appendChild(a.render())}}function KV(s){const e=new Ti({tag:"div",attributes:{class:["ck","ck-widget__type-around__fake-caret"]}});s.appendChild(e.render())}function YV(s,e){let i=e;for(const a of e.getAncestors({parentFirst:!0})){if(a.childCount>1||s.isLimit(a))break;i=a}return i}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function JV(s){const e=s.model;return(i,a)=>{const d=a.keyCode==qt.arrowup,h=a.keyCode==qt.arrowdown,f=a.shiftKey,b=e.document.selection;if(!d&&!h)return;const k=h;if(f&&ZV(b,k))return;const C=QV(s,b,k);if(C){if(C.isCollapsed){if(b.isCollapsed)return;if(f)return}(C.isCollapsed||XV(s,C,k))&&(e.change(y=>{const P=k?C.end:C.start;if(f){const R=e.createSelection(b.anchor);R.setFocus(P),y.setSelection(R)}else y.setSelection(P)}),i.stop(),a.preventDefault(),a.stopPropagation())}}}function QV(s,e,i){const a=s.model;if(i){const d=e.isCollapsed?e.focus:e.getLastPosition(),h=w_(a,d,"forward");if(!h)return null;const f=a.createRange(d,h),b=__(a.schema,f,"backward");return b?a.createRange(d,b):null}else{const d=e.isCollapsed?e.focus:e.getFirstPosition(),h=w_(a,d,"backward");if(!h)return null;const f=a.createRange(h,d),b=__(a.schema,f,"forward");return b?a.createRange(b,d):null}}function w_(s,e,i){const a=s.schema,d=s.createRangeIn(e.root),h=i=="forward"?"elementStart":"elementEnd";for(const{previousPosition:f,item:b,type:k}of d.getWalker({startPosition:e,direction:i})){if(a.isLimit(b)&&!a.isInline(b))return f;if(k==h&&a.isBlock(b))return null}return null}function __(s,e,i){const a=i=="backward"?e.end:e.start;if(s.checkChild(a,"$text"))return a;for(const{nextPosition:d}of e.getWalker({direction:i}))if(s.checkChild(d,"$text"))return d;return null}function XV(s,e,i){const a=s.model,d=s.view.domConverter;if(i){const C=a.createSelection(e.start);a.modifySelection(C),!C.focus.isAtEnd&&!e.start.isEqual(C.focus)&&(e=a.createRange(C.focus,e.end))}const h=s.mapper.toViewRange(e),f=d.viewRangeToDom(h),b=Qt.getDomRangeRects(f);let k;for(const C of b){if(k===void 0){k=Math.round(C.bottom);continue}if(Math.round(C.top)>=k)return!1;k=Math.max(k,Math.round(C.bottom))}return!0}function ZV(s,e){return!s.isCollapsed&&s.isBackward==e}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class tB extends oe{constructor(){super(...arguments),this._previouslySelected=new Set}static get pluginName(){return"Widget"}static get requires(){return[qV,Ev]}init(){const e=this.editor,i=e.editing.view,a=i.document;this.editor.editing.downcastDispatcher.on("selection",(d,h,f)=>{const b=f.writer,k=h.selection;if(k.isCollapsed)return;const C=k.getSelectedElement();if(!C)return;const y=e.editing.mapper.toViewElement(C);un(y)&&f.consumable.consume(k,"selection")&&b.setSelection(b.createRangeOn(y),{fake:!0,label:VV(y)})}),this.editor.editing.downcastDispatcher.on("selection",(d,h,f)=>{this._clearPreviouslySelectedWidgets(f.writer);const b=f.writer,k=b.document.selection;let C=null;for(const y of k.getRanges())for(const P of y){const R=P.item;un(R)&&!nB(R,C)&&(b.addClass(p_,R),this._previouslySelected.add(R),C=R)}},{priority:"low"}),i.addObserver(oD),this.listenTo(a,"mousedown",(...d)=>this._onMousedown(...d)),this.listenTo(a,"arrowKey",(...d)=>{this._handleSelectionChangeOnArrowKeyPress(...d)},{context:[un,"$text"]}),this.listenTo(a,"arrowKey",(...d)=>{this._preventDefaultOnArrowKeyPress(...d)},{context:"$root"}),this.listenTo(a,"arrowKey",JV(this.editor.editing),{context:"$text"}),this.listenTo(a,"delete",(d,h)=>{this._handleDelete(h.direction=="forward")&&(h.preventDefault(),d.stop())},{context:"$root"})}_onMousedown(e,i){const a=this.editor,d=a.editing.view,h=d.document;let f=i.target;if(i.domEvent.detail>=3){this._selectBlockContent(f)&&i.preventDefault();return}if(eB(f)||!un(f)&&(f=f.findAncestor(un),!f))return;Ye.isAndroid&&i.preventDefault(),h.isFocused||d.focus();const b=a.editing.mapper.toModelElement(f);this._setSelectionOverElement(b)}_selectBlockContent(e){const i=this.editor,a=i.model,d=i.editing.mapper,h=a.schema,f=d.findMappedViewAncestor(this.editor.editing.view.createPositionAt(e,0)),b=iB(d.toModelElement(f),a.schema);return b?(a.change(k=>{const C=h.isLimit(b)?null:oB(k.createPositionAfter(b),h),y=k.createPositionAt(b,0),P=C?k.createPositionAt(C,0):k.createPositionAt(b,"end");k.setSelection(k.createRange(y,P))}),!0):!1}_handleSelectionChangeOnArrowKeyPress(e,i){const a=i.keyCode,d=this.editor.model,h=d.schema,f=d.document.selection,b=f.getSelectedElement(),k=tv(a,this.editor.locale.contentLanguageDirection),C=k=="down"||k=="right",y=k=="up"||k=="down";if(b&&h.isObject(b)){const R=C?f.getLastPosition():f.getFirstPosition(),D=h.getNearestSelectionRange(R,C?"forward":"backward");D&&(d.change($=>{$.setSelection(D)}),i.preventDefault(),e.stop());return}if(!f.isCollapsed&&!i.shiftKey){const R=f.getFirstPosition(),D=f.getLastPosition(),$=R.nodeAfter,Z=D.nodeBefore;($&&h.isObject($)||Z&&h.isObject(Z))&&(d.change(nt=>{nt.setSelection(C?D:R)}),i.preventDefault(),e.stop());return}if(!f.isCollapsed)return;const P=this._getObjectElementNextToSelection(C);if(P&&h.isObject(P)){if(h.isInline(P)&&y)return;this._setSelectionOverElement(P),i.preventDefault(),e.stop()}}_preventDefaultOnArrowKeyPress(e,i){const a=this.editor.model,d=a.schema,h=a.document.selection.getSelectedElement();h&&d.isObject(h)&&(i.preventDefault(),e.stop())}_handleDelete(e){const a=this.editor.model.document.selection;if(!this.editor.model.canEditAt(a)||!a.isCollapsed)return;const d=this._getObjectElementNextToSelection(e);if(d)return this.editor.model.change(h=>{let f=a.anchor.parent;for(;f.isEmpty;){const b=f;f=b.parent,h.remove(b)}this._setSelectionOverElement(d)}),!0}_setSelectionOverElement(e){this.editor.model.change(i=>{i.setSelection(i.createRangeOn(e))})}_getObjectElementNextToSelection(e){const i=this.editor.model,a=i.schema,d=i.document.selection,h=i.createSelection(d);if(i.modifySelection(h,{direction:e?"forward":"backward"}),h.isEqual(d))return null;const f=e?h.focus.nodeBefore:h.focus.nodeAfter;return f&&a.isObject(f)?f:null}_clearPreviouslySelectedWidgets(e){for(const i of this._previouslySelected)e.removeClass(p_,i);this._previouslySelected.clear()}}function eB(s){let e=s;for(;e;){if(e.is("editableElement")&&!e.is("rootElement"))return!0;if(un(e))return!1;e=e.parent}return!1}function nB(s,e){return e?Array.from(s.getAncestors()).includes(e):!1}function iB(s,e){for(const i of s.getAncestors({includeSelf:!0,parentFirst:!0})){if(e.checkChild(i,"$text"))return i;if(e.isLimit(i)&&!e.isObject(i))break}return null}function oB(s,e){const i=new To({startPosition:s});for(const{item:a}of i){if(e.isLimit(a)||!a.is("element"))return null;if(e.checkChild(a,"$text"))return a}return null}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Ii(s,e,i,a){e&&sB(s,e,a),i&&fn(s,i,a)}function fn(s,e,i){if(e.attributes)for(const[a,d]of Object.entries(e.attributes))s.setAttribute(a,d,i);e.styles&&s.setStyle(e.styles,i),e.classes&&s.addClass(e.classes,i)}function sB(s,e,i){if(e.attributes)for(const[a]of Object.entries(e.attributes))s.removeAttribute(a,i);if(e.styles)for(const a of Object.keys(e.styles))s.removeStyle(a,i);e.classes&&s.removeClass(e.classes,i)}function rB(s,e){const i=nO(s);let a="attributes";for(a in e)a=="classes"?i[a]=Array.from(new Set([...s[a]||[],...e[a]])):i[a]={...s[a],...e[a]};return i}function bo(s,e,i,a,d){const h=e.getAttribute(i),f={};for(const b of["attributes","styles","classes"]){if(b!=a){h&&h[b]&&(f[b]=h[b]);continue}if(a=="classes"){const C=new Set(h&&h.classes||[]);d(C),C.size&&(f[b]=Array.from(C));continue}const k=new Map(Object.entries(h&&h[b]||{}));d(k),k.size&&(f[b]=Object.fromEntries(k))}Object.keys(f).length?e.is("documentSelection")?s.setSelectionAttribute(i,f):s.setAttribute(i,f,e):h&&(e.is("documentSelection")?s.removeSelectionAttribute(i):s.removeAttribute(i,e))}function aB(s){return a5(s).replace(/ /g,"")}function je(s){return`html${aB(s)}Attributes`}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function $u({model:s}){return(e,i)=>i.writer.createElement(s,{htmlContent:e.getCustomProperty("$rawContent")})}function lB(s,{view:e,isInline:i}){const a=s.t;return(d,{writer:h})=>{const f=a("HTML object"),b=ll(e,d,h),k=d.getAttribute(je(e));h.addClass("html-object-embed__content",b),k&&fn(h,k,b);const C=h.createContainerElement(i?"span":"div",{class:"html-object-embed","data-html-object-embed-label":f},b);return Fv(C,h,{label:f})}}function ll(s,e,i){return i.createRawElement(s,null,(a,d)=>{d.setContentOf(a,e.getAttribute("htmlContent"))})}function cB({view:s,model:e,allowEmpty:i},a){return h=>{h.on(`element:${s}`,(f,b,k)=>{let C=a.processViewAttributes(b.viewItem,k);if(!(!C&&!k.consumable.test(b.viewItem,{name:!0}))){if(C=C||{},k.consumable.consume(b.viewItem,{name:!0}),b.modelRange||(b=Object.assign(b,k.convertChildren(b.viewItem,b.modelCursor))),i&&b.modelRange.isCollapsed&&Object.keys(C).length){const y=k.writer.createElement("htmlEmptyElement");if(!k.safeInsert(y,b.modelCursor))return;const P=k.getSplitParts(y);b.modelRange=k.writer.createRange(b.modelRange.start,k.writer.createPositionAfter(P[P.length-1])),k.updateConversionResult(y,b),d(y,C,k);return}for(const y of b.modelRange.getItems())d(y,C,k)}},{priority:"low"})};function d(h,f,b){if(b.schema.checkAttribute(h,e)){const k=h.getAttribute(e),C=rB(f,k||{});b.writer.setAttribute(e,C,h)}}}function k_({model:s,view:e},i){return(a,{writer:d,consumable:h})=>{if(!a.hasAttribute(s))return null;const f=d.createContainerElement(e),b=a.getAttribute(s);return h.consume(a,`attribute:${s}`),fn(d,b,f),f.getFillerOffset=()=>null,i?Fv(f,d):f}}function dB({priority:s,view:e}){return(i,a)=>{if(!i)return;const{writer:d}=a,h=d.createAttributeElement(e,null,{priority:s});return fn(d,i,h),h}}function hr({view:s},e){return i=>{i.on(`element:${s}`,(a,d,h)=>{if(!d.modelRange||d.modelRange.isCollapsed)return;const f=e.processViewAttributes(d.viewItem,h);f&&h.writer.setAttribute(je(d.viewItem.name),f,d.modelRange)},{priority:"low"})}}function fr({view:s,model:e}){return i=>{i.on(`attribute:${je(s)}:${e}`,(a,d,h)=>{if(!h.consumable.consume(d.item,a.name))return;const{attributeOldValue:f,attributeNewValue:b}=d,k=h.writer,C=h.mapper.toViewElement(d.item);Ii(k,f,b,C)})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const v_={block:[{model:"codeBlock",view:"pre"},{model:"paragraph",view:"p"},{model:"blockQuote",view:"blockquote"},{model:"listItem",view:"li"},{model:"pageBreak",view:"div"},{model:"rawHtml",view:"div"},{model:"table",view:"table"},{model:"tableRow",view:"tr"},{model:"tableCell",view:"td"},{model:"tableCell",view:"th"},{model:"tableColumnGroup",view:"colgroup"},{model:"tableColumn",view:"col"},{model:"caption",view:"caption"},{model:"caption",view:"figcaption"},{model:"imageBlock",view:"img"},{model:"imageInline",view:"img"},{model:"htmlP",view:"p",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlBlockquote",view:"blockquote",modelSchema:{inheritAllFrom:"$container"}},{model:"htmlTable",view:"table",modelSchema:{allowWhere:"$block",isBlock:!0}},{model:"htmlTbody",view:"tbody",modelSchema:{allowIn:"htmlTable",isBlock:!1}},{model:"htmlThead",view:"thead",modelSchema:{allowIn:"htmlTable",isBlock:!1}},{model:"htmlTfoot",view:"tfoot",modelSchema:{allowIn:"htmlTable",isBlock:!1}},{model:"htmlCaption",view:"caption",modelSchema:{allowIn:"htmlTable",allowChildren:"$text",isBlock:!1}},{model:"htmlColgroup",view:"colgroup",modelSchema:{allowIn:"htmlTable",allowChildren:"col",isBlock:!1}},{model:"htmlCol",view:"col",modelSchema:{allowIn:"htmlColgroup",isBlock:!1}},{model:"htmlTr",view:"tr",modelSchema:{allowIn:["htmlTable","htmlThead","htmlTbody"],isLimit:!0}},{model:"htmlTd",view:"td",modelSchema:{allowIn:"htmlTr",allowContentOf:"$container",isLimit:!0,isBlock:!1}},{model:"htmlTh",view:"th",modelSchema:{allowIn:"htmlTr",allowContentOf:"$container",isLimit:!0,isBlock:!1}},{model:"htmlFigure",view:"figure",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlFigcaption",view:"figcaption",modelSchema:{allowIn:"htmlFigure",allowChildren:"$text",isBlock:!1}},{model:"htmlAddress",view:"address",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlAside",view:"aside",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlMain",view:"main",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlDetails",view:"details",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlSummary",view:"summary",modelSchema:{allowChildren:"$text",allowIn:"htmlDetails",isBlock:!1}},{model:"htmlDiv",view:"div",paragraphLikeModel:"htmlDivParagraph",modelSchema:{inheritAllFrom:"$container"}},{model:"htmlFieldset",view:"fieldset",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlLegend",view:"legend",modelSchema:{allowIn:"htmlFieldset",allowChildren:"$text"}},{model:"htmlHeader",view:"header",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlFooter",view:"footer",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlForm",view:"form",modelSchema:{inheritAllFrom:"$container",isBlock:!0}},{model:"htmlHgroup",view:"hgroup",modelSchema:{allowChildren:["htmlH1","htmlH2","htmlH3","htmlH4","htmlH5","htmlH6"],isBlock:!1}},{model:"htmlH1",view:"h1",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH2",view:"h2",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH3",view:"h3",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH4",view:"h4",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH5",view:"h5",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH6",view:"h6",modelSchema:{inheritAllFrom:"$block"}},{model:"$htmlList",modelSchema:{allowWhere:"$container",allowChildren:["$htmlList","htmlLi"],isBlock:!1}},{model:"htmlDir",view:"dir",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlMenu",view:"menu",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlUl",view:"ul",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlOl",view:"ol",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlLi",view:"li",modelSchema:{allowIn:"$htmlList",allowChildren:"$text",isBlock:!1}},{model:"htmlPre",view:"pre",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlArticle",view:"article",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlSection",view:"section",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlNav",view:"nav",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlDivDl",view:"div",modelSchema:{allowChildren:["htmlDt","htmlDd"],allowIn:"htmlDl"}},{model:"htmlDl",view:"dl",modelSchema:{allowWhere:"$container",allowChildren:["htmlDt","htmlDd","htmlDivDl"],isBlock:!1}},{model:"htmlDt",view:"dt",modelSchema:{allowChildren:"$block",isBlock:!1}},{model:"htmlDd",view:"dd",modelSchema:{allowChildren:"$block",isBlock:!1}},{model:"htmlCenter",view:"center",modelSchema:{inheritAllFrom:"$container",isBlock:!1}}],inline:[{model:"htmlLiAttributes",view:"li",appliesToBlock:!0,coupledAttribute:"listItemId"},{model:"htmlOlAttributes",view:"ol",appliesToBlock:!0,coupledAttribute:"listItemId"},{model:"htmlUlAttributes",view:"ul",appliesToBlock:!0,coupledAttribute:"listItemId"},{model:"htmlFigureAttributes",view:"figure",appliesToBlock:"table"},{model:"htmlTheadAttributes",view:"thead",appliesToBlock:"table"},{model:"htmlTbodyAttributes",view:"tbody",appliesToBlock:"table"},{model:"htmlFigureAttributes",view:"figure",appliesToBlock:"imageBlock"},{model:"htmlAcronym",view:"acronym",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlTt",view:"tt",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlFont",view:"font",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlTime",view:"time",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlVar",view:"var",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlBig",view:"big",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSmall",view:"small",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSamp",view:"samp",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlQ",view:"q",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlOutput",view:"output",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlKbd",view:"kbd",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlBdi",view:"bdi",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlBdo",view:"bdo",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlAbbr",view:"abbr",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlA",view:"a",priority:5,coupledAttribute:"linkHref"},{model:"htmlStrong",view:"strong",coupledAttribute:"bold",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlB",view:"b",coupledAttribute:"bold",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlI",view:"i",coupledAttribute:"italic",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlEm",view:"em",coupledAttribute:"italic",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlS",view:"s",coupledAttribute:"strikethrough",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlDel",view:"del",coupledAttribute:"strikethrough",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlIns",view:"ins",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlU",view:"u",coupledAttribute:"underline",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSub",view:"sub",coupledAttribute:"subscript",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSup",view:"sup",coupledAttribute:"superscript",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlCode",view:"code",coupledAttribute:"code",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlMark",view:"mark",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSpan",view:"span",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlCite",view:"cite",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlLabel",view:"label",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlDfn",view:"dfn",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlObject",view:"object",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlIframe",view:"iframe",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlInput",view:"input",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlButton",view:"button",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlTextarea",view:"textarea",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlSelect",view:"select",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlVideo",view:"video",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlEmbed",view:"embed",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlOembed",view:"oembed",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlAudio",view:"audio",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlImg",view:"img",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlCanvas",view:"canvas",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlMeter",view:"meter",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlProgress",view:"progress",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlScript",view:"script",modelSchema:{allowWhere:["$text","$block"],isInline:!0}},{model:"htmlStyle",view:"style",modelSchema:{allowWhere:["$text","$block"],isInline:!0}},{model:"htmlCustomElement",view:"$customElement",modelSchema:{allowWhere:["$text","$block"],allowAttributesOf:"$inlineObject",isInline:!0}}]};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Lo extends oe{constructor(){super(...arguments),this._definitions=[]}static get pluginName(){return"DataSchema"}init(){for(const e of v_.block)this.registerBlockElement(e);for(const e of v_.inline)this.registerInlineElement(e)}registerBlockElement(e){this._definitions.push({...e,isBlock:!0})}registerInlineElement(e){this._definitions.push({...e,isInline:!0})}extendBlockElement(e){this._extendDefinition({...e,isBlock:!0})}extendInlineElement(e){this._extendDefinition({...e,isInline:!0})}getDefinitionsForView(e,i=!1){const a=new Set;for(const d of this._getMatchingViewDefinitions(e)){if(i)for(const h of this._getReferences(d.model))a.add(h);a.add(d)}return a}getDefinitionsForModel(e){return this._definitions.filter(i=>i.model==e)}_getMatchingViewDefinitions(e){return this._definitions.filter(i=>i.view&&uB(e,i.view))}*_getReferences(e){const i=["inheritAllFrom","inheritTypesFrom","allowWhere","allowContentOf","allowAttributesOf"],a=this._definitions.filter(d=>d.model==e);for(const{modelSchema:d}of a)if(d)for(const h of i)for(const f of ke(d[h]||[])){const b=this._definitions.filter(k=>k.model==f);for(const k of b)f!==e&&(yield*this._getReferences(k.model),yield k)}}_extendDefinition(e){const i=Array.from(this._definitions.entries()).filter(([,a])=>a.model==e.model);if(i.length==0){this._definitions.push(e);return}for(const[a,d]of i)this._definitions[a]=KO({},d,e,(h,f)=>Array.isArray(h)?h.concat(f):void 0)}}function uB(s,e){return typeof s=="string"?s===e:s instanceof RegExp?s.test(e):!1}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class jt extends oe{constructor(e){super(e),this._dataSchema=e.plugins.get("DataSchema"),this._allowedAttributes=new nr,this._disallowedAttributes=new nr,this._allowedElements=new Set,this._disallowedElements=new Set,this._dataInitialized=!1,this._coupledAttributes=null,this._registerElementsAfterInit(),this._registerElementHandlers(),this._registerCoupledAttributesPostFixer(),this._registerAssociatedHtmlAttributesPostFixer()}static get pluginName(){return"DataFilter"}static get requires(){return[Lo,tB]}loadAllowedConfig(e){for(const i of e){const a=i.name||/[\s\S]+/,d=C_(i);this.allowElement(a),d.forEach(h=>this.allowAttributes(h))}}loadDisallowedConfig(e){for(const i of e){const a=i.name||/[\s\S]+/,d=C_(i);d.length==0?this.disallowElement(a):d.forEach(h=>this.disallowAttributes(h))}}loadAllowedEmptyElementsConfig(e){for(const i of e)this.allowEmptyElement(i)}allowElement(e){for(const i of this._dataSchema.getDefinitionsForView(e,!0))this._addAllowedElement(i),this._coupledAttributes=null}disallowElement(e){for(const i of this._dataSchema.getDefinitionsForView(e,!1))this._disallowedElements.add(i.view)}allowEmptyElement(e){for(const i of this._dataSchema.getDefinitionsForView(e,!0))i.isInline&&this._dataSchema.extendInlineElement({...i,allowEmpty:!0})}allowAttributes(e){this._allowedAttributes.add(e)}disallowAttributes(e){this._disallowedAttributes.add(e)}processViewAttributes(e,i){return y_(e,i,this._disallowedAttributes),y_(e,i,this._allowedAttributes)}_addAllowedElement(e){if(!this._allowedElements.has(e)){if(this._allowedElements.add(e),"appliesToBlock"in e&&typeof e.appliesToBlock=="string")for(const i of this._dataSchema.getDefinitionsForModel(e.appliesToBlock))i.isBlock&&this._addAllowedElement(i);this._dataInitialized&&this.editor.data.once("set",()=>{this._fireRegisterEvent(e)},{priority:Un.highest+1})}}_registerElementsAfterInit(){this.editor.data.on("init",()=>{this._dataInitialized=!0;for(const e of this._allowedElements)this._fireRegisterEvent(e)},{priority:Un.highest+1})}_registerElementHandlers(){this.on("register",(e,i)=>{const a=this.editor.model.schema;if(i.isObject&&!a.isRegistered(i.model))this._registerObjectElement(i);else if(i.isBlock)this._registerBlockElement(i);else if(i.isInline)this._registerInlineElement(i);else throw new M("data-filter-invalid-definition",null,i);e.stop()},{priority:"lowest"})}_registerCoupledAttributesPostFixer(){const e=this.editor.model,i=e.document.selection;e.document.registerPostFixer(a=>{const d=e.document.differ.getChanges();let h=!1;const f=this._getCoupledAttributesMap();for(const b of d){if(b.type!="attribute"||b.attributeNewValue!==null)continue;const k=f.get(b.attributeKey);if(k)for(const{item:C}of b.range.getWalker())for(const y of k)C.hasAttribute(y)&&(a.removeAttribute(y,C),h=!0)}return h}),this.listenTo(i,"change:attribute",(a,{attributeKeys:d})=>{const h=new Set,f=this._getCoupledAttributesMap();for(const b of d){if(i.hasAttribute(b))continue;const k=f.get(b);if(k)for(const C of k)i.hasAttribute(C)&&h.add(C)}h.size!=0&&e.change(b=>{for(const k of h)b.removeSelectionAttribute(k)})})}_registerAssociatedHtmlAttributesPostFixer(){const e=this.editor.model;e.document.registerPostFixer(i=>{const a=e.document.differ.getChanges();let d=!1;for(const h of a)if(!(h.type!=="insert"||h.name==="$text"))for(const f of h.attributes.keys())!f.startsWith("html")||!f.endsWith("Attributes")||e.schema.checkAttribute(h.name,f)||(i.removeAttribute(f,h.position.nodeAfter),d=!0);return d})}_getCoupledAttributesMap(){if(this._coupledAttributes)return this._coupledAttributes;this._coupledAttributes=new Map;for(const e of this._allowedElements)if(e.coupledAttribute&&e.model){const i=this._coupledAttributes.get(e.coupledAttribute);i?i.push(e.model):this._coupledAttributes.set(e.coupledAttribute,[e.model])}return this._coupledAttributes}_fireRegisterEvent(e){e.view&&this._disallowedElements.has(e.view)||this.fire(e.view?`register:${e.view}`:"register",e)}_registerObjectElement(e){const i=this.editor,a=i.model.schema,d=i.conversion,{view:h,model:f}=e;a.register(f,e.modelSchema);/* istanbul ignore next: paranoid check -- @preserve */h&&(a.extend(e.model,{allowAttributes:[je(h),"htmlContent"]}),i.data.registerRawContentMatcher({name:h}),d.for("upcast").elementToElement({view:h,model:$u(e),converterPriority:Un.low+2}),d.for("upcast").add(hr(e,this)),d.for("editingDowncast").elementToStructure({model:{name:f,attributes:[je(h)]},view:lB(i,e)}),d.for("dataDowncast").elementToElement({model:f,view:(b,{writer:k})=>ll(h,b,k)}),d.for("dataDowncast").add(fr(e)))}_registerBlockElement(e){const i=this.editor,a=i.model.schema,d=i.conversion,{view:h,model:f}=e;if(!a.isRegistered(e.model)){if(a.register(e.model,e.modelSchema),!h)return;d.for("upcast").elementToElement({model:f,view:h,converterPriority:Un.low+2}),d.for("downcast").elementToElement({model:f,view:h})}h&&(a.extend(e.model,{allowAttributes:je(h)}),d.for("upcast").add(hr(e,this)),d.for("downcast").add(fr(e)))}_registerInlineElement(e){const i=this.editor,a=i.model.schema,d=i.conversion,h=e.model;e.appliesToBlock||(a.extend("$text",{allowAttributes:h}),e.attributeProperties&&a.setAttributeProperties(h,e.attributeProperties),d.for("upcast").add(cB(e,this)),d.for("downcast").attributeToElement({model:h,view:dB(e)}),e.allowEmpty&&(a.setAttributeProperties(h,{copyFromObject:!1}),a.isRegistered("htmlEmptyElement")||a.register("htmlEmptyElement",{inheritAllFrom:"$inlineObject"}),i.data.htmlProcessor.domConverter.registerInlineObjectMatcher(f=>f.name==e.view&&f.isEmpty&&Array.from(f.getAttributeKeys()).length?{name:!0}:null),d.for("editingDowncast").elementToElement({model:"htmlEmptyElement",view:k_(e,!0)}),d.for("dataDowncast").elementToElement({model:"htmlEmptyElement",view:k_(e)})))}}function y_(s,e,i){const a=hB(s,e,i),{attributes:d,styles:h,classes:f}=gB(a),b={};if(d.size)for(const k of d)Qk(k)||d.delete(k);return d.size&&(b.attributes=A_(d,k=>s.getAttribute(k))),h.size&&(b.styles=A_(h,k=>s.getStyle(k))),f.size&&(b.classes=Array.from(f)),Object.keys(b).length?b:null}function hB(s,{consumable:e},i){const a=i.matchAll(s)||[],d=[];for(const h of a)fB(e,s,h),delete h.match.name,e.consume(s,h.match),d.push(h);return d}function fB(s,e,i){for(const a of["attributes","classes","styles"]){const d=i.match[a];if(d)for(const h of Array.from(d))s.test(e,{[a]:[h]})||s5(d,h)}}function gB(s){const e={attributes:new Set,classes:new Set,styles:new Set};for(const i of s)for(const a in e)(i.match[a]||[]).forEach(h=>e[a].add(h));return e}function A_(s,e){const i={};for(const a of s)e(a)!==void 0&&(i[a]=e(a));return i}function Dd(s,e){const{name:i}=s,a=s[e];return Mn(a)?Object.entries(a).map(([d,h])=>({name:i,[e]:{[d]:h}})):Array.isArray(a)?a.map(d=>({name:i,[e]:[d]})):[s]}function C_(s){const{name:e,attributes:i,classes:a,styles:d}=s,h=[];return i&&h.push(...Dd({name:e,attributes:i},"attributes")),a&&h.push(...Dd({name:e,classes:a},"classes")),d&&h.push(...Dd({name:e,styles:d},"styles")),h}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class mB extends oe{static get requires(){return[jt]}static get pluginName(){return"CodeBlockElementSupport"}init(){if(!this.editor.plugins.has("CodeBlockEditing"))return;const e=this.editor.plugins.get(jt);e.on("register:pre",(i,a)=>{if(a.model!=="codeBlock")return;const d=this.editor,h=d.model.schema,f=d.conversion;h.extend("codeBlock",{allowAttributes:["htmlPreAttributes","htmlContentAttributes"]}),f.for("upcast").add(pB(e)),f.for("downcast").add(bB()),i.stop()})}}function pB(s){return e=>{e.on("element:code",(i,a,d)=>{const h=a.viewItem,f=h.parent;if(!f||!f.is("element","pre"))return;b(f,"htmlPreAttributes"),b(h,"htmlContentAttributes");function b(k,C){const y=s.processViewAttributes(k,d);y&&d.writer.setAttribute(C,y,a.modelRange)}},{priority:"low"})}}function bB(){return s=>{s.on("attribute:htmlPreAttributes:codeBlock",(e,i,a)=>{if(!a.consumable.consume(i.item,e.name))return;const{attributeOldValue:d,attributeNewValue:h}=i,b=a.mapper.toViewElement(i.item).parent;Ii(a.writer,d,h,b)}),s.on("attribute:htmlContentAttributes:codeBlock",(e,i,a)=>{if(!a.consumable.consume(i.item,e.name))return;const{attributeOldValue:d,attributeNewValue:h}=i,f=a.mapper.toViewElement(i.item);Ii(a.writer,d,h,f)})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class wB extends oe{static get requires(){return[jt]}static get pluginName(){return"DualContentModelElementSupport"}init(){this.editor.plugins.get(jt).on("register",(i,a)=>{const d=a,h=this.editor,f=h.model.schema,b=h.conversion;if(!d.paragraphLikeModel||f.isRegistered(d.model)||f.isRegistered(d.paragraphLikeModel))return;const k={model:d.paragraphLikeModel,view:d.view};f.register(d.model,d.modelSchema),f.register(k.model,{inheritAllFrom:"$block"}),b.for("upcast").elementToElement({view:d.view,model:(C,{writer:y})=>this._hasBlockContent(C)?y.createElement(d.model):y.createElement(k.model),converterPriority:Un.low+.5}),b.for("downcast").elementToElement({view:d.view,model:d.model}),this._addAttributeConversion(d),b.for("downcast").elementToElement({view:k.view,model:k.model}),this._addAttributeConversion(k),i.stop()})}_hasBlockContent(e){const i=this.editor.editing.view,a=i.domConverter.blockElements;for(const d of i.createRangeIn(e).getItems())if(d.is("element")&&a.includes(d.name))return!0;return!1}_addAttributeConversion(e){const i=this.editor,a=i.conversion,d=i.plugins.get(jt);i.model.schema.extend(e.model,{allowAttributes:je(e.view)}),a.for("upcast").add(hr(e,d)),a.for("downcast").add(fr(e))}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class _B extends oe{static get requires(){return[Lo,Bv]}static get pluginName(){return"HeadingElementSupport"}init(){const e=this.editor;if(!e.plugins.has("HeadingEditing"))return;const i=e.config.get("heading.options");this.registerHeadingElements(e,i)}registerHeadingElements(e,i){const a=e.plugins.get(Lo),d=[];for(const h of i)"model"in h&&"view"in h&&(a.registerBlockElement({view:h.view,model:h.model}),d.push(h.model));a.extendBlockElement({model:"htmlHgroup",modelSchema:{allowChildren:d}})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Ga(s,e,i){const a=s.createRangeOn(e);for(const{item:d}of a.getWalker())if(d.is("element",i))return d}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class kB extends oe{static get requires(){return[jt]}static get pluginName(){return"ImageElementSupport"}init(){const e=this.editor;if(!e.plugins.has("ImageInlineEditing")&&!e.plugins.has("ImageBlockEditing"))return;const i=e.model.schema,a=e.conversion,d=e.plugins.get(jt);d.on("register:figure",()=>{a.for("upcast").add(AB(d))}),d.on("register:img",(h,f)=>{f.model!=="imageBlock"&&f.model!=="imageInline"||(i.isRegistered("imageBlock")&&i.extend("imageBlock",{allowAttributes:["htmlImgAttributes","htmlFigureAttributes","htmlLinkAttributes"]}),i.isRegistered("imageInline")&&i.extend("imageInline",{allowAttributes:["htmlA","htmlImgAttributes"]}),a.for("upcast").add(vB(d)),a.for("downcast").add(CB()),e.plugins.has("LinkImage")&&a.for("upcast").add(yB(d,e)),h.stop())})}}function vB(s){return e=>{e.on("element:img",(i,a,d)=>{if(!a.modelRange)return;const h=a.viewItem,f=s.processViewAttributes(h,d);f&&d.writer.setAttribute("htmlImgAttributes",f,a.modelRange)},{priority:"low"})}}function yB(s,e){const i=e.plugins.get("ImageUtils");return a=>{a.on("element:a",(d,h,f)=>{const b=h.viewItem;if(!i.findViewImgElement(b))return;const C=h.modelCursor.parent;if(!C.is("element","imageBlock"))return;const y=s.processViewAttributes(b,f);y&&f.writer.setAttribute("htmlLinkAttributes",y,C)},{priority:"low"})}}function AB(s){return e=>{e.on("element:figure",(i,a,d)=>{const h=a.viewItem;if(!a.modelRange||!h.hasClass("image"))return;const f=s.processViewAttributes(h,d);f&&d.writer.setAttribute("htmlFigureAttributes",f,a.modelRange)},{priority:"low"})}}function CB(){return s=>{e("htmlImgAttributes"),i("img","htmlImgAttributes"),i("figure","htmlFigureAttributes"),i("a","htmlLinkAttributes");function e(a){s.on(`attribute:${a}:imageInline`,(d,h,f)=>{if(!f.consumable.consume(h.item,d.name))return;const{attributeOldValue:b,attributeNewValue:k}=h,C=f.mapper.toViewElement(h.item);Ii(f.writer,b,k,C)},{priority:"low"})}function i(a,d){s.on(`attribute:${d}:imageBlock`,(h,f,b)=>{if(!b.consumable.test(f.item,h.name))return;const{attributeOldValue:k,attributeNewValue:C}=f,y=b.mapper.toViewElement(f.item),P=Ga(b.writer,y,a);P&&(Ii(b.writer,k,C,P),b.consumable.consume(f.item,h.name))},{priority:"low"}),a==="a"&&s.on("attribute:linkHref:imageBlock",(h,f,b)=>{if(!b.consumable.consume(f.item,"attribute:htmlLinkAttributes:imageBlock"))return;const k=b.mapper.toViewElement(f.item),C=Ga(b.writer,k,"a");fn(b.writer,f.item.getAttribute("htmlLinkAttributes"),C)},{priority:"low"})}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class xB extends oe{static get requires(){return[jt]}static get pluginName(){return"MediaEmbedElementSupport"}init(){const e=this.editor;if(!e.plugins.has("MediaEmbed")||e.config.get("mediaEmbed.previewsInData"))return;const i=e.model.schema,a=e.conversion,d=this.editor.plugins.get(jt),h=this.editor.plugins.get(Lo),f=e.config.get("mediaEmbed.elementName");h.registerBlockElement({model:"media",view:f}),d.on("register:figure",()=>{a.for("upcast").add(TB(d))}),d.on(`register:${f}`,(b,k)=>{k.model==="media"&&(i.extend("media",{allowAttributes:[je(f),"htmlFigureAttributes"]}),a.for("upcast").add(EB(d,f)),a.for("dataDowncast").add(SB(f)),b.stop())})}}function EB(s,e){const i=(a,d,h)=>{const f=d.viewItem;b(f,je(e));function b(k,C){const y=s.processViewAttributes(k,h);y&&h.writer.setAttribute(C,y,d.modelRange)}};return a=>{a.on(`element:${e}`,i,{priority:"low"})}}function TB(s){return e=>{e.on("element:figure",(i,a,d)=>{const h=a.viewItem;if(!a.modelRange||!h.hasClass("media"))return;const f=s.processViewAttributes(h,d);f&&d.writer.setAttribute("htmlFigureAttributes",f,a.modelRange)},{priority:"low"})}}function SB(s){return e=>{i(s,je(s)),i("figure","htmlFigureAttributes");function i(a,d){e.on(`attribute:${d}:media`,(h,f,b)=>{if(!b.consumable.consume(f.item,h.name))return;const{attributeOldValue:k,attributeNewValue:C}=f,y=b.mapper.toViewElement(f.item),P=Ga(b.writer,y,a);Ii(b.writer,k,C,P)})}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class PB extends oe{static get requires(){return[jt]}static get pluginName(){return"ScriptElementSupport"}init(){const e=this.editor.plugins.get(jt);e.on("register:script",(i,a)=>{const d=this.editor,h=d.model.schema,f=d.conversion;h.register("htmlScript",a.modelSchema),h.extend("htmlScript",{allowAttributes:["htmlScriptAttributes","htmlContent"],isContent:!0}),d.data.registerRawContentMatcher({name:"script"}),f.for("upcast").elementToElement({view:"script",model:$u(a)}),f.for("upcast").add(hr(a,e)),f.for("downcast").elementToElement({model:"htmlScript",view:(b,{writer:k})=>ll("script",b,k)}),f.for("downcast").add(fr(a)),i.stop()})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class IB extends oe{static get requires(){return[jt]}static get pluginName(){return"TableElementSupport"}init(){const e=this.editor;if(!e.plugins.has("TableEditing"))return;const i=e.model.schema,a=e.conversion,d=e.plugins.get(jt),h=e.plugins.get("TableUtils");d.on("register:figure",()=>{a.for("upcast").add(OB(d))}),d.on("register:table",(f,b)=>{b.model==="table"&&(i.extend("table",{allowAttributes:["htmlTableAttributes","htmlFigureAttributes","htmlTheadAttributes","htmlTbodyAttributes"]}),a.for("upcast").add(RB(d)),a.for("downcast").add(NB()),e.model.document.registerPostFixer(MB(e.model,h)),f.stop())})}}function MB(s,e){return i=>{const a=s.document.differ.getChanges();let d=!1;for(const h of a){if(h.type!="attribute"||h.attributeKey!="headingRows")continue;const f=h.range.start.nodeAfter,b=f.getAttribute("htmlTheadAttributes"),k=f.getAttribute("htmlTbodyAttributes");b&&!h.attributeNewValue?(i.removeAttribute("htmlTheadAttributes",f),d=!0):k&&h.attributeNewValue==e.getRows(f)&&(i.removeAttribute("htmlTbodyAttributes",f),d=!0)}return d}}function RB(s){return e=>{e.on("element:table",(i,a,d)=>{if(!a.modelRange)return;const h=a.viewItem;f(h,"htmlTableAttributes");for(const b of h.getChildren())b.is("element","thead")&&f(b,"htmlTheadAttributes"),b.is("element","tbody")&&f(b,"htmlTbodyAttributes");function f(b,k){const C=s.processViewAttributes(b,d);C&&d.writer.setAttribute(k,C,a.modelRange)}},{priority:"low"})}}function OB(s){return e=>{e.on("element:figure",(i,a,d)=>{const h=a.viewItem;if(!a.modelRange||!h.hasClass("table"))return;const f=s.processViewAttributes(h,d);f&&d.writer.setAttribute("htmlFigureAttributes",f,a.modelRange)},{priority:"low"})}}function NB(){return s=>{e("table","htmlTableAttributes"),e("figure","htmlFigureAttributes"),e("thead","htmlTheadAttributes"),e("tbody","htmlTbodyAttributes");function e(i,a){s.on(`attribute:${a}:table`,(d,h,f)=>{if(!f.consumable.test(h.item,d.name))return;const b=f.mapper.toViewElement(h.item),k=Ga(f.writer,b,i);k&&(f.consumable.consume(h.item,d.name),Ii(f.writer,h.attributeOldValue,h.attributeNewValue,k))})}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class DB extends oe{static get requires(){return[jt]}static get pluginName(){return"StyleElementSupport"}init(){const e=this.editor.plugins.get(jt);e.on("register:style",(i,a)=>{const d=this.editor,h=d.model.schema,f=d.conversion;h.register("htmlStyle",a.modelSchema),h.extend("htmlStyle",{allowAttributes:["htmlStyleAttributes","htmlContent"],isContent:!0}),d.data.registerRawContentMatcher({name:"style"}),f.for("upcast").elementToElement({view:"style",model:$u(a)}),f.for("upcast").add(hr(a,e)),f.for("downcast").elementToElement({model:"htmlStyle",view:(b,{writer:k})=>ll("style",b,k)}),f.for("downcast").add(fr(a)),i.stop()})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class LB extends oe{static get requires(){return[jt]}static get pluginName(){return"ListElementSupport"}init(){const e=this.editor;if(!e.plugins.has("ListEditing"))return;const i=e.model.schema,a=e.conversion,d=e.plugins.get(jt),h=e.plugins.get("ListEditing"),f=["ul","ol","li"];h.registerDowncastStrategy({scope:"item",attributeName:"htmlLiAttributes",setAttributeOnDowncast:fn}),h.registerDowncastStrategy({scope:"list",attributeName:"htmlUlAttributes",setAttributeOnDowncast:fn}),h.registerDowncastStrategy({scope:"list",attributeName:"htmlOlAttributes",setAttributeOnDowncast:fn}),d.on("register",(b,k)=>{if(!f.includes(k.view)||(b.stop(),i.checkAttribute("$block","htmlLiAttributes")))return;const C=f.map(y=>je(y));i.extend("$listItem",{allowAttributes:C}),a.for("upcast").add(y=>{y.on("element:ul",Ld("htmlUlAttributes",d),{priority:"low"}),y.on("element:ol",Ld("htmlOlAttributes",d),{priority:"low"}),y.on("element:li",Ld("htmlLiAttributes",d),{priority:"low"})})}),h.on("postFixer",(b,{listNodes:k,writer:C})=>{for(const{node:y,previousNodeInList:P}of k)if(P){if(P.getAttribute("listType")==y.getAttribute("listType")){const R=x_(P.getAttribute("listType")),D=P.getAttribute(R);!Va(y.getAttribute(R),D)&&C.model.schema.checkAttribute(y,R)&&(C.setAttribute(R,D,y),b.return=!0)}if(P.getAttribute("listItemId")==y.getAttribute("listItemId")){const R=P.getAttribute("htmlLiAttributes");!Va(y.getAttribute("htmlLiAttributes"),R)&&C.model.schema.checkAttribute(y,"htmlLiAttributes")&&(C.setAttribute("htmlLiAttributes",R,y),b.return=!0)}}}),h.on("postFixer",(b,{listNodes:k,writer:C})=>{for(const{node:y}of k){const P=y.getAttribute("listType");P!=="numbered"&&y.getAttribute("htmlOlAttributes")&&(C.removeAttribute("htmlOlAttributes",y),b.return=!0),P==="numbered"&&y.getAttribute("htmlUlAttributes")&&(C.removeAttribute("htmlUlAttributes",y),b.return=!0)}})}afterInit(){const e=this.editor;if(!e.commands.get("indentList"))return;const i=e.commands.get("indentList");this.listenTo(i,"afterExecute",(a,d)=>{e.model.change(h=>{for(const f of d){const b=x_(f.getAttribute("listType"));e.model.schema.checkAttribute(f,b)&&h.setAttribute(b,{},f)}})})}}function Ld(s,e){return(i,a,d)=>{const h=a.viewItem;a.modelRange||Object.assign(a,d.convertChildren(a.viewItem,a.modelCursor));const f=e.processViewAttributes(h,d);for(const b of a.modelRange.getItems({shallow:!0}))b.hasAttribute("listItemId")&&(b.hasAttribute(s)||d.writer.model.schema.checkAttribute(b,s)&&d.writer.setAttribute(s,f||{},b))}}function x_(s){return s==="numbered"?"htmlOlAttributes":"htmlUlAttributes"}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class VB extends oe{static get requires(){return[jt,Lo]}static get pluginName(){return"CustomElementSupport"}init(){const e=this.editor.plugins.get(jt),i=this.editor.plugins.get(Lo);e.on("register:$customElement",(a,d)=>{a.stop();const h=this.editor,f=h.model.schema,b=h.conversion,k=h.editing.view.domConverter.unsafeElements,C=h.data.htmlProcessor.domConverter.preElements;f.register(d.model,d.modelSchema),f.extend(d.model,{allowAttributes:["htmlElementName","htmlCustomElementAttributes","htmlContent"],isContent:!0}),h.data.htmlProcessor.domConverter.registerRawContentMatcher({name:"template"}),b.for("upcast").elementToElement({view:/.*/,model:(y,P)=>{if(y.name=="$comment"||!BB(y.name)||i.getDefinitionsForView(y.name).size)return null;k.includes(y.name)||k.push(y.name),C.includes(y.name)||C.push(y.name);const R=P.writer.createElement(d.model,{htmlElementName:y.name}),D=e.processViewAttributes(y,P);D&&P.writer.setAttribute("htmlCustomElementAttributes",D,R);let $;if(y.is("element","template")&&y.getCustomProperty("$rawContent"))$=y.getCustomProperty("$rawContent");else{const nt=new sD(y.document).createDocumentFragment(y),ot=h.data.htmlProcessor.domConverter.viewToDom(nt),Lt=ot.firstChild;for(;Lt.firstChild;)ot.appendChild(Lt.firstChild);Lt.remove(),$=h.data.htmlProcessor.htmlWriter.getHtml(ot)}P.writer.setAttribute("htmlContent",$,R);for(const{item:Z}of h.editing.view.createRangeIn(y))P.consumable.consume(Z,{name:!0});return R},converterPriority:"low"}),b.for("editingDowncast").elementToElement({model:{name:d.model,attributes:["htmlElementName","htmlCustomElementAttributes","htmlContent"]},view:(y,{writer:P})=>{const R=y.getAttribute("htmlElementName"),D=P.createRawElement(R);return y.hasAttribute("htmlCustomElementAttributes")&&fn(P,y.getAttribute("htmlCustomElementAttributes"),D),D}}),b.for("dataDowncast").elementToElement({model:{name:d.model,attributes:["htmlElementName","htmlCustomElementAttributes","htmlContent"]},view:(y,{writer:P})=>{const R=y.getAttribute("htmlElementName"),D=y.getAttribute("htmlContent"),$=P.createRawElement(R,null,(Z,nt)=>{nt.setContentOf(Z,D)});return y.hasAttribute("htmlCustomElementAttributes")&&fn(P,y.getAttribute("htmlCustomElementAttributes"),$),$}})})}}function BB(s){try{document.createElement(s)}catch{return!1}return!0}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class FB extends oe{static get pluginName(){return"GeneralHtmlSupport"}static get requires(){return[jt,mB,wB,_B,kB,xB,PB,IB,DB,LB,VB]}init(){const e=this.editor,i=e.plugins.get(jt);i.loadAllowedEmptyElementsConfig(e.config.get("htmlSupport.allowEmpty")||[]),i.loadAllowedConfig(e.config.get("htmlSupport.allow")||[]),i.loadDisallowedConfig(e.config.get("htmlSupport.disallow")||[])}getGhsAttributeNameForElement(e){const i=this.editor.plugins.get("DataSchema"),a=Array.from(i.getDefinitionsForView(e,!1)),d=a.find(h=>h.isInline&&!a[0].isObject);return d?d.model:je(e)}addModelHtmlClass(e,i,a){const d=this.editor.model,h=this.getGhsAttributeNameForElement(e);d.change(f=>{for(const b of wo(d,a,h))bo(f,b,h,"classes",k=>{for(const C of ke(i))k.add(C)})})}removeModelHtmlClass(e,i,a){const d=this.editor.model,h=this.getGhsAttributeNameForElement(e);d.change(f=>{for(const b of wo(d,a,h))bo(f,b,h,"classes",k=>{for(const C of ke(i))k.delete(C)})})}setModelHtmlAttributes(e,i,a){const d=this.editor.model,h=this.getGhsAttributeNameForElement(e);d.change(f=>{for(const b of wo(d,a,h))bo(f,b,h,"attributes",k=>{for(const[C,y]of Object.entries(i))k.set(C,y)})})}removeModelHtmlAttributes(e,i,a){const d=this.editor.model,h=this.getGhsAttributeNameForElement(e);d.change(f=>{for(const b of wo(d,a,h))bo(f,b,h,"attributes",k=>{for(const C of ke(i))k.delete(C)})})}setModelHtmlStyles(e,i,a){const d=this.editor.model,h=this.getGhsAttributeNameForElement(e);d.change(f=>{for(const b of wo(d,a,h))bo(f,b,h,"styles",k=>{for(const[C,y]of Object.entries(i))k.set(C,y)})})}removeModelHtmlStyles(e,i,a){const d=this.editor.model,h=this.getGhsAttributeNameForElement(e);d.change(f=>{for(const b of wo(d,a,h))bo(f,b,h,"styles",k=>{for(const C of ke(i))k.delete(C)})})}}function*wo(s,e,i){if(e)if(!(Symbol.iterator in e)&&e.is("documentSelection")&&e.isCollapsed)s.schema.checkAttributeInSelection(e,i)&&(yield e);else for(const a of zB(s,e,i))yield*a.getItems({shallow:!0})}function zB(s,e,i){return!(Symbol.iterator in e)&&(e.is("node")||e.is("$text")||e.is("$textProxy"))?s.schema.checkAttribute(e,i)?[s.createRangeOn(e)]:[]:s.schema.getValidRanges(s.createSelection(e).getRanges(),i)}const Vo={selector:"[data-ckeditor]",basicSelector:"[data-basic-ckeditor]",init:s=>{s._CKEDITOR=Fb.create(s,{plugins:[FB]})},initBasic:s=>{s._CKEDITOR=Fb.create(s,{toolbar:["undo","redo","|","heading","|","bold","italic","link","|","bulletedList","numberedList"]})}};document.querySelectorAll(Vo.selector).forEach(s=>Vo.init(s));document.querySelectorAll(Vo.basicSelector).forEach(s=>Vo.initBasic(s));const jB=s=>s.replace(/\[\]/g,"").replace(/\[/g,".").replace(/\]/g,""),$B=s=>jB(s).replace(/\./g,"_"),HB=s=>{const e=s.split(".");let i="";return e.forEach((a,d)=>{if(d===0){i+=a;return}if(a==="*"){i+="[]";return}i+=`[${a}]`}),i};function Be(s,e){if(s==null)return null;function i(d){return d==null||e==null?!1:WB(e)?Element.prototype.matches.call(d,e):qB(e)?[...e].includes(d):UB(e)?e===d:GB(e)?e(d):!1}let a=s;do{if(a=a.correspondingUseElement||a.correspondingElement||a,i(a))return a;a=(a==null?void 0:a.parentNode)||null}while(a!=null&&a!==document.body&&a!==document);return null}function WB(s){return typeof s=="string"}function qB(s){return s instanceof NodeList||s instanceof Array}function UB(s){return s instanceof Node}function GB(s){return typeof s=="function"}class cl{constructor(e){this.draggable=e}attach(){throw new Error("Not Implemented")}detach(){throw new Error("Not Implemented")}}const xa=Symbol("onInitialize"),Ea=Symbol("onDestroy"),E_=Symbol("announceEvent"),Vd=Symbol("announceMessage"),KB="aria-relevant",YB="aria-atomic",JB="aria-live",QB="role",XB={expire:7e3};class ZB extends cl{constructor(e){super(e),this.options={...XB,...this.getOptions()},this.originalTriggerMethod=this.draggable.trigger,this[xa]=this[xa].bind(this),this[Ea]=this[Ea].bind(this)}attach(){this.draggable.on("draggable:initialize",this[xa])}detach(){this.draggable.off("draggable:destroy",this[Ea])}getOptions(){return this.draggable.options.announcements||{}}[E_](e){const i=this.options[e.type];i&&typeof i=="string"&&this[Vd](i),i&&typeof i=="function"&&this[Vd](i(e))}[Vd](e){tF(e,{expire:this.options.expire})}[xa](){this.draggable.trigger=e=>{try{this[E_](e)}finally{this.originalTriggerMethod.call(this.draggable,e)}}}[Ea](){this.draggable.trigger=this.originalTriggerMethod}}const hu=eF();function tF(s,{expire:e}){const i=document.createElement("div");return i.textContent=s,hu.appendChild(i),setTimeout(()=>{hu.removeChild(i)},e)}function eF(){const s=document.createElement("div");return s.setAttribute("id","draggable-live-region"),s.setAttribute(KB,"additions"),s.setAttribute(YB,"true"),s.setAttribute(JB,"assertive"),s.setAttribute(QB,"log"),s.style.position="fixed",s.style.width="1px",s.style.height="1px",s.style.top="-1px",s.style.overflow="hidden",s}document.addEventListener("DOMContentLoaded",()=>{document.body.appendChild(hu)});const _s=Symbol("onInitialize"),_o=Symbol("onDestroy"),nF={};class iF extends cl{constructor(e){super(e),this.options={...nF,...this.getOptions()},this[_s]=this[_s].bind(this),this[_o]=this[_o].bind(this)}attach(){this.draggable.on("draggable:initialize",this[_s]).on("draggable:destroy",this[_o])}detach(){this.draggable.off("draggable:initialize",this[_s]).off("draggable:destroy",this[_o]),this[_o]()}getOptions(){return this.draggable.options.focusable||{}}getElements(){return[...this.draggable.containers,...this.draggable.getDraggableElements()]}[_s](){requestAnimationFrame(()=>{this.getElements().forEach(e=>oF(e))})}[_o](){requestAnimationFrame(()=>{this.getElements().forEach(e=>sF(e))})}}const fu=[];function oF(s){!s.getAttribute("tabindex")&&s.tabIndex===-1&&(fu.push(s),s.tabIndex=0)}function sF(s){const e=fu.indexOf(s);e!==-1&&(s.tabIndex=-1,fu.splice(e,1))}class Bi{constructor(e){this._canceled=!1,this.data=e}get type(){return this.constructor.type}get cancelable(){return this.constructor.cancelable}cancel(){this._canceled=!0}canceled(){return this._canceled}clone(e){return new this.constructor({...this.data,...e})}}Bi.type="event";Bi.cancelable=!1;class Ho extends Bi{constructor(e){super(e),this.data=e}get source(){return this.data.source}get originalSource(){return this.data.originalSource}get sourceContainer(){return this.data.sourceContainer}get sensorEvent(){return this.data.sensorEvent}get dragEvent(){return this.data.dragEvent}get originalEvent(){return this.sensorEvent?this.sensorEvent.originalEvent:null}}class jv extends Ho{}jv.type="mirror:create";class $v extends Ho{get mirror(){return this.data.mirror}}$v.type="mirror:created";class Hv extends Ho{get mirror(){return this.data.mirror}}Hv.type="mirror:attached";class Hu extends Ho{get mirror(){return this.data.mirror}get passedThreshX(){return this.data.passedThreshX}get passedThreshY(){return this.data.passedThreshY}}Hu.type="mirror:move";Hu.cancelable=!0;class Wv extends Ho{get mirror(){return this.data.mirror}get passedThreshX(){return this.data.passedThreshX}get passedThreshY(){return this.data.passedThreshY}}Wv.type="mirror:moved";class Wu extends Ho{get mirror(){return this.data.mirror}}Wu.type="mirror:destroy";Wu.cancelable=!0;const ks=Symbol("onDragStart"),vs=Symbol("onDragMove"),ys=Symbol("onDragStop"),As=Symbol("onMirrorCreated"),Cs=Symbol("onMirrorMove"),xs=Symbol("onScroll"),T_=Symbol("getAppendableContainer"),rF={constrainDimensions:!1,xAxis:!0,yAxis:!0,cursorOffsetX:null,cursorOffsetY:null,thresholdX:null,thresholdY:null};class aF extends cl{constructor(e){super(e),this.options={...rF,...this.getOptions()},this.scrollOffset={x:0,y:0},this.initialScrollOffset={x:window.scrollX,y:window.scrollY},this[ks]=this[ks].bind(this),this[vs]=this[vs].bind(this),this[ys]=this[ys].bind(this),this[As]=this[As].bind(this),this[Cs]=this[Cs].bind(this),this[xs]=this[xs].bind(this)}attach(){this.draggable.on("drag:start",this[ks]).on("drag:move",this[vs]).on("drag:stop",this[ys]).on("mirror:created",this[As]).on("mirror:move",this[Cs])}detach(){this.draggable.off("drag:start",this[ks]).off("drag:move",this[vs]).off("drag:stop",this[ys]).off("mirror:created",this[As]).off("mirror:move",this[Cs])}getOptions(){return this.draggable.options.mirror||{}}[ks](e){if(e.canceled())return;"ontouchstart"in window&&document.addEventListener("scroll",this[xs],!0),this.initialScrollOffset={x:window.scrollX,y:window.scrollY};const{source:i,originalSource:a,sourceContainer:d,sensorEvent:h}=e;this.lastMirrorMovedClient={x:h.clientX,y:h.clientY};const f=new jv({source:i,originalSource:a,sourceContainer:d,sensorEvent:h,dragEvent:e});if(this.draggable.trigger(f),fF(h)||f.canceled())return;const b=this[T_](i)||d;this.mirror=i.cloneNode(!0);const k=new $v({source:i,originalSource:a,sourceContainer:d,sensorEvent:h,dragEvent:e,mirror:this.mirror}),C=new Hv({source:i,originalSource:a,sourceContainer:d,sensorEvent:h,dragEvent:e,mirror:this.mirror});this.draggable.trigger(k),b.appendChild(this.mirror),this.draggable.trigger(C)}[vs](e){if(!this.mirror||e.canceled())return;const{source:i,originalSource:a,sourceContainer:d,sensorEvent:h}=e;let f=!0,b=!0;if(this.options.thresholdX||this.options.thresholdY){const{x:C,y}=this.lastMirrorMovedClient;if(Math.abs(C-h.clientX)<this.options.thresholdX?f=!1:this.lastMirrorMovedClient.x=h.clientX,Math.abs(y-h.clientY)<this.options.thresholdY?b=!1:this.lastMirrorMovedClient.y=h.clientY,!f&&!b)return}const k=new Hu({source:i,originalSource:a,sourceContainer:d,sensorEvent:h,dragEvent:e,mirror:this.mirror,passedThreshX:f,passedThreshY:b});this.draggable.trigger(k)}[ys](e){if("ontouchstart"in window&&document.removeEventListener("scroll",this[xs],!0),this.initialScrollOffset={x:0,y:0},this.scrollOffset={x:0,y:0},!this.mirror)return;const{source:i,sourceContainer:a,sensorEvent:d}=e,h=new Wu({source:i,mirror:this.mirror,sourceContainer:a,sensorEvent:d,dragEvent:e});this.draggable.trigger(h),h.canceled()||this.mirror.remove()}[xs](){this.scrollOffset={x:window.scrollX-this.initialScrollOffset.x,y:window.scrollY-this.initialScrollOffset.y}}[As]({mirror:e,source:i,sensorEvent:a}){const d=this.draggable.getClassNamesFor("mirror"),h=({mirrorOffset:b,initialX:k,initialY:C,...y})=>(this.mirrorOffset=b,this.initialX=k,this.initialY=C,this.lastMovedX=k,this.lastMovedY=C,{mirrorOffset:b,initialX:k,initialY:C,...y});e.style.display="none";const f={mirror:e,source:i,sensorEvent:a,mirrorClasses:d,scrollOffset:this.scrollOffset,options:this.options,passedThreshX:!0,passedThreshY:!0};return Promise.resolve(f).then(lF).then(cF).then(dF).then(uF).then(S_({initial:!0})).then(hF).then(h)}[Cs](e){if(e.canceled())return null;const i=({lastMovedX:h,lastMovedY:f,...b})=>(this.lastMovedX=h,this.lastMovedY=f,{lastMovedX:h,lastMovedY:f,...b}),a=h=>{const f=new Wv({source:e.source,originalSource:e.originalSource,sourceContainer:e.sourceContainer,sensorEvent:e.sensorEvent,dragEvent:e.dragEvent,mirror:this.mirror,passedThreshX:e.passedThreshX,passedThreshY:e.passedThreshY});return this.draggable.trigger(f),h},d={mirror:e.mirror,sensorEvent:e.sensorEvent,mirrorOffset:this.mirrorOffset,options:this.options,initialX:this.initialX,initialY:this.initialY,scrollOffset:this.scrollOffset,passedThreshX:e.passedThreshX,passedThreshY:e.passedThreshY,lastMovedX:this.lastMovedX,lastMovedY:this.lastMovedY};return Promise.resolve(d).then(S_({raf:!0})).then(i).then(a)}[T_](e){const i=this.options.appendTo;return typeof i=="string"?document.querySelector(i):i instanceof HTMLElement?i:typeof i=="function"?i(e):e.parentNode}}function lF({source:s,...e}){return Wo(i=>{const a=s.getBoundingClientRect();i({source:s,sourceRect:a,...e})})}function cF({sensorEvent:s,sourceRect:e,options:i,...a}){return Wo(d=>{const h=i.cursorOffsetY===null?s.clientY-e.top:i.cursorOffsetY,f=i.cursorOffsetX===null?s.clientX-e.left:i.cursorOffsetX;d({sensorEvent:s,sourceRect:e,mirrorOffset:{top:h,left:f},options:i,...a})})}function dF({mirror:s,source:e,options:i,...a}){return Wo(d=>{let h,f;if(i.constrainDimensions){const b=getComputedStyle(e);h=b.getPropertyValue("height"),f=b.getPropertyValue("width")}s.style.display=null,s.style.position="fixed",s.style.pointerEvents="none",s.style.top=0,s.style.left=0,s.style.margin=0,i.constrainDimensions&&(s.style.height=h,s.style.width=f),d({mirror:s,source:e,options:i,...a})})}function uF({mirror:s,mirrorClasses:e,...i}){return Wo(a=>{s.classList.add(...e),a({mirror:s,mirrorClasses:e,...i})})}function hF({mirror:s,...e}){return Wo(i=>{s.removeAttribute("id"),delete s.id,i({mirror:s,...e})})}function S_({withFrame:s=!1,initial:e=!1}={}){return({mirror:i,sensorEvent:a,mirrorOffset:d,initialY:h,initialX:f,scrollOffset:b,options:k,passedThreshX:C,passedThreshY:y,lastMovedX:P,lastMovedY:R,...D})=>Wo($=>{const Z={mirror:i,sensorEvent:a,mirrorOffset:d,options:k,...D};if(d){const nt=C?Math.round((a.clientX-d.left-b.x)/(k.thresholdX||1))*(k.thresholdX||1):Math.round(P),ot=y?Math.round((a.clientY-d.top-b.y)/(k.thresholdY||1))*(k.thresholdY||1):Math.round(R);k.xAxis&&k.yAxis||e?i.style.transform=`translate3d(${nt}px, ${ot}px, 0)`:k.xAxis&&!k.yAxis?i.style.transform=`translate3d(${nt}px, ${h}px, 0)`:k.yAxis&&!k.xAxis&&(i.style.transform=`translate3d(${f}px, ${ot}px, 0)`),e&&(Z.initialX=nt,Z.initialY=ot),Z.lastMovedX=nt,Z.lastMovedY=ot}$(Z)},{frame:s})}function Wo(s,{raf:e=!1}={}){return new Promise((i,a)=>{e?requestAnimationFrame(()=>{s(i,a)}):s(i,a)})}function fF(s){return/^drag/.test(s.originalEvent.type)}const Es=Symbol("onDragStart"),Ts=Symbol("onDragMove"),Ss=Symbol("onDragStop"),Ps=Symbol("scroll"),gF={speed:6,sensitivity:50,scrollableElements:[]};class mF extends cl{constructor(e){super(e),this.options={...gF,...this.getOptions()},this.currentMousePosition=null,this.scrollAnimationFrame=null,this.scrollableElement=null,this.findScrollableElementFrame=null,this[Es]=this[Es].bind(this),this[Ts]=this[Ts].bind(this),this[Ss]=this[Ss].bind(this),this[Ps]=this[Ps].bind(this)}attach(){this.draggable.on("drag:start",this[Es]).on("drag:move",this[Ts]).on("drag:stop",this[Ss])}detach(){this.draggable.off("drag:start",this[Es]).off("drag:move",this[Ts]).off("drag:stop",this[Ss])}getOptions(){return this.draggable.options.scrollable||{}}getScrollableElement(e){return this.hasDefinedScrollableElements()?Be(e,this.options.scrollableElements)||document.documentElement:wF(e)}hasDefinedScrollableElements(){return this.options.scrollableElements.length!==0}[Es](e){this.findScrollableElementFrame=requestAnimationFrame(()=>{this.scrollableElement=this.getScrollableElement(e.source)})}[Ts](e){if(this.findScrollableElementFrame=requestAnimationFrame(()=>{this.scrollableElement=this.getScrollableElement(e.sensorEvent.target)}),!this.scrollableElement)return;const i=e.sensorEvent,a={x:0,y:0};"ontouchstart"in window&&(a.y=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,a.x=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0),this.currentMousePosition={clientX:i.clientX-a.x,clientY:i.clientY-a.y},this.scrollAnimationFrame=requestAnimationFrame(this[Ps])}[Ss](){cancelAnimationFrame(this.scrollAnimationFrame),cancelAnimationFrame(this.findScrollableElementFrame),this.scrollableElement=null,this.scrollAnimationFrame=null,this.findScrollableElementFrame=null,this.currentMousePosition=null}[Ps](){if(!this.scrollableElement||!this.currentMousePosition)return;cancelAnimationFrame(this.scrollAnimationFrame);const{speed:e,sensitivity:i}=this.options,a=this.scrollableElement.getBoundingClientRect(),d=a.bottom>window.innerHeight,f=a.top<0||d,b=gu(),k=this.scrollableElement,C=this.currentMousePosition.clientX,y=this.currentMousePosition.clientY;if(k!==document.body&&k!==document.documentElement&&!f){const{offsetHeight:P,offsetWidth:R}=k;a.top+P-y<i?k.scrollTop+=e:y-a.top<i&&(k.scrollTop-=e),a.left+R-C<i?k.scrollLeft+=e:C-a.left<i&&(k.scrollLeft-=e)}else{const{innerHeight:P,innerWidth:R}=window;y<i?b.scrollTop-=e:P-y<i&&(b.scrollTop+=e),C<i?b.scrollLeft-=e:R-C<i&&(b.scrollLeft+=e)}this.scrollAnimationFrame=requestAnimationFrame(this[Ps])}}function pF(s){const e=/(auto|scroll)/,i=getComputedStyle(s,null),a=i.getPropertyValue("overflow")+i.getPropertyValue("overflow-y")+i.getPropertyValue("overflow-x");return e.test(a)}function bF(s){return getComputedStyle(s).getPropertyValue("position")==="static"}function wF(s){if(!s)return gu();const e=getComputedStyle(s).getPropertyValue("position"),i=e==="absolute",a=Be(s,d=>i&&bF(d)?!1:pF(d));return e==="fixed"||!a?gu():a}function gu(){return document.scrollingElement||document.documentElement}class _F{constructor(){this.callbacks={}}on(e,...i){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(...i),this}off(e,i){if(!this.callbacks[e])return null;const a=this.callbacks[e].slice(0);for(let d=0;d<a.length;d++)i===a[d]&&this.callbacks[e].splice(d,1);return this}trigger(e){if(!this.callbacks[e.type])return null;const i=[...this.callbacks[e.type]],a=[];for(let d=i.length-1;d>=0;d--){const h=i[d];try{h(e)}catch(f){a.push(f)}}return a.length&&console.error(`Draggable caught errors while triggering '${e.type}'`,a),this}}function qv(s,e,i,a){return Math.sqrt((i-s)**2+(a-e)**2)}const ko={mouse:0,drag:0,touch:100};class Uv{constructor(e=[],i={}){this.containers=[...e],this.options={...i},this.dragging=!1,this.currentContainer=null,this.originalSource=null,this.startEvent=null,this.delay=kF(i.delay)}attach(){return this}detach(){return this}addContainer(...e){this.containers=[...this.containers,...e]}removeContainer(...e){this.containers=this.containers.filter(i=>!e.includes(i))}trigger(e,i){const a=document.createEvent("Event");return a.detail=i,a.initEvent(i.type,!0,!0),e.dispatchEvent(a),this.lastEvent=i,i}}function kF(s){const e={};if(s===void 0)return{...ko};if(typeof s=="number"){for(const i in ko)Object.prototype.hasOwnProperty.call(ko,i)&&(e[i]=s);return e}for(const i in ko)Object.prototype.hasOwnProperty.call(ko,i)&&(s[i]===void 0?e[i]=ko[i]:e[i]=s[i]);return e}class dl extends Bi{get originalEvent(){return this.data.originalEvent}get clientX(){return this.data.clientX}get clientY(){return this.data.clientY}get target(){return this.data.target}get container(){return this.data.container}get originalSource(){return this.data.originalSource}get pressure(){return this.data.pressure}}class qu extends dl{}qu.type="drag:start";class Uu extends dl{}Uu.type="drag:move";class Gu extends dl{}Gu.type="drag:stop";class vF extends dl{}vF.type="drag:pressure";const Is=Symbol("onContextMenuWhileDragging"),Ms=Symbol("onMouseDown"),Rs=Symbol("onMouseMove"),Os=Symbol("onMouseUp"),Ta=Symbol("startDrag"),jn=Symbol("onDistanceChange");class yF extends Uv{constructor(e=[],i={}){super(e,i),this.mouseDownTimeout=null,this.pageX=null,this.pageY=null,this[Is]=this[Is].bind(this),this[Ms]=this[Ms].bind(this),this[Rs]=this[Rs].bind(this),this[Os]=this[Os].bind(this),this[Ta]=this[Ta].bind(this),this[jn]=this[jn].bind(this)}attach(){document.addEventListener("mousedown",this[Ms],!0)}detach(){document.removeEventListener("mousedown",this[Ms],!0)}[Ms](e){if(e.button!==0||e.ctrlKey||e.metaKey)return;const i=Be(e.target,this.containers);if(!i||this.options.handle&&e.target&&!Be(e.target,this.options.handle))return;const a=Be(e.target,this.options.draggable);if(!a)return;const{delay:d}=this,{pageX:h,pageY:f}=e;Object.assign(this,{pageX:h,pageY:f}),this.onMouseDownAt=Date.now(),this.startEvent=e,this.currentContainer=i,this.originalSource=a,document.addEventListener("mouseup",this[Os]),document.addEventListener("dragstart",P_),document.addEventListener("mousemove",this[jn]),this.mouseDownTimeout=window.setTimeout(()=>{this[jn]({pageX:this.pageX,pageY:this.pageY})},d.mouse)}[Ta](){const e=this.startEvent,i=this.currentContainer,a=this.originalSource,d=new qu({clientX:e.clientX,clientY:e.clientY,target:e.target,container:i,originalSource:a,originalEvent:e});this.trigger(this.currentContainer,d),this.dragging=!d.canceled(),this.dragging&&(document.addEventListener("contextmenu",this[Is],!0),document.addEventListener("mousemove",this[Rs]))}[jn](e){const{pageX:i,pageY:a}=e,{distance:d}=this.options,{startEvent:h,delay:f}=this;if(Object.assign(this,{pageX:i,pageY:a}),!this.currentContainer)return;const b=Date.now()-this.onMouseDownAt,k=qv(h.pageX,h.pageY,i,a)||0;clearTimeout(this.mouseDownTimeout),b<f.mouse?document.removeEventListener("mousemove",this[jn]):k>=d&&(document.removeEventListener("mousemove",this[jn]),this[Ta]())}[Rs](e){if(!this.dragging)return;const i=document.elementFromPoint(e.clientX,e.clientY),a=new Uu({clientX:e.clientX,clientY:e.clientY,target:i,container:this.currentContainer,originalEvent:e});this.trigger(this.currentContainer,a)}[Os](e){if(clearTimeout(this.mouseDownTimeout),e.button!==0||(document.removeEventListener("mouseup",this[Os]),document.removeEventListener("dragstart",P_),document.removeEventListener("mousemove",this[jn]),!this.dragging))return;const i=document.elementFromPoint(e.clientX,e.clientY),a=new Gu({clientX:e.clientX,clientY:e.clientY,target:i,container:this.currentContainer,originalEvent:e});this.trigger(this.currentContainer,a),document.removeEventListener("contextmenu",this[Is],!0),document.removeEventListener("mousemove",this[Rs]),this.currentContainer=null,this.dragging=!1,this.startEvent=null}[Is](e){e.preventDefault()}}function P_(s){s.preventDefault()}function vo(s){const{touches:e,changedTouches:i}=s;return e&&e[0]||i&&i[0]}const Ns=Symbol("onTouchStart"),ki=Symbol("onTouchEnd"),Ds=Symbol("onTouchMove"),Sa=Symbol("startDrag"),$n=Symbol("onDistanceChange");let Oa=!1;window.addEventListener("touchmove",s=>{Oa&&s.preventDefault()},{passive:!1});class AF extends Uv{constructor(e=[],i={}){super(e,i),this.currentScrollableParent=null,this.tapTimeout=null,this.touchMoved=!1,this.pageX=null,this.pageY=null,this[Ns]=this[Ns].bind(this),this[ki]=this[ki].bind(this),this[Ds]=this[Ds].bind(this),this[Sa]=this[Sa].bind(this),this[$n]=this[$n].bind(this)}attach(){document.addEventListener("touchstart",this[Ns])}detach(){document.removeEventListener("touchstart",this[Ns])}[Ns](e){const i=Be(e.target,this.containers);if(!i||this.options.handle&&e.target&&!Be(e.target,this.options.handle))return;const a=Be(e.target,this.options.draggable);if(!a)return;const{distance:d=0}=this.options,{delay:h}=this,{pageX:f,pageY:b}=vo(e);Object.assign(this,{pageX:f,pageY:b}),this.onTouchStartAt=Date.now(),this.startEvent=e,this.currentContainer=i,this.originalSource=a,document.addEventListener("touchend",this[ki]),document.addEventListener("touchcancel",this[ki]),document.addEventListener("touchmove",this[$n]),i.addEventListener("contextmenu",I_),d&&(Oa=!0),this.tapTimeout=window.setTimeout(()=>{this[$n]({touches:[{pageX:this.pageX,pageY:this.pageY}]})},h.touch)}[Sa](){const e=this.startEvent,i=this.currentContainer,a=vo(e),d=this.originalSource,h=new qu({clientX:a.pageX,clientY:a.pageY,target:e.target,container:i,originalSource:d,originalEvent:e});this.trigger(this.currentContainer,h),this.dragging=!h.canceled(),this.dragging&&document.addEventListener("touchmove",this[Ds]),Oa=this.dragging}[$n](e){const{distance:i}=this.options,{startEvent:a,delay:d}=this,h=vo(a),f=vo(e),b=Date.now()-this.onTouchStartAt,k=qv(h.pageX,h.pageY,f.pageX,f.pageY);Object.assign(this,f),clearTimeout(this.tapTimeout),b<d.touch?document.removeEventListener("touchmove",this[$n]):k>=i&&(document.removeEventListener("touchmove",this[$n]),this[Sa]())}[Ds](e){if(!this.dragging)return;const{pageX:i,pageY:a}=vo(e),d=document.elementFromPoint(i-window.scrollX,a-window.scrollY),h=new Uu({clientX:i,clientY:a,target:d,container:this.currentContainer,originalEvent:e});this.trigger(this.currentContainer,h)}[ki](e){if(clearTimeout(this.tapTimeout),Oa=!1,document.removeEventListener("touchend",this[ki]),document.removeEventListener("touchcancel",this[ki]),document.removeEventListener("touchmove",this[$n]),this.currentContainer&&this.currentContainer.removeEventListener("contextmenu",I_),!this.dragging)return;document.removeEventListener("touchmove",this[Ds]);const{pageX:i,pageY:a}=vo(e),d=document.elementFromPoint(i-window.scrollX,a-window.scrollY);e.preventDefault();const h=new Gu({clientX:i,clientY:a,target:d,container:this.currentContainer,originalEvent:e});this.trigger(this.currentContainer,h),this.currentContainer=null,this.dragging=!1,this.startEvent=null}}function I_(s){s.preventDefault(),s.stopPropagation()}class Ku extends Bi{get draggable(){return this.data.draggable}}Ku.type="draggable";class Gv extends Ku{}Gv.type="draggable:initialize";class Kv extends Ku{}Kv.type="draggable:destroy";class mn extends Bi{constructor(e){super(e),this.data=e}get source(){return this.data.source}get originalSource(){return this.data.originalSource}get mirror(){return this.data.mirror}get sourceContainer(){return this.data.sourceContainer}get sensorEvent(){return this.data.sensorEvent}get originalEvent(){return this.sensorEvent?this.sensorEvent.originalEvent:null}}mn.type="drag";class Yu extends mn{}Yu.type="drag:start";Yu.cancelable=!0;class Yv extends mn{}Yv.type="drag:move";class Ju extends mn{get overContainer(){return this.data.overContainer}get over(){return this.data.over}}Ju.type="drag:over";Ju.cancelable=!0;class Jv extends mn{get overContainer(){return this.data.overContainer}get over(){return this.data.over}}Jv.type="drag:out";class Qv extends mn{get overContainer(){return this.data.overContainer}}Qv.type="drag:over:container";class Xv extends mn{get overContainer(){return this.data.overContainer}}Xv.type="drag:out:container";class Zv extends mn{get pressure(){return this.data.pressure}}Zv.type="drag:pressure";class Qu extends mn{}Qu.type="drag:stop";Qu.cancelable=!0;class ty extends mn{}ty.type="drag:stopped";const Ls=Symbol("onDragStart"),yo=Symbol("onDragMove"),Vs=Symbol("onDragStop"),Bs=Symbol("onDragPressure"),Fs=Symbol("dragStop"),CF={"drag:start":s=>`Picked up ${s.source.textContent.trim()||s.source.id||"draggable element"}`,"drag:stop":s=>`Released ${s.source.textContent.trim()||s.source.id||"draggable element"}`},xF={"container:dragging":"draggable-container--is-dragging","source:dragging":"draggable-source--is-dragging","source:placed":"draggable-source--placed","container:placed":"draggable-container--placed","body:dragging":"draggable--is-dragging","draggable:over":"draggable--over","container:over":"draggable-container--over","source:original":"draggable--original",mirror:"draggable-mirror"},EF={draggable:".draggable-source",handle:null,delay:{},distance:0,placedTimeout:800,plugins:[],sensors:[],exclude:{plugins:[],sensors:[]}};class Bo{constructor(e=[document.body],i={}){if(e instanceof NodeList||e instanceof Array)this.containers=[...e];else if(e instanceof HTMLElement)this.containers=[e];else throw new Error("Draggable containers are expected to be of type `NodeList`, `HTMLElement[]` or `HTMLElement`");this.options={...EF,...i,classes:{...xF,...i.classes||{}},announcements:{...CF,...i.announcements||{}},exclude:{plugins:i.exclude&&i.exclude.plugins||[],sensors:i.exclude&&i.exclude.sensors||[]}},this.emitter=new _F,this.dragging=!1,this.plugins=[],this.sensors=[],this[Ls]=this[Ls].bind(this),this[yo]=this[yo].bind(this),this[Vs]=this[Vs].bind(this),this[Bs]=this[Bs].bind(this),this[Fs]=this[Fs].bind(this),document.addEventListener("drag:start",this[Ls],!0),document.addEventListener("drag:move",this[yo],!0),document.addEventListener("drag:stop",this[Vs],!0),document.addEventListener("drag:pressure",this[Bs],!0);const a=Object.values(Bo.Plugins).filter(f=>!this.options.exclude.plugins.includes(f)),d=Object.values(Bo.Sensors).filter(f=>!this.options.exclude.sensors.includes(f));this.addPlugin(...a,...this.options.plugins),this.addSensor(...d,...this.options.sensors);const h=new Gv({draggable:this});this.on("mirror:created",({mirror:f})=>this.mirror=f),this.on("mirror:destroy",()=>this.mirror=null),this.trigger(h)}destroy(){document.removeEventListener("drag:start",this[Ls],!0),document.removeEventListener("drag:move",this[yo],!0),document.removeEventListener("drag:stop",this[Vs],!0),document.removeEventListener("drag:pressure",this[Bs],!0);const e=new Kv({draggable:this});this.trigger(e),this.removePlugin(...this.plugins.map(i=>i.constructor)),this.removeSensor(...this.sensors.map(i=>i.constructor))}addPlugin(...e){const i=e.map(a=>new a(this));return i.forEach(a=>a.attach()),this.plugins=[...this.plugins,...i],this}removePlugin(...e){return this.plugins.filter(a=>e.includes(a.constructor)).forEach(a=>a.detach()),this.plugins=this.plugins.filter(a=>!e.includes(a.constructor)),this}addSensor(...e){const i=e.map(a=>new a(this.containers,this.options));return i.forEach(a=>a.attach()),this.sensors=[...this.sensors,...i],this}removeSensor(...e){return this.sensors.filter(a=>e.includes(a.constructor)).forEach(a=>a.detach()),this.sensors=this.sensors.filter(a=>!e.includes(a.constructor)),this}addContainer(...e){return this.containers=[...this.containers,...e],this.sensors.forEach(i=>i.addContainer(...e)),this}removeContainer(...e){return this.containers=this.containers.filter(i=>!e.includes(i)),this.sensors.forEach(i=>i.removeContainer(...e)),this}on(e,...i){return this.emitter.on(e,...i),this}off(e,i){return this.emitter.off(e,i),this}trigger(e){return this.emitter.trigger(e),this}getClassNameFor(e){return this.getClassNamesFor(e)[0]}getClassNamesFor(e){const i=this.options.classes[e];return i instanceof Array?i:typeof i=="string"||i instanceof String?[i]:[]}isDragging(){return!!this.dragging}getDraggableElements(){return this.containers.reduce((e,i)=>[...e,...this.getDraggableElementsForContainer(i)],[])}getDraggableElementsForContainer(e){return[...e.querySelectorAll(this.options.draggable)].filter(a=>a!==this.originalSource&&a!==this.mirror)}cancel(){this[Fs]()}[Ls](e){const i=Pa(e),{target:a,container:d,originalSource:h}=i;if(!this.containers.includes(d))return;if(this.options.handle&&a&&!Be(a,this.options.handle)){i.cancel();return}this.originalSource=h,this.sourceContainer=d,this.lastPlacedSource&&this.lastPlacedContainer&&(clearTimeout(this.placedTimeoutID),this.lastPlacedSource.classList.remove(...this.getClassNamesFor("source:placed")),this.lastPlacedContainer.classList.remove(...this.getClassNamesFor("container:placed"))),this.source=this.originalSource.cloneNode(!0),this.originalSource.parentNode.insertBefore(this.source,this.originalSource),this.originalSource.style.display="none";const f=new Yu({source:this.source,originalSource:this.originalSource,sourceContainer:d,sensorEvent:i});if(this.trigger(f),this.dragging=!f.canceled(),f.canceled()){this.source.remove(),this.originalSource.style.display=null;return}this.originalSource.classList.add(...this.getClassNamesFor("source:original")),this.source.classList.add(...this.getClassNamesFor("source:dragging")),this.sourceContainer.classList.add(...this.getClassNamesFor("container:dragging")),document.body.classList.add(...this.getClassNamesFor("body:dragging")),M_(document.body,"none"),requestAnimationFrame(()=>{const k=Pa(e).clone({target:this.source});this[yo]({...e,detail:k})})}[yo](e){if(!this.dragging)return;const i=Pa(e),{container:a}=i;let d=i.target;const h=new Yv({source:this.source,originalSource:this.originalSource,sourceContainer:a,sensorEvent:i});this.trigger(h),h.canceled()&&i.cancel(),d=Be(d,this.options.draggable);const f=Be(i.target,this.containers),b=i.overContainer||f,k=this.currentOverContainer&&b!==this.currentOverContainer,C=this.currentOver&&d!==this.currentOver,y=b&&this.currentOverContainer!==b,P=f&&d&&this.currentOver!==d;if(C){const R=new Jv({source:this.source,originalSource:this.originalSource,sourceContainer:a,sensorEvent:i,over:this.currentOver,overContainer:this.currentOverContainer});this.currentOver.classList.remove(...this.getClassNamesFor("draggable:over")),this.currentOver=null,this.trigger(R)}if(k){const R=new Xv({source:this.source,originalSource:this.originalSource,sourceContainer:a,sensorEvent:i,overContainer:this.currentOverContainer});this.currentOverContainer.classList.remove(...this.getClassNamesFor("container:over")),this.currentOverContainer=null,this.trigger(R)}if(y){b.classList.add(...this.getClassNamesFor("container:over"));const R=new Qv({source:this.source,originalSource:this.originalSource,sourceContainer:a,sensorEvent:i,overContainer:b});this.currentOverContainer=b,this.trigger(R)}if(P){d.classList.add(...this.getClassNamesFor("draggable:over"));const R=new Ju({source:this.source,originalSource:this.originalSource,sourceContainer:a,sensorEvent:i,overContainer:b,over:d});this.currentOver=d,this.trigger(R)}}[Fs](e){if(!this.dragging)return;this.dragging=!1;const i=new Qu({source:this.source,originalSource:this.originalSource,sensorEvent:e?e.sensorEvent:null,sourceContainer:this.sourceContainer});this.trigger(i),i.canceled()||this.source.parentNode.insertBefore(this.originalSource,this.source),this.source.remove(),this.originalSource.style.display="",this.source.classList.remove(...this.getClassNamesFor("source:dragging")),this.originalSource.classList.remove(...this.getClassNamesFor("source:original")),this.originalSource.classList.add(...this.getClassNamesFor("source:placed")),this.sourceContainer.classList.add(...this.getClassNamesFor("container:placed")),this.sourceContainer.classList.remove(...this.getClassNamesFor("container:dragging")),document.body.classList.remove(...this.getClassNamesFor("body:dragging")),M_(document.body,""),this.currentOver&&this.currentOver.classList.remove(...this.getClassNamesFor("draggable:over")),this.currentOverContainer&&this.currentOverContainer.classList.remove(...this.getClassNamesFor("container:over")),this.lastPlacedSource=this.originalSource,this.lastPlacedContainer=this.sourceContainer,this.placedTimeoutID=setTimeout(()=>{this.lastPlacedSource&&this.lastPlacedSource.classList.remove(...this.getClassNamesFor("source:placed")),this.lastPlacedContainer&&this.lastPlacedContainer.classList.remove(...this.getClassNamesFor("container:placed")),this.lastPlacedSource=null,this.lastPlacedContainer=null},this.options.placedTimeout);const a=new ty({source:this.source,originalSource:this.originalSource,sensorEvent:e?e.sensorEvent:null,sourceContainer:this.sourceContainer});this.trigger(a),this.source=null,this.originalSource=null,this.currentOverContainer=null,this.currentOver=null,this.sourceContainer=null}[Vs](e){this[Fs](e)}[Bs](e){if(!this.dragging)return;const i=Pa(e),a=this.source||Be(i.originalEvent.target,this.options.draggable),d=new Zv({sensorEvent:i,source:a,pressure:i.pressure});this.trigger(d)}}Bo.Plugins={Announcement:ZB,Focusable:iF,Mirror:aF,Scrollable:mF};Bo.Sensors={MouseSensor:yF,TouchSensor:AF};function Pa(s){return s.detail}function M_(s,e){s.style.webkitUserSelect=e,s.style.mozUserSelect=e,s.style.msUserSelect=e,s.style.oUserSelect=e,s.style.userSelect=e}class _r extends Bi{constructor(e){super(e),this.data=e}get dragEvent(){return this.data.dragEvent}}_r.type="sortable";class Xu extends _r{get startIndex(){return this.data.startIndex}get startContainer(){return this.data.startContainer}}Xu.type="sortable:start";Xu.cancelable=!0;class Ka extends _r{get currentIndex(){return this.data.currentIndex}get over(){return this.data.over}get overContainer(){return this.data.dragEvent.overContainer}}Ka.type="sortable:sort";Ka.cancelable=!0;class mu extends _r{get oldIndex(){return this.data.oldIndex}get newIndex(){return this.data.newIndex}get oldContainer(){return this.data.oldContainer}get newContainer(){return this.data.newContainer}}mu.type="sortable:sorted";class ey extends _r{get oldIndex(){return this.data.oldIndex}get newIndex(){return this.data.newIndex}get oldContainer(){return this.data.oldContainer}get newContainer(){return this.data.newContainer}}ey.type="sortable:stop";const zs=Symbol("onDragStart"),js=Symbol("onDragOverContainer"),$s=Symbol("onDragOver"),Hs=Symbol("onDragStop");function TF({dragEvent:s}){const e=s.source.textContent.trim()||s.source.id||"sortable element";if(s.over){const i=s.over.textContent.trim()||s.over.id||"sortable element";return s.source.compareDocumentPosition(s.over)&Node.DOCUMENT_POSITION_FOLLOWING?`Placed ${e} after ${i}`:`Placed ${e} before ${i}`}else return`Placed ${e} into a different container`}const SF={"sortable:sorted":TF};class PF extends Bo{constructor(e=[],i={}){super(e,{...i,announcements:{...SF,...i.announcements||{}}}),this.startIndex=null,this.startContainer=null,this[zs]=this[zs].bind(this),this[js]=this[js].bind(this),this[$s]=this[$s].bind(this),this[Hs]=this[Hs].bind(this),this.on("drag:start",this[zs]).on("drag:over:container",this[js]).on("drag:over",this[$s]).on("drag:stop",this[Hs])}destroy(){super.destroy(),this.off("drag:start",this[zs]).off("drag:over:container",this[js]).off("drag:over",this[$s]).off("drag:stop",this[Hs])}index(e){return this.getSortableElementsForContainer(e.parentNode).indexOf(e)}getSortableElementsForContainer(e){return[...e.querySelectorAll(this.options.draggable)].filter(a=>a!==this.originalSource&&a!==this.mirror&&a.parentNode===e)}[zs](e){this.startContainer=e.source.parentNode,this.startIndex=this.index(e.source);const i=new Xu({dragEvent:e,startIndex:this.startIndex,startContainer:this.startContainer});this.trigger(i),i.canceled()&&e.cancel()}[js](e){if(e.canceled())return;const{source:i,over:a,overContainer:d}=e,h=this.index(i),f=new Ka({dragEvent:e,currentIndex:h,source:i,over:a});if(this.trigger(f),f.canceled())return;const b=this.getSortableElementsForContainer(d),k=O_({source:i,over:a,overContainer:d,children:b});if(!k)return;const{oldContainer:C,newContainer:y}=k,P=this.index(e.source),R=new mu({dragEvent:e,oldIndex:h,newIndex:P,oldContainer:C,newContainer:y});this.trigger(R)}[$s](e){if(e.over===e.originalSource||e.over===e.source)return;const{source:i,over:a,overContainer:d}=e,h=this.index(i),f=new Ka({dragEvent:e,currentIndex:h,source:i,over:a});if(this.trigger(f),f.canceled())return;const b=this.getDraggableElementsForContainer(d),k=O_({source:i,over:a,overContainer:d,children:b});if(!k)return;const{oldContainer:C,newContainer:y}=k,P=this.index(i),R=new mu({dragEvent:e,oldIndex:h,newIndex:P,oldContainer:C,newContainer:y});this.trigger(R)}[Hs](e){const i=new ey({dragEvent:e,oldIndex:this.startIndex,newIndex:this.index(e.source),oldContainer:this.startContainer,newContainer:e.source.parentNode});this.trigger(i),this.startIndex=null,this.startContainer=null}}function R_(s){return Array.prototype.indexOf.call(s.parentNode.children,s)}function O_({source:s,over:e,overContainer:i,children:a}){const d=!a.length,h=s.parentNode!==i,f=e&&s.parentNode===e.parentNode;return d?IF(s,i):f?MF(s,e):h?RF(s,e,i):null}function IF(s,e){const i=s.parentNode;return e.appendChild(s),{oldContainer:i,newContainer:e}}function MF(s,e){const i=R_(s),a=R_(e);return i<a?s.parentNode.insertBefore(s,e.nextElementSibling):s.parentNode.insertBefore(s,e),{oldContainer:s.parentNode,newContainer:s.parentNode}}function RF(s,e,i){const a=s.parentNode;return e?e.parentNode.insertBefore(s,e):i.appendChild(s),{oldContainer:a,newContainer:s.parentNode}}const F={itemSelector:"[data-repeated-field-item]",singleItemSelector:'[data-repeated-field-item=":id"]',rowsSelector:"[data-repeated-field-rows]",rowSelector:"[data-repeated-field-row]",rowIterationSelector:"[data-repeated-field-row-iteration]",rowIterationLabelSelector:"[data-repeated-field-row-iteration-label]",rowContentSelector:"[data-repeated-field-row-content]",templateSelector:"[data-repeated-field-template]",addRowSelector:"[data-repeated-field-add-row]",handleRowSelector:"[data-repeated-field-handle-row]",collapseRowSelector:"[data-repeated-field-collapse-row]",removeRowSelector:"[data-repeated-field-remove-row]",emptyInputSelector:"[data-repeated-field-empty-input]",formGroupSelector:"[data-form-group]",imageWrapperSelector:"[data-image-wrapper]",findContainer:s=>document.querySelector(F.singleItemSelector.replace(":id",s)),getRowsElement:s=>s.querySelector(F.rowsSelector),getRowsCount:s=>F.getRowsElement(s).children.length,getMaxRow:s=>{const e=Number(s.dataset.maxRow);return e===-1?1/0:e},getIndexOfRow(s){const e=s.closest(F.rowsSelector);return Array.from(e.children).indexOf(s)},getLastIndexOfRow(s){const e=s.closest(F.rowsSelector);return Number(e.getAttribute("data-last-row-index"))},parseName(s,e,i={}){const a=s.closest(F.itemSelector);let d=Number(s.getAttribute("data-row-index"));i.indexByDomOrder&&(d=F.getIndexOfRow(s)),i.selectedRowIndex===void 0&&(i.selectedRowIndex=d),i.dottedName||(i.dottedName=s.querySelector(`[data-form-field-key="${e}"]`).dataset.originalFormGroup),i.dottedName=i.dottedName.replace(/(.*)(\*.*)/,(k,C,y)=>C+y.replace(/\*/,d));const h=HB(i.dottedName),f=$B(h),b=a.closest(F.rowSelector);return b?F.parseName(b,e,i):{id:f,key:e,index:i.selectedRowIndex,computedName:h,dottedName:i.dottedName}},getTemplate:s=>{const e=s.querySelectorAll(F.templateSelector);return e[e.length-1]},addRow:s=>{const e=typeof s.itemContainer=="string"?F.findContainer(s.itemContainer):s.itemContainer,i=F.getRowsElement(e),a=F.getMaxRow(e);if(F.getRowsCount(e)>=a)return;const h=F.getTemplate(e).cloneNode(!0).content.children[0];i.appendChild(h),F.onAddRow(h,s),F.getRowsCount(e)>=a&&F.disableAddRowButton(e),Object.keys((s==null?void 0:s.fields)||{}).forEach(f=>{var k;const b=(k=s==null?void 0:s.fields)==null?void 0:k[f];Array.isArray(b)&&b.forEach((C,y)=>{const R=e.querySelectorAll(F.singleItemSelector.replace(":id",`${s==null?void 0:s.dottedName}.*.${f}`))[s.index];F.addRow({itemContainer:R,fields:C,errors:s==null?void 0:s.errors,dottedName:`${s==null?void 0:s.dottedName}.*.${f}`,index:y})})})},removeRow:s=>{s.preventDefault();const e=s.target.closest(F.itemSelector),i=e.dataset.repeatedFieldItem,a=s.target.closest(F.rowsSelector);a.children.length<=1&&a.classList.add("fd-hidden"),F.enableAddRowButton(i);const d=s.target.closest(F.rowSelector),{dottedName:h}=F.parseName(d.parentElement.closest(F.rowSelector)||d,void 0,{dottedName:i});F.addToRemoveList(e,`${h}.${Number(d.getAttribute("data-row-index"))}`),d.remove(),F.resetRowIndexes(a)},setRowIndexes:(s,e)=>{if(e.mode==="add"){const i=s.closest(F.rowsSelector);let a=0;i.hasAttribute("data-last-row-index")&&(a=Number(i.getAttribute("data-last-row-index"))+1),i.setAttribute("data-last-row-index",a),s.setAttribute("data-row-index",a),F.setRowInputs(s,e),F.prepareConditionalFields(s),bd.listen(s)}F.setIteration(s,e)},setRowInputs:(s,e)=>{s.querySelectorAll("[name]").forEach(i=>{var y,P,R;const a=i.closest(F.formGroupSelector),{id:d,key:h,computedName:f,dottedName:b}=F.parseName(s,a.dataset.formFieldKey),k=a.querySelector("label");k&&k.setAttribute("for",d),a.dataset.formGroup=b,i.setAttribute("name",f),i.setAttribute("id",d);const C=((y=e==null?void 0:e.fields)==null?void 0:y[h])||"";if(C){i.setAttribute("value",C),(P=i==null?void 0:i._CKEDITOR)==null||P.then($=>{$.setData(C)});const D=a.querySelector(F.imageWrapperSelector);if(D){const $=document.createElement("img");$.classList.add("fd-w-full","fd-h-full","fd-object-cover"),$.setAttribute("src",C),$.setAttribute("alt","Uploaded image"),D.append($)}if(i.tagName==="SELECT"){const $=i.querySelector(`option[value="${C}"]`);$==null||$.setAttribute("selected","selected")}if(i.type==="checkbox"&&(C==="0"||C==="false"?i.checked=!1:i.checked=!!C),i.type==="file"){const $=document.querySelector(Ft.fileDefaultTemplateSelector);i.after($.cloneNode(!0).content);const Z=a.querySelector(Ft.fileInfoSelector),nt=Z.querySelector("a"),ot=Z.querySelector(Ft.deleteFileSelector);nt.setAttribute("href",C),nt.textContent=C,ot.addEventListener("click",()=>{Ft.onRemoveFile(Z)})}}if((R=e==null?void 0:e.errors)!=null&&R[b]&&!a.classList.contains("fd-has-error")){a.classList.add("fd-has-error");const D=document.createElement("span");D.classList.add("fd-text-xs","fd-text-red-500"),D.innerText=e.errors[b][0],i.parentNode.parentNode.appendChild(D)}})},resetRowIndexes:(s,e="reset")=>{s.querySelectorAll(F.rowSelector).forEach(i=>{F.setRowIndexes(i,{mode:e})})},onAddRow:(s,e)=>{F.initPluginsBeforeSetRowIndexes(s),F.setRowIndexes(s,{...e,mode:"add"}),F.initPluginsAfterSetRowIndexes(s,e)},initPluginsBeforeSetRowIndexes:s=>{s.querySelectorAll(Vo.selector).forEach(i=>{Vo.init(i)}),s.querySelectorAll(Ft.imageSelector).forEach(i=>{Ft.handleImageInput(i.querySelector('input[type="file"]'))});const e=s.querySelectorAll("[data-code-editor]");e.length>0&&LT(()=>import("./code-editor-a98523db.js").then(i=>i.c),["assets/code-editor-a98523db.js","assets/preload-helper-edc1b5d6.js","assets/code-editor-ad044914.css"]).then(i=>{e.forEach(a=>{a._MONACO_EDITOR||i.default.createEditor(a)})})},initPluginsAfterSetRowIndexes:(s,e)=>{if(s.querySelectorAll(Ft.checkboxSelector).forEach(i=>{Ft.handleCheckbox(i)}),F.highlightRowIfError(s,e),F.listenCollapseRowButton(s),F.listenRemoveRowButton(s),F.removeEmptyInputIfNoRows(s.closest(F.rowsSelector)),(e==null?void 0:e.collapse)===!1){const i=s.querySelector(F.collapseRowSelector);F.handleCollapseRowButton(i)}},listenRemoveRowButton:s=>{s.querySelector(F.removeRowSelector).addEventListener("click",F.removeRow)},highlightRowIfError:(s,e,i=!1)=>{var d,h,f,b;if(!(e!=null&&e.errors)||!s)return;if(i){s.classList.add("fd-border","fd-border-red-500"),(h=(d=s.querySelector(F.rowIterationSelector))==null?void 0:d.classList)==null||h.add("fd-text-red-500"),(b=(f=s.querySelector(F.rowIterationLabelSelector))==null?void 0:f.classList)==null||b.add("fd-text-red-500");return}s.querySelectorAll(F.formGroupSelector).forEach(k=>{const{dottedName:C}=F.parseName(s,k.dataset.formFieldKey);e.errors[C]&&(F.highlightRowIfError(s,e,!0),F.highlightRowIfError(s.parentElement.closest(F.rowSelector),e,!0))})},listenCollapseRowButton:s=>{const e=s.querySelector(F.collapseRowSelector);e==null||e.addEventListener("click",i=>{i.preventDefault(),F.handleCollapseRowButton(e)})},handleCollapseRowButton:s=>{const i=s.closest(F.rowSelector).querySelector(F.rowContentSelector);i.classList.contains("fd-hidden")?(i.classList.remove("fd-hidden"),s.style.transform="rotate(90deg)"):(i.classList.add("fd-hidden"),s.style.transform="rotate(0deg)")},enableAddRowButton:s=>{F.findContainer(s).querySelector(F.addRowSelector).removeAttribute("disabled")},disableAddRowButton:s=>{s.querySelector(F.addRowSelector).setAttribute("disabled","disabled")},addToRemoveList:(s,e)=>{const i=document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name","_deleted_fields[]"),i.setAttribute("value",e),s.appendChild(i)},reorderRows:s=>{s.querySelectorAll("[name]").forEach(e=>{const i=e.closest(F.rowSelector),a=e.closest(F.formGroupSelector),d=s.closest(F.itemSelector),{dottedName:h}=F.parseName(i,a.dataset.formFieldKey,{indexByDomOrder:!0}),f=a.dataset.formGroup,b=h;if(f===b){const C=d.querySelector(`input[name="_reordered_fields[${f}]"]`);C==null||C.remove();return}const k=document.createElement("input");k.setAttribute("type","hidden"),k.setAttribute("name",`_reordered_fields[${f}]`),k.setAttribute("value",b),d.appendChild(k)})},removeEmptyInputIfNoRows:s=>{s.children.length<=0||(s.classList.remove("fd-hidden"),F.removeEmptyInput(s.closest(F.itemSelector).dataset.repeatedFieldItem))},addEmptyInput:s=>{const e=F.findContainer(s),i=document.createElement("input"),a=F.emptyInputSelector.replace(/\[|]/g,"");i.setAttribute("type","hidden"),i.setAttribute("name",e.dataset.repeatedFieldItem),i.setAttribute(a,a),e.appendChild(i)},removeEmptyInput:s=>{const i=F.findContainer(s).querySelector(F.emptyInputSelector);i==null||i.remove()},initializeSortable:s=>{const e=s.querySelector(F.rowsSelector),i=new PF(e,{draggable:F.rowSelector,handle:F.handleRowSelector,mirror:{constrainDimensions:!0}});i.on("sortable:sort",a=>{const d=a.dragEvent.data.originalSource,h=a.dragEvent.data.over;(d==null?void 0:d.parentElement)!==(h==null?void 0:h.parentElement)&&a.cancel()}),i.on("sortable:stop",a=>{setTimeout(()=>{const h=a.dragEvent.data.originalSource.closest(F.rowsSelector);F.reorderRows(h),F.resetRowIndexes(h,"sort")},250)})},prepareConditionalFields:s=>{s.querySelectorAll(bd.containerSelector).forEach(e=>{const a=bd.parseConditions(e).map(d=>{const{id:h}=F.parseName(s,d.key);return{...d,key:h}});e.dataset.conditionalFieldItem=JSON.stringify(a)})},setIteration:(s,e)=>{s.querySelectorAll(F.rowIterationSelector).forEach(i=>{i.innerText=`${F.getIndexOfRow(s)+1}.`}),e.mode==="add"&&s.querySelectorAll(F.rowIterationLabelSelector).forEach(i=>{const a=Ia.findFirstFormGroupForIterationLabel(s);a&&(Ia.handleImageField(a,i)||Ia.handleTextField(a,i)||Ia.handleSelectField(a,i))})}},Ia={findFirstFormGroupForIterationLabel:s=>{const e=s.querySelectorAll(F.formGroupSelector),i=Array.from(e).filter(a=>!a.querySelector('input[type="checkbox"]')&&!a.querySelector('input[type="radio"]')&&!a.hasAttribute("hidden"));return i==null?void 0:i[0]},handleImageField:(s,e)=>{var f;const i=s.querySelector(F.imageWrapperSelector);if(!i)return;const a=s.querySelector('input[type="file"]');if(!a)return;const d=i.querySelector("img");(f=e.querySelector("img"))==null||f.remove();const h=document.createElement("img");return h.classList.add("fd-w-12","fd-h-12","fd-border","fd-rounded-lg","fd-object-cover"),h.setAttribute("src",(d==null?void 0:d.src)||""),h.setAttribute("alt","Uploaded image"),d?h.classList.remove("fd-hidden"):h.classList.add("fd-hidden"),e.innerHTML="",e.append(h),a==null||a.addEventListener("image:loaded",({detail:b})=>{h.classList.remove("fd-hidden"),h.setAttribute("src",b.imgElem.src)}),!0},handleTextField:(s,e)=>{const i=s.querySelector('input[name]:not([type="checkbox"]):not([type="radio"]):not([type="file"]), textarea[name]');if(!i)return;const a=d=>{e.textContent=d.length>20?d.substring(0,20)+"...":d};return a(i.value),i.addEventListener("input",()=>{a(i.value)}),!0},handleSelectField:(s,e)=>{const i=s.querySelector("select[name]");if(!i)return;const a=d=>{const h=i.querySelector(`option[value="${d}"]`);e.textContent=h==null?void 0:h.textContent};return a(i.value),i.addEventListener("change",d=>{a(d.target.value)}),!0}};document.querySelectorAll(F.itemSelector).forEach(F.initializeSortable);document.addEventListener("click",s=>{const e=s.target.closest(F.addRowSelector);if(!e)return;s.preventDefault();const i=e.closest(F.itemSelector);F.addRow({itemContainer:i,collapse:!1})});window.Feadmin.RepeatedField=F;const Ft={imageSelector:"[data-form-image]",formGroupSelector:"[data-form-group]",checkboxSelector:'input[type="checkbox"]',deleteFileSelector:"[data-delete-file]",fileInfoSelector:"[data-file-info]",fileDefaultTemplateSelector:"[data-file-default-template]",handleSubmitters:s=>{s.querySelectorAll('[type="submit"]').forEach(i=>{i.classList.add("btn--loading"),i.disabled=!0})},handleSingleSubmitter:s=>{s.classList.add("btn--loading"),s.disabled=!0},handleImageInput:s=>{const e=s.closest(Ft.imageSelector),i=()=>{const a=new FileReader,d=s.files[0];a.readAsDataURL(d),d.type.match("image.*")||window.Feadmin.Toastr.add("Please select an image file."),a.onload=()=>{let h=e.querySelector("[data-image-wrapper] > img");if(h||(h=document.createElement("img"),h.classList.add("fd-w-full","fd-h-full","fd-object-cover")),h.src=a.result,e.querySelector("[data-image-wrapper]").appendChild(h),!d.type.match("image.*"))h.remove();else{const f=new CustomEvent("image:loaded",{detail:{file:d,imgElem:h}});s.dispatchEvent(f)}}};return s.addEventListener("change",i),{destroy:()=>{s.removeEventListener("change",i)}}},handleCheckbox:s=>{var i;const e=(i=s==null?void 0:s.closest(Ft.formGroupSelector))==null?void 0:i.querySelector('input[type="hidden"]');e&&(s.setAttribute("name",`_visualized_${s.name}`),s.closest("label").addEventListener("click",a=>{a.target.tagName!=="INPUT"&&(a.preventDefault(),s.checked=!s.checked,s.dispatchEvent(new Event("change")))}),s.addEventListener("change",()=>{e.value=s.checked?1:0,e.dispatchEvent(new Event("change"))}))},onRemoveFile:s=>{if(!s)return;const e=s.closest("form"),i=s.closest(Ft.formGroupSelector);e&&i&&F.addToRemoveList(e,i.dataset.formGroup),s.remove()}};document.querySelectorAll("form").forEach(s=>{s.addEventListener("submit",()=>{Ft.handleSubmitters(s)})});document.querySelectorAll("[data-like-submit]").forEach(s=>{s.addEventListener("click",()=>{Ft.handleSingleSubmitter(s)})});document.querySelectorAll(Ft.imageSelector).forEach(s=>{Ft.handleImageInput(s.querySelector('input[type="file"]'))});document.querySelectorAll(Ft.deleteFileSelector).forEach(s=>{s.addEventListener("click",()=>{Ft.onRemoveFile(s.closest(Ft.fileInfoSelector))})});document.querySelectorAll(Ft.checkboxSelector).forEach(s=>{Ft.handleCheckbox(s)});window.Feadmin.Form=Ft;const ul={open(s,e={}){var i,a,d;s.style.removeProperty("display"),document.body.classList.add("fd-overflow-hidden"),(a=(i=e.related)==null?void 0:i.dataset)!=null&&a.action&&this.setFormAction(s,e.related),(d=s.querySelector("[data-modal-autofocus]"))==null||d.focus(),s.dispatchEvent(new CustomEvent("modal.open",{detail:e}))},close(s,e={}){s.style.setProperty("display","none"),document.body.classList.remove("fd-overflow-hidden"),s.dispatchEvent(new CustomEvent("modal.close",{detail:e}))},setFormAction(s,e){const i=s.querySelector("form");i.action=e.dataset.action}},OF=document.querySelectorAll("[data-modal-close]"),Ws=document.querySelector("[data-modal]");document.addEventListener("click",s=>{const e=s.target.closest("[data-modal-open]");e&&(s.preventDefault(),ul.open(document.querySelector(e.dataset.modalOpen),{related:e}))});OF.forEach(s=>{const e=s.closest("[data-modal]");s.addEventListener("click",()=>ul.close(e,{related:s}))});Ws==null||Ws.addEventListener("click",s=>{s.target===Ws&&ul.close(Ws)});window.Feadmin.Modal=ul;const yi={containerSelector:"[data-collapsible]",toggleSelector:"[data-collapse-toggle]",contentSelector:"[data-collapse-content]",iconSelector:"[data-collapse-icon]",init:()=>{document.querySelectorAll(yi.containerSelector).forEach(s=>{const e=s.querySelector(yi.toggleSelector);e==null||e.addEventListener("click",i=>{i.preventDefault(),yi.toggle(e.closest(yi.containerSelector))})})},toggle:(s,e=null)=>{e===null?s.setAttribute("aria-expanded",s.getAttribute("aria-expanded")==="true"?"false":"true"):e?s.setAttribute("aria-expanded","true"):s.setAttribute("aria-expanded","false")},open:s=>{yi.toggle(s,!0)},close:s=>{yi.toggle(s,!1)}};yi.init();const we={fieldSelector:"[data-taxonomy-field]",primaryGroupSelector:"[data-primary-taxonomy-group]",primarySelectSelector:"[data-primary-taxonomy-select]",checkboxSelector:"[data-taxonomy-checkbox]",displaySelect:s=>{s.querySelector(we.primaryGroupSelector).classList.remove("fd-hidden")},hideSelect:s=>{s.querySelector(we.primaryGroupSelector).classList.add("fd-hidden")},clearSelectOptions:s=>{const e=s.querySelector(we.primarySelectSelector);for(;e.options.length>1;)e.remove(1)},createOption:(s,e,i)=>{const a=s.querySelector(we.primarySelectSelector),d=document.createElement("option");d.value=e,d.text=i,a.dataset.primaryTaxonomySelect===e&&(d.selected=!0),a.appendChild(d)},onChange:s=>{const e=s.querySelectorAll(we.checkboxSelector),i=Array.from(e).filter(a=>a.checked);we.clearSelectOptions(s),i.map(a=>{we.createOption(s,a.value,a.dataset.taxonomyCheckbox)}),i.length>0?we.displaySelect(s):we.hideSelect(s)}},NF=document.querySelectorAll(we.checkboxSelector);NF.forEach(s=>{s.addEventListener("change",e=>{we.onChange(e.target.closest(we.fieldSelector))})});const DF=document.querySelectorAll(we.fieldSelector);DF.forEach(s=>{we.onChange(s)})});export default LF();
